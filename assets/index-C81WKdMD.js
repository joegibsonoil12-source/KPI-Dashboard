(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function AI(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var WA={exports:{}},pp={},zA={exports:{}},rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hf=Symbol.for("react.element"),OI=Symbol.for("react.portal"),CI=Symbol.for("react.fragment"),PI=Symbol.for("react.strict_mode"),jI=Symbol.for("react.profiler"),NI=Symbol.for("react.provider"),FI=Symbol.for("react.context"),II=Symbol.for("react.forward_ref"),DI=Symbol.for("react.suspense"),RI=Symbol.for("react.memo"),MI=Symbol.for("react.lazy"),Yb=Symbol.iterator;function $I(e){return e===null||typeof e!="object"?null:(e=Yb&&e[Yb]||e["@@iterator"],typeof e=="function"?e:null)}var HA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},VA=Object.assign,GA={};function Zl(e,t,r){this.props=e,this.context=t,this.refs=GA,this.updater=r||HA}Zl.prototype.isReactComponent={};Zl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Zl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function KA(){}KA.prototype=Zl.prototype;function Xx(e,t,r){this.props=e,this.context=t,this.refs=GA,this.updater=r||HA}var Yx=Xx.prototype=new KA;Yx.constructor=Xx;VA(Yx,Zl.prototype);Yx.isPureReactComponent=!0;var Jb=Array.isArray,qA=Object.prototype.hasOwnProperty,Jx={current:null},XA={key:!0,ref:!0,__self:!0,__source:!0};function YA(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)qA.call(t,n)&&!XA.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Hf,type:e,key:i,ref:s,props:a,_owner:Jx.current}}function LI(e,t){return{$$typeof:Hf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Qx(e){return typeof e=="object"&&e!==null&&e.$$typeof===Hf}function BI(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Qb=/\/+/g;function Fm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?BI(""+e.key):t.toString(36)}function h0(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Hf:case OI:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+Fm(s,0):n,Jb(a)?(r="",e!=null&&(r=e.replace(Qb,"$&/")+"/"),h0(a,t,r,"",function(c){return c})):a!=null&&(Qx(a)&&(a=LI(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(Qb,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",Jb(e))for(var o=0;o<e.length;o++){i=e[o];var l=n+Fm(i,o);s+=h0(i,t,r,l,a)}else if(l=$I(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=n+Fm(i,o++),s+=h0(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function yd(e,t,r){if(e==null)return e;var n=[],a=0;return h0(e,n,"","",function(i){return t.call(r,i,a++)}),n}function UI(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var tn={current:null},p0={transition:null},WI={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:p0,ReactCurrentOwner:Jx};function JA(){throw Error("act(...) is not supported in production builds of React.")}rt.Children={map:yd,forEach:function(e,t,r){yd(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return yd(e,function(){t++}),t},toArray:function(e){return yd(e,function(t){return t})||[]},only:function(e){if(!Qx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};rt.Component=Zl;rt.Fragment=CI;rt.Profiler=jI;rt.PureComponent=Xx;rt.StrictMode=PI;rt.Suspense=DI;rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WI;rt.act=JA;rt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=VA({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=Jx.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)qA.call(t,l)&&!XA.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Hf,type:e.type,key:a,ref:i,props:n,_owner:s}};rt.createContext=function(e){return e={$$typeof:FI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:NI,_context:e},e.Consumer=e};rt.createElement=YA;rt.createFactory=function(e){var t=YA.bind(null,e);return t.type=e,t};rt.createRef=function(){return{current:null}};rt.forwardRef=function(e){return{$$typeof:II,render:e}};rt.isValidElement=Qx;rt.lazy=function(e){return{$$typeof:MI,_payload:{_status:-1,_result:e},_init:UI}};rt.memo=function(e,t){return{$$typeof:RI,type:e,compare:t===void 0?null:t}};rt.startTransition=function(e){var t=p0.transition;p0.transition={};try{e()}finally{p0.transition=t}};rt.unstable_act=JA;rt.useCallback=function(e,t){return tn.current.useCallback(e,t)};rt.useContext=function(e){return tn.current.useContext(e)};rt.useDebugValue=function(){};rt.useDeferredValue=function(e){return tn.current.useDeferredValue(e)};rt.useEffect=function(e,t){return tn.current.useEffect(e,t)};rt.useId=function(){return tn.current.useId()};rt.useImperativeHandle=function(e,t,r){return tn.current.useImperativeHandle(e,t,r)};rt.useInsertionEffect=function(e,t){return tn.current.useInsertionEffect(e,t)};rt.useLayoutEffect=function(e,t){return tn.current.useLayoutEffect(e,t)};rt.useMemo=function(e,t){return tn.current.useMemo(e,t)};rt.useReducer=function(e,t,r){return tn.current.useReducer(e,t,r)};rt.useRef=function(e){return tn.current.useRef(e)};rt.useState=function(e){return tn.current.useState(e)};rt.useSyncExternalStore=function(e,t,r){return tn.current.useSyncExternalStore(e,t,r)};rt.useTransition=function(){return tn.current.useTransition()};rt.version="18.3.1";zA.exports=rt;var R=zA.exports;const Z=_t(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zI=R,HI=Symbol.for("react.element"),VI=Symbol.for("react.fragment"),GI=Object.prototype.hasOwnProperty,KI=zI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qI={key:!0,ref:!0,__self:!0,__source:!0};function QA(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)GI.call(t,n)&&!qI.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:HI,type:e,key:i,ref:s,props:a,_owner:KI.current}}pp.Fragment=VI;pp.jsx=QA;pp.jsxs=QA;WA.exports=pp;var v=WA.exports,ng={},ZA={exports:{}},Pn={},eO={exports:{}},tO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Q,j){var X=Q.length;Q.push(j);e:for(;0<X;){var ee=X-1>>>1,P=Q[ee];if(0<a(P,j))Q[ee]=j,Q[X]=P,X=ee;else break e}}function r(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var j=Q[0],X=Q.pop();if(X!==j){Q[0]=X;e:for(var ee=0,P=Q.length,G=P>>>1;ee<G;){var B=2*(ee+1)-1,q=Q[B],ne=B+1,ye=Q[ne];if(0>a(q,X))ne<P&&0>a(ye,q)?(Q[ee]=ye,Q[ne]=X,ee=ne):(Q[ee]=q,Q[B]=X,ee=B);else if(ne<P&&0>a(ye,X))Q[ee]=ye,Q[ne]=X,ee=ne;else break e}}return j}function a(Q,j){var X=Q.sortIndex-j.sortIndex;return X!==0?X:Q.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,f=null,d=3,h=!1,m=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Q){for(var j=r(c);j!==null;){if(j.callback===null)n(c);else if(j.startTime<=Q)n(c),j.sortIndex=j.expirationTime,t(l,j);else break;j=r(c)}}function k(Q){if(p=!1,y(Q),!m)if(r(l)!==null)m=!0,Y(b);else{var j=r(c);j!==null&&J(k,j.startTime-Q)}}function b(Q,j){m=!1,p&&(p=!1,x(E),E=-1),h=!0;var X=d;try{for(y(j),f=r(l);f!==null&&(!(f.expirationTime>j)||Q&&!C());){var ee=f.callback;if(typeof ee=="function"){f.callback=null,d=f.priorityLevel;var P=ee(f.expirationTime<=j);j=e.unstable_now(),typeof P=="function"?f.callback=P:f===r(l)&&n(l),y(j)}else n(l);f=r(l)}if(f!==null)var G=!0;else{var B=r(c);B!==null&&J(k,B.startTime-j),G=!1}return G}finally{f=null,d=X,h=!1}}var _=!1,S=null,E=-1,T=5,F=-1;function C(){return!(e.unstable_now()-F<T)}function A(){if(S!==null){var Q=e.unstable_now();F=Q;var j=!0;try{j=S(!0,Q)}finally{j?M():(_=!1,S=null)}}else _=!1}var M;if(typeof w=="function")M=function(){w(A)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,z=V.port2;V.port1.onmessage=A,M=function(){z.postMessage(null)}}else M=function(){g(A,0)};function Y(Q){S=Q,_||(_=!0,M())}function J(Q,j){E=g(function(){Q(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,Y(b))},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(Q){switch(d){case 1:case 2:case 3:var j=3;break;default:j=d}var X=d;d=j;try{return Q()}finally{d=X}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Q,j){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var X=d;d=Q;try{return j()}finally{d=X}},e.unstable_scheduleCallback=function(Q,j,X){var ee=e.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ee+X:ee):X=ee,Q){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=X+P,Q={id:u++,callback:j,priorityLevel:Q,startTime:X,expirationTime:P,sortIndex:-1},X>ee?(Q.sortIndex=X,t(c,Q),r(l)===null&&Q===r(c)&&(p?(x(E),E=-1):p=!0,J(k,X-ee))):(Q.sortIndex=P,t(l,Q),m||h||(m=!0,Y(b))),Q},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(Q){var j=d;return function(){var X=d;d=j;try{return Q.apply(this,arguments)}finally{d=X}}}})(tO);eO.exports=tO;var XI=eO.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YI=R,An=XI;function _e(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rO=new Set,Pu={};function fo(e,t){yl(e,t),yl(e+"Capture",t)}function yl(e,t){for(Pu[e]=t,e=0;e<t.length;e++)rO.add(t[e])}var ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ag=Object.prototype.hasOwnProperty,JI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zb={},e_={};function QI(e){return ag.call(e_,e)?!0:ag.call(Zb,e)?!1:JI.test(e)?e_[e]=!0:(Zb[e]=!0,!1)}function ZI(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function eD(e,t,r,n){if(t===null||typeof t>"u"||ZI(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function rn(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var Pr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Pr[e]=new rn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Pr[t]=new rn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Pr[e]=new rn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Pr[e]=new rn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Pr[e]=new rn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Pr[e]=new rn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Pr[e]=new rn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Pr[e]=new rn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Pr[e]=new rn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Zx=/[\-:]([a-z])/g;function e1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zx,e1);Pr[t]=new rn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zx,e1);Pr[t]=new rn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zx,e1);Pr[t]=new rn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Pr[e]=new rn(e,1,!1,e.toLowerCase(),null,!1,!1)});Pr.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Pr[e]=new rn(e,1,!1,e.toLowerCase(),null,!0,!0)});function t1(e,t,r,n){var a=Pr.hasOwnProperty(t)?Pr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(eD(t,r,a,n)&&(r=null),n||a===null?QI(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var xi=YI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xd=Symbol.for("react.element"),zo=Symbol.for("react.portal"),Ho=Symbol.for("react.fragment"),r1=Symbol.for("react.strict_mode"),ig=Symbol.for("react.profiler"),nO=Symbol.for("react.provider"),aO=Symbol.for("react.context"),n1=Symbol.for("react.forward_ref"),sg=Symbol.for("react.suspense"),og=Symbol.for("react.suspense_list"),a1=Symbol.for("react.memo"),Fi=Symbol.for("react.lazy"),iO=Symbol.for("react.offscreen"),t_=Symbol.iterator;function Tc(e){return e===null||typeof e!="object"?null:(e=t_&&e[t_]||e["@@iterator"],typeof e=="function"?e:null)}var Ut=Object.assign,Im;function Yc(e){if(Im===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Im=t&&t[1]||""}return`
`+Im+e}var Dm=!1;function Rm(e,t){if(!e||Dm)return"";Dm=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{Dm=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Yc(e):""}function tD(e){switch(e.tag){case 5:return Yc(e.type);case 16:return Yc("Lazy");case 13:return Yc("Suspense");case 19:return Yc("SuspenseList");case 0:case 2:case 15:return e=Rm(e.type,!1),e;case 11:return e=Rm(e.type.render,!1),e;case 1:return e=Rm(e.type,!0),e;default:return""}}function lg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ho:return"Fragment";case zo:return"Portal";case ig:return"Profiler";case r1:return"StrictMode";case sg:return"Suspense";case og:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case aO:return(e.displayName||"Context")+".Consumer";case nO:return(e._context.displayName||"Context")+".Provider";case n1:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case a1:return t=e.displayName||null,t!==null?t:lg(e.type)||"Memo";case Fi:t=e._payload,e=e._init;try{return lg(e(t))}catch{}}return null}function rD(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lg(t);case 8:return t===r1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ns(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function sO(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function nD(e){var t=sO(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wd(e){e._valueTracker||(e._valueTracker=nD(e))}function oO(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=sO(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function A0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function cg(e,t){var r=t.checked;return Ut({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function r_(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ns(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function lO(e,t){t=t.checked,t!=null&&t1(e,"checked",t,!1)}function ug(e,t){lO(e,t);var r=ns(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?fg(e,t.type,r):t.hasOwnProperty("defaultValue")&&fg(e,t.type,ns(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function n_(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function fg(e,t,r){(t!=="number"||A0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Jc=Array.isArray;function il(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ns(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function dg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(_e(91));return Ut({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function a_(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(_e(92));if(Jc(r)){if(1<r.length)throw Error(_e(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ns(r)}}function cO(e,t){var r=ns(t.value),n=ns(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function i_(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function uO(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function hg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?uO(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var bd,fO=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(bd=bd||document.createElement("div"),bd.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=bd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ju(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var iu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aD=["Webkit","ms","Moz","O"];Object.keys(iu).forEach(function(e){aD.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),iu[t]=iu[e]})});function dO(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||iu.hasOwnProperty(e)&&iu[e]?(""+t).trim():t+"px"}function hO(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=dO(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var iD=Ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pg(e,t){if(t){if(iD[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(_e(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(_e(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(_e(61))}if(t.style!=null&&typeof t.style!="object")throw Error(_e(62))}}function mg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vg=null;function i1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gg=null,sl=null,ol=null;function s_(e){if(e=Kf(e)){if(typeof gg!="function")throw Error(_e(280));var t=e.stateNode;t&&(t=xp(t),gg(e.stateNode,e.type,t))}}function pO(e){sl?ol?ol.push(e):ol=[e]:sl=e}function mO(){if(sl){var e=sl,t=ol;if(ol=sl=null,s_(e),t)for(e=0;e<t.length;e++)s_(t[e])}}function vO(e,t){return e(t)}function gO(){}var Mm=!1;function yO(e,t,r){if(Mm)return e(t,r);Mm=!0;try{return vO(e,t,r)}finally{Mm=!1,(sl!==null||ol!==null)&&(gO(),mO())}}function Nu(e,t){var r=e.stateNode;if(r===null)return null;var n=xp(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(_e(231,t,typeof r));return r}var yg=!1;if(ci)try{var Ac={};Object.defineProperty(Ac,"passive",{get:function(){yg=!0}}),window.addEventListener("test",Ac,Ac),window.removeEventListener("test",Ac,Ac)}catch{yg=!1}function sD(e,t,r,n,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var su=!1,O0=null,C0=!1,xg=null,oD={onError:function(e){su=!0,O0=e}};function lD(e,t,r,n,a,i,s,o,l){su=!1,O0=null,sD.apply(oD,arguments)}function cD(e,t,r,n,a,i,s,o,l){if(lD.apply(this,arguments),su){if(su){var c=O0;su=!1,O0=null}else throw Error(_e(198));C0||(C0=!0,xg=c)}}function ho(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function xO(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function o_(e){if(ho(e)!==e)throw Error(_e(188))}function uD(e){var t=e.alternate;if(!t){if(t=ho(e),t===null)throw Error(_e(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return o_(a),e;if(i===n)return o_(a),t;i=i.sibling}throw Error(_e(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(_e(189))}}if(r.alternate!==n)throw Error(_e(190))}if(r.tag!==3)throw Error(_e(188));return r.stateNode.current===r?e:t}function wO(e){return e=uD(e),e!==null?bO(e):null}function bO(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=bO(e);if(t!==null)return t;e=e.sibling}return null}var _O=An.unstable_scheduleCallback,l_=An.unstable_cancelCallback,fD=An.unstable_shouldYield,dD=An.unstable_requestPaint,Xt=An.unstable_now,hD=An.unstable_getCurrentPriorityLevel,s1=An.unstable_ImmediatePriority,SO=An.unstable_UserBlockingPriority,P0=An.unstable_NormalPriority,pD=An.unstable_LowPriority,kO=An.unstable_IdlePriority,mp=null,Ia=null;function mD(e){if(Ia&&typeof Ia.onCommitFiberRoot=="function")try{Ia.onCommitFiberRoot(mp,e,void 0,(e.current.flags&128)===128)}catch{}}var ga=Math.clz32?Math.clz32:yD,vD=Math.log,gD=Math.LN2;function yD(e){return e>>>=0,e===0?32:31-(vD(e)/gD|0)|0}var _d=64,Sd=4194304;function Qc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function j0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=Qc(o):(i&=s,i!==0&&(n=Qc(i)))}else s=r&~a,s!==0?n=Qc(s):i!==0&&(n=Qc(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ga(t),a=1<<r,n|=e[r],t&=~a;return n}function xD(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wD(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-ga(i),o=1<<s,l=a[s];l===-1?(!(o&r)||o&n)&&(a[s]=xD(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function wg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function EO(){var e=_d;return _d<<=1,!(_d&4194240)&&(_d=64),e}function $m(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Vf(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ga(t),e[t]=r}function bD(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ga(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function o1(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ga(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var vt=0;function TO(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var AO,l1,OO,CO,PO,bg=!1,kd=[],Ki=null,qi=null,Xi=null,Fu=new Map,Iu=new Map,Mi=[],_D="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function c_(e,t){switch(e){case"focusin":case"focusout":Ki=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":Xi=null;break;case"pointerover":case"pointerout":Fu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Iu.delete(t.pointerId)}}function Oc(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Kf(t),t!==null&&l1(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function SD(e,t,r,n,a){switch(t){case"focusin":return Ki=Oc(Ki,e,t,r,n,a),!0;case"dragenter":return qi=Oc(qi,e,t,r,n,a),!0;case"mouseover":return Xi=Oc(Xi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Fu.set(i,Oc(Fu.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Iu.set(i,Oc(Iu.get(i)||null,e,t,r,n,a)),!0}return!1}function jO(e){var t=Fs(e.target);if(t!==null){var r=ho(t);if(r!==null){if(t=r.tag,t===13){if(t=xO(r),t!==null){e.blockedOn=t,PO(e.priority,function(){OO(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function m0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=_g(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);vg=n,r.target.dispatchEvent(n),vg=null}else return t=Kf(r),t!==null&&l1(t),e.blockedOn=r,!1;t.shift()}return!0}function u_(e,t,r){m0(e)&&r.delete(t)}function kD(){bg=!1,Ki!==null&&m0(Ki)&&(Ki=null),qi!==null&&m0(qi)&&(qi=null),Xi!==null&&m0(Xi)&&(Xi=null),Fu.forEach(u_),Iu.forEach(u_)}function Cc(e,t){e.blockedOn===t&&(e.blockedOn=null,bg||(bg=!0,An.unstable_scheduleCallback(An.unstable_NormalPriority,kD)))}function Du(e){function t(a){return Cc(a,e)}if(0<kd.length){Cc(kd[0],e);for(var r=1;r<kd.length;r++){var n=kd[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ki!==null&&Cc(Ki,e),qi!==null&&Cc(qi,e),Xi!==null&&Cc(Xi,e),Fu.forEach(t),Iu.forEach(t),r=0;r<Mi.length;r++)n=Mi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Mi.length&&(r=Mi[0],r.blockedOn===null);)jO(r),r.blockedOn===null&&Mi.shift()}var ll=xi.ReactCurrentBatchConfig,N0=!0;function ED(e,t,r,n){var a=vt,i=ll.transition;ll.transition=null;try{vt=1,c1(e,t,r,n)}finally{vt=a,ll.transition=i}}function TD(e,t,r,n){var a=vt,i=ll.transition;ll.transition=null;try{vt=4,c1(e,t,r,n)}finally{vt=a,ll.transition=i}}function c1(e,t,r,n){if(N0){var a=_g(e,t,r,n);if(a===null)qm(e,t,n,F0,r),c_(e,n);else if(SD(a,e,t,r,n))n.stopPropagation();else if(c_(e,n),t&4&&-1<_D.indexOf(e)){for(;a!==null;){var i=Kf(a);if(i!==null&&AO(i),i=_g(e,t,r,n),i===null&&qm(e,t,n,F0,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else qm(e,t,n,null,r)}}var F0=null;function _g(e,t,r,n){if(F0=null,e=i1(n),e=Fs(e),e!==null)if(t=ho(e),t===null)e=null;else if(r=t.tag,r===13){if(e=xO(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return F0=e,null}function NO(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hD()){case s1:return 1;case SO:return 4;case P0:case pD:return 16;case kO:return 536870912;default:return 16}default:return 16}}var Ui=null,u1=null,v0=null;function FO(){if(v0)return v0;var e,t=u1,r=t.length,n,a="value"in Ui?Ui.value:Ui.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return v0=a.slice(e,1<n?1-n:void 0)}function g0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ed(){return!0}function f_(){return!1}function jn(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ed:f_,this.isPropagationStopped=f_,this}return Ut(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ed)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ed)},persist:function(){},isPersistent:Ed}),t}var ec={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},f1=jn(ec),Gf=Ut({},ec,{view:0,detail:0}),AD=jn(Gf),Lm,Bm,Pc,vp=Ut({},Gf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:d1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Pc&&(Pc&&e.type==="mousemove"?(Lm=e.screenX-Pc.screenX,Bm=e.screenY-Pc.screenY):Bm=Lm=0,Pc=e),Lm)},movementY:function(e){return"movementY"in e?e.movementY:Bm}}),d_=jn(vp),OD=Ut({},vp,{dataTransfer:0}),CD=jn(OD),PD=Ut({},Gf,{relatedTarget:0}),Um=jn(PD),jD=Ut({},ec,{animationName:0,elapsedTime:0,pseudoElement:0}),ND=jn(jD),FD=Ut({},ec,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ID=jn(FD),DD=Ut({},ec,{data:0}),h_=jn(DD),RD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$D={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LD(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$D[e])?!!t[e]:!1}function d1(){return LD}var BD=Ut({},Gf,{key:function(e){if(e.key){var t=RD[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=g0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?MD[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:d1,charCode:function(e){return e.type==="keypress"?g0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?g0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),UD=jn(BD),WD=Ut({},vp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),p_=jn(WD),zD=Ut({},Gf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:d1}),HD=jn(zD),VD=Ut({},ec,{propertyName:0,elapsedTime:0,pseudoElement:0}),GD=jn(VD),KD=Ut({},vp,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qD=jn(KD),XD=[9,13,27,32],h1=ci&&"CompositionEvent"in window,ou=null;ci&&"documentMode"in document&&(ou=document.documentMode);var YD=ci&&"TextEvent"in window&&!ou,IO=ci&&(!h1||ou&&8<ou&&11>=ou),m_=" ",v_=!1;function DO(e,t){switch(e){case"keyup":return XD.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function RO(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vo=!1;function JD(e,t){switch(e){case"compositionend":return RO(t);case"keypress":return t.which!==32?null:(v_=!0,m_);case"textInput":return e=t.data,e===m_&&v_?null:e;default:return null}}function QD(e,t){if(Vo)return e==="compositionend"||!h1&&DO(e,t)?(e=FO(),v0=u1=Ui=null,Vo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return IO&&t.locale!=="ko"?null:t.data;default:return null}}var ZD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function g_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ZD[e.type]:t==="textarea"}function MO(e,t,r,n){pO(n),t=I0(t,"onChange"),0<t.length&&(r=new f1("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var lu=null,Ru=null;function eR(e){qO(e,0)}function gp(e){var t=qo(e);if(oO(t))return e}function tR(e,t){if(e==="change")return t}var $O=!1;if(ci){var Wm;if(ci){var zm="oninput"in document;if(!zm){var y_=document.createElement("div");y_.setAttribute("oninput","return;"),zm=typeof y_.oninput=="function"}Wm=zm}else Wm=!1;$O=Wm&&(!document.documentMode||9<document.documentMode)}function x_(){lu&&(lu.detachEvent("onpropertychange",LO),Ru=lu=null)}function LO(e){if(e.propertyName==="value"&&gp(Ru)){var t=[];MO(t,Ru,e,i1(e)),yO(eR,t)}}function rR(e,t,r){e==="focusin"?(x_(),lu=t,Ru=r,lu.attachEvent("onpropertychange",LO)):e==="focusout"&&x_()}function nR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return gp(Ru)}function aR(e,t){if(e==="click")return gp(t)}function iR(e,t){if(e==="input"||e==="change")return gp(t)}function sR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ba=typeof Object.is=="function"?Object.is:sR;function Mu(e,t){if(ba(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!ag.call(t,a)||!ba(e[a],t[a]))return!1}return!0}function w_(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function b_(e,t){var r=w_(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=w_(r)}}function BO(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?BO(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function UO(){for(var e=window,t=A0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=A0(e.document)}return t}function p1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function oR(e){var t=UO(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&BO(r.ownerDocument.documentElement,r)){if(n!==null&&p1(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=b_(r,i);var s=b_(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var lR=ci&&"documentMode"in document&&11>=document.documentMode,Go=null,Sg=null,cu=null,kg=!1;function __(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;kg||Go==null||Go!==A0(n)||(n=Go,"selectionStart"in n&&p1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),cu&&Mu(cu,n)||(cu=n,n=I0(Sg,"onSelect"),0<n.length&&(t=new f1("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Go)))}function Td(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ko={animationend:Td("Animation","AnimationEnd"),animationiteration:Td("Animation","AnimationIteration"),animationstart:Td("Animation","AnimationStart"),transitionend:Td("Transition","TransitionEnd")},Hm={},WO={};ci&&(WO=document.createElement("div").style,"AnimationEvent"in window||(delete Ko.animationend.animation,delete Ko.animationiteration.animation,delete Ko.animationstart.animation),"TransitionEvent"in window||delete Ko.transitionend.transition);function yp(e){if(Hm[e])return Hm[e];if(!Ko[e])return e;var t=Ko[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in WO)return Hm[e]=t[r];return e}var zO=yp("animationend"),HO=yp("animationiteration"),VO=yp("animationstart"),GO=yp("transitionend"),KO=new Map,S_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cs(e,t){KO.set(e,t),fo(t,[e])}for(var Vm=0;Vm<S_.length;Vm++){var Gm=S_[Vm],cR=Gm.toLowerCase(),uR=Gm[0].toUpperCase()+Gm.slice(1);cs(cR,"on"+uR)}cs(zO,"onAnimationEnd");cs(HO,"onAnimationIteration");cs(VO,"onAnimationStart");cs("dblclick","onDoubleClick");cs("focusin","onFocus");cs("focusout","onBlur");cs(GO,"onTransitionEnd");yl("onMouseEnter",["mouseout","mouseover"]);yl("onMouseLeave",["mouseout","mouseover"]);yl("onPointerEnter",["pointerout","pointerover"]);yl("onPointerLeave",["pointerout","pointerover"]);fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fo("onBeforeInput",["compositionend","keypress","textInput","paste"]);fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zc));function k_(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,cD(n,t,void 0,e),e.currentTarget=null}function qO(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;k_(a,o,c),i=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;k_(a,o,c),i=l}}}if(C0)throw e=xg,C0=!1,xg=null,e}function Tt(e,t){var r=t[Cg];r===void 0&&(r=t[Cg]=new Set);var n=e+"__bubble";r.has(n)||(XO(t,e,2,!1),r.add(n))}function Km(e,t,r){var n=0;t&&(n|=4),XO(r,e,n,t)}var Ad="_reactListening"+Math.random().toString(36).slice(2);function $u(e){if(!e[Ad]){e[Ad]=!0,rO.forEach(function(r){r!=="selectionchange"&&(fR.has(r)||Km(r,!1,e),Km(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ad]||(t[Ad]=!0,Km("selectionchange",!1,t))}}function XO(e,t,r,n){switch(NO(t)){case 1:var a=ED;break;case 4:a=TD;break;default:a=c1}r=a.bind(null,t,r,e),a=void 0,!yg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function qm(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Fs(o),s===null)return;if(l=s.tag,l===5||l===6){n=i=s;continue e}o=o.parentNode}}n=n.return}yO(function(){var c=i,u=i1(r),f=[];e:{var d=KO.get(e);if(d!==void 0){var h=f1,m=e;switch(e){case"keypress":if(g0(r)===0)break e;case"keydown":case"keyup":h=UD;break;case"focusin":m="focus",h=Um;break;case"focusout":m="blur",h=Um;break;case"beforeblur":case"afterblur":h=Um;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=d_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=CD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=HD;break;case zO:case HO:case VO:h=ND;break;case GO:h=GD;break;case"scroll":h=AD;break;case"wheel":h=qD;break;case"copy":case"cut":case"paste":h=ID;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=p_}var p=(t&4)!==0,g=!p&&e==="scroll",x=p?d!==null?d+"Capture":null:d;p=[];for(var w=c,y;w!==null;){y=w;var k=y.stateNode;if(y.tag===5&&k!==null&&(y=k,x!==null&&(k=Nu(w,x),k!=null&&p.push(Lu(w,k,y)))),g)break;w=w.return}0<p.length&&(d=new h(d,m,null,r,u),f.push({event:d,listeners:p}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&r!==vg&&(m=r.relatedTarget||r.fromElement)&&(Fs(m)||m[ui]))break e;if((h||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=c,m=m?Fs(m):null,m!==null&&(g=ho(m),m!==g||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=c),h!==m)){if(p=d_,k="onMouseLeave",x="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(p=p_,k="onPointerLeave",x="onPointerEnter",w="pointer"),g=h==null?d:qo(h),y=m==null?d:qo(m),d=new p(k,w+"leave",h,r,u),d.target=g,d.relatedTarget=y,k=null,Fs(u)===c&&(p=new p(x,w+"enter",m,r,u),p.target=y,p.relatedTarget=g,k=p),g=k,h&&m)t:{for(p=h,x=m,w=0,y=p;y;y=Eo(y))w++;for(y=0,k=x;k;k=Eo(k))y++;for(;0<w-y;)p=Eo(p),w--;for(;0<y-w;)x=Eo(x),y--;for(;w--;){if(p===x||x!==null&&p===x.alternate)break t;p=Eo(p),x=Eo(x)}p=null}else p=null;h!==null&&E_(f,d,h,p,!1),m!==null&&g!==null&&E_(f,g,m,p,!0)}}e:{if(d=c?qo(c):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var b=tR;else if(g_(d))if($O)b=iR;else{b=nR;var _=rR}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(b=aR);if(b&&(b=b(e,c))){MO(f,b,r,u);break e}_&&_(e,d,c),e==="focusout"&&(_=d._wrapperState)&&_.controlled&&d.type==="number"&&fg(d,"number",d.value)}switch(_=c?qo(c):window,e){case"focusin":(g_(_)||_.contentEditable==="true")&&(Go=_,Sg=c,cu=null);break;case"focusout":cu=Sg=Go=null;break;case"mousedown":kg=!0;break;case"contextmenu":case"mouseup":case"dragend":kg=!1,__(f,r,u);break;case"selectionchange":if(lR)break;case"keydown":case"keyup":__(f,r,u)}var S;if(h1)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Vo?DO(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(IO&&r.locale!=="ko"&&(Vo||E!=="onCompositionStart"?E==="onCompositionEnd"&&Vo&&(S=FO()):(Ui=u,u1="value"in Ui?Ui.value:Ui.textContent,Vo=!0)),_=I0(c,E),0<_.length&&(E=new h_(E,e,null,r,u),f.push({event:E,listeners:_}),S?E.data=S:(S=RO(r),S!==null&&(E.data=S)))),(S=YD?JD(e,r):QD(e,r))&&(c=I0(c,"onBeforeInput"),0<c.length&&(u=new h_("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=S))}qO(f,t)})}function Lu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function I0(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Nu(e,r),i!=null&&n.unshift(Lu(e,i,a)),i=Nu(e,t),i!=null&&n.push(Lu(e,i,a))),e=e.return}return n}function Eo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function E_(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=Nu(r,i),l!=null&&s.unshift(Lu(r,l,o))):a||(l=Nu(r,i),l!=null&&s.push(Lu(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var dR=/\r\n?/g,hR=/\u0000|\uFFFD/g;function T_(e){return(typeof e=="string"?e:""+e).replace(dR,`
`).replace(hR,"")}function Od(e,t,r){if(t=T_(t),T_(e)!==t&&r)throw Error(_e(425))}function D0(){}var Eg=null,Tg=null;function Ag(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Og=typeof setTimeout=="function"?setTimeout:void 0,pR=typeof clearTimeout=="function"?clearTimeout:void 0,A_=typeof Promise=="function"?Promise:void 0,mR=typeof queueMicrotask=="function"?queueMicrotask:typeof A_<"u"?function(e){return A_.resolve(null).then(e).catch(vR)}:Og;function vR(e){setTimeout(function(){throw e})}function Xm(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Du(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Du(t)}function Yi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function O_(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var tc=Math.random().toString(36).slice(2),ja="__reactFiber$"+tc,Bu="__reactProps$"+tc,ui="__reactContainer$"+tc,Cg="__reactEvents$"+tc,gR="__reactListeners$"+tc,yR="__reactHandles$"+tc;function Fs(e){var t=e[ja];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ui]||r[ja]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=O_(e);e!==null;){if(r=e[ja])return r;e=O_(e)}return t}e=r,r=e.parentNode}return null}function Kf(e){return e=e[ja]||e[ui],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function qo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(_e(33))}function xp(e){return e[Bu]||null}var Pg=[],Xo=-1;function us(e){return{current:e}}function Pt(e){0>Xo||(e.current=Pg[Xo],Pg[Xo]=null,Xo--)}function Et(e,t){Xo++,Pg[Xo]=e.current,e.current=t}var as={},Vr=us(as),cn=us(!1),Xs=as;function xl(e,t){var r=e.type.contextTypes;if(!r)return as;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function un(e){return e=e.childContextTypes,e!=null}function R0(){Pt(cn),Pt(Vr)}function C_(e,t,r){if(Vr.current!==as)throw Error(_e(168));Et(Vr,t),Et(cn,r)}function YO(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(_e(108,rD(e)||"Unknown",a));return Ut({},r,n)}function M0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||as,Xs=Vr.current,Et(Vr,e),Et(cn,cn.current),!0}function P_(e,t,r){var n=e.stateNode;if(!n)throw Error(_e(169));r?(e=YO(e,t,Xs),n.__reactInternalMemoizedMergedChildContext=e,Pt(cn),Pt(Vr),Et(Vr,e)):Pt(cn),Et(cn,r)}var qa=null,wp=!1,Ym=!1;function JO(e){qa===null?qa=[e]:qa.push(e)}function xR(e){wp=!0,JO(e)}function fs(){if(!Ym&&qa!==null){Ym=!0;var e=0,t=vt;try{var r=qa;for(vt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}qa=null,wp=!1}catch(a){throw qa!==null&&(qa=qa.slice(e+1)),_O(s1,fs),a}finally{vt=t,Ym=!1}}return null}var Yo=[],Jo=0,$0=null,L0=0,Un=[],Wn=0,Ys=null,Xa=1,Ya="";function Es(e,t){Yo[Jo++]=L0,Yo[Jo++]=$0,$0=e,L0=t}function QO(e,t,r){Un[Wn++]=Xa,Un[Wn++]=Ya,Un[Wn++]=Ys,Ys=e;var n=Xa;e=Ya;var a=32-ga(n)-1;n&=~(1<<a),r+=1;var i=32-ga(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,Xa=1<<32-ga(t)+a|r<<a|n,Ya=i+e}else Xa=1<<i|r<<a|n,Ya=e}function m1(e){e.return!==null&&(Es(e,1),QO(e,1,0))}function v1(e){for(;e===$0;)$0=Yo[--Jo],Yo[Jo]=null,L0=Yo[--Jo],Yo[Jo]=null;for(;e===Ys;)Ys=Un[--Wn],Un[Wn]=null,Ya=Un[--Wn],Un[Wn]=null,Xa=Un[--Wn],Un[Wn]=null}var Tn=null,En=null,Ft=!1,fa=null;function ZO(e,t){var r=zn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function j_(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Tn=e,En=Yi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Tn=e,En=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ys!==null?{id:Xa,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=zn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Tn=e,En=null,!0):!1;default:return!1}}function jg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ng(e){if(Ft){var t=En;if(t){var r=t;if(!j_(e,t)){if(jg(e))throw Error(_e(418));t=Yi(r.nextSibling);var n=Tn;t&&j_(e,t)?ZO(n,r):(e.flags=e.flags&-4097|2,Ft=!1,Tn=e)}}else{if(jg(e))throw Error(_e(418));e.flags=e.flags&-4097|2,Ft=!1,Tn=e}}}function N_(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Tn=e}function Cd(e){if(e!==Tn)return!1;if(!Ft)return N_(e),Ft=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ag(e.type,e.memoizedProps)),t&&(t=En)){if(jg(e))throw eC(),Error(_e(418));for(;t;)ZO(e,t),t=Yi(t.nextSibling)}if(N_(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(_e(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){En=Yi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}En=null}}else En=Tn?Yi(e.stateNode.nextSibling):null;return!0}function eC(){for(var e=En;e;)e=Yi(e.nextSibling)}function wl(){En=Tn=null,Ft=!1}function g1(e){fa===null?fa=[e]:fa.push(e)}var wR=xi.ReactCurrentBatchConfig;function jc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_e(309));var n=r.stateNode}if(!n)throw Error(_e(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(_e(284));if(!r._owner)throw Error(_e(290,e))}return e}function Pd(e,t){throw e=Object.prototype.toString.call(t),Error(_e(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function F_(e){var t=e._init;return t(e._payload)}function tC(e){function t(x,w){if(e){var y=x.deletions;y===null?(x.deletions=[w],x.flags|=16):y.push(w)}}function r(x,w){if(!e)return null;for(;w!==null;)t(x,w),w=w.sibling;return null}function n(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function a(x,w){return x=es(x,w),x.index=0,x.sibling=null,x}function i(x,w,y){return x.index=y,e?(y=x.alternate,y!==null?(y=y.index,y<w?(x.flags|=2,w):y):(x.flags|=2,w)):(x.flags|=1048576,w)}function s(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,w,y,k){return w===null||w.tag!==6?(w=nv(y,x.mode,k),w.return=x,w):(w=a(w,y),w.return=x,w)}function l(x,w,y,k){var b=y.type;return b===Ho?u(x,w,y.props.children,k,y.key):w!==null&&(w.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Fi&&F_(b)===w.type)?(k=a(w,y.props),k.ref=jc(x,w,y),k.return=x,k):(k=k0(y.type,y.key,y.props,null,x.mode,k),k.ref=jc(x,w,y),k.return=x,k)}function c(x,w,y,k){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=av(y,x.mode,k),w.return=x,w):(w=a(w,y.children||[]),w.return=x,w)}function u(x,w,y,k,b){return w===null||w.tag!==7?(w=Ws(y,x.mode,k,b),w.return=x,w):(w=a(w,y),w.return=x,w)}function f(x,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=nv(""+w,x.mode,y),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case xd:return y=k0(w.type,w.key,w.props,null,x.mode,y),y.ref=jc(x,null,w),y.return=x,y;case zo:return w=av(w,x.mode,y),w.return=x,w;case Fi:var k=w._init;return f(x,k(w._payload),y)}if(Jc(w)||Tc(w))return w=Ws(w,x.mode,y,null),w.return=x,w;Pd(x,w)}return null}function d(x,w,y,k){var b=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:o(x,w,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case xd:return y.key===b?l(x,w,y,k):null;case zo:return y.key===b?c(x,w,y,k):null;case Fi:return b=y._init,d(x,w,b(y._payload),k)}if(Jc(y)||Tc(y))return b!==null?null:u(x,w,y,k,null);Pd(x,y)}return null}function h(x,w,y,k,b){if(typeof k=="string"&&k!==""||typeof k=="number")return x=x.get(y)||null,o(w,x,""+k,b);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case xd:return x=x.get(k.key===null?y:k.key)||null,l(w,x,k,b);case zo:return x=x.get(k.key===null?y:k.key)||null,c(w,x,k,b);case Fi:var _=k._init;return h(x,w,y,_(k._payload),b)}if(Jc(k)||Tc(k))return x=x.get(y)||null,u(w,x,k,b,null);Pd(w,k)}return null}function m(x,w,y,k){for(var b=null,_=null,S=w,E=w=0,T=null;S!==null&&E<y.length;E++){S.index>E?(T=S,S=null):T=S.sibling;var F=d(x,S,y[E],k);if(F===null){S===null&&(S=T);break}e&&S&&F.alternate===null&&t(x,S),w=i(F,w,E),_===null?b=F:_.sibling=F,_=F,S=T}if(E===y.length)return r(x,S),Ft&&Es(x,E),b;if(S===null){for(;E<y.length;E++)S=f(x,y[E],k),S!==null&&(w=i(S,w,E),_===null?b=S:_.sibling=S,_=S);return Ft&&Es(x,E),b}for(S=n(x,S);E<y.length;E++)T=h(S,x,E,y[E],k),T!==null&&(e&&T.alternate!==null&&S.delete(T.key===null?E:T.key),w=i(T,w,E),_===null?b=T:_.sibling=T,_=T);return e&&S.forEach(function(C){return t(x,C)}),Ft&&Es(x,E),b}function p(x,w,y,k){var b=Tc(y);if(typeof b!="function")throw Error(_e(150));if(y=b.call(y),y==null)throw Error(_e(151));for(var _=b=null,S=w,E=w=0,T=null,F=y.next();S!==null&&!F.done;E++,F=y.next()){S.index>E?(T=S,S=null):T=S.sibling;var C=d(x,S,F.value,k);if(C===null){S===null&&(S=T);break}e&&S&&C.alternate===null&&t(x,S),w=i(C,w,E),_===null?b=C:_.sibling=C,_=C,S=T}if(F.done)return r(x,S),Ft&&Es(x,E),b;if(S===null){for(;!F.done;E++,F=y.next())F=f(x,F.value,k),F!==null&&(w=i(F,w,E),_===null?b=F:_.sibling=F,_=F);return Ft&&Es(x,E),b}for(S=n(x,S);!F.done;E++,F=y.next())F=h(S,x,E,F.value,k),F!==null&&(e&&F.alternate!==null&&S.delete(F.key===null?E:F.key),w=i(F,w,E),_===null?b=F:_.sibling=F,_=F);return e&&S.forEach(function(A){return t(x,A)}),Ft&&Es(x,E),b}function g(x,w,y,k){if(typeof y=="object"&&y!==null&&y.type===Ho&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case xd:e:{for(var b=y.key,_=w;_!==null;){if(_.key===b){if(b=y.type,b===Ho){if(_.tag===7){r(x,_.sibling),w=a(_,y.props.children),w.return=x,x=w;break e}}else if(_.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Fi&&F_(b)===_.type){r(x,_.sibling),w=a(_,y.props),w.ref=jc(x,_,y),w.return=x,x=w;break e}r(x,_);break}else t(x,_);_=_.sibling}y.type===Ho?(w=Ws(y.props.children,x.mode,k,y.key),w.return=x,x=w):(k=k0(y.type,y.key,y.props,null,x.mode,k),k.ref=jc(x,w,y),k.return=x,x=k)}return s(x);case zo:e:{for(_=y.key;w!==null;){if(w.key===_)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){r(x,w.sibling),w=a(w,y.children||[]),w.return=x,x=w;break e}else{r(x,w);break}else t(x,w);w=w.sibling}w=av(y,x.mode,k),w.return=x,x=w}return s(x);case Fi:return _=y._init,g(x,w,_(y._payload),k)}if(Jc(y))return m(x,w,y,k);if(Tc(y))return p(x,w,y,k);Pd(x,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(r(x,w.sibling),w=a(w,y),w.return=x,x=w):(r(x,w),w=nv(y,x.mode,k),w.return=x,x=w),s(x)):r(x,w)}return g}var bl=tC(!0),rC=tC(!1),B0=us(null),U0=null,Qo=null,y1=null;function x1(){y1=Qo=U0=null}function w1(e){var t=B0.current;Pt(B0),e._currentValue=t}function Fg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function cl(e,t){U0=e,y1=Qo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(on=!0),e.firstContext=null)}function Xn(e){var t=e._currentValue;if(y1!==e)if(e={context:e,memoizedValue:t,next:null},Qo===null){if(U0===null)throw Error(_e(308));Qo=e,U0.dependencies={lanes:0,firstContext:e}}else Qo=Qo.next=e;return t}var Is=null;function b1(e){Is===null?Is=[e]:Is.push(e)}function nC(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,b1(t)):(r.next=a.next,a.next=r),t.interleaved=r,fi(e,n)}function fi(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ii=!1;function _1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aC(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ti(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ji(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,it&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,fi(e,r)}return a=n.interleaved,a===null?(t.next=t,b1(n)):(t.next=a.next,a.next=t),n.interleaved=t,fi(e,r)}function y0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,o1(e,r)}}function I_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function W0(e,t,r,n){var a=e.updateQueue;Ii=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var f=a.baseState;s=0,u=c=l=null,o=i;do{var d=o.lane,h=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(d=t,h=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(h,f,d);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,d=typeof m=="function"?m.call(h,f,d):m,d==null)break e;f=Ut({},f,d);break e;case 2:Ii=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=a.effects,d===null?a.effects=[o]:d.push(o))}else h={eventTime:h,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=h,l=f):u=u.next=h,s|=d;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;d=o,o=d.next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}while(!0);if(u===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Qs|=s,e.lanes=s,e.memoizedState=f}}function D_(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(_e(191,a));a.call(n)}}}var qf={},Da=us(qf),Uu=us(qf),Wu=us(qf);function Ds(e){if(e===qf)throw Error(_e(174));return e}function S1(e,t){switch(Et(Wu,t),Et(Uu,e),Et(Da,qf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:hg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=hg(t,e)}Pt(Da),Et(Da,t)}function _l(){Pt(Da),Pt(Uu),Pt(Wu)}function iC(e){Ds(Wu.current);var t=Ds(Da.current),r=hg(t,e.type);t!==r&&(Et(Uu,e),Et(Da,r))}function k1(e){Uu.current===e&&(Pt(Da),Pt(Uu))}var Mt=us(0);function z0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Jm=[];function E1(){for(var e=0;e<Jm.length;e++)Jm[e]._workInProgressVersionPrimary=null;Jm.length=0}var x0=xi.ReactCurrentDispatcher,Qm=xi.ReactCurrentBatchConfig,Js=0,Bt=null,ur=null,yr=null,H0=!1,uu=!1,zu=0,bR=0;function Nr(){throw Error(_e(321))}function T1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ba(e[r],t[r]))return!1;return!0}function A1(e,t,r,n,a,i){if(Js=i,Bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,x0.current=e===null||e.memoizedState===null?ER:TR,e=r(n,a),uu){i=0;do{if(uu=!1,zu=0,25<=i)throw Error(_e(301));i+=1,yr=ur=null,t.updateQueue=null,x0.current=AR,e=r(n,a)}while(uu)}if(x0.current=V0,t=ur!==null&&ur.next!==null,Js=0,yr=ur=Bt=null,H0=!1,t)throw Error(_e(300));return e}function O1(){var e=zu!==0;return zu=0,e}function Ca(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?Bt.memoizedState=yr=e:yr=yr.next=e,yr}function Yn(){if(ur===null){var e=Bt.alternate;e=e!==null?e.memoizedState:null}else e=ur.next;var t=yr===null?Bt.memoizedState:yr.next;if(t!==null)yr=t,ur=e;else{if(e===null)throw Error(_e(310));ur=e,e={memoizedState:ur.memoizedState,baseState:ur.baseState,baseQueue:ur.baseQueue,queue:ur.queue,next:null},yr===null?Bt.memoizedState=yr=e:yr=yr.next=e}return yr}function Hu(e,t){return typeof t=="function"?t(e):t}function Zm(e){var t=Yn(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var n=ur,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if((Js&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,s=n):l=l.next=f,Bt.lanes|=u,Qs|=u}c=c.next}while(c!==null&&c!==i);l===null?s=n:l.next=o,ba(n,t.memoizedState)||(on=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Bt.lanes|=i,Qs|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ev(e){var t=Yn(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);ba(i,t.memoizedState)||(on=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function sC(){}function oC(e,t){var r=Bt,n=Yn(),a=t(),i=!ba(n.memoizedState,a);if(i&&(n.memoizedState=a,on=!0),n=n.queue,C1(uC.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||yr!==null&&yr.memoizedState.tag&1){if(r.flags|=2048,Vu(9,cC.bind(null,r,n,a,t),void 0,null),br===null)throw Error(_e(349));Js&30||lC(r,t,a)}return a}function lC(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Bt.updateQueue,t===null?(t={lastEffect:null,stores:null},Bt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function cC(e,t,r,n){t.value=r,t.getSnapshot=n,fC(t)&&dC(e)}function uC(e,t,r){return r(function(){fC(t)&&dC(e)})}function fC(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ba(e,r)}catch{return!0}}function dC(e){var t=fi(e,1);t!==null&&ya(t,e,1,-1)}function R_(e){var t=Ca();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hu,lastRenderedState:e},t.queue=e,e=e.dispatch=kR.bind(null,Bt,e),[t.memoizedState,e]}function Vu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Bt.updateQueue,t===null?(t={lastEffect:null,stores:null},Bt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function hC(){return Yn().memoizedState}function w0(e,t,r,n){var a=Ca();Bt.flags|=e,a.memoizedState=Vu(1|t,r,void 0,n===void 0?null:n)}function bp(e,t,r,n){var a=Yn();n=n===void 0?null:n;var i=void 0;if(ur!==null){var s=ur.memoizedState;if(i=s.destroy,n!==null&&T1(n,s.deps)){a.memoizedState=Vu(t,r,i,n);return}}Bt.flags|=e,a.memoizedState=Vu(1|t,r,i,n)}function M_(e,t){return w0(8390656,8,e,t)}function C1(e,t){return bp(2048,8,e,t)}function pC(e,t){return bp(4,2,e,t)}function mC(e,t){return bp(4,4,e,t)}function vC(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function gC(e,t,r){return r=r!=null?r.concat([e]):null,bp(4,4,vC.bind(null,t,e),r)}function P1(){}function yC(e,t){var r=Yn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function xC(e,t){var r=Yn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function wC(e,t,r){return Js&21?(ba(r,t)||(r=EO(),Bt.lanes|=r,Qs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,on=!0),e.memoizedState=r)}function _R(e,t){var r=vt;vt=r!==0&&4>r?r:4,e(!0);var n=Qm.transition;Qm.transition={};try{e(!1),t()}finally{vt=r,Qm.transition=n}}function bC(){return Yn().memoizedState}function SR(e,t,r){var n=Zi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},_C(e))SC(t,r);else if(r=nC(e,t,r,n),r!==null){var a=Zr();ya(r,e,n,a),kC(r,t,n)}}function kR(e,t,r){var n=Zi(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(_C(e))SC(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,ba(o,s)){var l=t.interleaved;l===null?(a.next=a,b1(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=nC(e,t,a,n),r!==null&&(a=Zr(),ya(r,e,n,a),kC(r,t,n))}}function _C(e){var t=e.alternate;return e===Bt||t!==null&&t===Bt}function SC(e,t){uu=H0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function kC(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,o1(e,r)}}var V0={readContext:Xn,useCallback:Nr,useContext:Nr,useEffect:Nr,useImperativeHandle:Nr,useInsertionEffect:Nr,useLayoutEffect:Nr,useMemo:Nr,useReducer:Nr,useRef:Nr,useState:Nr,useDebugValue:Nr,useDeferredValue:Nr,useTransition:Nr,useMutableSource:Nr,useSyncExternalStore:Nr,useId:Nr,unstable_isNewReconciler:!1},ER={readContext:Xn,useCallback:function(e,t){return Ca().memoizedState=[e,t===void 0?null:t],e},useContext:Xn,useEffect:M_,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,w0(4194308,4,vC.bind(null,t,e),r)},useLayoutEffect:function(e,t){return w0(4194308,4,e,t)},useInsertionEffect:function(e,t){return w0(4,2,e,t)},useMemo:function(e,t){var r=Ca();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ca();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=SR.bind(null,Bt,e),[n.memoizedState,e]},useRef:function(e){var t=Ca();return e={current:e},t.memoizedState=e},useState:R_,useDebugValue:P1,useDeferredValue:function(e){return Ca().memoizedState=e},useTransition:function(){var e=R_(!1),t=e[0];return e=_R.bind(null,e[1]),Ca().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Bt,a=Ca();if(Ft){if(r===void 0)throw Error(_e(407));r=r()}else{if(r=t(),br===null)throw Error(_e(349));Js&30||lC(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,M_(uC.bind(null,n,i,e),[e]),n.flags|=2048,Vu(9,cC.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Ca(),t=br.identifierPrefix;if(Ft){var r=Ya,n=Xa;r=(n&~(1<<32-ga(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=zu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=bR++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},TR={readContext:Xn,useCallback:yC,useContext:Xn,useEffect:C1,useImperativeHandle:gC,useInsertionEffect:pC,useLayoutEffect:mC,useMemo:xC,useReducer:Zm,useRef:hC,useState:function(){return Zm(Hu)},useDebugValue:P1,useDeferredValue:function(e){var t=Yn();return wC(t,ur.memoizedState,e)},useTransition:function(){var e=Zm(Hu)[0],t=Yn().memoizedState;return[e,t]},useMutableSource:sC,useSyncExternalStore:oC,useId:bC,unstable_isNewReconciler:!1},AR={readContext:Xn,useCallback:yC,useContext:Xn,useEffect:C1,useImperativeHandle:gC,useInsertionEffect:pC,useLayoutEffect:mC,useMemo:xC,useReducer:ev,useRef:hC,useState:function(){return ev(Hu)},useDebugValue:P1,useDeferredValue:function(e){var t=Yn();return ur===null?t.memoizedState=e:wC(t,ur.memoizedState,e)},useTransition:function(){var e=ev(Hu)[0],t=Yn().memoizedState;return[e,t]},useMutableSource:sC,useSyncExternalStore:oC,useId:bC,unstable_isNewReconciler:!1};function sa(e,t){if(e&&e.defaultProps){t=Ut({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Ig(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ut({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var _p={isMounted:function(e){return(e=e._reactInternals)?ho(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Zr(),a=Zi(e),i=ti(n,a);i.payload=t,r!=null&&(i.callback=r),t=Ji(e,i,a),t!==null&&(ya(t,e,a,n),y0(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Zr(),a=Zi(e),i=ti(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Ji(e,i,a),t!==null&&(ya(t,e,a,n),y0(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Zr(),n=Zi(e),a=ti(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ji(e,a,n),t!==null&&(ya(t,e,n,r),y0(t,e,n))}};function $_(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!Mu(r,n)||!Mu(a,i):!0}function EC(e,t,r){var n=!1,a=as,i=t.contextType;return typeof i=="object"&&i!==null?i=Xn(i):(a=un(t)?Xs:Vr.current,n=t.contextTypes,i=(n=n!=null)?xl(e,a):as),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_p,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function L_(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&_p.enqueueReplaceState(t,t.state,null)}function Dg(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},_1(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Xn(i):(i=un(t)?Xs:Vr.current,a.context=xl(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Ig(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&_p.enqueueReplaceState(a,a.state,null),W0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Sl(e,t){try{var r="",n=t;do r+=tD(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function tv(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Rg(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var OR=typeof WeakMap=="function"?WeakMap:Map;function TC(e,t,r){r=ti(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){K0||(K0=!0,Gg=n),Rg(e,t)},r}function AC(e,t,r){r=ti(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Rg(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Rg(e,t),typeof n!="function"&&(Qi===null?Qi=new Set([this]):Qi.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function B_(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new OR;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=WR.bind(null,e,t,r),t.then(e,e))}function U_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function W_(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ti(-1,1),t.tag=2,Ji(r,t,1))),r.lanes|=1),e)}var CR=xi.ReactCurrentOwner,on=!1;function Xr(e,t,r,n){t.child=e===null?rC(t,null,r,n):bl(t,e.child,r,n)}function z_(e,t,r,n,a){r=r.render;var i=t.ref;return cl(t,a),n=A1(e,t,r,n,i,a),r=O1(),e!==null&&!on?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,di(e,t,a)):(Ft&&r&&m1(t),t.flags|=1,Xr(e,t,n,a),t.child)}function H_(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!$1(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,OC(e,t,i,n,a)):(e=k0(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:Mu,r(s,n)&&e.ref===t.ref)return di(e,t,a)}return t.flags|=1,e=es(i,n),e.ref=t.ref,e.return=t,t.child=e}function OC(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Mu(i,n)&&e.ref===t.ref)if(on=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(on=!0);else return t.lanes=e.lanes,di(e,t,a)}return Mg(e,t,r,n,a)}function CC(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Et(el,gn),gn|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Et(el,gn),gn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Et(el,gn),gn|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Et(el,gn),gn|=n;return Xr(e,t,a,r),t.child}function PC(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Mg(e,t,r,n,a){var i=un(r)?Xs:Vr.current;return i=xl(t,i),cl(t,a),r=A1(e,t,r,n,i,a),n=O1(),e!==null&&!on?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,di(e,t,a)):(Ft&&n&&m1(t),t.flags|=1,Xr(e,t,r,a),t.child)}function V_(e,t,r,n,a){if(un(r)){var i=!0;M0(t)}else i=!1;if(cl(t,a),t.stateNode===null)b0(e,t),EC(t,r,n),Dg(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=Xn(c):(c=un(r)?Xs:Vr.current,c=xl(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&L_(t,s,n,c),Ii=!1;var d=t.memoizedState;s.state=d,W0(t,n,s,a),l=t.memoizedState,o!==n||d!==l||cn.current||Ii?(typeof u=="function"&&(Ig(t,r,u,n),l=t.memoizedState),(o=Ii||$_(t,r,o,n,d,l,c))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,aC(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:sa(t.type,o),s.props=c,f=t.pendingProps,d=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=Xn(l):(l=un(r)?Xs:Vr.current,l=xl(t,l));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==f||d!==l)&&L_(t,s,n,l),Ii=!1,d=t.memoizedState,s.state=d,W0(t,n,s,a);var m=t.memoizedState;o!==f||d!==m||cn.current||Ii?(typeof h=="function"&&(Ig(t,r,h,n),m=t.memoizedState),(c=Ii||$_(t,r,c,n,d,m,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,m,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,m,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return $g(e,t,r,n,i,a)}function $g(e,t,r,n,a,i){PC(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&P_(t,r,!1),di(e,t,i);n=t.stateNode,CR.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=bl(t,e.child,null,i),t.child=bl(t,null,o,i)):Xr(e,t,o,i),t.memoizedState=n.state,a&&P_(t,r,!0),t.child}function jC(e){var t=e.stateNode;t.pendingContext?C_(e,t.pendingContext,t.pendingContext!==t.context):t.context&&C_(e,t.context,!1),S1(e,t.containerInfo)}function G_(e,t,r,n,a){return wl(),g1(a),t.flags|=256,Xr(e,t,r,n),t.child}var Lg={dehydrated:null,treeContext:null,retryLane:0};function Bg(e){return{baseLanes:e,cachePool:null,transitions:null}}function NC(e,t,r){var n=t.pendingProps,a=Mt.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Et(Mt,a&1),e===null)return Ng(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Ep(s,n,0,null),e=Ws(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Bg(r),t.memoizedState=Lg,e):j1(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return PR(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=es(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=es(o,i):(i=Ws(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?Bg(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=Lg,n}return i=e.child,e=i.sibling,n=es(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function j1(e,t){return t=Ep({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function jd(e,t,r,n){return n!==null&&g1(n),bl(t,e.child,null,r),e=j1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function PR(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=tv(Error(_e(422))),jd(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Ep({mode:"visible",children:n.children},a,0,null),i=Ws(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&bl(t,e.child,null,s),t.child.memoizedState=Bg(s),t.memoizedState=Lg,i);if(!(t.mode&1))return jd(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(_e(419)),n=tv(i,n,void 0),jd(e,t,s,n)}if(o=(s&e.childLanes)!==0,on||o){if(n=br,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,fi(e,a),ya(n,e,a,-1))}return M1(),n=tv(Error(_e(421))),jd(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=zR.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,En=Yi(a.nextSibling),Tn=t,Ft=!0,fa=null,e!==null&&(Un[Wn++]=Xa,Un[Wn++]=Ya,Un[Wn++]=Ys,Xa=e.id,Ya=e.overflow,Ys=t),t=j1(t,n.children),t.flags|=4096,t)}function K_(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Fg(e.return,t,r)}function rv(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function FC(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Xr(e,t,n.children,r),n=Mt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&K_(e,r,t);else if(e.tag===19)K_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Et(Mt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&z0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),rv(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&z0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}rv(t,!0,r,null,i);break;case"together":rv(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function b0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function di(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Qs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(_e(153));if(t.child!==null){for(e=t.child,r=es(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=es(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function jR(e,t,r){switch(t.tag){case 3:jC(t),wl();break;case 5:iC(t);break;case 1:un(t.type)&&M0(t);break;case 4:S1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Et(B0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Et(Mt,Mt.current&1),t.flags|=128,null):r&t.child.childLanes?NC(e,t,r):(Et(Mt,Mt.current&1),e=di(e,t,r),e!==null?e.sibling:null);Et(Mt,Mt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return FC(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Et(Mt,Mt.current),n)break;return null;case 22:case 23:return t.lanes=0,CC(e,t,r)}return di(e,t,r)}var IC,Ug,DC,RC;IC=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ug=function(){};DC=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ds(Da.current);var i=null;switch(r){case"input":a=cg(e,a),n=cg(e,n),i=[];break;case"select":a=Ut({},a,{value:void 0}),n=Ut({},n,{value:void 0}),i=[];break;case"textarea":a=dg(e,a),n=dg(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=D0)}pg(r,n);var s;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Pu.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Pu.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Tt("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};RC=function(e,t,r,n){r!==n&&(t.flags|=4)};function Nc(e,t){if(!Ft)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Fr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function NR(e,t,r){var n=t.pendingProps;switch(v1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(t),null;case 1:return un(t.type)&&R0(),Fr(t),null;case 3:return n=t.stateNode,_l(),Pt(cn),Pt(Vr),E1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Cd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,fa!==null&&(Xg(fa),fa=null))),Ug(e,t),Fr(t),null;case 5:k1(t);var a=Ds(Wu.current);if(r=t.type,e!==null&&t.stateNode!=null)DC(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(_e(166));return Fr(t),null}if(e=Ds(Da.current),Cd(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ja]=t,n[Bu]=i,e=(t.mode&1)!==0,r){case"dialog":Tt("cancel",n),Tt("close",n);break;case"iframe":case"object":case"embed":Tt("load",n);break;case"video":case"audio":for(a=0;a<Zc.length;a++)Tt(Zc[a],n);break;case"source":Tt("error",n);break;case"img":case"image":case"link":Tt("error",n),Tt("load",n);break;case"details":Tt("toggle",n);break;case"input":r_(n,i),Tt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Tt("invalid",n);break;case"textarea":a_(n,i),Tt("invalid",n)}pg(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Od(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Od(n.textContent,o,e),a=["children",""+o]):Pu.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Tt("scroll",n)}switch(r){case"input":wd(n),n_(n,i,!0);break;case"textarea":wd(n),i_(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=D0)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=uO(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[ja]=t,e[Bu]=n,IC(e,t,!1,!1),t.stateNode=e;e:{switch(s=mg(r,n),r){case"dialog":Tt("cancel",e),Tt("close",e),a=n;break;case"iframe":case"object":case"embed":Tt("load",e),a=n;break;case"video":case"audio":for(a=0;a<Zc.length;a++)Tt(Zc[a],e);a=n;break;case"source":Tt("error",e),a=n;break;case"img":case"image":case"link":Tt("error",e),Tt("load",e),a=n;break;case"details":Tt("toggle",e),a=n;break;case"input":r_(e,n),a=cg(e,n),Tt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ut({},n,{value:void 0}),Tt("invalid",e);break;case"textarea":a_(e,n),a=dg(e,n),Tt("invalid",e);break;default:a=n}pg(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?hO(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&fO(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ju(e,l):typeof l=="number"&&ju(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Pu.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Tt("scroll",e):l!=null&&t1(e,i,l,s))}switch(r){case"input":wd(e),n_(e,n,!1);break;case"textarea":wd(e),i_(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ns(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?il(e,!!n.multiple,i,!1):n.defaultValue!=null&&il(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=D0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Fr(t),null;case 6:if(e&&t.stateNode!=null)RC(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(_e(166));if(r=Ds(Wu.current),Ds(Da.current),Cd(t)){if(n=t.stateNode,r=t.memoizedProps,n[ja]=t,(i=n.nodeValue!==r)&&(e=Tn,e!==null))switch(e.tag){case 3:Od(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Od(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ja]=t,t.stateNode=n}return Fr(t),null;case 13:if(Pt(Mt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ft&&En!==null&&t.mode&1&&!(t.flags&128))eC(),wl(),t.flags|=98560,i=!1;else if(i=Cd(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(_e(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(_e(317));i[ja]=t}else wl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Fr(t),i=!1}else fa!==null&&(Xg(fa),fa=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Mt.current&1?dr===0&&(dr=3):M1())),t.updateQueue!==null&&(t.flags|=4),Fr(t),null);case 4:return _l(),Ug(e,t),e===null&&$u(t.stateNode.containerInfo),Fr(t),null;case 10:return w1(t.type._context),Fr(t),null;case 17:return un(t.type)&&R0(),Fr(t),null;case 19:if(Pt(Mt),i=t.memoizedState,i===null)return Fr(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)Nc(i,!1);else{if(dr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=z0(e),s!==null){for(t.flags|=128,Nc(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Et(Mt,Mt.current&1|2),t.child}e=e.sibling}i.tail!==null&&Xt()>kl&&(t.flags|=128,n=!0,Nc(i,!1),t.lanes=4194304)}else{if(!n)if(e=z0(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Nc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!Ft)return Fr(t),null}else 2*Xt()-i.renderingStartTime>kl&&r!==1073741824&&(t.flags|=128,n=!0,Nc(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Xt(),t.sibling=null,r=Mt.current,Et(Mt,n?r&1|2:r&1),t):(Fr(t),null);case 22:case 23:return R1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?gn&1073741824&&(Fr(t),t.subtreeFlags&6&&(t.flags|=8192)):Fr(t),null;case 24:return null;case 25:return null}throw Error(_e(156,t.tag))}function FR(e,t){switch(v1(t),t.tag){case 1:return un(t.type)&&R0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _l(),Pt(cn),Pt(Vr),E1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return k1(t),null;case 13:if(Pt(Mt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(_e(340));wl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Pt(Mt),null;case 4:return _l(),null;case 10:return w1(t.type._context),null;case 22:case 23:return R1(),null;case 24:return null;default:return null}}var Nd=!1,$r=!1,IR=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function Zo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){zt(e,t,n)}else r.current=null}function Wg(e,t,r){try{r()}catch(n){zt(e,t,n)}}var q_=!1;function DR(e,t){if(Eg=N0,e=UO(),p1(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,f=e,d=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(o=s+a),f!==i||n!==0&&f.nodeType!==3||(l=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===r&&++c===a&&(o=s),d===i&&++u===n&&(l=s),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Tg={focusedElem:e,selectionRange:r},N0=!1,Ie=t;Ie!==null;)if(t=Ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ie=e;else for(;Ie!==null;){t=Ie;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,g=m.memoizedState,x=t.stateNode,w=x.getSnapshotBeforeUpdate(t.elementType===t.type?p:sa(t.type,p),g);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(k){zt(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Ie=e;break}Ie=t.return}return m=q_,q_=!1,m}function fu(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Wg(t,r,i)}a=a.next}while(a!==n)}}function Sp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function zg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function MC(e){var t=e.alternate;t!==null&&(e.alternate=null,MC(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ja],delete t[Bu],delete t[Cg],delete t[gR],delete t[yR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $C(e){return e.tag===5||e.tag===3||e.tag===4}function X_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$C(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Hg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=D0));else if(n!==4&&(e=e.child,e!==null))for(Hg(e,t,r),e=e.sibling;e!==null;)Hg(e,t,r),e=e.sibling}function Vg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Vg(e,t,r),e=e.sibling;e!==null;)Vg(e,t,r),e=e.sibling}var Er=null,oa=!1;function Ti(e,t,r){for(r=r.child;r!==null;)LC(e,t,r),r=r.sibling}function LC(e,t,r){if(Ia&&typeof Ia.onCommitFiberUnmount=="function")try{Ia.onCommitFiberUnmount(mp,r)}catch{}switch(r.tag){case 5:$r||Zo(r,t);case 6:var n=Er,a=oa;Er=null,Ti(e,t,r),Er=n,oa=a,Er!==null&&(oa?(e=Er,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Er.removeChild(r.stateNode));break;case 18:Er!==null&&(oa?(e=Er,r=r.stateNode,e.nodeType===8?Xm(e.parentNode,r):e.nodeType===1&&Xm(e,r),Du(e)):Xm(Er,r.stateNode));break;case 4:n=Er,a=oa,Er=r.stateNode.containerInfo,oa=!0,Ti(e,t,r),Er=n,oa=a;break;case 0:case 11:case 14:case 15:if(!$r&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&Wg(r,t,s),a=a.next}while(a!==n)}Ti(e,t,r);break;case 1:if(!$r&&(Zo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){zt(r,t,o)}Ti(e,t,r);break;case 21:Ti(e,t,r);break;case 22:r.mode&1?($r=(n=$r)||r.memoizedState!==null,Ti(e,t,r),$r=n):Ti(e,t,r);break;default:Ti(e,t,r)}}function Y_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new IR),t.forEach(function(n){var a=HR.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function ra(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Er=o.stateNode,oa=!1;break e;case 3:Er=o.stateNode.containerInfo,oa=!0;break e;case 4:Er=o.stateNode.containerInfo,oa=!0;break e}o=o.return}if(Er===null)throw Error(_e(160));LC(i,s,a),Er=null,oa=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){zt(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)BC(t,e),t=t.sibling}function BC(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ra(t,e),ka(e),n&4){try{fu(3,e,e.return),Sp(3,e)}catch(p){zt(e,e.return,p)}try{fu(5,e,e.return)}catch(p){zt(e,e.return,p)}}break;case 1:ra(t,e),ka(e),n&512&&r!==null&&Zo(r,r.return);break;case 5:if(ra(t,e),ka(e),n&512&&r!==null&&Zo(r,r.return),e.flags&32){var a=e.stateNode;try{ju(a,"")}catch(p){zt(e,e.return,p)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&lO(a,i),mg(o,s);var c=mg(o,i);for(s=0;s<l.length;s+=2){var u=l[s],f=l[s+1];u==="style"?hO(a,f):u==="dangerouslySetInnerHTML"?fO(a,f):u==="children"?ju(a,f):t1(a,u,f,c)}switch(o){case"input":ug(a,i);break;case"textarea":cO(a,i);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?il(a,!!i.multiple,h,!1):d!==!!i.multiple&&(i.defaultValue!=null?il(a,!!i.multiple,i.defaultValue,!0):il(a,!!i.multiple,i.multiple?[]:"",!1))}a[Bu]=i}catch(p){zt(e,e.return,p)}}break;case 6:if(ra(t,e),ka(e),n&4){if(e.stateNode===null)throw Error(_e(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(p){zt(e,e.return,p)}}break;case 3:if(ra(t,e),ka(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Du(t.containerInfo)}catch(p){zt(e,e.return,p)}break;case 4:ra(t,e),ka(e);break;case 13:ra(t,e),ka(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(I1=Xt())),n&4&&Y_(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?($r=(c=$r)||u,ra(t,e),$r=c):ra(t,e),ka(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ie=e,u=e.child;u!==null;){for(f=Ie=u;Ie!==null;){switch(d=Ie,h=d.child,d.tag){case 0:case 11:case 14:case 15:fu(4,d,d.return);break;case 1:Zo(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(p){zt(n,r,p)}}break;case 5:Zo(d,d.return);break;case 22:if(d.memoizedState!==null){Q_(f);continue}}h!==null?(h.return=d,Ie=h):Q_(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,l=f.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=dO("display",s))}catch(p){zt(e,e.return,p)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(p){zt(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ra(t,e),ka(e),n&4&&Y_(e);break;case 21:break;default:ra(t,e),ka(e)}}function ka(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if($C(r)){var n=r;break e}r=r.return}throw Error(_e(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(ju(a,""),n.flags&=-33);var i=X_(e);Vg(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=X_(e);Hg(e,o,s);break;default:throw Error(_e(161))}}catch(l){zt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function RR(e,t,r){Ie=e,UC(e)}function UC(e,t,r){for(var n=(e.mode&1)!==0;Ie!==null;){var a=Ie,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||Nd;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||$r;o=Nd;var c=$r;if(Nd=s,($r=l)&&!c)for(Ie=a;Ie!==null;)s=Ie,l=s.child,s.tag===22&&s.memoizedState!==null?Z_(a):l!==null?(l.return=s,Ie=l):Z_(a);for(;i!==null;)Ie=i,UC(i),i=i.sibling;Ie=a,Nd=o,$r=c}J_(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ie=i):J_(e)}}function J_(e){for(;Ie!==null;){var t=Ie;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:$r||Sp(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!$r)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:sa(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&D_(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}D_(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Du(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}$r||t.flags&512&&zg(t)}catch(d){zt(t,t.return,d)}}if(t===e){Ie=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ie=r;break}Ie=t.return}}function Q_(e){for(;Ie!==null;){var t=Ie;if(t===e){Ie=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ie=r;break}Ie=t.return}}function Z_(e){for(;Ie!==null;){var t=Ie;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Sp(4,t)}catch(l){zt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){zt(t,a,l)}}var i=t.return;try{zg(t)}catch(l){zt(t,i,l)}break;case 5:var s=t.return;try{zg(t)}catch(l){zt(t,s,l)}}}catch(l){zt(t,t.return,l)}if(t===e){Ie=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ie=o;break}Ie=t.return}}var MR=Math.ceil,G0=xi.ReactCurrentDispatcher,N1=xi.ReactCurrentOwner,Vn=xi.ReactCurrentBatchConfig,it=0,br=null,ar=null,Cr=0,gn=0,el=us(0),dr=0,Gu=null,Qs=0,kp=0,F1=0,du=null,an=null,I1=0,kl=1/0,Va=null,K0=!1,Gg=null,Qi=null,Fd=!1,Wi=null,q0=0,hu=0,Kg=null,_0=-1,S0=0;function Zr(){return it&6?Xt():_0!==-1?_0:_0=Xt()}function Zi(e){return e.mode&1?it&2&&Cr!==0?Cr&-Cr:wR.transition!==null?(S0===0&&(S0=EO()),S0):(e=vt,e!==0||(e=window.event,e=e===void 0?16:NO(e.type)),e):1}function ya(e,t,r,n){if(50<hu)throw hu=0,Kg=null,Error(_e(185));Vf(e,r,n),(!(it&2)||e!==br)&&(e===br&&(!(it&2)&&(kp|=r),dr===4&&$i(e,Cr)),fn(e,n),r===1&&it===0&&!(t.mode&1)&&(kl=Xt()+500,wp&&fs()))}function fn(e,t){var r=e.callbackNode;wD(e,t);var n=j0(e,e===br?Cr:0);if(n===0)r!==null&&l_(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&l_(r),t===1)e.tag===0?xR(e2.bind(null,e)):JO(e2.bind(null,e)),mR(function(){!(it&6)&&fs()}),r=null;else{switch(TO(n)){case 1:r=s1;break;case 4:r=SO;break;case 16:r=P0;break;case 536870912:r=kO;break;default:r=P0}r=XC(r,WC.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function WC(e,t){if(_0=-1,S0=0,it&6)throw Error(_e(327));var r=e.callbackNode;if(ul()&&e.callbackNode!==r)return null;var n=j0(e,e===br?Cr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=X0(e,n);else{t=n;var a=it;it|=2;var i=HC();(br!==e||Cr!==t)&&(Va=null,kl=Xt()+500,Us(e,t));do try{BR();break}catch(o){zC(e,o)}while(!0);x1(),G0.current=i,it=a,ar!==null?t=0:(br=null,Cr=0,t=dr)}if(t!==0){if(t===2&&(a=wg(e),a!==0&&(n=a,t=qg(e,a))),t===1)throw r=Gu,Us(e,0),$i(e,n),fn(e,Xt()),r;if(t===6)$i(e,n);else{if(a=e.current.alternate,!(n&30)&&!$R(a)&&(t=X0(e,n),t===2&&(i=wg(e),i!==0&&(n=i,t=qg(e,i))),t===1))throw r=Gu,Us(e,0),$i(e,n),fn(e,Xt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(_e(345));case 2:Ts(e,an,Va);break;case 3:if($i(e,n),(n&130023424)===n&&(t=I1+500-Xt(),10<t)){if(j0(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Zr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Og(Ts.bind(null,e,an,Va),t);break}Ts(e,an,Va);break;case 4:if($i(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-ga(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Xt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*MR(n/1960))-n,10<n){e.timeoutHandle=Og(Ts.bind(null,e,an,Va),n);break}Ts(e,an,Va);break;case 5:Ts(e,an,Va);break;default:throw Error(_e(329))}}}return fn(e,Xt()),e.callbackNode===r?WC.bind(null,e):null}function qg(e,t){var r=du;return e.current.memoizedState.isDehydrated&&(Us(e,t).flags|=256),e=X0(e,t),e!==2&&(t=an,an=r,t!==null&&Xg(t)),e}function Xg(e){an===null?an=e:an.push.apply(an,e)}function $R(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!ba(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $i(e,t){for(t&=~F1,t&=~kp,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ga(t),n=1<<r;e[r]=-1,t&=~n}}function e2(e){if(it&6)throw Error(_e(327));ul();var t=j0(e,0);if(!(t&1))return fn(e,Xt()),null;var r=X0(e,t);if(e.tag!==0&&r===2){var n=wg(e);n!==0&&(t=n,r=qg(e,n))}if(r===1)throw r=Gu,Us(e,0),$i(e,t),fn(e,Xt()),r;if(r===6)throw Error(_e(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ts(e,an,Va),fn(e,Xt()),null}function D1(e,t){var r=it;it|=1;try{return e(t)}finally{it=r,it===0&&(kl=Xt()+500,wp&&fs())}}function Zs(e){Wi!==null&&Wi.tag===0&&!(it&6)&&ul();var t=it;it|=1;var r=Vn.transition,n=vt;try{if(Vn.transition=null,vt=1,e)return e()}finally{vt=n,Vn.transition=r,it=t,!(it&6)&&fs()}}function R1(){gn=el.current,Pt(el)}function Us(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,pR(r)),ar!==null)for(r=ar.return;r!==null;){var n=r;switch(v1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&R0();break;case 3:_l(),Pt(cn),Pt(Vr),E1();break;case 5:k1(n);break;case 4:_l();break;case 13:Pt(Mt);break;case 19:Pt(Mt);break;case 10:w1(n.type._context);break;case 22:case 23:R1()}r=r.return}if(br=e,ar=e=es(e.current,null),Cr=gn=t,dr=0,Gu=null,F1=kp=Qs=0,an=du=null,Is!==null){for(t=0;t<Is.length;t++)if(r=Is[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}Is=null}return e}function zC(e,t){do{var r=ar;try{if(x1(),x0.current=V0,H0){for(var n=Bt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}H0=!1}if(Js=0,yr=ur=Bt=null,uu=!1,zu=0,N1.current=null,r===null||r.return===null){dr=1,Gu=t,ar=null;break}e:{var i=e,s=r.return,o=r,l=t;if(t=Cr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=U_(s);if(h!==null){h.flags&=-257,W_(h,s,o,i,t),h.mode&1&&B_(i,c,t),t=h,l=c;var m=t.updateQueue;if(m===null){var p=new Set;p.add(l),t.updateQueue=p}else m.add(l);break e}else{if(!(t&1)){B_(i,c,t),M1();break e}l=Error(_e(426))}}else if(Ft&&o.mode&1){var g=U_(s);if(g!==null){!(g.flags&65536)&&(g.flags|=256),W_(g,s,o,i,t),g1(Sl(l,o));break e}}i=l=Sl(l,o),dr!==4&&(dr=2),du===null?du=[i]:du.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=TC(i,l,t);I_(i,x);break e;case 1:o=l;var w=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Qi===null||!Qi.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var k=AC(i,o,t);I_(i,k);break e}}i=i.return}while(i!==null)}GC(r)}catch(b){t=b,ar===r&&r!==null&&(ar=r=r.return);continue}break}while(!0)}function HC(){var e=G0.current;return G0.current=V0,e===null?V0:e}function M1(){(dr===0||dr===3||dr===2)&&(dr=4),br===null||!(Qs&268435455)&&!(kp&268435455)||$i(br,Cr)}function X0(e,t){var r=it;it|=2;var n=HC();(br!==e||Cr!==t)&&(Va=null,Us(e,t));do try{LR();break}catch(a){zC(e,a)}while(!0);if(x1(),it=r,G0.current=n,ar!==null)throw Error(_e(261));return br=null,Cr=0,dr}function LR(){for(;ar!==null;)VC(ar)}function BR(){for(;ar!==null&&!fD();)VC(ar)}function VC(e){var t=qC(e.alternate,e,gn);e.memoizedProps=e.pendingProps,t===null?GC(e):ar=t,N1.current=null}function GC(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=FR(r,t),r!==null){r.flags&=32767,ar=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{dr=6,ar=null;return}}else if(r=NR(r,t,gn),r!==null){ar=r;return}if(t=t.sibling,t!==null){ar=t;return}ar=t=e}while(t!==null);dr===0&&(dr=5)}function Ts(e,t,r){var n=vt,a=Vn.transition;try{Vn.transition=null,vt=1,UR(e,t,r,n)}finally{Vn.transition=a,vt=n}return null}function UR(e,t,r,n){do ul();while(Wi!==null);if(it&6)throw Error(_e(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(_e(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(bD(e,i),e===br&&(ar=br=null,Cr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Fd||(Fd=!0,XC(P0,function(){return ul(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Vn.transition,Vn.transition=null;var s=vt;vt=1;var o=it;it|=4,N1.current=null,DR(e,r),BC(r,e),oR(Tg),N0=!!Eg,Tg=Eg=null,e.current=r,RR(r),dD(),it=o,vt=s,Vn.transition=i}else e.current=r;if(Fd&&(Fd=!1,Wi=e,q0=a),i=e.pendingLanes,i===0&&(Qi=null),mD(r.stateNode),fn(e,Xt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(K0)throw K0=!1,e=Gg,Gg=null,e;return q0&1&&e.tag!==0&&ul(),i=e.pendingLanes,i&1?e===Kg?hu++:(hu=0,Kg=e):hu=0,fs(),null}function ul(){if(Wi!==null){var e=TO(q0),t=Vn.transition,r=vt;try{if(Vn.transition=null,vt=16>e?16:e,Wi===null)var n=!1;else{if(e=Wi,Wi=null,q0=0,it&6)throw Error(_e(331));var a=it;for(it|=4,Ie=e.current;Ie!==null;){var i=Ie,s=i.child;if(Ie.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ie=c;Ie!==null;){var u=Ie;switch(u.tag){case 0:case 11:case 15:fu(8,u,i)}var f=u.child;if(f!==null)f.return=u,Ie=f;else for(;Ie!==null;){u=Ie;var d=u.sibling,h=u.return;if(MC(u),u===c){Ie=null;break}if(d!==null){d.return=h,Ie=d;break}Ie=h}}}var m=i.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}Ie=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,Ie=s;else e:for(;Ie!==null;){if(i=Ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:fu(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,Ie=x;break e}Ie=i.return}}var w=e.current;for(Ie=w;Ie!==null;){s=Ie;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,Ie=y;else e:for(s=w;Ie!==null;){if(o=Ie,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Sp(9,o)}}catch(b){zt(o,o.return,b)}if(o===s){Ie=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Ie=k;break e}Ie=o.return}}if(it=a,fs(),Ia&&typeof Ia.onPostCommitFiberRoot=="function")try{Ia.onPostCommitFiberRoot(mp,e)}catch{}n=!0}return n}finally{vt=r,Vn.transition=t}}return!1}function t2(e,t,r){t=Sl(r,t),t=TC(e,t,1),e=Ji(e,t,1),t=Zr(),e!==null&&(Vf(e,1,t),fn(e,t))}function zt(e,t,r){if(e.tag===3)t2(e,e,r);else for(;t!==null;){if(t.tag===3){t2(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Qi===null||!Qi.has(n))){e=Sl(r,e),e=AC(t,e,1),t=Ji(t,e,1),e=Zr(),t!==null&&(Vf(t,1,e),fn(t,e));break}}t=t.return}}function WR(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Zr(),e.pingedLanes|=e.suspendedLanes&r,br===e&&(Cr&r)===r&&(dr===4||dr===3&&(Cr&130023424)===Cr&&500>Xt()-I1?Us(e,0):F1|=r),fn(e,t)}function KC(e,t){t===0&&(e.mode&1?(t=Sd,Sd<<=1,!(Sd&130023424)&&(Sd=4194304)):t=1);var r=Zr();e=fi(e,t),e!==null&&(Vf(e,t,r),fn(e,r))}function zR(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),KC(e,r)}function HR(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(_e(314))}n!==null&&n.delete(t),KC(e,r)}var qC;qC=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||cn.current)on=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return on=!1,jR(e,t,r);on=!!(e.flags&131072)}else on=!1,Ft&&t.flags&1048576&&QO(t,L0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;b0(e,t),e=t.pendingProps;var a=xl(t,Vr.current);cl(t,r),a=A1(null,t,n,e,a,r);var i=O1();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,un(n)?(i=!0,M0(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,_1(t),a.updater=_p,t.stateNode=a,a._reactInternals=t,Dg(t,n,e,r),t=$g(null,t,n,!0,i,r)):(t.tag=0,Ft&&i&&m1(t),Xr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(b0(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=GR(n),e=sa(n,e),a){case 0:t=Mg(null,t,n,e,r);break e;case 1:t=V_(null,t,n,e,r);break e;case 11:t=z_(null,t,n,e,r);break e;case 14:t=H_(null,t,n,sa(n.type,e),r);break e}throw Error(_e(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:sa(n,a),Mg(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:sa(n,a),V_(e,t,n,a,r);case 3:e:{if(jC(t),e===null)throw Error(_e(387));n=t.pendingProps,i=t.memoizedState,a=i.element,aC(e,t),W0(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Sl(Error(_e(423)),t),t=G_(e,t,n,r,a);break e}else if(n!==a){a=Sl(Error(_e(424)),t),t=G_(e,t,n,r,a);break e}else for(En=Yi(t.stateNode.containerInfo.firstChild),Tn=t,Ft=!0,fa=null,r=rC(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(wl(),n===a){t=di(e,t,r);break e}Xr(e,t,n,r)}t=t.child}return t;case 5:return iC(t),e===null&&Ng(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,Ag(n,a)?s=null:i!==null&&Ag(n,i)&&(t.flags|=32),PC(e,t),Xr(e,t,s,r),t.child;case 6:return e===null&&Ng(t),null;case 13:return NC(e,t,r);case 4:return S1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=bl(t,null,n,r):Xr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:sa(n,a),z_(e,t,n,a,r);case 7:return Xr(e,t,t.pendingProps,r),t.child;case 8:return Xr(e,t,t.pendingProps.children,r),t.child;case 12:return Xr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,Et(B0,n._currentValue),n._currentValue=s,i!==null)if(ba(i.value,s)){if(i.children===a.children&&!cn.current){t=di(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=ti(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Fg(i.return,r,t),o.lanes|=r;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(_e(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Fg(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Xr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,cl(t,r),a=Xn(a),n=n(a),t.flags|=1,Xr(e,t,n,r),t.child;case 14:return n=t.type,a=sa(n,t.pendingProps),a=sa(n.type,a),H_(e,t,n,a,r);case 15:return OC(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:sa(n,a),b0(e,t),t.tag=1,un(n)?(e=!0,M0(t)):e=!1,cl(t,r),EC(t,n,a),Dg(t,n,a,r),$g(null,t,n,!0,e,r);case 19:return FC(e,t,r);case 22:return CC(e,t,r)}throw Error(_e(156,t.tag))};function XC(e,t){return _O(e,t)}function VR(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(e,t,r,n){return new VR(e,t,r,n)}function $1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function GR(e){if(typeof e=="function")return $1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===n1)return 11;if(e===a1)return 14}return 2}function es(e,t){var r=e.alternate;return r===null?(r=zn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function k0(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")$1(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Ho:return Ws(r.children,a,i,t);case r1:s=8,a|=8;break;case ig:return e=zn(12,r,t,a|2),e.elementType=ig,e.lanes=i,e;case sg:return e=zn(13,r,t,a),e.elementType=sg,e.lanes=i,e;case og:return e=zn(19,r,t,a),e.elementType=og,e.lanes=i,e;case iO:return Ep(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case nO:s=10;break e;case aO:s=9;break e;case n1:s=11;break e;case a1:s=14;break e;case Fi:s=16,n=null;break e}throw Error(_e(130,e==null?e:typeof e,""))}return t=zn(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Ws(e,t,r,n){return e=zn(7,e,n,t),e.lanes=r,e}function Ep(e,t,r,n){return e=zn(22,e,n,t),e.elementType=iO,e.lanes=r,e.stateNode={isHidden:!1},e}function nv(e,t,r){return e=zn(6,e,null,t),e.lanes=r,e}function av(e,t,r){return t=zn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function KR(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$m(0),this.expirationTimes=$m(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$m(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function L1(e,t,r,n,a,i,s,o,l){return e=new KR(e,t,r,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=zn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},_1(i),e}function qR(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function YC(e){if(!e)return as;e=e._reactInternals;e:{if(ho(e)!==e||e.tag!==1)throw Error(_e(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(un(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(_e(171))}if(e.tag===1){var r=e.type;if(un(r))return YO(e,r,t)}return t}function JC(e,t,r,n,a,i,s,o,l){return e=L1(r,n,!0,e,a,i,s,o,l),e.context=YC(null),r=e.current,n=Zr(),a=Zi(r),i=ti(n,a),i.callback=t??null,Ji(r,i,a),e.current.lanes=a,Vf(e,a,n),fn(e,n),e}function Tp(e,t,r,n){var a=t.current,i=Zr(),s=Zi(a);return r=YC(r),t.context===null?t.context=r:t.pendingContext=r,t=ti(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ji(a,t,s),e!==null&&(ya(e,a,s,i),y0(e,a,s)),s}function Y0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function r2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function B1(e,t){r2(e,t),(e=e.alternate)&&r2(e,t)}function XR(){return null}var QC=typeof reportError=="function"?reportError:function(e){console.error(e)};function U1(e){this._internalRoot=e}Ap.prototype.render=U1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(_e(409));Tp(e,t,null,null)};Ap.prototype.unmount=U1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Zs(function(){Tp(null,e,null,null)}),t[ui]=null}};function Ap(e){this._internalRoot=e}Ap.prototype.unstable_scheduleHydration=function(e){if(e){var t=CO();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Mi.length&&t!==0&&t<Mi[r].priority;r++);Mi.splice(r,0,e),r===0&&jO(e)}};function W1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Op(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function n2(){}function YR(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var c=Y0(s);i.call(c)}}var s=JC(t,n,e,0,null,!1,!1,"",n2);return e._reactRootContainer=s,e[ui]=s.current,$u(e.nodeType===8?e.parentNode:e),Zs(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=Y0(l);o.call(c)}}var l=L1(e,0,!1,null,null,!1,!1,"",n2);return e._reactRootContainer=l,e[ui]=l.current,$u(e.nodeType===8?e.parentNode:e),Zs(function(){Tp(t,l,r,n)}),l}function Cp(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=Y0(s);o.call(l)}}Tp(t,s,e,a)}else s=YR(r,t,e,a,n);return Y0(s)}AO=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Qc(t.pendingLanes);r!==0&&(o1(t,r|1),fn(t,Xt()),!(it&6)&&(kl=Xt()+500,fs()))}break;case 13:Zs(function(){var n=fi(e,1);if(n!==null){var a=Zr();ya(n,e,1,a)}}),B1(e,1)}};l1=function(e){if(e.tag===13){var t=fi(e,134217728);if(t!==null){var r=Zr();ya(t,e,134217728,r)}B1(e,134217728)}};OO=function(e){if(e.tag===13){var t=Zi(e),r=fi(e,t);if(r!==null){var n=Zr();ya(r,e,t,n)}B1(e,t)}};CO=function(){return vt};PO=function(e,t){var r=vt;try{return vt=e,t()}finally{vt=r}};gg=function(e,t,r){switch(t){case"input":if(ug(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=xp(n);if(!a)throw Error(_e(90));oO(n),ug(n,a)}}}break;case"textarea":cO(e,r);break;case"select":t=r.value,t!=null&&il(e,!!r.multiple,t,!1)}};vO=D1;gO=Zs;var JR={usingClientEntryPoint:!1,Events:[Kf,qo,xp,pO,mO,D1]},Fc={findFiberByHostInstance:Fs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QR={bundleType:Fc.bundleType,version:Fc.version,rendererPackageName:Fc.rendererPackageName,rendererConfig:Fc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xi.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wO(e),e===null?null:e.stateNode},findFiberByHostInstance:Fc.findFiberByHostInstance||XR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Id.isDisabled&&Id.supportsFiber)try{mp=Id.inject(QR),Ia=Id}catch{}}Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JR;Pn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W1(t))throw Error(_e(200));return qR(e,t,null,r)};Pn.createRoot=function(e,t){if(!W1(e))throw Error(_e(299));var r=!1,n="",a=QC;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=L1(e,1,!1,null,null,r,!1,n,a),e[ui]=t.current,$u(e.nodeType===8?e.parentNode:e),new U1(t)};Pn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(_e(188)):(e=Object.keys(e).join(","),Error(_e(268,e)));return e=wO(t),e=e===null?null:e.stateNode,e};Pn.flushSync=function(e){return Zs(e)};Pn.hydrate=function(e,t,r){if(!Op(t))throw Error(_e(200));return Cp(null,e,t,!0,r)};Pn.hydrateRoot=function(e,t,r){if(!W1(e))throw Error(_e(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=QC;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=JC(t,null,e,1,r??null,a,!1,i,s),e[ui]=t.current,$u(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Ap(t)};Pn.render=function(e,t,r){if(!Op(t))throw Error(_e(200));return Cp(null,e,t,!1,r)};Pn.unmountComponentAtNode=function(e){if(!Op(e))throw Error(_e(40));return e._reactRootContainer?(Zs(function(){Cp(null,null,e,!1,function(){e._reactRootContainer=null,e[ui]=null})}),!0):!1};Pn.unstable_batchedUpdates=D1;Pn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Op(r))throw Error(_e(200));if(e==null||e._reactInternals===void 0)throw Error(_e(38));return Cp(e,t,r,!1,n)};Pn.version="18.3.1-next-f1338f8080-20240426";function ZC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ZC)}catch(e){console.error(e)}}ZC(),ZA.exports=Pn;var ZR=ZA.exports,a2=ZR;ng.createRoot=a2.createRoot,ng.hydrateRoot=a2.hydrateRoot;const e8="modulepreload",t8=function(e){return"/KPI-Dashboard/"+e},i2={},rc=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=t8(l),l in i2)return;i2[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":e8,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((d,h)=>{f.addEventListener("load",d),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},r8=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>rc(async()=>{const{default:n}=await Promise.resolve().then(()=>nc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class z1 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class n8 extends z1{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class s2 extends z1{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class o2 extends z1{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Yg;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Yg||(Yg={}));var a8=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class i8{constructor(t,{headers:r={},customFetch:n,region:a=Yg.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=r8(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return a8(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:s}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=s):typeof s=="string"?(o["Content-Type"]="text/plain",u=s):typeof FormData<"u"&&s instanceof FormData?u=s:(o["Content-Type"]="application/json",u=JSON.stringify(s)));const f=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(p=>{throw new n8(p)}),d=f.headers.get("x-relay-error");if(d&&d==="true")throw new s2(f);if(!f.ok)throw new o2(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),m;return h==="application/json"?m=yield f.json():h==="application/octet-stream"?m=yield f.blob():h==="text/event-stream"?m=f:h==="multipart/form-data"?m=yield f.formData():m=yield f.text(),{data:m,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof o2||a instanceof s2?a.context:void 0}}})}}var sn={},H1={},Pp={},Xf={},jp={},Np={},s8=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},El=s8();const o8=El.fetch,eP=El.fetch.bind(El),tP=El.Headers,l8=El.Request,c8=El.Response,nc=Object.freeze(Object.defineProperty({__proto__:null,Headers:tP,Request:l8,Response:c8,default:eP,fetch:o8},Symbol.toStringTag,{value:"Module"})),u8=AI(nc);var Fp={};Object.defineProperty(Fp,"__esModule",{value:!0});let f8=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Fp.default=f8;var rP=zr&&zr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Np,"__esModule",{value:!0});const d8=rP(u8),h8=rP(Fp);let p8=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=d8.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var s,o,l,c;let u=null,f=null,d=null,h=i.status,m=i.statusText;if(i.ok){if(this.method!=="HEAD"){const w=await i.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((s=this.headers.get("Accept"))===null||s===void 0)&&s.includes("application/vnd.pgrst.plan+text"))?f=w:f=JSON.parse(w))}const g=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),x=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&x&&x.length>1&&(d=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,d=null,h=406,m="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const g=await i.text();try{u=JSON.parse(g),Array.isArray(u)&&i.status===404&&(f=[],u=null,h=200,m="OK")}catch{i.status===404&&g===""?(h=204,m="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,h=200,m="OK"),u&&this.shouldThrowOnError)throw new h8.default(u)}return{error:u,data:f,count:d,status:h,statusText:m}});return this.shouldThrowOnError||(a=a.catch(i=>{var s,o,l;return{error:{message:`${(s=i==null?void 0:i.name)!==null&&s!==void 0?s:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Np.default=p8;var m8=zr&&zr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jp,"__esModule",{value:!0});const v8=m8(Np);let g8=class extends v8.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${c}"; options=${l};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};jp.default=g8;var y8=zr&&zr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xf,"__esModule",{value:!0});const x8=y8(jp);let w8=class extends x8.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Xf.default=w8;var b8=zr&&zr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pp,"__esModule",{value:!0});const Ic=b8(Xf);let _8=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const s=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",s),n&&this.headers.append("Prefer",`count=${n}`),new Ic.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const s=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(s.length>0){const o=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ic.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){var s;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ic.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Ic.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Ic.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};Pp.default=_8;var nP=zr&&zr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(H1,"__esModule",{value:!0});const S8=nP(Pp),k8=nP(Xf);let E8=class aP{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new S8.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new aP(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var s;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([f,d])=>d!==void 0).map(([f,d])=>[f,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([f,d])=>{l.searchParams.append(f,d)})):(o="POST",c=r);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new k8.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};H1.default=E8;var ac=zr&&zr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(sn,"__esModule",{value:!0});sn.PostgrestError=sn.PostgrestBuilder=sn.PostgrestTransformBuilder=sn.PostgrestFilterBuilder=sn.PostgrestQueryBuilder=sn.PostgrestClient=void 0;const iP=ac(H1);sn.PostgrestClient=iP.default;const sP=ac(Pp);sn.PostgrestQueryBuilder=sP.default;const oP=ac(Xf);sn.PostgrestFilterBuilder=oP.default;const lP=ac(jp);sn.PostgrestTransformBuilder=lP.default;const cP=ac(Np);sn.PostgrestBuilder=cP.default;const uP=ac(Fp);sn.PostgrestError=uP.default;var T8=sn.default={PostgrestClient:iP.default,PostgrestQueryBuilder:sP.default,PostgrestFilterBuilder:oP.default,PostgrestTransformBuilder:lP.default,PostgrestBuilder:cP.default,PostgrestError:uP.default};const{PostgrestClient:A8,PostgrestQueryBuilder:J1e,PostgrestFilterBuilder:Q1e,PostgrestTransformBuilder:Z1e,PostgrestBuilder:ewe,PostgrestError:twe}=T8;class O8{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const C8="2.15.5",P8=`realtime-js/${C8}`,j8="1.0.0",Jg=1e4,N8=1e3,F8=100;var pu;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(pu||(pu={}));var lr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(lr||(lr={}));var la;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(la||(la={}));var Qg;(function(e){e.websocket="websocket"})(Qg||(Qg={}));var js;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(js||(js={}));class I8{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(t.slice(s,s+a));s=s+a;const l=n.decode(t.slice(s,s+i));s=s+i;const c=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class fP{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var St;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(St||(St={}));const l2=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,s)=>(i[s]=D8(s,e,t,a),i),{})},D8=(e,t,r,n)=>{const a=t.find(o=>o.name===e),i=a==null?void 0:a.type,s=r[e];return i&&!n.includes(i)?dP(i,s):Zg(s)},dP=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return L8(t,r)}switch(e){case St.bool:return R8(t);case St.float4:case St.float8:case St.int2:case St.int4:case St.int8:case St.numeric:case St.oid:return M8(t);case St.json:case St.jsonb:return $8(t);case St.timestamp:return B8(t);case St.abstime:case St.date:case St.daterange:case St.int4range:case St.int8range:case St.money:case St.reltime:case St.text:case St.time:case St.timestamptz:case St.timetz:case St.tsrange:case St.tstzrange:return Zg(t);default:return Zg(t)}},Zg=e=>e,R8=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},M8=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},$8=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},L8=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(o=>dP(t,o))}return e},B8=e=>typeof e=="string"?e.replace(" ","T"):e,hP=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class iv{constructor(t,r,n={},a=Jg){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var c2;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(c2||(c2={}));class mu{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mu.syncState(this.state,a,i,s),this.pendingDiffs.forEach(l=>{this.state=mu.syncDiff(this.state,l,i,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=mu.syncDiff(this.state,a,i,s),o())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),o={},l={};return this.map(i,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const f=i[c];if(f){const d=u.map(g=>g.presence_ref),h=f.map(g=>g.presence_ref),m=u.filter(g=>h.indexOf(g.presence_ref)<0),p=f.filter(g=>d.indexOf(g.presence_ref)<0);m.length>0&&(o[c]=m),p.length>0&&(l[c]=p)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(h=>h.presence_ref),d=u.filter(h=>f.indexOf(h.presence_ref)<0);t[o].unshift(...d)}n(o,u,l)}),this.map(s,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var u2;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(u2||(u2={}));var vu;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(vu||(vu={}));var Ga;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ga||(Ga={}));class V1{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=lr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new iv(this,la.join,this.params,this.timeout),this.rejoinTimer=new fP(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=lr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=lr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=lr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=lr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=lr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(la.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new mu(this),this.broadcastEndpointURL=hP(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==lr.closed){const{config:{broadcast:s,presence:o,private:l}}=this.params,c=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[vu.PRESENCE]&&this.bindings[vu.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},d={broadcast:s,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(Ga.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(Ga.CLOSED)),this.updateJoinPayload(Object.assign({config:d},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var m;if(this.socket.setAuth(),h===void 0){t==null||t(Ga.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,g=(m=p==null?void 0:p.length)!==null&&m!==void 0?m:0,x=[];for(let w=0;w<g;w++){const y=p[w],{filter:{event:k,schema:b,table:_,filter:S}}=y,E=h&&h[w];if(E&&E.event===k&&E.schema===b&&E.table===_&&E.filter===S)x.push(Object.assign(Object.assign({},y),{id:E.id}));else{this.unsubscribe(),this.state=lr.errored,t==null||t(Ga.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(Ga.SUBSCRIBED);return}}).receive("error",h=>{this.state=lr.errored,t==null||t(Ga.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Ga.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===lr.joined&&t===vu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:s}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=lr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(la.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new iv(this,la.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=lr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new iv(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>F8){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=la;if(n&&[o,l,c,u].indexOf(s)>=0&&n!==this._joinRef())return;let d=this._onMessage(s,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var m,p,g;return((m=h.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(p=h.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===s}).map(h=>h.callback(d,n)):(i=this.bindings[s])===null||i===void 0||i.filter(h=>{var m,p,g,x,w,y;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const k=h.id,b=(m=h.filter)===null||m===void 0?void 0:m.event;return k&&((p=r.ids)===null||p===void 0?void 0:p.includes(k))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const k=(w=(x=h==null?void 0:h.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return k==="*"||k===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof d=="object"&&"ids"in d){const m=d.data,{schema:p,table:g,commit_timestamp:x,type:w,errors:y}=m;d=Object.assign(Object.assign({},{schema:p,table:g,commit_timestamp:x,eventType:w,new:{},old:{},errors:y}),this._getPayloadRecords(m))}h.callback(d,n)})}_isClosed(){return this.state===lr.closed}_isJoined(){return this.state===lr.joined}_isJoining(){return this.state===lr.joining}_isLeaving(){return this.state===lr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&V1.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(la.close,{},t)}_onError(t){this._on(la.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=lr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=l2(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=l2(t.columns,t.old_record)),r}}const sv=()=>{},Dd={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},U8=[1e3,2e3,5e3,1e4],W8=1e4,z8=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class H8{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Jg,this.transport=null,this.heartbeatIntervalMs=Dd.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=sv,this.ref=0,this.reconnectTimer=null,this.logger=sv,this.conn=null,this.sendBuffer=[],this.serializer=new I8,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...s)=>rc(async()=>{const{default:o}=await Promise.resolve().then(()=>nc);return{default:o}},void 0).then(({default:o})=>o(...s)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...s)=>i(...s)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Qg.websocket}`,this.httpEndpoint=hP(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=O8.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:j8}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case pu.connecting:return js.Connecting;case pu.open:return js.Open;case pu.closing:return js.Closing;default:return js.Closed}}isConnected(){return this.connectionState()===js.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new V1(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(N8,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Dd.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:s}=r,o=s?`(${s})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,i,s)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(la.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([z8],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:P8};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(la.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new fP(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Dd.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,s,o,l,c,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Jg,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Dd.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(s=t==null?void 0:t.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:sv,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:f=>U8[f-1]||W8,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(f,d)=>d(JSON.stringify(f)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class G1 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function cr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class V8 extends G1{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ey extends G1{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var G8=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const pP=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>rc(async()=>{const{default:n}=await Promise.resolve().then(()=>nc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},K8=()=>G8(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield rc(()=>Promise.resolve().then(()=>nc),void 0)).Response:Response}),ty=e=>{if(Array.isArray(e))return e.map(r=>ty(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=ty(n)}),t},q8=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var po=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const ov=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),X8=(e,t,r)=>po(void 0,void 0,void 0,function*(){const n=yield K8();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const i=e.status||500,s=(a==null?void 0:a.statusCode)||i+"";t(new V8(ov(a),i,s))}).catch(a=>{t(new ey(ov(a),a))}):t(new ey(ov(e),e))}),Y8=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(q8(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function Yf(e,t,r,n,a,i){return po(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,Y8(t,n,a,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>X8(l,o,n))})})}function J0(e,t,r,n){return po(this,void 0,void 0,function*(){return Yf(e,"GET",t,r,n)})}function Pa(e,t,r,n,a){return po(this,void 0,void 0,function*(){return Yf(e,"POST",t,n,a,r)})}function ry(e,t,r,n,a){return po(this,void 0,void 0,function*(){return Yf(e,"PUT",t,n,a,r)})}function J8(e,t,r,n){return po(this,void 0,void 0,function*(){return Yf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function mP(e,t,r,n,a){return po(this,void 0,void 0,function*(){return Yf(e,"DELETE",t,n,a,r)})}var qr=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Q8={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},f2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Z8{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=pP(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return qr(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},f2),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield(t=="PUT"?ry:Pa)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{}));return{data:{path:c,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(cr(i))return{data:null,error:i};throw i}})}upload(t,r,n){return qr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return qr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:f2.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield ry(this.fetch,o.toString(),l,{headers:u});return{data:{path:i,fullPath:f.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(cr(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return qr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield Pa(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new G1("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cr(n))return{data:null,error:n};throw n}})}update(t,r,n){return qr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return qr(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}})}copy(t,r,n){return qr(this,void 0,void 0,function*(){try{return{data:{path:(yield Pa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return qr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield Pa(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return qr(this,void 0,void 0,function*(){try{const a=yield Pa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}})}download(t,r){return qr(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield J0(this.fetch,`${this.url}/${a}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(cr(o))return{data:null,error:o};throw o}})}info(t){return qr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield J0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:ty(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cr(n))return{data:null,error:n};throw n}})}exists(t){return qr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield J8(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cr(n)&&n instanceof ey){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return qr(this,void 0,void 0,function*(){try{return{data:yield mP(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cr(r))return{data:null,error:r};throw r}})}list(t,r,n){return qr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Q8),r),{prefix:t||""});return{data:yield Pa(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(cr(a))return{data:null,error:a};throw a}})}listV2(t,r){return qr(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Pa(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cr(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const eM="2.12.1",tM={"X-Client-Info":`storage-js/${eM}`};var To=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class rM{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const i=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},tM),r),this.fetch=pP(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return To(this,void 0,void 0,function*(){try{return{data:yield J0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cr(t))return{data:null,error:t};throw t}})}getBucket(t){return To(this,void 0,void 0,function*(){try{return{data:yield J0(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return To(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cr(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return To(this,void 0,void 0,function*(){try{return{data:yield ry(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(cr(n))return{data:null,error:n};throw n}})}emptyBucket(t){return To(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return To(this,void 0,void 0,function*(){try{return{data:yield mP(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cr(r))return{data:null,error:r};throw r}})}}class nM extends rM{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new Z8(this.url,this.headers,t,this.fetch)}}const aM="2.57.4";let eu="";typeof Deno<"u"?eu="deno":typeof document<"u"?eu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?eu="react-native":eu="node";const iM={"X-Client-Info":`supabase-js-${eu}/${aM}`},sM={headers:iM},oM={schema:"public"},lM={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},cM={};var uM=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const fM=e=>{let t;return e?t=e:typeof fetch>"u"?t=eP:t=fetch,(...r)=>t(...r)},dM=()=>typeof Headers>"u"?tP:Headers,hM=(e,t,r)=>{const n=fM(r),a=dM();return(i,s)=>uM(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},s),{headers:c}))})};var pM=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function mM(e){return e.endsWith("/")?e:e+"/"}function vM(e,t){var r,n;const{db:a,auth:i,realtime:s,global:o}=e,{db:l,auth:c,realtime:u,global:f}=t,d={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),s),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>pM(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}function gM(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(mM(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const vP="2.71.1",Lo=30*1e3,ny=3,lv=ny*Lo,yM="http://localhost:9999",xM="supabase.auth.token",wM={"X-Client-Info":`gotrue-js/${vP}`},ay="X-Supabase-Api-Version",gP={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bM=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,_M=10*60*1e3;class K1 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function qe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class SM extends K1{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function kM(e){return qe(e)&&e.name==="AuthApiError"}class yP extends K1{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ds extends K1{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Ni extends ds{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function EM(e){return qe(e)&&e.name==="AuthSessionMissingError"}class Rd extends ds{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Md extends ds{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class $d extends ds{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function TM(e){return qe(e)&&e.name==="AuthImplicitGrantRedirectError"}class d2 extends ds{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class iy extends ds{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function cv(e){return qe(e)&&e.name==="AuthRetryableFetchError"}class h2 extends ds{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class sy extends ds{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Q0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),p2=` 	
\r=`.split(""),AM=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<p2.length;t+=1)e[p2[t].charCodeAt(0)]=-2;for(let t=0;t<Q0.length;t+=1)e[Q0[t].charCodeAt(0)]=t;return e})();function m2(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Q0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Q0[n]),t.queuedBits-=6}}function xP(e,t,r){const n=AM[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function v2(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{PM(s,n,r)};for(let s=0;s<e.length;s+=1)xP(e.charCodeAt(s),a,i);return t.join("")}function OM(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function CM(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}OM(n,t)}}function PM(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function jM(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)xP(e.charCodeAt(a),r,n);return new Uint8Array(t)}function NM(e){const t=[];return CM(e,r=>t.push(r)),new Uint8Array(t)}function FM(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>m2(a,r,n)),m2(null,r,n),t.join("")}function IM(e){return Math.round(Date.now()/1e3)+e}function DM(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const ia=()=>typeof window<"u"&&typeof document<"u",_s={tested:!1,writable:!1},wP=()=>{if(!ia())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(_s.tested)return _s.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),_s.tested=!0,_s.writable=!0}catch{_s.tested=!0,_s.writable=!1}return _s.writable};function RM(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const bP=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>rc(async()=>{const{default:n}=await Promise.resolve().then(()=>nc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},MM=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Bo=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ss=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ai=async(e,t)=>{await e.removeItem(t)};class Ip{constructor(){this.promise=new Ip.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ip.promiseConstructor=Promise;function uv(e){const t=e.split(".");if(t.length!==3)throw new sy("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!bM.test(t[n]))throw new sy("JWT not in base64url format");return{header:JSON.parse(v2(t[0])),payload:JSON.parse(v2(t[1])),signature:jM(t[2]),raw:{header:t[0],payload:t[1]}}}async function $M(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function LM(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function BM(e){return("0"+e.toString(16)).substr(-2)}function UM(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,BM).join("")}async function WM(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function zM(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await WM(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ao(e,t,r=!1){const n=UM();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Bo(e,`${t}-code-verifier`,a);const i=await zM(n);return[i,n===i?"plain":"s256"]}const HM=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function VM(e){const t=e.headers.get(ay);if(!t||!t.match(HM))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function GM(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function KM(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const qM=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Oo(e){if(!qM.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function fv(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function g2(e){return JSON.parse(JSON.stringify(e))}var XM=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const As=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),YM=[502,503,504];async function y2(e){var t;if(!MM(e))throw new iy(As(e),0);if(YM.includes(e.status))throw new iy(As(e),e.status);let r;try{r=await e.json()}catch(i){throw new yP(As(i),i)}let n;const a=VM(e);if(a&&a.getTime()>=gP["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new h2(As(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ni}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new h2(As(r),e.status,r.weak_password.reasons);throw new SM(As(r),e.status||500,n)}const JM=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function et(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[ay]||(i[ay]=gP["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await QM(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function QM(e,t,r,n,a,i){const s=JM(t,n,a,i);let o;try{o=await e(r,Object.assign({},s))}catch(l){throw console.error(l),new iy(As(l),0)}if(o.ok||await y2(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await y2(l)}}function Ha(e){var t;let r=null;r6(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=IM(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function x2(e){const t=Ha(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Li(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function ZM(e){return{data:e,error:null}}function e6(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=XM(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function t6(e){return e}function r6(e){return e.access_token&&e.refresh_token&&e.expires_in}const dv=["global","local","others"];var n6=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class a6{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=bP(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=dv[0]){if(dv.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${dv.join(", ")}`);try{return await et(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(qe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await et(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Li})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=n6(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await et(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:e6,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(qe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await et(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Li})}catch(r){if(qe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await et(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:t6});if(u.error)throw u.error;const f=await u.json(),d=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(m=>{const p=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=p}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(qe(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Oo(t);try{return await et(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Li})}catch(r){if(qe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Oo(t);try{return await et(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Li})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Oo(t);try{return await et(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Li})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Oo(t.userId);try{const{data:r,error:n}=await et(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(qe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Oo(t.userId),Oo(t.id);try{return{data:await et(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(qe(r))return{data:null,error:r};throw r}}}function w2(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function i6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Co={debug:!!(globalThis&&wP()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class _P extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class s6 extends _P{}async function o6(e,t,r){Co.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Co.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Co.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Co.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Co.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new s6(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Co.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}i6();const l6={url:yM,storageKey:xM,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wM,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function b2(e,t,r){return await r()}const Po={};class Ku{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ku.nextInstanceID,Ku.nextInstanceID+=1,this.instanceID>0&&ia()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},l6),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new a6({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=bP(a.fetch),this.lock=a.lock||b2,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:ia()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=o6:this.lock=b2,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:wP()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=w2(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=w2(this.memoryStorage)),ia()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Po[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Po[this.storageKey]=Object.assign(Object.assign({},Po[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Po[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Po[this.storageKey]=Object.assign(Object.assign({},Po[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${vP}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=RM(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),ia()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),TM(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return qe(r)?{error:r}:{error:new yP("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ha}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(qe(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:f,options:d}=t;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await Ao(this.storage,this.storageKey)),i=await et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:f,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:m},xform:Ha})}else if("phone"in t){const{phone:u,password:f,options:d}=t;i=await et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(a=d==null?void 0:d.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Ha})}else throw new Md("You must provide either an email or phone number and a password");const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(qe(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:o}=t;r=await et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:x2})}else if("phone"in t){const{phone:i,password:s,options:o}=t;r=await et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:x2})}else throw new Md("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Rd}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(qe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,i,s,o,l,c,u,f,d,h;let m,p;if("message"in t)m=t.message,p=t.signature;else{const{chain:g,wallet:x,statement:w,options:y}=t;let k;if(ia())if(typeof x=="object")k=x;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))k=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=x}const b=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in k&&k.signIn){const _=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),w?{statement:w}:null));let S;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")S=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)S=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)m=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),p=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${b.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(a=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const _=await k.signMessage(new TextEncoder().encode(m),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=_}}try{const{data:g,error:x}=await et(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:FM(p)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Ha});if(x)throw x;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Rd}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:x})}catch(g){if(qe(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(t){const r=await Ss(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await et(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ha});if(await Ai(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Rd}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(qe(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,o=await et(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ha}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Rd}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(qe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ao(this.storage,this.storageKey));const{error:f}=await et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Md("You must provide either an email or phone number.")}catch(o){if(qe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await et(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Ha});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(qe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await Ao(this.storage,this.storageKey)),await et(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:ZM})}catch(i){if(qe(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ni;const{error:a}=await et(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(qe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await et(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:o}=await et(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o}}throw new Md("You must provide either an email or phone number and a type")}catch(r){if(qe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ss(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<lv:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const s=await Ss(this.userStorage,this.storageKey+"-user");s!=null&&s.user?t.user=s.user:t.user=fv()}if(this.storage.isServer&&t.user){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!s&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Li}):await this._useSession(async r=>{var n,a,i;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ni}:await et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Li})})}catch(r){if(qe(r))return EM(r)&&(await this._removeSession(),await Ai(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new Ni;const s=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Ao(this.storage,this.storageKey));const{data:c,error:u}=await et(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:Li});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(qe(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ni;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=uv(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(qe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:o}=r;if(o)throw o;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ni;const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(qe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!ia())throw new $d("No browser detected.");if(t.error||t.error_description||t.error_code)throw new $d(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new d2("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $d("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new d2("No code detected.");const{data:w,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!s||!c)throw new $d("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let d=u+f;l&&(d=parseInt(l));const h=d-u;h*1e3<=Lo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const m=d-f;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,d,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,d,u);const{data:p,error:g}=await this._getUser(i);if(g)throw g;const x={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:d,refresh_token:s,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(qe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ss(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,t);if(o&&!(kM(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Ai(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=DM(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Ao(this.storage,this.storageKey,!0));try{return await et(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(qe(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(qe(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,o,l,c,u;const{data:f,error:d}=i;if(d)throw d;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await et(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return ia()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(qe(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await et(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(qe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await LM(async a=>(a>0&&await $M(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await et(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ha})),(a,i)=>{const s=200*Math.pow(2,a);return i&&cv(i)&&Date.now()+s-n<Lo})}catch(n){if(this._debug(r,"error",n),qe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ia()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Ss(this.storage,this.storageKey);if(a&&this.userStorage){let s=await Ss(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await Bo(this.userStorage,this.storageKey+"-user",s)),a.user=(t=s==null?void 0:s.user)!==null&&t!==void 0?t:fv()}else if(a&&!a.user&&!a.user){const s=await Ss(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(a.user=s.user,await Ai(this.storage,this.storageKey+"-user"),await Bo(this.storage,this.storageKey,a)):a.user=fv()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<lv;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${lv}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),cv(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:o}=await this._getUser(a.access_token);!o&&(s!=null&&s.user)?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ni;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Ip;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new Ni;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),qe(i)){const s={session:null,error:i};return cv(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(s),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Bo(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=g2(a);await Bo(this.storage,this.storageKey,i)}else{const a=g2(r);await Bo(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ai(this.storage,this.storageKey),await Ai(this.storage,this.storageKey+"-code-verifier"),await Ai(this.storage,this.storageKey+"-user"),this.userStorage&&await Ai(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ia()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Lo);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Lo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Lo}ms, refresh threshold is ${ny} ticks`),a<=ny&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof _P)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ia()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await Ao(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await et(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(qe(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await et(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(qe(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:s,error:o}=await et(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(qe(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await et(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(qe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),i=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=uv(a.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+_M>a)return n;const{data:i,error:s}=await et(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:h,error:m}=await this.getSession();if(m||!h.session)return{data:null,error:m};n=h.session.access_token}const{header:a,payload:i,signature:s,raw:{header:o,payload:l}}=uv(n);r!=null&&r.allowExpired||GM(i.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:a,signature:s},error:null}}const u=KM(a.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,s,NM(`${o}.${l}`)))throw new sy("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(qe(n))return{data:null,error:n};throw n}}}Ku.nextInstanceID=0;const c6=Ku;class u6 extends c6{constructor(t){super(t)}}var f6=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class d6{constructor(t,r,n){var a,i,s;this.supabaseUrl=t,this.supabaseKey=r;const o=gM(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:oM,realtime:cM,auth:Object.assign(Object.assign({},lM),{storageKey:l}),global:sM},u=vM(n??{},c);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=hM(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new A8(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new nM(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new i8(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return f6(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,storageKey:s,flowType:o,lock:l,debug:c},u,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new u6({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,flowType:o,lock:l,debug:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new H8(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const h6=(e,t,r)=>new d6(e,t,r);function p6(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}p6()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const SP={BASE_URL:"/KPI-Dashboard/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impza2Fqa3d1bGFhYWtoYW9semR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0NTExMjEsImV4cCI6MjA3MzAyNzEyMX0.8pq0sVGGofg2vGmrOdbvqbVX-mFcdQInZ3T5pc70Qb4",VITE_SUPABASE_URL:"https://jskajkwulaaakhaolzdu.supabase.co"};var zi={},BA;const m6=typeof window<"u"&&((BA=window.__ENV)==null?void 0:BA.VITE_SUPABASE_URL)||typeof import.meta<"u"&&SP&&"https://jskajkwulaaakhaolzdu.supabase.co"||typeof process<"u"&&(zi.NEXT_PUBLIC_SUPABASE_URL||zi.REACT_APP_SUPABASE_URL||zi.VITE_SUPABASE_URL)||typeof process<"u"&&zi.SUPABASE_URL||"";var UA;const v6=typeof window<"u"&&((UA=window.__ENV)==null?void 0:UA.VITE_SUPABASE_ANON_KEY)||typeof import.meta<"u"&&SP&&"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impza2Fqa3d1bGFhYWtoYW9semR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0NTExMjEsImV4cCI6MjA3MzAyNzEyMX0.8pq0sVGGofg2vGmrOdbvqbVX-mFcdQInZ3T5pc70Qb4"||typeof process<"u"&&(zi.NEXT_PUBLIC_SUPABASE_ANON_KEY||zi.REACT_APP_SUPABASE_ANON_KEY||zi.VITE_SUPABASE_ANON_KEY)||typeof process<"u"&&zi.SUPABASE_ANON_KEY||"",g6=typeof window<"u"&&localStorage.getItem("SUPABASE_URL")||"",y6=typeof window<"u"&&localStorage.getItem("SUPABASE_ANON_KEY")||"",kP=m6||g6,EP=v6||y6,x6=kP||"https://placeholder.supabase.co",w6=EP||"placeholder-anon-key";(!kP||!EP)&&console.warn("[supabaseClient] Missing Supabase URL or anon key. Provide VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY (or NEXT_PUBLIC_/REACT_APP_ equivalents) via environment variables, or configure via Supabase Settings panel. Using placeholder values.");const be=h6(x6,w6,{auth:{persistSession:!0,autoRefreshToken:!0}});function Dc({children:e,fallback:t=null}){const[r,n]=R.useState(!1),[a,i]=R.useState(!1);return R.useEffect(()=>{async function s(){const{data:{session:o}}=await be.auth.getSession();if(!o){n(!1),i(!0);return}const{data:l,error:c}=await be.from("app_roles").select("role").eq("user_id",o.user.id).maybeSingle();{if(c)console.warn("AdminOnly app_roles error:",c),n(!1);else{const u=((l==null?void 0:l.role)??"user")==="admin";n(u),u||console.warn("AdminOnly: user is not admin; role =",l==null?void 0:l.role)}i(!0)}}s()},[]),a?r?e:t??null:v.jsx("div",{children:"Loading…"})}const oy="v3.2";console.log("[Procedures.jsx]",oy);function Di(e){if(!e)return"";const t=e.trim();return/^[a-zA-Z][a-zA-Z\d+\-.]*:\/\//.test(t)?t:"https://"+t}async function Ld(){var e,t,r;try{if((e=be==null?void 0:be.auth)!=null&&e.getUser){const{data:n,error:a}=await be.auth.getUser();return a?(console.warn("supabase.auth.getUser error",a),null):((t=n==null?void 0:n.user)==null?void 0:t.id)||null}if((r=be==null?void 0:be.auth)!=null&&r.user){const n=be.auth.user();return(n==null?void 0:n.id)||null}}catch(n){console.warn("getUserId unexpected error",n)}return null}function b6({url:e}){if(!e)return null;const t=n=>/\.(mp4|webm|ogg|m3u8)(\?.*)?$/i.test(n);let r;try{r=new URL(e)}catch{try{r=new URL(Di(e))}catch{r=null}}if(r){const n=r.hostname||"";if(n.includes("youtube.com")||n.includes("youtu.be")){let a=r.searchParams.get("v");return!a&&n.includes("youtu.be")&&(a=r.pathname.replace("/","")),a?v.jsx("iframe",{width:"560",height:"315",src:`https://www.youtube.com/embed/${a}`,title:"YouTube video",frameBorder:"0",allowFullScreen:!0,style:{maxWidth:"100%",borderRadius:8}}):null}if(n.includes("vimeo.com")){const a=r.pathname.split("/").pop();return a?v.jsx("iframe",{width:"560",height:"315",src:`https://player.vimeo.com/video/${a}`,title:"Vimeo video",frameBorder:"0",allowFullScreen:!0,style:{maxWidth:"100%",borderRadius:8}}):null}if(n.includes("loom.com")){const a=(r.href||e).replace("/share/","/embed/");return v.jsx("iframe",{width:"560",height:"315",src:a,title:"Loom video",frameBorder:"0",allowFullScreen:!0,style:{maxWidth:"100%",borderRadius:8}})}if(t(r.href||e))return v.jsx("video",{controls:!0,src:r.href||e,style:{width:"100%",maxWidth:560,height:315,borderRadius:8}})}return v.jsxs("div",{style:{background:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:8,padding:12,textAlign:"center"},children:[v.jsx("p",{style:{margin:0,color:"#666",fontSize:14},children:"Video Link:"}),v.jsx("a",{href:Di(e),target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"none"},children:e})]})}function _6({attachment:e}){if(!(e!=null&&e.url))return null;const{url:t,filename:r,mime_type:n}=e;return n&&n.startsWith("image/")?v.jsxs("div",{style:{border:"1px solid #dee2e6",borderRadius:8,padding:8,background:"#ffffff",textAlign:"center"},children:[v.jsx("img",{src:t,alt:r||"Attachment",style:{maxWidth:"100%",maxHeight:200,borderRadius:6,objectFit:"contain"}}),r&&v.jsx("div",{style:{fontSize:12,marginTop:4,color:"#666"},children:r})]}):v.jsxs("div",{style:{border:"1px solid #dee2e6",borderRadius:8,padding:12,background:"#f8f9fa",textAlign:"center"},children:[v.jsx("div",{style:{marginBottom:8},children:v.jsx("span",{style:{fontSize:24},children:"📁"})}),v.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"none",fontWeight:500,fontSize:14},children:r||"Download File"}),n&&v.jsx("div",{style:{fontSize:11,marginTop:4,color:"#888"},children:n})]})}function S6(){const[e,t]=R.useState([]),[r,n]=R.useState(!0),[a,i]=R.useState(null),[s,o]=R.useState("procedure"),[l,c]=R.useState(""),[u,f]=R.useState(""),[d,h]=R.useState(""),[m,p]=R.useState(""),[g,x]=R.useState(null),[w,y]=R.useState("url"),[k,b]=R.useState(!1),[_,S]=R.useState(null),[E,T]=R.useState(null),[F,C]=R.useState(""),[A,M]=R.useState("file"),[V,z]=R.useState(!1),[Y,J]=R.useState({}),[Q,j]=R.useState({}),[X,ee]=R.useState({}),[P,G]=R.useState({}),[B,q]=R.useState({}),[ne,ye]=R.useState({});async function pe(){n(!0),i(null);try{const{data:I,error:K}=await be.from("procedures").select("id,title,body,created_at,procedure_videos(id,url,created_at,owner),procedure_attachments(id,url,filename,mime_type,created_at,owner)").order("created_at",{ascending:!1});K?(i(`Failed to load procedures: ${K.message}`),t([])):t(I||[])}catch(I){i(`Supabase connection error: ${I.message}`),t([])}n(!1)}R.useEffect(()=>{pe()},[]);const te=R.useMemo(()=>e.map(I=>({value:I.id,label:I.title||"(untitled)"})),[e]);async function le(I){if(!I)throw new Error("No file provided to uploadAttachmentToSupabase");const K=`${Date.now()}_${I.name.replace(/\s+/g,"_")}`;console.log("uploadAttachmentToSupabase: uploading",K);const{data:ue,error:ve}=await be.storage.from("procedure-attachments").upload(K,I,{cacheControl:"3600",upsert:!1});if(ve)throw console.error("Storage upload error",ve),ve;const{data:ke,error:Be}=await be.storage.from("procedure-attachments").getPublicUrl(K);Be&&console.warn("Failed to get public URL; returning filename instead",Be);const Me=Di((ke==null?void 0:ke.publicUrl)||K);return console.log("uploadAttachmentToSupabase: uploaded",{filename:K,publicUrl:Me,mimeType:I.type}),{publicUrl:Me,filename:K,mimeType:I.type}}async function Se(I){if(!I)throw new Error("No file provided to uploadVideoToSupabase");const K=`${Date.now()}_${I.name.replace(/\s+/g,"_")}`;console.log("uploadVideoToSupabase: uploading",K);const{data:ue,error:ve}=await be.storage.from("videos").upload(K,I,{cacheControl:"3600",upsert:!1});if(ve)throw console.error("Storage upload error",ve),ve;const{data:ke,error:Be}=await be.storage.from("videos").getPublicUrl(K);Be&&console.warn("Failed to get public URL; returning filename instead",Be);const Me=Di((ke==null?void 0:ke.publicUrl)||K);return console.log("uploadVideoToSupabase: uploaded",{filename:K,publicUrl:Me}),{publicUrl:Me,filename:K}}async function N(I){if(I.preventDefault(),S(null),!l.trim()){S("Title is required.");return}try{const{error:K}=await be.from("procedures").insert({title:l.trim(),body:u.trim()||null});if(K){console.error("Supabase error adding procedure:",K),S(`Failed to add procedure: ${K.message}`);return}c(""),f(""),S(null),pe()}catch(K){console.error("Unexpected error adding procedure:",K),S(`Unexpected error: ${K.message}`)}}async function Re(I){if(I.preventDefault(),!m)return alert("Choose a procedure to attach the video to.");b(!0);let K=null;try{const ue=await Ld();if(console.log("addVideoTop ownerId:",ue),!ue)return b(!1),alert("You must be signed in to add a video.");let ve="";if(w==="url"){if(!d.trim())return b(!1),alert("Paste a YouTube, Vimeo, or Loom URL.");const Ce=Di(d);if(!/youtube\.com|youtu\.be|vimeo\.com|loom\.com|\.mp4|\.webm|\.ogg|\.m3u8/i.test(Ce)&&!confirm("This URL does not look like YouTube/Vimeo/Loom or a direct video file. Add anyway?")){b(!1);return}ve=Ce}else{if(!g)return b(!1),alert("Select a video file to upload.");const{publicUrl:Ce,filename:$e}=await Se(g);ve=Ce,K=$e}const ke={procedure_id:m,url:ve,owner:ue};console.log("addVideoTop inserting payload:",ke);const{data:Be,error:Me}=await be.from("procedure_videos").insert(ke).select().limit(1);if(Me){if(console.error("Supabase error adding procedure video:",Me),K)try{const{error:Ce}=await be.storage.from("videos").remove([K]);Ce?console.warn("Cleanup remove error:",Ce):console.log("Cleaned up uploaded file after DB insert failure:",K)}catch(Ce){console.warn("Failed to cleanup uploaded file",Ce)}alert(Me.message),b(!1);return}h(""),x(null),pe()}catch(ue){if(console.error("addVideoTop unexpected error",ue),K)try{const{error:ve}=await be.storage.from("videos").remove([K]);ve?console.warn("Cleanup remove error (catch):",ve):console.log("Cleaned up uploaded file after unexpected failure:",K)}catch(ve){console.warn("Failed to cleanup uploaded file (catch)",ve)}alert("Failed to add video: "+(ue.message||String(ue)))}finally{b(!1)}}async function ae(I){if(I.preventDefault(),!m)return alert("Choose a procedure to attach the file to.");z(!0);let K=null;try{const ue=await Ld();if(console.log("addAttachmentTop ownerId:",ue),!ue)return z(!1),alert("You must be signed in to add an attachment.");let ve="",ke="",Be="";if(A==="url"){if(!F.trim())return z(!1),alert("Enter a URL for the attachment.");ve=Di(F),Be=F.split("/").pop()||"linked-file"}else{if(!E)return z(!1),alert("Select a file to upload.");const{publicUrl:ct,filename:je,mimeType:Ge}=await le(E);ve=ct,K=je,Be=E.name,ke=Ge}const Me={procedure_id:m,url:ve,filename:Be,mime_type:ke||null,owner:ue};console.log("addAttachmentTop inserting payload:",Me);const{data:Ce,error:$e}=await be.from("procedure_attachments").insert(Me).select().limit(1);if($e){if(console.error("Supabase error adding procedure attachment:",$e),K)try{const{error:ct}=await be.storage.from("procedure-attachments").remove([K]);ct?console.warn("Cleanup remove error:",ct):console.log("Cleaned up uploaded file after DB insert failure:",K)}catch(ct){console.warn("Failed to cleanup uploaded file",ct)}alert($e.message),z(!1);return}C(""),T(null),pe()}catch(ue){if(console.error("addAttachmentTop unexpected error",ue),K)try{const{error:ve}=await be.storage.from("procedure-attachments").remove([K]);ve?console.warn("Cleanup remove error (catch):",ve):console.log("Cleaned up uploaded file after unexpected failure:",K)}catch(ve){console.warn("Failed to cleanup uploaded file (catch)",ve)}alert("Failed to add attachment: "+(ue.message||String(ue)))}finally{z(!1)}}async function re(I){const K=ne[I]||"file";let ue=null;try{const ve=await Ld();if(console.log("addAttachmentInline ownerId:",ve),!ve)return alert("You must be signed in to add an attachment.");let ke="",Be="",Me="";if(K==="url"){const je=(P[I]||"").trim();if(!je)return;ke=Di(je),Me=je.split("/").pop()||"linked-file"}else{const je=B[I];if(!je)return;const{publicUrl:Ge,filename:Zt,mimeType:yt}=await le(je);ke=Ge,ue=Zt,Me=je.name,Be=yt}const Ce={procedure_id:I,url:ke,filename:Me,mime_type:Be||null,owner:ve};console.log("addAttachmentInline inserting payload:",Ce);const{data:$e,error:ct}=await be.from("procedure_attachments").insert(Ce).select().limit(1);if(ct){if(console.error("Supabase error adding inline attachment:",ct),ue)try{const{error:je}=await be.storage.from("procedure-attachments").remove([ue]);je?console.warn("Cleanup remove error (inline):",je):console.log("Cleaned up uploaded file after inline DB insert failure:",ue)}catch(je){console.warn("Cleanup failed (inline)",je)}return alert(ct.message)}G(je=>({...je,[I]:""})),q(je=>({...je,[I]:null})),pe()}catch(ve){if(console.error("addAttachmentInline unexpected error",ve),ue)try{const{error:ke}=await be.storage.from("procedure-attachments").remove([ue]);ke?console.warn("Cleanup remove error (inline catch):",ke):console.log("Cleaned up uploaded file after inline unexpected failure:",ue)}catch(ke){console.warn("Failed to cleanup uploaded file (inline catch)",ke)}alert("Failed to add attachment: "+(ve.message||String(ve)))}}async function fe(I){let K=null;try{const ue=await Ld();if(console.log("addVideoInline ownerId:",ue),!ue)return alert("You must be signed in to add a video.");let ve="";if(sourceType==="url"){const Ce=(Y[I]||"").trim();if(!Ce)return;ve=Di(Ce)}else{const Ce=Q[I];if(!Ce)return;const{publicUrl:$e,filename:ct}=await Se(Ce);ve=$e,K=ct}const ke={procedure_id:I,url:ve,owner:ue};console.log("addVideoInline inserting payload:",ke);const{data:Be,error:Me}=await be.from("procedure_videos").insert(ke).select().limit(1);if(Me){if(console.error("Supabase error adding inline video:",Me),K)try{const{error:Ce}=await be.storage.from("videos").remove([K]);Ce?console.warn("Cleanup remove error (inline):",Ce):console.log("Cleaned up uploaded file after inline DB insert failure:",K)}catch(Ce){console.warn("Cleanup failed (inline)",Ce)}return alert(Me.message)}J(Ce=>({...Ce,[I]:""})),j(Ce=>({...Ce,[I]:null})),pe()}catch(ue){if(console.error("addVideoInline unexpected error",ue),K)try{const{error:ve}=await be.storage.from("videos").remove([K]);ve?console.warn("Cleanup remove error (inline catch):",ve):console.log("Cleaned up uploaded file after inline unexpected failure:",K)}catch(ve){console.warn("Failed to cleanup uploaded file (inline catch)",ve)}alert("Failed to add video: "+(ue.message||String(ue)))}}async function de(I){const{error:K}=await be.from("procedures").delete().eq("id",I);if(K)return alert(K.message);pe()}async function Ue(I){const{error:K}=await be.from("procedure_attachments").delete().eq("id",I);if(K)return alert(K.message);pe()}async function at(I){const{error:K}=await be.from("procedure_videos").delete().eq("id",I);if(K)return alert(K.message);pe()}return v.jsxs("div",{className:"p-4",style:{maxWidth:1e3},"data-proc-version":oy,children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[v.jsx("h1",{style:{margin:0},children:"Procedures"}),v.jsx("span",{style:{fontSize:12,padding:"2px 6px",border:"1px solid #e5e7eb",borderRadius:999},children:oy})]}),v.jsx(Dc,{children:v.jsxs("div",{style:{marginTop:12,marginBottom:16,border:"1px solid #eee",borderRadius:10,padding:12,background:"#fafbfd"},children:[v.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",marginBottom:10},children:[v.jsxs("select",{value:s,onChange:I=>o(I.target.value),style:{minWidth:220},children:[v.jsx("option",{value:"procedure",children:"Procedure (Text)"}),v.jsx("option",{value:"video",children:"Video for… (attach to procedure)"}),v.jsx("option",{value:"attachment",children:"Attachment for… (attach to procedure)"})]}),v.jsx("div",{style:{opacity:.7,fontSize:12},children:"Tip: You can also add videos and attachments inline on each procedure card below. Supports YouTube, Vimeo, Loom, file uploads, and file attachments."})]}),s==="procedure"?v.jsxs("div",{children:[v.jsxs("form",{onSubmit:N,style:{display:"grid",gridTemplateColumns:"1fr 1fr 96px",gap:10},children:[v.jsx("input",{placeholder:"Title",value:l,onChange:I=>c(I.target.value),required:!0}),v.jsx("input",{placeholder:"Short description / steps",value:u,onChange:I=>f(I.target.value)}),v.jsx("button",{type:"submit",children:"Add"})]}),_&&v.jsx("div",{style:{background:"#fee",border:"1px solid #fcc",color:"#c33",padding:"8px 12px",borderRadius:6,marginTop:10,fontSize:14},children:_})]}):s==="video"?v.jsxs("div",{style:{display:"grid",gap:10},children:[v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[v.jsxs("select",{value:m,onChange:I=>p(I.target.value),required:!0,children:[v.jsx("option",{value:"",children:"Choose procedure…"}),te.map(I=>v.jsx("option",{value:I.value,children:I.label},I.value))]}),v.jsxs("select",{value:w,onChange:I=>y(I.target.value),children:[v.jsx("option",{value:"url",children:"URL (YouTube, Vimeo, Loom)"}),v.jsx("option",{value:"file",children:"Upload File"})]})]}),v.jsxs("form",{onSubmit:Re,style:{display:"grid",gridTemplateColumns:"1fr 96px",gap:10},children:[w==="url"?v.jsx("input",{placeholder:"Paste YouTube, Vimeo, or Loom URL…",value:d,onChange:I=>h(I.target.value),required:!0}):v.jsx("input",{type:"file",accept:"video/*",onChange:I=>{var K;return x(((K=I.target.files)==null?void 0:K[0])||null)},required:!0,style:{padding:"8px"}}),v.jsx("button",{type:"submit",disabled:k,children:k?"Adding...":"Add"})]})]}):v.jsxs("div",{style:{display:"grid",gap:10},children:[v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[v.jsxs("select",{value:m,onChange:I=>p(I.target.value),required:!0,children:[v.jsx("option",{value:"",children:"Choose procedure…"}),te.map(I=>v.jsx("option",{value:I.value,children:I.label},I.value))]}),v.jsxs("select",{value:A,onChange:I=>M(I.target.value),children:[v.jsx("option",{value:"file",children:"Upload File"}),v.jsx("option",{value:"url",children:"Link to URL"})]})]}),v.jsxs("form",{onSubmit:ae,style:{display:"grid",gridTemplateColumns:"1fr 96px",gap:10},children:[A==="url"?v.jsx("input",{placeholder:"Paste URL for file/image…",value:F,onChange:I=>C(I.target.value),required:!0}):v.jsx("input",{type:"file",onChange:I=>{var K;return T(((K=I.target.files)==null?void 0:K[0])||null)},required:!0,style:{padding:"8px"}}),v.jsx("button",{type:"submit",disabled:V,children:V?"Adding...":"Add"})]})]})]})}),v.jsx("h2",{style:{fontSize:16,margin:"12px 0"},children:"Procedures & Training"}),a&&v.jsx("div",{style:{background:"#fee",border:"1px solid #fcc",color:"#c33",padding:"12px 16px",borderRadius:8,marginBottom:16},children:a}),r?v.jsx("div",{children:"Loading…"}):v.jsx(v.Fragment,{children:e.length===0?v.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666",background:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:8},children:"No procedures found."}):v.jsx("ul",{style:{listStyle:"none",padding:0,display:"grid",gap:14},children:e.map(I=>v.jsxs("li",{style:{border:"1px solid #e6e6e6",borderRadius:12,padding:16,background:"#fff"},children:[v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:12},children:[v.jsxs("div",{style:{flex:1},children:[v.jsx("h3",{style:{margin:0,marginBottom:4,fontSize:18,fontWeight:700,color:"#1a1a1a"},children:I.title}),I.body&&v.jsx("div",{style:{color:"#666",lineHeight:1.5,fontSize:14,padding:"8px 12px",background:"#f8f9fa",borderRadius:6,border:"1px solid #e9ecef"},children:I.body})]}),v.jsx(Dc,{children:v.jsx("button",{onClick:()=>de(I.id),style:{background:"#dc3545",color:"#fff",border:"none",padding:"8px 12px",borderRadius:6,fontSize:12,cursor:"pointer"},children:"Remove Procedure"})})]}),I.procedure_videos&&I.procedure_videos.length>0&&v.jsxs("div",{style:{marginBottom:12},children:[v.jsxs("h4",{style:{margin:"0 0 8px 0",fontSize:14,fontWeight:600,color:"#555"},children:["Attached Videos (",I.procedure_videos.length,")"]}),v.jsx("div",{style:{display:"grid",gap:12},children:I.procedure_videos.map(K=>v.jsxs("div",{style:{border:"1px solid #dee2e6",borderRadius:8,padding:12,background:"#ffffff"},children:[v.jsx(b6,{url:K.url}),v.jsxs("div",{style:{fontSize:12,opacity:.7,marginTop:8},children:["Added: ",new Date(K.created_at).toLocaleDateString()]}),v.jsx(Dc,{children:v.jsx("div",{style:{marginTop:8},children:v.jsx("button",{onClick:()=>at(K.id),style:{background:"#6c757d",color:"#fff",border:"none",padding:"4px 8px",borderRadius:4,fontSize:11,cursor:"pointer"},children:"Remove Video"})})})]},K.id))})]}),I.procedure_attachments&&I.procedure_attachments.length>0&&v.jsxs("div",{style:{marginBottom:12},children:[v.jsxs("h4",{style:{margin:"0 0 8px 0",fontSize:14,fontWeight:600,color:"#555"},children:["Attached Files (",I.procedure_attachments.length,")"]}),v.jsx("div",{style:{display:"grid",gap:12},children:I.procedure_attachments.map(K=>v.jsxs("div",{style:{border:"1px solid #dee2e6",borderRadius:8,padding:12,background:"#ffffff"},children:[v.jsx(_6,{attachment:K}),v.jsxs("div",{style:{fontSize:12,opacity:.7,marginTop:8},children:["Added: ",new Date(K.created_at).toLocaleDateString()]}),v.jsx(Dc,{children:v.jsx("div",{style:{marginTop:8},children:v.jsx("button",{onClick:()=>Ue(K.id),style:{background:"#6c757d",color:"#fff",border:"none",padding:"4px 8px",borderRadius:4,fontSize:11,cursor:"pointer"},children:"Remove Attachment"})})})]},K.id))})]}),v.jsxs(Dc,{children:[v.jsxs("div",{style:{marginTop:10,border:"1px solid #e9ecef",borderRadius:8,padding:10,background:"#f8f9fa"},children:[v.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:8,color:"#666"},children:"Add Video to this Procedure:"}),v.jsx("div",{style:{marginBottom:8},children:v.jsxs("select",{value:X[I.id]||"url",onChange:K=>ee(ue=>({...ue,[I.id]:K.target.value})),style:{width:"100%",padding:"6px 8px",fontSize:12},children:[v.jsx("option",{value:"url",children:"URL (YouTube, Vimeo, Loom)"}),v.jsx("option",{value:"file",children:"Upload File"})]})}),v.jsxs("div",{style:{display:"flex",gap:8},children:[(X[I.id]||"url")==="url"?v.jsx("input",{placeholder:"Paste video URL…",value:Y[I.id]||"",onChange:K=>J(ue=>({...ue,[I.id]:K.target.value})),style:{flex:1,padding:"6px 8px"}}):v.jsx("input",{type:"file",accept:"video/*",onChange:K=>j(ue=>{var ve;return{...ue,[I.id]:((ve=K.target.files)==null?void 0:ve[0])||null}}),style:{flex:1,padding:"6px 8px"}}),v.jsx("button",{type:"button",onClick:()=>fe(I.id),children:"Add video"})]})]}),v.jsxs("div",{style:{marginTop:10,border:"1px solid #e9ecef",borderRadius:8,padding:10,background:"#f8f9fa"},children:[v.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:8,color:"#666"},children:"Add Attachment to this Procedure:"}),v.jsx("div",{style:{marginBottom:8},children:v.jsxs("select",{value:ne[I.id]||"file",onChange:K=>ye(ue=>({...ue,[I.id]:K.target.value})),style:{width:"100%",padding:"6px 8px",fontSize:12},children:[v.jsx("option",{value:"file",children:"Upload File"}),v.jsx("option",{value:"url",children:"Link to URL"})]})}),v.jsxs("div",{style:{display:"flex",gap:8},children:[(ne[I.id]||"file")==="url"?v.jsx("input",{placeholder:"Paste file/image URL…",value:P[I.id]||"",onChange:K=>G(ue=>({...ue,[I.id]:K.target.value})),style:{flex:1,padding:"6px 8px"}}):v.jsx("input",{type:"file",onChange:K=>q(ue=>{var ve;return{...ue,[I.id]:((ve=K.target.files)==null?void 0:ve[0])||null}}),style:{flex:1,padding:"6px 8px"}}),v.jsx("button",{type:"button",onClick:()=>re(I.id),children:"Add attachment"})]})]})]})]},I.id))})})]})}const k6="private-attachments";async function E6(){const{data:e,error:t}=await be.from("delivery_tickets").select("*").order("created_at",{ascending:!1}).order("date",{ascending:!1});if(t)throw t;return e||[]}async function _2(e=1,t=50){const r=(e-1)*t,n=r+t-1,{data:a,error:i,count:s}=await be.from("delivery_tickets").select("*",{count:"exact"}).order("created_at",{ascending:!1}).order("date",{ascending:!1}).range(r,n);if(i)throw i;return{rows:a||[],count:s||0}}async function T6(){const{data:e,error:t}=await be.from("delivery_tickets").select("*").order("created_at",{ascending:!1}).order("date",{ascending:!1});if(t)throw t;return e||[]}async function A6(e){const{data:t,error:r}=await be.from("delivery_tickets").insert(e).select();if(r)throw r;return(t==null?void 0:t[0])??null}async function O6(e,t){const{data:r,error:n}=await be.from("delivery_tickets").update(t).eq("id",e).select();if(n)throw n;return(r==null?void 0:r[0])??null}async function C6(e){const{error:t}=await be.from("delivery_tickets").delete().eq("id",e);if(t)throw t;return!0}async function P6(e){const t={},r=Object.keys(e);for(const n of r)try{const a=await O6(n,e[n]);t[n]={success:!0,data:a}}catch(a){t[n]={success:!1,error:a}}return t}async function j6(e,t){const{data:r,error:n}=await be.storage.from(k6).upload(t,e,{cacheControl:"3600",upsert:!1});if(n)throw n;return r}async function N6({ticket_id:e,storage_key:t,filename:r,content_type:n,size:a,uploaded_by:i}){const{data:s,error:o}=await be.from("ticket_attachments").insert([{ticket_id:e,storage_key:t,filename:r,content_type:n,size:a,uploaded_by:i}]).select();if(o)throw o;return(s==null?void 0:s[0])??null}async function S2(e){const{data:t,error:r}=await be.from("ticket_attachments").select("*").eq("ticket_id",e).order("uploaded_at",{ascending:!1});if(r)throw r;return t||[]}function F6(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");return`${r}-${n}-${a}T${i}:${s}`}function I6(e){if(!e)return null;const t=new Date(e);return isNaN(t.getTime())?null:t.toISOString()}function ly(e){const t=e.length,r=e.reduce((m,p)=>{const g=Number(p.gallons_delivered||p.qty)||0;return m+g},0),n=e.reduce((m,p)=>m+(Number(p.amount)||0),0),a=e.filter(m=>m.miles_driven!=null&&m.miles_driven>0),i=a.reduce((m,p)=>m+(Number(p.miles_driven)||0),0),s=a.length>0?i/a.length:0,o=e.filter(m=>m.on_time_flag===0||m.on_time_flag===1),l=o.filter(m=>m.on_time_flag===1).length,c=o.length>0?l/o.length*100:0,u=r>0?n/r:0,f=u,d=t>0?r/t:0;return{tickets:t,totalGallons:r,amount:n,avgMiles:s,onTimePct:c,avgPricePerGallon:u,revenuePerGallon:f,gallonsPerTicket:d,milesPerTicket:s}}function D6(e){const t={};e.forEach(n=>{const a=n.truck||n.truck_id||"Unassigned";t[a]||(t[a]=[]),t[a].push(n)});const r={};return Object.keys(t).forEach(n=>{r[n]=ly(t[n])}),r}function R6(e){const t=new Set;return e.forEach(r=>{const n=r.truck||r.truck_id||"Unassigned";t.add(n)}),Array.from(t).sort()}function TP(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=TP(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ot(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=TP(e))&&(n&&(n+=" "),n+=t);return n}var M6=Array.isArray,pn=M6,$6=typeof zr=="object"&&zr&&zr.Object===Object&&zr,AP=$6,L6=AP,B6=typeof self=="object"&&self&&self.Object===Object&&self,U6=L6||B6||Function("return this")(),La=U6,W6=La,z6=W6.Symbol,Jf=z6,k2=Jf,OP=Object.prototype,H6=OP.hasOwnProperty,V6=OP.toString,Rc=k2?k2.toStringTag:void 0;function G6(e){var t=H6.call(e,Rc),r=e[Rc];try{e[Rc]=void 0;var n=!0}catch{}var a=V6.call(e);return n&&(t?e[Rc]=r:delete e[Rc]),a}var K6=G6,q6=Object.prototype,X6=q6.toString;function Y6(e){return X6.call(e)}var J6=Y6,E2=Jf,Q6=K6,Z6=J6,e$="[object Null]",t$="[object Undefined]",T2=E2?E2.toStringTag:void 0;function r$(e){return e==null?e===void 0?t$:e$:T2&&T2 in Object(e)?Q6(e):Z6(e)}var wi=r$;function n$(e){return e!=null&&typeof e=="object"}var bi=n$,a$=wi,i$=bi,s$="[object Symbol]";function o$(e){return typeof e=="symbol"||i$(e)&&a$(e)==s$}var ic=o$,l$=pn,c$=ic,u$=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,f$=/^\w*$/;function d$(e,t){if(l$(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||c$(e)?!0:f$.test(e)||!u$.test(e)||t!=null&&e in Object(t)}var q1=d$;function h$(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var hs=h$;const sc=_t(hs);var p$=wi,m$=hs,v$="[object AsyncFunction]",g$="[object Function]",y$="[object GeneratorFunction]",x$="[object Proxy]";function w$(e){if(!m$(e))return!1;var t=p$(e);return t==g$||t==y$||t==v$||t==x$}var X1=w$;const Je=_t(X1);var b$=La,_$=b$["__core-js_shared__"],S$=_$,hv=S$,A2=function(){var e=/[^.]+$/.exec(hv&&hv.keys&&hv.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function k$(e){return!!A2&&A2 in e}var E$=k$,T$=Function.prototype,A$=T$.toString;function O$(e){if(e!=null){try{return A$.call(e)}catch{}try{return e+""}catch{}}return""}var CP=O$,C$=X1,P$=E$,j$=hs,N$=CP,F$=/[\\^$.*+?()[\]{}|]/g,I$=/^\[object .+?Constructor\]$/,D$=Function.prototype,R$=Object.prototype,M$=D$.toString,$$=R$.hasOwnProperty,L$=RegExp("^"+M$.call($$).replace(F$,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function B$(e){if(!j$(e)||P$(e))return!1;var t=C$(e)?L$:I$;return t.test(N$(e))}var U$=B$;function W$(e,t){return e==null?void 0:e[t]}var z$=W$,H$=U$,V$=z$;function G$(e,t){var r=V$(e,t);return H$(r)?r:void 0}var mo=G$,K$=mo,q$=K$(Object,"create"),Dp=q$,O2=Dp;function X$(){this.__data__=O2?O2(null):{},this.size=0}var Y$=X$;function J$(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Q$=J$,Z$=Dp,eL="__lodash_hash_undefined__",tL=Object.prototype,rL=tL.hasOwnProperty;function nL(e){var t=this.__data__;if(Z$){var r=t[e];return r===eL?void 0:r}return rL.call(t,e)?t[e]:void 0}var aL=nL,iL=Dp,sL=Object.prototype,oL=sL.hasOwnProperty;function lL(e){var t=this.__data__;return iL?t[e]!==void 0:oL.call(t,e)}var cL=lL,uL=Dp,fL="__lodash_hash_undefined__";function dL(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=uL&&t===void 0?fL:t,this}var hL=dL,pL=Y$,mL=Q$,vL=aL,gL=cL,yL=hL;function oc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}oc.prototype.clear=pL;oc.prototype.delete=mL;oc.prototype.get=vL;oc.prototype.has=gL;oc.prototype.set=yL;var xL=oc;function wL(){this.__data__=[],this.size=0}var bL=wL;function _L(e,t){return e===t||e!==e&&t!==t}var Y1=_L,SL=Y1;function kL(e,t){for(var r=e.length;r--;)if(SL(e[r][0],t))return r;return-1}var Rp=kL,EL=Rp,TL=Array.prototype,AL=TL.splice;function OL(e){var t=this.__data__,r=EL(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():AL.call(t,r,1),--this.size,!0}var CL=OL,PL=Rp;function jL(e){var t=this.__data__,r=PL(t,e);return r<0?void 0:t[r][1]}var NL=jL,FL=Rp;function IL(e){return FL(this.__data__,e)>-1}var DL=IL,RL=Rp;function ML(e,t){var r=this.__data__,n=RL(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var $L=ML,LL=bL,BL=CL,UL=NL,WL=DL,zL=$L;function lc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}lc.prototype.clear=LL;lc.prototype.delete=BL;lc.prototype.get=UL;lc.prototype.has=WL;lc.prototype.set=zL;var Mp=lc,HL=mo,VL=La,GL=HL(VL,"Map"),J1=GL,C2=xL,KL=Mp,qL=J1;function XL(){this.size=0,this.__data__={hash:new C2,map:new(qL||KL),string:new C2}}var YL=XL;function JL(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var QL=JL,ZL=QL;function e5(e,t){var r=e.__data__;return ZL(t)?r[typeof t=="string"?"string":"hash"]:r.map}var $p=e5,t5=$p;function r5(e){var t=t5(this,e).delete(e);return this.size-=t?1:0,t}var n5=r5,a5=$p;function i5(e){return a5(this,e).get(e)}var s5=i5,o5=$p;function l5(e){return o5(this,e).has(e)}var c5=l5,u5=$p;function f5(e,t){var r=u5(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var d5=f5,h5=YL,p5=n5,m5=s5,v5=c5,g5=d5;function cc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}cc.prototype.clear=h5;cc.prototype.delete=p5;cc.prototype.get=m5;cc.prototype.has=v5;cc.prototype.set=g5;var Q1=cc,PP=Q1,y5="Expected a function";function Z1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(y5);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var s=e.apply(this,n);return r.cache=i.set(a,s)||i,s};return r.cache=new(Z1.Cache||PP),r}Z1.Cache=PP;var jP=Z1;const x5=_t(jP);var w5=jP,b5=500;function _5(e){var t=w5(e,function(n){return r.size===b5&&r.clear(),n}),r=t.cache;return t}var S5=_5,k5=S5,E5=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,T5=/\\(\\)?/g,A5=k5(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(E5,function(r,n,a,i){t.push(a?i.replace(T5,"$1"):n||r)}),t}),O5=A5;function C5(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var ew=C5,P2=Jf,P5=ew,j5=pn,N5=ic,j2=P2?P2.prototype:void 0,N2=j2?j2.toString:void 0;function NP(e){if(typeof e=="string")return e;if(j5(e))return P5(e,NP)+"";if(N5(e))return N2?N2.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var F5=NP,I5=F5;function D5(e){return e==null?"":I5(e)}var FP=D5,R5=pn,M5=q1,$5=O5,L5=FP;function B5(e,t){return R5(e)?e:M5(e,t)?[e]:$5(L5(e))}var IP=B5,U5=ic;function W5(e){if(typeof e=="string"||U5(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Lp=W5,z5=IP,H5=Lp;function V5(e,t){t=z5(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[H5(t[r++])];return r&&r==n?e:void 0}var tw=V5,G5=tw;function K5(e,t,r){var n=e==null?void 0:G5(e,t);return n===void 0?r:n}var DP=K5;const Gn=_t(DP);function q5(e){return e==null}var X5=q5;const tt=_t(X5);var Y5=wi,J5=pn,Q5=bi,Z5="[object String]";function eB(e){return typeof e=="string"||!J5(e)&&Q5(e)&&Y5(e)==Z5}var tB=eB;const eo=_t(tB);var RP={exports:{}},gt={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rw=Symbol.for("react.element"),nw=Symbol.for("react.portal"),Bp=Symbol.for("react.fragment"),Up=Symbol.for("react.strict_mode"),Wp=Symbol.for("react.profiler"),zp=Symbol.for("react.provider"),Hp=Symbol.for("react.context"),rB=Symbol.for("react.server_context"),Vp=Symbol.for("react.forward_ref"),Gp=Symbol.for("react.suspense"),Kp=Symbol.for("react.suspense_list"),qp=Symbol.for("react.memo"),Xp=Symbol.for("react.lazy"),nB=Symbol.for("react.offscreen"),MP;MP=Symbol.for("react.module.reference");function Zn(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case rw:switch(e=e.type,e){case Bp:case Wp:case Up:case Gp:case Kp:return e;default:switch(e=e&&e.$$typeof,e){case rB:case Hp:case Vp:case Xp:case qp:case zp:return e;default:return t}}case nw:return t}}}gt.ContextConsumer=Hp;gt.ContextProvider=zp;gt.Element=rw;gt.ForwardRef=Vp;gt.Fragment=Bp;gt.Lazy=Xp;gt.Memo=qp;gt.Portal=nw;gt.Profiler=Wp;gt.StrictMode=Up;gt.Suspense=Gp;gt.SuspenseList=Kp;gt.isAsyncMode=function(){return!1};gt.isConcurrentMode=function(){return!1};gt.isContextConsumer=function(e){return Zn(e)===Hp};gt.isContextProvider=function(e){return Zn(e)===zp};gt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===rw};gt.isForwardRef=function(e){return Zn(e)===Vp};gt.isFragment=function(e){return Zn(e)===Bp};gt.isLazy=function(e){return Zn(e)===Xp};gt.isMemo=function(e){return Zn(e)===qp};gt.isPortal=function(e){return Zn(e)===nw};gt.isProfiler=function(e){return Zn(e)===Wp};gt.isStrictMode=function(e){return Zn(e)===Up};gt.isSuspense=function(e){return Zn(e)===Gp};gt.isSuspenseList=function(e){return Zn(e)===Kp};gt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Bp||e===Wp||e===Up||e===Gp||e===Kp||e===nB||typeof e=="object"&&e!==null&&(e.$$typeof===Xp||e.$$typeof===qp||e.$$typeof===zp||e.$$typeof===Hp||e.$$typeof===Vp||e.$$typeof===MP||e.getModuleId!==void 0)};gt.typeOf=Zn;RP.exports=gt;var aB=RP.exports,iB=wi,sB=bi,oB="[object Number]";function lB(e){return typeof e=="number"||sB(e)&&iB(e)==oB}var $P=lB;const cB=_t($P);var uB=$P;function fB(e){return uB(e)&&e!=+e}var dB=fB;const Qf=_t(dB);var pa=function(t){return t===0?0:t>0?1:-1},Rs=function(t){return eo(t)&&t.indexOf("%")===t.length-1},Oe=function(t){return cB(t)&&!Qf(t)},hB=function(t){return tt(t)},hr=function(t){return Oe(t)||eo(t)},pB=0,Zf=function(t){var r=++pB;return"".concat(t||"").concat(r)},to=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Oe(t)&&!eo(t))return n;var i;if(Rs(t)){var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return Qf(i)&&(i=n),a&&i>r&&(i=r),i},Bi=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},mB=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},da=function(t,r){return Oe(t)&&Oe(r)?function(n){return t+n*(r-t)}:function(){return r}};function Z0(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Gn(n,t))===r})}var vB=function(t,r){return Oe(t)&&Oe(r)?t-r:eo(t)&&eo(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function fl(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function cy(e){"@babel/helpers - typeof";return cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cy(e)}var gB=["viewBox","children"],yB=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],F2=["points","pathLength"],pv={svg:gB,polygon:F2,polyline:F2},aw=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],eh=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(R.isValidElement(t)&&(n=t.props),!sc(n))return null;var a={};return Object.keys(n).forEach(function(i){aw.includes(i)&&(a[i]=r||function(s){return n[i](n,s)})}),a},xB=function(t,r,n){return function(a){return t(r,n,a),null}},th=function(t,r,n){if(!sc(t)||cy(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var s=t[i];aw.includes(i)&&typeof s=="function"&&(a||(a={}),a[i]=xB(s,r,n))}),a},wB=["children"],bB=["children"];function I2(e,t){if(e==null)return{};var r=_B(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _B(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function uy(e){"@babel/helpers - typeof";return uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uy(e)}var D2={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},ri=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},R2=null,mv=null,iw=function e(t){if(t===R2&&Array.isArray(mv))return mv;var r=[];return R.Children.forEach(t,function(n){tt(n)||(aB.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),mv=r,R2=t,r};function Kn(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return ri(a)}):n=[ri(t)],iw(e).forEach(function(a){var i=Gn(a,"type.displayName")||Gn(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function yn(e,t){var r=Kn(e,t);return r&&r[0]}var M2=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Oe(n)||n<=0||!Oe(a)||a<=0)},SB=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],kB=function(t){return t&&t.type&&eo(t.type)&&SB.indexOf(t.type)>=0},EB=function(t){return t&&uy(t)==="object"&&"clipDot"in t},TB=function(t,r,n,a){var i,s=(i=pv==null?void 0:pv[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Je(t)&&(a&&s.includes(r)||yB.includes(r))||n&&aw.includes(r)},nt=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(R.isValidElement(t)&&(a=t.props),!sc(a))return null;var i={};return Object.keys(a).forEach(function(s){var o;TB((o=a)===null||o===void 0?void 0:o[s],s,r,n)&&(i[s]=a[s])}),i},fy=function e(t,r){if(t===r)return!0;var n=R.Children.count(t);if(n!==R.Children.count(r))return!1;if(n===0)return!0;if(n===1)return $2(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],s=r[a];if(Array.isArray(i)||Array.isArray(s)){if(!e(i,s))return!1}else if(!$2(i,s))return!1}return!0},$2=function(t,r){if(tt(t)&&tt(r))return!0;if(!tt(t)&&!tt(r)){var n=t.props||{},a=n.children,i=I2(n,wB),s=r.props||{},o=s.children,l=I2(s,bB);return a&&o?fl(i,l)&&fy(a,o):!a&&!o?fl(i,l):!1}return!1},L2=function(t,r){var n=[],a={};return iw(t).forEach(function(i,s){if(kB(i))n.push(i);else if(i){var o=ri(i.type),l=r[o]||{},c=l.handler,u=l.once;if(c&&(!u||!a[o])){var f=c(i,o,s);n.push(f),a[o]=!0}}}),n},AB=function(t){var r=t&&t.type;return r&&D2[r]?D2[r]:null},OB=function(t,r){return iw(r).indexOf(t)},CB=["children","width","height","viewBox","className","style","title","desc"];function dy(){return dy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dy.apply(this,arguments)}function PB(e,t){if(e==null)return{};var r=jB(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jB(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function hy(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,s=e.style,o=e.title,l=e.desc,c=PB(e,CB),u=a||{width:r,height:n,x:0,y:0},f=ot("recharts-surface",i);return Z.createElement("svg",dy({},nt(c,!0,"svg"),{className:f,width:r,height:n,style:s,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),Z.createElement("title",null,o),Z.createElement("desc",null,l),t)}var NB=["children","className"];function py(){return py=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},py.apply(this,arguments)}function FB(e,t){if(e==null)return{};var r=IB(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function IB(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Yt=Z.forwardRef(function(e,t){var r=e.children,n=e.className,a=FB(e,NB),i=ot("recharts-layer",n);return Z.createElement("g",py({className:i},nt(a,!0),{ref:t}),r)}),ni=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function DB(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var RB=DB,MB=RB;function $B(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:MB(e,t,r)}var LB=$B,BB="\\ud800-\\udfff",UB="\\u0300-\\u036f",WB="\\ufe20-\\ufe2f",zB="\\u20d0-\\u20ff",HB=UB+WB+zB,VB="\\ufe0e\\ufe0f",GB="\\u200d",KB=RegExp("["+GB+BB+HB+VB+"]");function qB(e){return KB.test(e)}var LP=qB;function XB(e){return e.split("")}var YB=XB,BP="\\ud800-\\udfff",JB="\\u0300-\\u036f",QB="\\ufe20-\\ufe2f",ZB="\\u20d0-\\u20ff",e7=JB+QB+ZB,t7="\\ufe0e\\ufe0f",r7="["+BP+"]",my="["+e7+"]",vy="\\ud83c[\\udffb-\\udfff]",n7="(?:"+my+"|"+vy+")",UP="[^"+BP+"]",WP="(?:\\ud83c[\\udde6-\\uddff]){2}",zP="[\\ud800-\\udbff][\\udc00-\\udfff]",a7="\\u200d",HP=n7+"?",VP="["+t7+"]?",i7="(?:"+a7+"(?:"+[UP,WP,zP].join("|")+")"+VP+HP+")*",s7=VP+HP+i7,o7="(?:"+[UP+my+"?",my,WP,zP,r7].join("|")+")",l7=RegExp(vy+"(?="+vy+")|"+o7+s7,"g");function c7(e){return e.match(l7)||[]}var u7=c7,f7=YB,d7=LP,h7=u7;function p7(e){return d7(e)?h7(e):f7(e)}var m7=p7,v7=LB,g7=LP,y7=m7,x7=FP;function w7(e){return function(t){t=x7(t);var r=g7(t)?y7(t):void 0,n=r?r[0]:t.charAt(0),a=r?v7(r,1).join(""):t.slice(1);return n[e]()+a}}var b7=w7,_7=b7,S7=_7("toUpperCase"),k7=S7;const Yp=_t(k7);function kt(e){return function(){return e}}const GP=Math.cos,rh=Math.sin,_a=Math.sqrt,nh=Math.PI,Jp=2*nh,gy=Math.PI,yy=2*gy,Os=1e-6,E7=yy-Os;function KP(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function T7(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return KP;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class A7{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?KP:T7(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,l=n-t,c=a-r,u=s-t,f=o-r,d=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(d>Os)if(!(Math.abs(f*l-c*u)>Os)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-s,m=a-o,p=l*l+c*c,g=h*h+m*m,x=Math.sqrt(p),w=Math.sqrt(d),y=i*Math.tan((gy-Math.acos((p+d-g)/(2*x*w)))/2),k=y/w,b=y/x;Math.abs(k-1)>Os&&this._append`L${t+k*u},${r+k*f}`,this._append`A${i},${i},0,0,${+(f*h>u*m)},${this._x1=t+b*l},${this._y1=r+b*c}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),l=n*Math.sin(a),c=t+o,u=r+l,f=1^s,d=s?a-i:i-a;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Os||Math.abs(this._y1-u)>Os)&&this._append`L${c},${u}`,n&&(d<0&&(d=d%yy+yy),d>E7?this._append`A${n},${n},0,1,${f},${t-o},${r-l}A${n},${n},0,1,${f},${this._x1=c},${this._y1=u}`:d>Os&&this._append`A${n},${n},0,${+(d>=gy)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function sw(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new A7(t)}function ow(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function qP(e){this._context=e}qP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Qp(e){return new qP(e)}function XP(e){return e[0]}function YP(e){return e[1]}function JP(e,t){var r=kt(!0),n=null,a=Qp,i=null,s=sw(o);e=typeof e=="function"?e:e===void 0?XP:kt(e),t=typeof t=="function"?t:t===void 0?YP:kt(t);function o(l){var c,u=(l=ow(l)).length,f,d=!1,h;for(n==null&&(i=a(h=s())),c=0;c<=u;++c)!(c<u&&r(f=l[c],c,l))===d&&((d=!d)?i.lineStart():i.lineEnd()),d&&i.point(+e(f,c,l),+t(f,c,l));if(h)return i=null,h+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:kt(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:kt(+l),o):t},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:kt(!!l),o):r},o.curve=function(l){return arguments.length?(a=l,n!=null&&(i=a(n)),o):a},o.context=function(l){return arguments.length?(l==null?n=i=null:i=a(n=l),o):n},o}function Bd(e,t,r){var n=null,a=kt(!0),i=null,s=Qp,o=null,l=sw(c);e=typeof e=="function"?e:e===void 0?XP:kt(+e),t=typeof t=="function"?t:kt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?YP:kt(+r);function c(f){var d,h,m,p=(f=ow(f)).length,g,x=!1,w,y=new Array(p),k=new Array(p);for(i==null&&(o=s(w=l())),d=0;d<=p;++d){if(!(d<p&&a(g=f[d],d,f))===x)if(x=!x)h=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),m=d-1;m>=h;--m)o.point(y[m],k[m]);o.lineEnd(),o.areaEnd()}x&&(y[d]=+e(g,d,f),k[d]=+t(g,d,f),o.point(n?+n(g,d,f):y[d],r?+r(g,d,f):k[d]))}if(w)return o=null,w+""||null}function u(){return JP().defined(a).curve(s).context(i)}return c.x=function(f){return arguments.length?(e=typeof f=="function"?f:kt(+f),n=null,c):e},c.x0=function(f){return arguments.length?(e=typeof f=="function"?f:kt(+f),c):e},c.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:kt(+f),c):n},c.y=function(f){return arguments.length?(t=typeof f=="function"?f:kt(+f),r=null,c):t},c.y0=function(f){return arguments.length?(t=typeof f=="function"?f:kt(+f),c):t},c.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:kt(+f),c):r},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(r)},c.lineX1=function(){return u().x(n).y(t)},c.defined=function(f){return arguments.length?(a=typeof f=="function"?f:kt(!!f),c):a},c.curve=function(f){return arguments.length?(s=f,i!=null&&(o=s(i)),c):s},c.context=function(f){return arguments.length?(f==null?i=o=null:o=s(i=f),c):i},c}class QP{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function O7(e){return new QP(e,!0)}function C7(e){return new QP(e,!1)}const lw={draw(e,t){const r=_a(t/nh);e.moveTo(r,0),e.arc(0,0,r,0,Jp)}},P7={draw(e,t){const r=_a(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},ZP=_a(1/3),j7=ZP*2,N7={draw(e,t){const r=_a(t/j7),n=r*ZP;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},F7={draw(e,t){const r=_a(t),n=-r/2;e.rect(n,n,r,r)}},I7=.8908130915292852,e4=rh(nh/10)/rh(7*nh/10),D7=rh(Jp/10)*e4,R7=-GP(Jp/10)*e4,M7={draw(e,t){const r=_a(t*I7),n=D7*r,a=R7*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=Jp*i/5,o=GP(s),l=rh(s);e.lineTo(l*r,-o*r),e.lineTo(o*n-l*a,l*n+o*a)}e.closePath()}},vv=_a(3),$7={draw(e,t){const r=-_a(t/(vv*3));e.moveTo(0,r*2),e.lineTo(-vv*r,-r),e.lineTo(vv*r,-r),e.closePath()}},Nn=-.5,Fn=_a(3)/2,xy=1/_a(12),L7=(xy/2+1)*3,B7={draw(e,t){const r=_a(t/L7),n=r/2,a=r*xy,i=n,s=r*xy+r,o=-i,l=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,l),e.lineTo(Nn*n-Fn*a,Fn*n+Nn*a),e.lineTo(Nn*i-Fn*s,Fn*i+Nn*s),e.lineTo(Nn*o-Fn*l,Fn*o+Nn*l),e.lineTo(Nn*n+Fn*a,Nn*a-Fn*n),e.lineTo(Nn*i+Fn*s,Nn*s-Fn*i),e.lineTo(Nn*o+Fn*l,Nn*l-Fn*o),e.closePath()}};function U7(e,t){let r=null,n=sw(a);e=typeof e=="function"?e:kt(e||lw),t=typeof t=="function"?t:kt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:kt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:kt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function ah(){}function ih(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function t4(e){this._context=e}t4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ih(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ih(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function W7(e){return new t4(e)}function r4(e){this._context=e}r4.prototype={areaStart:ah,areaEnd:ah,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ih(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function z7(e){return new r4(e)}function n4(e){this._context=e}n4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:ih(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function H7(e){return new n4(e)}function a4(e){this._context=e}a4.prototype={areaStart:ah,areaEnd:ah,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function V7(e){return new a4(e)}function B2(e){return e<0?-1:1}function U2(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(B2(i)+B2(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function W2(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function gv(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function sh(e){this._context=e}sh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:gv(this,this._t0,W2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,gv(this,W2(this,r=U2(this,e,t)),r);break;default:gv(this,this._t0,r=U2(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function i4(e){this._context=new s4(e)}(i4.prototype=Object.create(sh.prototype)).point=function(e,t){sh.prototype.point.call(this,t,e)};function s4(e){this._context=e}s4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function G7(e){return new sh(e)}function K7(e){return new i4(e)}function o4(e){this._context=e}o4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=z2(e),a=z2(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function z2(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function q7(e){return new o4(e)}function Zp(e,t){this._context=e,this._t=t}Zp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function X7(e){return new Zp(e,.5)}function Y7(e){return new Zp(e,0)}function J7(e){return new Zp(e,1)}function Tl(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function wy(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Q7(e,t){return e[t]}function Z7(e){const t=[];return t.key=e,t}function eU(){var e=kt([]),t=wy,r=Tl,n=Q7;function a(i){var s=Array.from(e.apply(this,arguments),Z7),o,l=s.length,c=-1,u;for(const f of i)for(o=0,++c;o<l;++o)(s[o][c]=[0,+n(f,s[o].key,c,i)]).data=f;for(o=0,u=ow(t(s));o<l;++o)s[u[o]].index=o;return r(s,u),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:kt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:kt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?wy:typeof i=="function"?i:kt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Tl,a):r},a}function tU(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}Tl(e,t)}}function rU(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Tl(e,t)}}function nU(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,l=0,c=0;o<s;++o){for(var u=e[t[o]],f=u[n][1]||0,d=u[n-1][1]||0,h=(f-d)/2,m=0;m<o;++m){var p=e[t[m]],g=p[n][1]||0,x=p[n-1][1]||0;h+=g-x}l+=f,c+=h*f}a[n-1][1]+=a[n-1][0]=r,l&&(r-=c/l)}a[n-1][1]+=a[n-1][0]=r,Tl(e,t)}}function qu(e){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qu(e)}var aU=["type","size","sizeType"];function by(){return by=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},by.apply(this,arguments)}function H2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function V2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H2(Object(r),!0).forEach(function(n){iU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iU(e,t,r){return t=sU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sU(e){var t=oU(e,"string");return qu(t)=="symbol"?t:t+""}function oU(e,t){if(qu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(qu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lU(e,t){if(e==null)return{};var r=cU(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cU(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var l4={symbolCircle:lw,symbolCross:P7,symbolDiamond:N7,symbolSquare:F7,symbolStar:M7,symbolTriangle:$7,symbolWye:B7},uU=Math.PI/180,fU=function(t){var r="symbol".concat(Yp(t));return l4[r]||lw},dU=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*uU;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},hU=function(t,r){l4["symbol".concat(Yp(t))]=r},cw=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,s=t.sizeType,o=s===void 0?"area":s,l=lU(t,aU),c=V2(V2({},l),{},{type:n,size:i,sizeType:o}),u=function(){var g=fU(n),x=U7().type(g).size(dU(i,o,n));return x()},f=c.className,d=c.cx,h=c.cy,m=nt(c,!0);return d===+d&&h===+h&&i===+i?Z.createElement("path",by({},m,{className:ot("recharts-symbols",f),transform:"translate(".concat(d,", ").concat(h,")"),d:u()})):null};cw.registerSymbol=hU;function Al(e){"@babel/helpers - typeof";return Al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Al(e)}function _y(){return _y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_y.apply(this,arguments)}function G2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G2(Object(r),!0).forEach(function(n){Xu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vU(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u4(n.key),n)}}function gU(e,t,r){return t&&vU(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yU(e,t,r){return t=oh(t),xU(e,c4()?Reflect.construct(t,r||[],oh(e).constructor):t.apply(e,r))}function xU(e,t){if(t&&(Al(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wU(e)}function wU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c4(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(c4=function(){return!!e})()}function oh(e){return oh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oh(e)}function bU(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sy(e,t)}function Sy(e,t){return Sy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Sy(e,t)}function Xu(e,t,r){return t=u4(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u4(e){var t=_U(e,"string");return Al(t)=="symbol"?t:t+""}function _U(e,t){if(Al(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Al(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var In=32,uw=function(e){function t(){return mU(this,t),yU(this,t,arguments)}return bU(t,e),gU(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=In/2,s=In/6,o=In/3,l=n.inactive?a:n.color;if(n.type==="plainline")return Z.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:In,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return Z.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(In,"M").concat(2*o,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return Z.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(In/8,"h").concat(In,"v").concat(In*3/4,"h").concat(-In,"z"),className:"recharts-legend-icon"});if(Z.isValidElement(n.legendIcon)){var c=pU({},n);return delete c.legendIcon,Z.cloneElement(n.legendIcon,c)}return Z.createElement(cw,{fill:l,cx:i,cy:i,size:In,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,s=a.iconSize,o=a.layout,l=a.formatter,c=a.inactiveColor,u={x:0,y:0,width:In,height:In},f={display:o==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(h,m){var p=h.formatter||l,g=ot(Xu(Xu({"recharts-legend-item":!0},"legend-item-".concat(m),!0),"inactive",h.inactive));if(h.type==="none")return null;var x=Je(h.value)?null:h.value;ni(!Je(h.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var w=h.inactive?c:h.color;return Z.createElement("li",_y({className:g,style:f,key:"legend-item-".concat(m)},th(n.props,h,m)),Z.createElement(hy,{width:s,height:s,viewBox:u,style:d},n.renderIcon(h)),Z.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},p?p(x,h,m):x))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,s=n.align;if(!a||!a.length)return null;var o={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return Z.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}])}(R.PureComponent);Xu(uw,"displayName","Legend");Xu(uw,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var SU=Mp;function kU(){this.__data__=new SU,this.size=0}var EU=kU;function TU(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var AU=TU;function OU(e){return this.__data__.get(e)}var CU=OU;function PU(e){return this.__data__.has(e)}var jU=PU,NU=Mp,FU=J1,IU=Q1,DU=200;function RU(e,t){var r=this.__data__;if(r instanceof NU){var n=r.__data__;if(!FU||n.length<DU-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new IU(n)}return r.set(e,t),this.size=r.size,this}var MU=RU,$U=Mp,LU=EU,BU=AU,UU=CU,WU=jU,zU=MU;function uc(e){var t=this.__data__=new $U(e);this.size=t.size}uc.prototype.clear=LU;uc.prototype.delete=BU;uc.prototype.get=UU;uc.prototype.has=WU;uc.prototype.set=zU;var f4=uc,HU="__lodash_hash_undefined__";function VU(e){return this.__data__.set(e,HU),this}var GU=VU;function KU(e){return this.__data__.has(e)}var qU=KU,XU=Q1,YU=GU,JU=qU;function lh(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new XU;++t<r;)this.add(e[t])}lh.prototype.add=lh.prototype.push=YU;lh.prototype.has=JU;var d4=lh;function QU(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var h4=QU;function ZU(e,t){return e.has(t)}var p4=ZU,e9=d4,t9=h4,r9=p4,n9=1,a9=2;function i9(e,t,r,n,a,i){var s=r&n9,o=e.length,l=t.length;if(o!=l&&!(s&&l>o))return!1;var c=i.get(e),u=i.get(t);if(c&&u)return c==t&&u==e;var f=-1,d=!0,h=r&a9?new e9:void 0;for(i.set(e,t),i.set(t,e);++f<o;){var m=e[f],p=t[f];if(n)var g=s?n(p,m,f,t,e,i):n(m,p,f,e,t,i);if(g!==void 0){if(g)continue;d=!1;break}if(h){if(!t9(t,function(x,w){if(!r9(h,w)&&(m===x||a(m,x,r,n,i)))return h.push(w)})){d=!1;break}}else if(!(m===p||a(m,p,r,n,i))){d=!1;break}}return i.delete(e),i.delete(t),d}var m4=i9,s9=La,o9=s9.Uint8Array,l9=o9;function c9(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var u9=c9;function f9(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var fw=f9,K2=Jf,q2=l9,d9=Y1,h9=m4,p9=u9,m9=fw,v9=1,g9=2,y9="[object Boolean]",x9="[object Date]",w9="[object Error]",b9="[object Map]",_9="[object Number]",S9="[object RegExp]",k9="[object Set]",E9="[object String]",T9="[object Symbol]",A9="[object ArrayBuffer]",O9="[object DataView]",X2=K2?K2.prototype:void 0,yv=X2?X2.valueOf:void 0;function C9(e,t,r,n,a,i,s){switch(r){case O9:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case A9:return!(e.byteLength!=t.byteLength||!i(new q2(e),new q2(t)));case y9:case x9:case _9:return d9(+e,+t);case w9:return e.name==t.name&&e.message==t.message;case S9:case E9:return e==t+"";case b9:var o=p9;case k9:var l=n&v9;if(o||(o=m9),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;n|=g9,s.set(e,t);var u=h9(o(e),o(t),n,a,i,s);return s.delete(e),u;case T9:if(yv)return yv.call(e)==yv.call(t)}return!1}var P9=C9;function j9(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var v4=j9,N9=v4,F9=pn;function I9(e,t,r){var n=t(e);return F9(e)?n:N9(n,r(e))}var D9=I9;function R9(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[a++]=s)}return i}var M9=R9;function $9(){return[]}var L9=$9,B9=M9,U9=L9,W9=Object.prototype,z9=W9.propertyIsEnumerable,Y2=Object.getOwnPropertySymbols,H9=Y2?function(e){return e==null?[]:(e=Object(e),B9(Y2(e),function(t){return z9.call(e,t)}))}:U9,V9=H9;function G9(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var K9=G9,q9=wi,X9=bi,Y9="[object Arguments]";function J9(e){return X9(e)&&q9(e)==Y9}var Q9=J9,J2=Q9,Z9=bi,g4=Object.prototype,eW=g4.hasOwnProperty,tW=g4.propertyIsEnumerable,rW=J2(function(){return arguments}())?J2:function(e){return Z9(e)&&eW.call(e,"callee")&&!tW.call(e,"callee")},dw=rW,ch={exports:{}};function nW(){return!1}var aW=nW;ch.exports;(function(e,t){var r=La,n=aW,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,o=s?r.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||n;e.exports=c})(ch,ch.exports);var y4=ch.exports,iW=9007199254740991,sW=/^(?:0|[1-9]\d*)$/;function oW(e,t){var r=typeof e;return t=t??iW,!!t&&(r=="number"||r!="symbol"&&sW.test(e))&&e>-1&&e%1==0&&e<t}var hw=oW,lW=9007199254740991;function cW(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=lW}var pw=cW,uW=wi,fW=pw,dW=bi,hW="[object Arguments]",pW="[object Array]",mW="[object Boolean]",vW="[object Date]",gW="[object Error]",yW="[object Function]",xW="[object Map]",wW="[object Number]",bW="[object Object]",_W="[object RegExp]",SW="[object Set]",kW="[object String]",EW="[object WeakMap]",TW="[object ArrayBuffer]",AW="[object DataView]",OW="[object Float32Array]",CW="[object Float64Array]",PW="[object Int8Array]",jW="[object Int16Array]",NW="[object Int32Array]",FW="[object Uint8Array]",IW="[object Uint8ClampedArray]",DW="[object Uint16Array]",RW="[object Uint32Array]",At={};At[OW]=At[CW]=At[PW]=At[jW]=At[NW]=At[FW]=At[IW]=At[DW]=At[RW]=!0;At[hW]=At[pW]=At[TW]=At[mW]=At[AW]=At[vW]=At[gW]=At[yW]=At[xW]=At[wW]=At[bW]=At[_W]=At[SW]=At[kW]=At[EW]=!1;function MW(e){return dW(e)&&fW(e.length)&&!!At[uW(e)]}var $W=MW;function LW(e){return function(t){return e(t)}}var x4=LW,uh={exports:{}};uh.exports;(function(e,t){var r=AP,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,o=function(){try{var l=a&&a.require&&a.require("util").types;return l||s&&s.binding&&s.binding("util")}catch{}}();e.exports=o})(uh,uh.exports);var BW=uh.exports,UW=$W,WW=x4,Q2=BW,Z2=Q2&&Q2.isTypedArray,zW=Z2?WW(Z2):UW,w4=zW,HW=K9,VW=dw,GW=pn,KW=y4,qW=hw,XW=w4,YW=Object.prototype,JW=YW.hasOwnProperty;function QW(e,t){var r=GW(e),n=!r&&VW(e),a=!r&&!n&&KW(e),i=!r&&!n&&!a&&XW(e),s=r||n||a||i,o=s?HW(e.length,String):[],l=o.length;for(var c in e)(t||JW.call(e,c))&&!(s&&(c=="length"||a&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||qW(c,l)))&&o.push(c);return o}var ZW=QW,ez=Object.prototype;function tz(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||ez;return e===r}var rz=tz;function nz(e,t){return function(r){return e(t(r))}}var b4=nz,az=b4,iz=az(Object.keys,Object),sz=iz,oz=rz,lz=sz,cz=Object.prototype,uz=cz.hasOwnProperty;function fz(e){if(!oz(e))return lz(e);var t=[];for(var r in Object(e))uz.call(e,r)&&r!="constructor"&&t.push(r);return t}var dz=fz,hz=X1,pz=pw;function mz(e){return e!=null&&pz(e.length)&&!hz(e)}var ed=mz,vz=ZW,gz=dz,yz=ed;function xz(e){return yz(e)?vz(e):gz(e)}var em=xz,wz=D9,bz=V9,_z=em;function Sz(e){return wz(e,_z,bz)}var kz=Sz,eS=kz,Ez=1,Tz=Object.prototype,Az=Tz.hasOwnProperty;function Oz(e,t,r,n,a,i){var s=r&Ez,o=eS(e),l=o.length,c=eS(t),u=c.length;if(l!=u&&!s)return!1;for(var f=l;f--;){var d=o[f];if(!(s?d in t:Az.call(t,d)))return!1}var h=i.get(e),m=i.get(t);if(h&&m)return h==t&&m==e;var p=!0;i.set(e,t),i.set(t,e);for(var g=s;++f<l;){d=o[f];var x=e[d],w=t[d];if(n)var y=s?n(w,x,d,t,e,i):n(x,w,d,e,t,i);if(!(y===void 0?x===w||a(x,w,r,n,i):y)){p=!1;break}g||(g=d=="constructor")}if(p&&!g){var k=e.constructor,b=t.constructor;k!=b&&"constructor"in e&&"constructor"in t&&!(typeof k=="function"&&k instanceof k&&typeof b=="function"&&b instanceof b)&&(p=!1)}return i.delete(e),i.delete(t),p}var Cz=Oz,Pz=mo,jz=La,Nz=Pz(jz,"DataView"),Fz=Nz,Iz=mo,Dz=La,Rz=Iz(Dz,"Promise"),Mz=Rz,$z=mo,Lz=La,Bz=$z(Lz,"Set"),_4=Bz,Uz=mo,Wz=La,zz=Uz(Wz,"WeakMap"),Hz=zz,ky=Fz,Ey=J1,Ty=Mz,Ay=_4,Oy=Hz,S4=wi,fc=CP,tS="[object Map]",Vz="[object Object]",rS="[object Promise]",nS="[object Set]",aS="[object WeakMap]",iS="[object DataView]",Gz=fc(ky),Kz=fc(Ey),qz=fc(Ty),Xz=fc(Ay),Yz=fc(Oy),Cs=S4;(ky&&Cs(new ky(new ArrayBuffer(1)))!=iS||Ey&&Cs(new Ey)!=tS||Ty&&Cs(Ty.resolve())!=rS||Ay&&Cs(new Ay)!=nS||Oy&&Cs(new Oy)!=aS)&&(Cs=function(e){var t=S4(e),r=t==Vz?e.constructor:void 0,n=r?fc(r):"";if(n)switch(n){case Gz:return iS;case Kz:return tS;case qz:return rS;case Xz:return nS;case Yz:return aS}return t});var Jz=Cs,xv=f4,Qz=m4,Zz=P9,eH=Cz,sS=Jz,oS=pn,lS=y4,tH=w4,rH=1,cS="[object Arguments]",uS="[object Array]",Ud="[object Object]",nH=Object.prototype,fS=nH.hasOwnProperty;function aH(e,t,r,n,a,i){var s=oS(e),o=oS(t),l=s?uS:sS(e),c=o?uS:sS(t);l=l==cS?Ud:l,c=c==cS?Ud:c;var u=l==Ud,f=c==Ud,d=l==c;if(d&&lS(e)){if(!lS(t))return!1;s=!0,u=!1}if(d&&!u)return i||(i=new xv),s||tH(e)?Qz(e,t,r,n,a,i):Zz(e,t,l,r,n,a,i);if(!(r&rH)){var h=u&&fS.call(e,"__wrapped__"),m=f&&fS.call(t,"__wrapped__");if(h||m){var p=h?e.value():e,g=m?t.value():t;return i||(i=new xv),a(p,g,r,n,i)}}return d?(i||(i=new xv),eH(e,t,r,n,a,i)):!1}var iH=aH,sH=iH,dS=bi;function k4(e,t,r,n,a){return e===t?!0:e==null||t==null||!dS(e)&&!dS(t)?e!==e&&t!==t:sH(e,t,r,n,k4,a)}var mw=k4,oH=f4,lH=mw,cH=1,uH=2;function fH(e,t,r,n){var a=r.length,i=a,s=!n;if(e==null)return!i;for(e=Object(e);a--;){var o=r[a];if(s&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<i;){o=r[a];var l=o[0],c=e[l],u=o[1];if(s&&o[2]){if(c===void 0&&!(l in e))return!1}else{var f=new oH;if(n)var d=n(c,u,l,e,t,f);if(!(d===void 0?lH(u,c,cH|uH,n,f):d))return!1}}return!0}var dH=fH,hH=hs;function pH(e){return e===e&&!hH(e)}var E4=pH,mH=E4,vH=em;function gH(e){for(var t=vH(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,mH(a)]}return t}var yH=gH;function xH(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var T4=xH,wH=dH,bH=yH,_H=T4;function SH(e){var t=bH(e);return t.length==1&&t[0][2]?_H(t[0][0],t[0][1]):function(r){return r===e||wH(r,e,t)}}var kH=SH;function EH(e,t){return e!=null&&t in Object(e)}var TH=EH,AH=IP,OH=dw,CH=pn,PH=hw,jH=pw,NH=Lp;function FH(e,t,r){t=AH(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var s=NH(t[n]);if(!(i=e!=null&&r(e,s)))break;e=e[s]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&jH(a)&&PH(s,a)&&(CH(e)||OH(e)))}var IH=FH,DH=TH,RH=IH;function MH(e,t){return e!=null&&RH(e,t,DH)}var $H=MH,LH=mw,BH=DP,UH=$H,WH=q1,zH=E4,HH=T4,VH=Lp,GH=1,KH=2;function qH(e,t){return WH(e)&&zH(t)?HH(VH(e),t):function(r){var n=BH(r,e);return n===void 0&&n===t?UH(r,e):LH(t,n,GH|KH)}}var XH=qH;function YH(e){return e}var dc=YH;function JH(e){return function(t){return t==null?void 0:t[e]}}var QH=JH,ZH=tw;function eV(e){return function(t){return ZH(t,e)}}var tV=eV,rV=QH,nV=tV,aV=q1,iV=Lp;function sV(e){return aV(e)?rV(iV(e)):nV(e)}var oV=sV,lV=kH,cV=XH,uV=dc,fV=pn,dV=oV;function hV(e){return typeof e=="function"?e:e==null?uV:typeof e=="object"?fV(e)?cV(e[0],e[1]):lV(e):dV(e)}var ps=hV;function pV(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var A4=pV;function mV(e){return e!==e}var vV=mV;function gV(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var yV=gV,xV=A4,wV=vV,bV=yV;function _V(e,t,r){return t===t?bV(e,t,r):xV(e,wV,r)}var SV=_V,kV=SV;function EV(e,t){var r=e==null?0:e.length;return!!r&&kV(e,t,0)>-1}var TV=EV;function AV(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var OV=AV;function CV(){}var PV=CV,wv=_4,jV=PV,NV=fw,FV=1/0,IV=wv&&1/NV(new wv([,-0]))[1]==FV?function(e){return new wv(e)}:jV,DV=IV,RV=d4,MV=TV,$V=OV,LV=p4,BV=DV,UV=fw,WV=200;function zV(e,t,r){var n=-1,a=MV,i=e.length,s=!0,o=[],l=o;if(r)s=!1,a=$V;else if(i>=WV){var c=t?null:BV(e);if(c)return UV(c);s=!1,a=LV,l=new RV}else l=t?[]:o;e:for(;++n<i;){var u=e[n],f=t?t(u):u;if(u=r||u!==0?u:0,s&&f===f){for(var d=l.length;d--;)if(l[d]===f)continue e;t&&l.push(f),o.push(u)}else a(l,f,r)||(l!==o&&l.push(f),o.push(u))}return o}var HV=zV,VV=ps,GV=HV;function KV(e,t){return e&&e.length?GV(e,VV(t)):[]}var qV=KV;const hS=_t(qV);function O4(e,t,r){return t===!0?hS(e,r):Je(t)?hS(e,t):e}function Ol(e){"@babel/helpers - typeof";return Ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ol(e)}var XV=["ref"];function pS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function za(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pS(Object(r),!0).forEach(function(n){tm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P4(n.key),n)}}function JV(e,t,r){return t&&mS(e.prototype,t),r&&mS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function QV(e,t,r){return t=fh(t),ZV(e,C4()?Reflect.construct(t,r||[],fh(e).constructor):t.apply(e,r))}function ZV(e,t){if(t&&(Ol(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eG(e)}function eG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C4(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(C4=function(){return!!e})()}function fh(e){return fh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fh(e)}function tG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cy(e,t)}function Cy(e,t){return Cy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Cy(e,t)}function tm(e,t,r){return t=P4(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P4(e){var t=rG(e,"string");return Ol(t)=="symbol"?t:t+""}function rG(e,t){if(Ol(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ol(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function nG(e,t){if(e==null)return{};var r=aG(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aG(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function iG(e){return e.value}function sG(e,t){if(Z.isValidElement(e))return Z.cloneElement(e,t);if(typeof e=="function")return Z.createElement(e,t);t.ref;var r=nG(t,XV);return Z.createElement(uw,r)}var vS=1,ai=function(e){function t(){var r;YV(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=QV(this,t,[].concat(a)),tm(r,"lastBoundingBox",{width:-1,height:-1}),r}return tG(t,e),JV(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>vS||Math.abs(a.height-this.lastBoundingBox.height)>vS)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?za({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,s=a.align,o=a.verticalAlign,l=a.margin,c=a.chartWidth,u=a.chartHeight,f,d;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&i==="vertical"){var h=this.getBBoxSnapshot();f={left:((c||0)-h.width)/2}}else f=s==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(o==="middle"){var m=this.getBBoxSnapshot();d={top:((u||0)-m.height)/2}}else d=o==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return za(za({},f),d)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,s=a.width,o=a.height,l=a.wrapperStyle,c=a.payloadUniqBy,u=a.payload,f=za(za({position:"absolute",width:s||"auto",height:o||"auto"},this.getDefaultPosition(l)),l);return Z.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(h){n.wrapperNode=h}},sG(i,za(za({},this.props),{},{payload:O4(u,c,iG)})))}}],[{key:"getWithHeight",value:function(n,a){var i=za(za({},this.defaultProps),n.props),s=i.layout;return s==="vertical"&&Oe(n.props.height)?{height:n.props.height}:s==="horizontal"?{width:n.props.width||a}:null}}])}(R.PureComponent);tm(ai,"displayName","Legend");tm(ai,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var gS=Jf,oG=dw,lG=pn,yS=gS?gS.isConcatSpreadable:void 0;function cG(e){return lG(e)||oG(e)||!!(yS&&e&&e[yS])}var uG=cG,fG=v4,dG=uG;function j4(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=dG),a||(a=[]);++i<s;){var o=e[i];t>0&&r(o)?t>1?j4(o,t-1,r,n,a):fG(a,o):n||(a[a.length]=o)}return a}var N4=j4;function hG(e){return function(t,r,n){for(var a=-1,i=Object(t),s=n(t),o=s.length;o--;){var l=s[e?o:++a];if(r(i[l],l,i)===!1)break}return t}}var pG=hG,mG=pG,vG=mG(),gG=vG,yG=gG,xG=em;function wG(e,t){return e&&yG(e,t,xG)}var F4=wG,bG=ed;function _G(e,t){return function(r,n){if(r==null)return r;if(!bG(r))return e(r,n);for(var a=r.length,i=t?a:-1,s=Object(r);(t?i--:++i<a)&&n(s[i],i,s)!==!1;);return r}}var SG=_G,kG=F4,EG=SG,TG=EG(kG),vw=TG,AG=vw,OG=ed;function CG(e,t){var r=-1,n=OG(e)?Array(e.length):[];return AG(e,function(a,i,s){n[++r]=t(a,i,s)}),n}var I4=CG;function PG(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var jG=PG,xS=ic;function NG(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=xS(e),s=t!==void 0,o=t===null,l=t===t,c=xS(t);if(!o&&!c&&!i&&e>t||i&&s&&l&&!o&&!c||n&&s&&l||!r&&l||!a)return 1;if(!n&&!i&&!c&&e<t||c&&r&&a&&!n&&!i||o&&r&&a||!s&&a||!l)return-1}return 0}var FG=NG,IG=FG;function DG(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,s=a.length,o=r.length;++n<s;){var l=IG(a[n],i[n]);if(l){if(n>=o)return l;var c=r[n];return l*(c=="desc"?-1:1)}}return e.index-t.index}var RG=DG,bv=ew,MG=tw,$G=ps,LG=I4,BG=jG,UG=x4,WG=RG,zG=dc,HG=pn;function VG(e,t,r){t.length?t=bv(t,function(i){return HG(i)?function(s){return MG(s,i.length===1?i[0]:i)}:i}):t=[zG];var n=-1;t=bv(t,UG($G));var a=LG(e,function(i,s,o){var l=bv(t,function(c){return c(i)});return{criteria:l,index:++n,value:i}});return BG(a,function(i,s){return WG(i,s,r)})}var GG=VG;function KG(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var qG=KG,XG=qG,wS=Math.max;function YG(e,t,r){return t=wS(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=wS(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(s),XG(e,this,o)}}var JG=YG;function QG(e){return function(){return e}}var ZG=QG,eK=mo,tK=function(){try{var e=eK(Object,"defineProperty");return e({},"",{}),e}catch{}}(),D4=tK,rK=ZG,bS=D4,nK=dc,aK=bS?function(e,t){return bS(e,"toString",{configurable:!0,enumerable:!1,value:rK(t),writable:!0})}:nK,iK=aK,sK=800,oK=16,lK=Date.now;function cK(e){var t=0,r=0;return function(){var n=lK(),a=oK-(n-r);if(r=n,a>0){if(++t>=sK)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var uK=cK,fK=iK,dK=uK,hK=dK(fK),pK=hK,mK=dc,vK=JG,gK=pK;function yK(e,t){return gK(vK(e,t,mK),e+"")}var xK=yK,wK=Y1,bK=ed,_K=hw,SK=hs;function kK(e,t,r){if(!SK(r))return!1;var n=typeof t;return(n=="number"?bK(r)&&_K(t,r.length):n=="string"&&t in r)?wK(r[t],e):!1}var rm=kK,EK=N4,TK=GG,AK=xK,_S=rm,OK=AK(function(e,t){if(e==null)return[];var r=t.length;return r>1&&_S(e,t[0],t[1])?t=[]:r>2&&_S(t[0],t[1],t[2])&&(t=[t[0]]),TK(e,EK(t,1),[])}),CK=OK;const gw=_t(CK);function Yu(e){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(e)}function Py(){return Py=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Py.apply(this,arguments)}function PK(e,t){return IK(e)||FK(e,t)||NK(e,t)||jK()}function jK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NK(e,t){if(e){if(typeof e=="string")return SS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SS(e,t)}}function SS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function IK(e){if(Array.isArray(e))return e}function kS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _v(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kS(Object(r),!0).forEach(function(n){DK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DK(e,t,r){return t=RK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RK(e){var t=MK(e,"string");return Yu(t)=="symbol"?t:t+""}function MK(e,t){if(Yu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $K(e){return Array.isArray(e)&&hr(e[0])&&hr(e[1])?e.join(" ~ "):e}var LK=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,s=t.itemStyle,o=s===void 0?{}:s,l=t.labelStyle,c=l===void 0?{}:l,u=t.payload,f=t.formatter,d=t.itemSorter,h=t.wrapperClassName,m=t.labelClassName,p=t.label,g=t.labelFormatter,x=t.accessibilityLayer,w=x===void 0?!1:x,y=function(){if(u&&u.length){var A={padding:0,margin:0},M=(d?gw(u,d):u).map(function(V,z){if(V.type==="none")return null;var Y=_v({display:"block",paddingTop:4,paddingBottom:4,color:V.color||"#000"},o),J=V.formatter||f||$K,Q=V.value,j=V.name,X=Q,ee=j;if(J&&X!=null&&ee!=null){var P=J(Q,j,V,z,u);if(Array.isArray(P)){var G=PK(P,2);X=G[0],ee=G[1]}else X=P}return Z.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(z),style:Y},hr(ee)?Z.createElement("span",{className:"recharts-tooltip-item-name"},ee):null,hr(ee)?Z.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Z.createElement("span",{className:"recharts-tooltip-item-value"},X),Z.createElement("span",{className:"recharts-tooltip-item-unit"},V.unit||""))});return Z.createElement("ul",{className:"recharts-tooltip-item-list",style:A},M)}return null},k=_v({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),b=_v({margin:0},c),_=!tt(p),S=_?p:"",E=ot("recharts-default-tooltip",h),T=ot("recharts-tooltip-label",m);_&&g&&u!==void 0&&u!==null&&(S=g(p,u));var F=w?{role:"status","aria-live":"assertive"}:{};return Z.createElement("div",Py({className:E,style:k},F),Z.createElement("p",{className:T,style:b},Z.isValidElement(S)?S:"".concat(S)),y())};function Ju(e){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}function Wd(e,t,r){return t=BK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BK(e){var t=UK(e,"string");return Ju(t)=="symbol"?t:t+""}function UK(e,t){if(Ju(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ju(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mc="recharts-tooltip-wrapper",WK={visibility:"hidden"};function zK(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return ot(Mc,Wd(Wd(Wd(Wd({},"".concat(Mc,"-right"),Oe(r)&&t&&Oe(t.x)&&r>=t.x),"".concat(Mc,"-left"),Oe(r)&&t&&Oe(t.x)&&r<t.x),"".concat(Mc,"-bottom"),Oe(n)&&t&&Oe(t.y)&&n>=t.y),"".concat(Mc,"-top"),Oe(n)&&t&&Oe(t.y)&&n<t.y))}function ES(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,s=e.reverseDirection,o=e.tooltipDimension,l=e.viewBox,c=e.viewBoxDimension;if(i&&Oe(i[n]))return i[n];var u=r[n]-o-a,f=r[n]+a;if(t[n])return s[n]?u:f;if(s[n]){var d=u,h=l[n];return d<h?Math.max(f,l[n]):Math.max(u,l[n])}var m=f+o,p=l[n]+c;return m>p?Math.max(u,l[n]):Math.max(f,l[n])}function HK(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function VK(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,s=e.tooltipBox,o=e.useTranslate3d,l=e.viewBox,c,u,f;return s.height>0&&s.width>0&&r?(u=ES({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:l,viewBoxDimension:l.width}),f=ES({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:l,viewBoxDimension:l.height}),c=HK({translateX:u,translateY:f,useTranslate3d:o})):c=WK,{cssProperties:c,cssClasses:zK({translateX:u,translateY:f,coordinate:r})}}function Cl(e){"@babel/helpers - typeof";return Cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cl(e)}function TS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function AS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TS(Object(r),!0).forEach(function(n){Ny(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KK(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M4(n.key),n)}}function qK(e,t,r){return t&&KK(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function XK(e,t,r){return t=dh(t),YK(e,R4()?Reflect.construct(t,r||[],dh(e).constructor):t.apply(e,r))}function YK(e,t){if(t&&(Cl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JK(e)}function JK(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R4(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(R4=function(){return!!e})()}function dh(e){return dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dh(e)}function QK(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jy(e,t)}function jy(e,t){return jy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jy(e,t)}function Ny(e,t,r){return t=M4(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M4(e){var t=ZK(e,"string");return Cl(t)=="symbol"?t:t+""}function ZK(e,t){if(Cl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var OS=1,eq=function(e){function t(){var r;GK(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=XK(this,t,[].concat(a)),Ny(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Ny(r,"handleKeyDown",function(s){if(s.key==="Escape"){var o,l,c,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(o=(l=r.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&o!==void 0?o:0,y:(c=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0}})}}),r}return QK(t,e),qK(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>OS||Math.abs(n.height-this.state.lastBoundingBox.height)>OS)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,o=a.animationDuration,l=a.animationEasing,c=a.children,u=a.coordinate,f=a.hasPayload,d=a.isAnimationActive,h=a.offset,m=a.position,p=a.reverseDirection,g=a.useTranslate3d,x=a.viewBox,w=a.wrapperStyle,y=VK({allowEscapeViewBox:s,coordinate:u,offsetTopLeft:h,position:m,reverseDirection:p,tooltipBox:this.state.lastBoundingBox,useTranslate3d:g,viewBox:x}),k=y.cssClasses,b=y.cssProperties,_=AS(AS({transition:d&&i?"transform ".concat(o,"ms ").concat(l):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},w);return Z.createElement("div",{tabIndex:-1,className:k,style:_,ref:function(E){n.wrapperNode=E}},c)}}])}(R.PureComponent),tq=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},hc={isSsr:tq()};function Pl(e){"@babel/helpers - typeof";return Pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pl(e)}function CS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function PS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CS(Object(r),!0).forEach(function(n){yw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L4(n.key),n)}}function aq(e,t,r){return t&&nq(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iq(e,t,r){return t=hh(t),sq(e,$4()?Reflect.construct(t,r||[],hh(e).constructor):t.apply(e,r))}function sq(e,t){if(t&&(Pl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oq(e)}function oq(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $4(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($4=function(){return!!e})()}function hh(e){return hh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hh(e)}function lq(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fy(e,t)}function Fy(e,t){return Fy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Fy(e,t)}function yw(e,t,r){return t=L4(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L4(e){var t=cq(e,"string");return Pl(t)=="symbol"?t:t+""}function cq(e,t){if(Pl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function uq(e){return e.dataKey}function fq(e,t){return Z.isValidElement(e)?Z.cloneElement(e,t):typeof e=="function"?Z.createElement(e,t):Z.createElement(LK,t)}var xn=function(e){function t(){return rq(this,t),iq(this,t,arguments)}return lq(t,e),aq(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,o=a.animationDuration,l=a.animationEasing,c=a.content,u=a.coordinate,f=a.filterNull,d=a.isAnimationActive,h=a.offset,m=a.payload,p=a.payloadUniqBy,g=a.position,x=a.reverseDirection,w=a.useTranslate3d,y=a.viewBox,k=a.wrapperStyle,b=m??[];f&&b.length&&(b=O4(m.filter(function(S){return S.value!=null&&(S.hide!==!0||n.props.includeHidden)}),p,uq));var _=b.length>0;return Z.createElement(eq,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:i,coordinate:u,hasPayload:_,offset:h,position:g,reverseDirection:x,useTranslate3d:w,viewBox:y,wrapperStyle:k},fq(c,PS(PS({},this.props),{},{payload:b})))}}])}(R.PureComponent);yw(xn,"displayName","Tooltip");yw(xn,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!hc.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var dq=La,hq=function(){return dq.Date.now()},pq=hq,mq=/\s/;function vq(e){for(var t=e.length;t--&&mq.test(e.charAt(t)););return t}var gq=vq,yq=gq,xq=/^\s+/;function wq(e){return e&&e.slice(0,yq(e)+1).replace(xq,"")}var bq=wq,_q=bq,jS=hs,Sq=ic,NS=NaN,kq=/^[-+]0x[0-9a-f]+$/i,Eq=/^0b[01]+$/i,Tq=/^0o[0-7]+$/i,Aq=parseInt;function Oq(e){if(typeof e=="number")return e;if(Sq(e))return NS;if(jS(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=jS(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=_q(e);var r=Eq.test(e);return r||Tq.test(e)?Aq(e.slice(2),r?2:8):kq.test(e)?NS:+e}var B4=Oq,Cq=hs,Sv=pq,FS=B4,Pq="Expected a function",jq=Math.max,Nq=Math.min;function Fq(e,t,r){var n,a,i,s,o,l,c=0,u=!1,f=!1,d=!0;if(typeof e!="function")throw new TypeError(Pq);t=FS(t)||0,Cq(r)&&(u=!!r.leading,f="maxWait"in r,i=f?jq(FS(r.maxWait)||0,t):i,d="trailing"in r?!!r.trailing:d);function h(_){var S=n,E=a;return n=a=void 0,c=_,s=e.apply(E,S),s}function m(_){return c=_,o=setTimeout(x,t),u?h(_):s}function p(_){var S=_-l,E=_-c,T=t-S;return f?Nq(T,i-E):T}function g(_){var S=_-l,E=_-c;return l===void 0||S>=t||S<0||f&&E>=i}function x(){var _=Sv();if(g(_))return w(_);o=setTimeout(x,p(_))}function w(_){return o=void 0,d&&n?h(_):(n=a=void 0,s)}function y(){o!==void 0&&clearTimeout(o),c=0,n=l=a=o=void 0}function k(){return o===void 0?s:w(Sv())}function b(){var _=Sv(),S=g(_);if(n=arguments,a=this,l=_,S){if(o===void 0)return m(l);if(f)return clearTimeout(o),o=setTimeout(x,t),h(l)}return o===void 0&&(o=setTimeout(x,t)),s}return b.cancel=y,b.flush=k,b}var Iq=Fq,Dq=Iq,Rq=hs,Mq="Expected a function";function $q(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(Mq);return Rq(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),Dq(e,t,{leading:n,maxWait:t,trailing:a})}var Lq=$q;const U4=_t(Lq);function Qu(e){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qu(e)}function IS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IS(Object(r),!0).forEach(function(n){Bq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bq(e,t,r){return t=Uq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uq(e){var t=Wq(e,"string");return Qu(t)=="symbol"?t:t+""}function Wq(e,t){if(Qu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zq(e,t){return Kq(e)||Gq(e,t)||Vq(e,t)||Hq()}function Hq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vq(e,t){if(e){if(typeof e=="string")return DS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DS(e,t)}}function DS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Gq(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function Kq(e){if(Array.isArray(e))return e}var ph=R.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,s=i===void 0?"100%":i,o=e.height,l=o===void 0?"100%":o,c=e.minWidth,u=c===void 0?0:c,f=e.minHeight,d=e.maxHeight,h=e.children,m=e.debounce,p=m===void 0?0:m,g=e.id,x=e.className,w=e.onResize,y=e.style,k=y===void 0?{}:y,b=R.useRef(null),_=R.useRef();_.current=w,R.useImperativeHandle(t,function(){return Object.defineProperty(b.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),b.current},configurable:!0})});var S=R.useState({containerWidth:a.width,containerHeight:a.height}),E=zq(S,2),T=E[0],F=E[1],C=R.useCallback(function(M,V){F(function(z){var Y=Math.round(M),J=Math.round(V);return z.containerWidth===Y&&z.containerHeight===J?z:{containerWidth:Y,containerHeight:J}})},[]);R.useEffect(function(){var M=function(j){var X,ee=j[0].contentRect,P=ee.width,G=ee.height;C(P,G),(X=_.current)===null||X===void 0||X.call(_,P,G)};p>0&&(M=U4(M,p,{trailing:!0,leading:!1}));var V=new ResizeObserver(M),z=b.current.getBoundingClientRect(),Y=z.width,J=z.height;return C(Y,J),V.observe(b.current),function(){V.disconnect()}},[C,p]);var A=R.useMemo(function(){var M=T.containerWidth,V=T.containerHeight;if(M<0||V<0)return null;ni(Rs(s)||Rs(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,l),ni(!r||r>0,"The aspect(%s) must be greater than zero.",r);var z=Rs(s)?M:s,Y=Rs(l)?V:l;r&&r>0&&(z?Y=z/r:Y&&(z=Y*r),d&&Y>d&&(Y=d)),ni(z>0||Y>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,z,Y,s,l,u,f,r);var J=!Array.isArray(h)&&ri(h.type).endsWith("Chart");return Z.Children.map(h,function(Q){return Z.isValidElement(Q)?R.cloneElement(Q,zd({width:z,height:Y},J?{style:zd({height:"100%",width:"100%",maxHeight:Y,maxWidth:z},Q.props.style)}:{})):Q})},[r,h,l,d,f,u,T,s]);return Z.createElement("div",{id:g?"".concat(g):void 0,className:ot("recharts-responsive-container",x),style:zd(zd({},k),{},{width:s,height:l,minWidth:u,minHeight:f,maxHeight:d}),ref:b},A)}),W4=function(t){return null};W4.displayName="Cell";function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}function RS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Iy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RS(Object(r),!0).forEach(function(n){qq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qq(e,t,r){return t=Xq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xq(e){var t=Yq(e,"string");return Zu(t)=="symbol"?t:t+""}function Yq(e,t){if(Zu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jo={widthCache:{},cacheCount:0},Jq=2e3,Qq={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},MS="recharts_measurement_span";function Zq(e){var t=Iy({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var gu=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||hc.isSsr)return{width:0,height:0};var n=Zq(r),a=JSON.stringify({text:t,copyStyle:n});if(jo.widthCache[a])return jo.widthCache[a];try{var i=document.getElementById(MS);i||(i=document.createElement("span"),i.setAttribute("id",MS),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=Iy(Iy({},Qq),n);Object.assign(i.style,s),i.textContent="".concat(t);var o=i.getBoundingClientRect(),l={width:o.width,height:o.height};return jo.widthCache[a]=l,++jo.cacheCount>Jq&&(jo.cacheCount=0,jo.widthCache={}),l}catch{return{width:0,height:0}}},eX=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function mh(e,t){return aX(e)||nX(e,t)||rX(e,t)||tX()}function tX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rX(e,t){if(e){if(typeof e=="string")return $S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $S(e,t)}}function $S(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function aX(e){if(Array.isArray(e))return e}function iX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oX(n.key),n)}}function sX(e,t,r){return t&&LS(e.prototype,t),r&&LS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oX(e){var t=lX(e,"string");return ef(t)=="symbol"?t:t+""}function lX(e,t){if(ef(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ef(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var BS=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,US=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cX=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,uX=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,z4={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},fX=Object.keys(z4),tl="NaN";function dX(e,t){return e*z4[t]}var Hd=function(){function e(t,r){iX(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!cX.test(r)&&(this.num=NaN,this.unit=""),fX.includes(r)&&(this.num=dX(t,r),this.unit="px")}return sX(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=uX.exec(r))!==null&&n!==void 0?n:[],i=mh(a,3),s=i[1],o=i[2];return new e(parseFloat(s),o??"")}}])}();function H4(e){if(e.includes(tl))return tl;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=BS.exec(t))!==null&&r!==void 0?r:[],a=mh(n,4),i=a[1],s=a[2],o=a[3],l=Hd.parse(i??""),c=Hd.parse(o??""),u=s==="*"?l.multiply(c):l.divide(c);if(u.isNaN())return tl;t=t.replace(BS,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,d=(f=US.exec(t))!==null&&f!==void 0?f:[],h=mh(d,4),m=h[1],p=h[2],g=h[3],x=Hd.parse(m??""),w=Hd.parse(g??""),y=p==="+"?x.add(w):x.subtract(w);if(y.isNaN())return tl;t=t.replace(US,y.toString())}return t}var WS=/\(([^()]*)\)/;function hX(e){for(var t=e;t.includes("(");){var r=WS.exec(t),n=mh(r,2),a=n[1];t=t.replace(WS,H4(a))}return t}function pX(e){var t=e.replace(/\s+/g,"");return t=hX(t),t=H4(t),t}function mX(e){try{return pX(e)}catch{return tl}}function kv(e){var t=mX(e.slice(5,-1));return t===tl?"":t}var vX=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],gX=["dx","dy","angle","className","breakAll"];function Dy(){return Dy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dy.apply(this,arguments)}function zS(e,t){if(e==null)return{};var r=yX(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yX(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function HS(e,t){return _X(e)||bX(e,t)||wX(e,t)||xX()}function xX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wX(e,t){if(e){if(typeof e=="string")return VS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VS(e,t)}}function VS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function bX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function _X(e){if(Array.isArray(e))return e}var V4=/[ \f\n\r\t\v\u2028\u2029]+/,G4=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];tt(r)||(n?i=r.toString().split(""):i=r.toString().split(V4));var s=i.map(function(l){return{word:l,width:gu(l,a).width}}),o=n?0:gu(" ",a).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}},SX=function(t,r,n,a,i){var s=t.maxLines,o=t.children,l=t.style,c=t.breakAll,u=Oe(s),f=o,d=function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return z.reduce(function(Y,J){var Q=J.word,j=J.width,X=Y[Y.length-1];if(X&&(a==null||i||X.width+j+n<Number(a)))X.words.push(Q),X.width+=j+n;else{var ee={words:[Q],width:j};Y.push(ee)}return Y},[])},h=d(r),m=function(z){return z.reduce(function(Y,J){return Y.width>J.width?Y:J})};if(!u)return h;for(var p="…",g=function(z){var Y=f.slice(0,z),J=G4({breakAll:c,style:l,children:Y+p}).wordsWithComputedWidth,Q=d(J),j=Q.length>s||m(Q).width>Number(a);return[j,Q]},x=0,w=f.length-1,y=0,k;x<=w&&y<=f.length-1;){var b=Math.floor((x+w)/2),_=b-1,S=g(_),E=HS(S,2),T=E[0],F=E[1],C=g(b),A=HS(C,1),M=A[0];if(!T&&!M&&(x=b+1),T&&M&&(w=b-1),!T&&M){k=F;break}y++}return k||h},GS=function(t){var r=tt(t)?[]:t.toString().split(V4);return[{words:r}]},kX=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,s=t.breakAll,o=t.maxLines;if((r||n)&&!hc.isSsr){var l,c,u=G4({breakAll:s,children:a,style:i});if(u){var f=u.wordsWithComputedWidth,d=u.spaceWidth;l=f,c=d}else return GS(a);return SX({breakAll:s,children:a,maxLines:o,style:i},l,c,r,n)}return GS(a)},KS="#808080",vh=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.lineHeight,o=s===void 0?"1em":s,l=t.capHeight,c=l===void 0?"0.71em":l,u=t.scaleToFit,f=u===void 0?!1:u,d=t.textAnchor,h=d===void 0?"start":d,m=t.verticalAnchor,p=m===void 0?"end":m,g=t.fill,x=g===void 0?KS:g,w=zS(t,vX),y=R.useMemo(function(){return kX({breakAll:w.breakAll,children:w.children,maxLines:w.maxLines,scaleToFit:f,style:w.style,width:w.width})},[w.breakAll,w.children,w.maxLines,f,w.style,w.width]),k=w.dx,b=w.dy,_=w.angle,S=w.className,E=w.breakAll,T=zS(w,gX);if(!hr(n)||!hr(i))return null;var F=n+(Oe(k)?k:0),C=i+(Oe(b)?b:0),A;switch(p){case"start":A=kv("calc(".concat(c,")"));break;case"middle":A=kv("calc(".concat((y.length-1)/2," * -").concat(o," + (").concat(c," / 2))"));break;default:A=kv("calc(".concat(y.length-1," * -").concat(o,")"));break}var M=[];if(f){var V=y[0].width,z=w.width;M.push("scale(".concat((Oe(z)?z/V:1)/V,")"))}return _&&M.push("rotate(".concat(_,", ").concat(F,", ").concat(C,")")),M.length&&(T.transform=M.join(" ")),Z.createElement("text",Dy({},nt(T,!0),{x:F,y:C,className:ot("recharts-text",S),textAnchor:h,fill:x.includes("url")?KS:x}),y.map(function(Y,J){var Q=Y.words.join(E?"":" ");return Z.createElement("tspan",{x:F,dy:J===0?A:o,key:"".concat(Q,"-").concat(J)},Q)}))};function ts(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function EX(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function xw(e){let t,r,n;e.length!==2?(t=ts,r=(o,l)=>ts(e(o),l),n=(o,l)=>e(o)-l):(t=e===ts||e===EX?e:TX,r=e,n=e);function a(o,l,c=0,u=o.length){if(c<u){if(t(l,l)!==0)return u;do{const f=c+u>>>1;r(o[f],l)<0?c=f+1:u=f}while(c<u)}return c}function i(o,l,c=0,u=o.length){if(c<u){if(t(l,l)!==0)return u;do{const f=c+u>>>1;r(o[f],l)<=0?c=f+1:u=f}while(c<u)}return c}function s(o,l,c=0,u=o.length){const f=a(o,l,c,u-1);return f>c&&n(o[f-1],l)>-n(o[f],l)?f-1:f}return{left:a,center:s,right:i}}function TX(){return 0}function K4(e){return e===null?NaN:+e}function*AX(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const OX=xw(ts),td=OX.right;xw(K4).center;class qS extends Map{constructor(t,r=jX){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(XS(this,t))}has(t){return super.has(XS(this,t))}set(t,r){return super.set(CX(this,t),r)}delete(t){return super.delete(PX(this,t))}}function XS({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function CX({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function PX({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function jX(e){return e!==null&&typeof e=="object"?e.valueOf():e}function NX(e=ts){if(e===ts)return q4;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function q4(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const FX=Math.sqrt(50),IX=Math.sqrt(10),DX=Math.sqrt(2);function gh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=FX?10:i>=IX?5:i>=DX?2:1;let o,l,c;return a<0?(c=Math.pow(10,-a)/s,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,a)*s,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=r&&r<2?gh(e,t,r*2):[o,l,c]}function Ry(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?gh(t,e,r):gh(e,t,r);if(!(i>=a))return[];const o=i-a+1,l=new Array(o);if(n)if(s<0)for(let c=0;c<o;++c)l[c]=(i-c)/-s;else for(let c=0;c<o;++c)l[c]=(i-c)*s;else if(s<0)for(let c=0;c<o;++c)l[c]=(a+c)/-s;else for(let c=0;c<o;++c)l[c]=(a+c)*s;return l}function My(e,t,r){return t=+t,e=+e,r=+r,gh(e,t,r)[2]}function $y(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?My(t,e,r):My(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function YS(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function JS(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function X4(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?q4:NX(a);n>r;){if(n-r>600){const l=n-r+1,c=t-r+1,u=Math.log(l),f=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*f*(l-f)/l)*(c-l/2<0?-1:1),h=Math.max(r,Math.floor(t-c*f/l+d)),m=Math.min(n,Math.floor(t+(l-c)*f/l+d));X4(e,t,h,m,a)}const i=e[t];let s=r,o=n;for($c(e,r,t),a(e[n],i)>0&&$c(e,r,n);s<o;){for($c(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?$c(e,r,o):(++o,$c(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function $c(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function RX(e,t,r){if(e=Float64Array.from(AX(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return JS(e);if(t>=1)return YS(e);var n,a=(n-1)*t,i=Math.floor(a),s=YS(X4(e,i).subarray(0,i+1)),o=JS(e.subarray(i+1));return s+(o-s)*(a-i)}}function MX(e,t,r=K4){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function $X(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function ea(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function _i(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Ly=Symbol("implicit");function ww(){var e=new qS,t=[],r=[],n=Ly;function a(i){let s=e.get(i);if(s===void 0){if(n!==Ly)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new qS;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return ww(t,r).unknown(n)},ea.apply(a,arguments),a}function tf(){var e=ww().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,l=0,c=0,u=.5;delete e.unknown;function f(){var d=t().length,h=a<n,m=h?a:n,p=h?n:a;i=(p-m)/Math.max(1,d-l+c*2),o&&(i=Math.floor(i)),m+=(p-m-i*(d-l))*u,s=i*(1-l),o&&(m=Math.round(m),s=Math.round(s));var g=$X(d).map(function(x){return m+i*x});return r(h?g.reverse():g)}return e.domain=function(d){return arguments.length?(t(d),f()):t()},e.range=function(d){return arguments.length?([n,a]=d,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(d){return[n,a]=d,n=+n,a=+a,o=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(d){return arguments.length?(o=!!d,f()):o},e.padding=function(d){return arguments.length?(l=Math.min(1,c=+d),f()):l},e.paddingInner=function(d){return arguments.length?(l=Math.min(1,d),f()):l},e.paddingOuter=function(d){return arguments.length?(c=+d,f()):c},e.align=function(d){return arguments.length?(u=Math.max(0,Math.min(1,d)),f()):u},e.copy=function(){return tf(t(),[n,a]).round(o).paddingInner(l).paddingOuter(c).align(u)},ea.apply(f(),arguments)}function Y4(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Y4(t())},e}function yu(){return Y4(tf.apply(null,arguments).paddingInner(1))}function bw(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function J4(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function rd(){}var rf=.7,yh=1/rf,dl="\\s*([+-]?\\d+)\\s*",nf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ra="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",LX=/^#([0-9a-f]{3,8})$/,BX=new RegExp(`^rgb\\(${dl},${dl},${dl}\\)$`),UX=new RegExp(`^rgb\\(${Ra},${Ra},${Ra}\\)$`),WX=new RegExp(`^rgba\\(${dl},${dl},${dl},${nf}\\)$`),zX=new RegExp(`^rgba\\(${Ra},${Ra},${Ra},${nf}\\)$`),HX=new RegExp(`^hsl\\(${nf},${Ra},${Ra}\\)$`),VX=new RegExp(`^hsla\\(${nf},${Ra},${Ra},${nf}\\)$`),QS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};bw(rd,af,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ZS,formatHex:ZS,formatHex8:GX,formatHsl:KX,formatRgb:ek,toString:ek});function ZS(){return this.rgb().formatHex()}function GX(){return this.rgb().formatHex8()}function KX(){return Q4(this).formatHsl()}function ek(){return this.rgb().formatRgb()}function af(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=LX.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?tk(t):r===3?new ln(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Vd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Vd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=BX.exec(e))?new ln(t[1],t[2],t[3],1):(t=UX.exec(e))?new ln(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=WX.exec(e))?Vd(t[1],t[2],t[3],t[4]):(t=zX.exec(e))?Vd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=HX.exec(e))?ak(t[1],t[2]/100,t[3]/100,1):(t=VX.exec(e))?ak(t[1],t[2]/100,t[3]/100,t[4]):QS.hasOwnProperty(e)?tk(QS[e]):e==="transparent"?new ln(NaN,NaN,NaN,0):null}function tk(e){return new ln(e>>16&255,e>>8&255,e&255,1)}function Vd(e,t,r,n){return n<=0&&(e=t=r=NaN),new ln(e,t,r,n)}function qX(e){return e instanceof rd||(e=af(e)),e?(e=e.rgb(),new ln(e.r,e.g,e.b,e.opacity)):new ln}function By(e,t,r,n){return arguments.length===1?qX(e):new ln(e,t,r,n??1)}function ln(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}bw(ln,By,J4(rd,{brighter(e){return e=e==null?yh:Math.pow(yh,e),new ln(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?rf:Math.pow(rf,e),new ln(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ln(zs(this.r),zs(this.g),zs(this.b),xh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rk,formatHex:rk,formatHex8:XX,formatRgb:nk,toString:nk}));function rk(){return`#${Ms(this.r)}${Ms(this.g)}${Ms(this.b)}`}function XX(){return`#${Ms(this.r)}${Ms(this.g)}${Ms(this.b)}${Ms((isNaN(this.opacity)?1:this.opacity)*255)}`}function nk(){const e=xh(this.opacity);return`${e===1?"rgb(":"rgba("}${zs(this.r)}, ${zs(this.g)}, ${zs(this.b)}${e===1?")":`, ${e})`}`}function xh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function zs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ms(e){return e=zs(e),(e<16?"0":"")+e.toString(16)}function ak(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ha(e,t,r,n)}function Q4(e){if(e instanceof ha)return new ha(e.h,e.s,e.l,e.opacity);if(e instanceof rd||(e=af(e)),!e)return new ha;if(e instanceof ha)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,l=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=l<.5?i+a:2-i-a,s*=60):o=l>0&&l<1?0:s,new ha(s,o,l,e.opacity)}function YX(e,t,r,n){return arguments.length===1?Q4(e):new ha(e,t,r,n??1)}function ha(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}bw(ha,YX,J4(rd,{brighter(e){return e=e==null?yh:Math.pow(yh,e),new ha(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?rf:Math.pow(rf,e),new ha(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ln(Ev(e>=240?e-240:e+120,a,n),Ev(e,a,n),Ev(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ha(ik(this.h),Gd(this.s),Gd(this.l),xh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=xh(this.opacity);return`${e===1?"hsl(":"hsla("}${ik(this.h)}, ${Gd(this.s)*100}%, ${Gd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ik(e){return e=(e||0)%360,e<0?e+360:e}function Gd(e){return Math.max(0,Math.min(1,e||0))}function Ev(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const _w=e=>()=>e;function JX(e,t){return function(r){return e+r*t}}function QX(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function ZX(e){return(e=+e)==1?Z4:function(t,r){return r-t?QX(t,r,e):_w(isNaN(t)?r:t)}}function Z4(e,t){var r=t-e;return r?JX(e,r):_w(isNaN(e)?t:e)}const sk=function e(t){var r=ZX(t);function n(a,i){var s=r((a=By(a)).r,(i=By(i)).r),o=r(a.g,i.g),l=r(a.b,i.b),c=Z4(a.opacity,i.opacity);return function(u){return a.r=s(u),a.g=o(u),a.b=l(u),a.opacity=c(u),a+""}}return n.gamma=e,n}(1);function eY(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function tY(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function rY(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=pc(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function nY(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function wh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function aY(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=pc(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Uy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Tv=new RegExp(Uy.source,"g");function iY(e){return function(){return e}}function sY(e){return function(t){return e(t)+""}}function oY(e,t){var r=Uy.lastIndex=Tv.lastIndex=0,n,a,i,s=-1,o=[],l=[];for(e=e+"",t=t+"";(n=Uy.exec(e))&&(a=Tv.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,l.push({i:s,x:wh(n,a)})),r=Tv.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?sY(l[0].x):iY(t):(t=l.length,function(c){for(var u=0,f;u<t;++u)o[(f=l[u]).i]=f.x(c);return o.join("")})}function pc(e,t){var r=typeof t,n;return t==null||r==="boolean"?_w(t):(r==="number"?wh:r==="string"?(n=af(t))?(t=n,sk):oY:t instanceof af?sk:t instanceof Date?nY:tY(t)?eY:Array.isArray(t)?rY:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?aY:wh)(e,t)}function Sw(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function lY(e,t){t===void 0&&(t=e,e=pc);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function cY(e){return function(){return e}}function bh(e){return+e}var ok=[0,1];function Qr(e){return e}function Wy(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:cY(isNaN(t)?NaN:.5)}function uY(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function fY(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=Wy(a,n),i=r(s,i)):(n=Wy(n,a),i=r(i,s)),function(o){return i(n(o))}}function dY(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=Wy(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var l=td(e,o,1,n)-1;return i[l](a[l](o))}}function nd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function nm(){var e=ok,t=ok,r=pc,n,a,i,s=Qr,o,l,c;function u(){var d=Math.min(e.length,t.length);return s!==Qr&&(s=uY(e[0],e[d-1])),o=d>2?dY:fY,l=c=null,f}function f(d){return d==null||isNaN(d=+d)?i:(l||(l=o(e.map(n),t,r)))(n(s(d)))}return f.invert=function(d){return s(a((c||(c=o(t,e.map(n),wh)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,bh),u()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),u()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),r=Sw,u()},f.clamp=function(d){return arguments.length?(s=d?!0:Qr,u()):s!==Qr},f.interpolate=function(d){return arguments.length?(r=d,u()):r},f.unknown=function(d){return arguments.length?(i=d,f):i},function(d,h){return n=d,a=h,u()}}function kw(){return nm()(Qr,Qr)}function hY(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function _h(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function jl(e){return e=_h(Math.abs(e)),e?e[1]:NaN}function pY(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],l=0;a>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),i.push(r.substring(a-=o,a+o)),!((l+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function mY(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var vY=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function sf(e){if(!(t=vY.exec(e)))throw new Error("invalid format: "+e);var t;return new Ew({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}sf.prototype=Ew.prototype;function Ew(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Ew.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gY(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var ej;function yY(e,t){var r=_h(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(ej=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+_h(e,Math.max(0,t+i-1))[0]}function lk(e,t){var r=_h(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const ck={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:hY,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>lk(e*100,t),r:lk,s:yY,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function uk(e){return e}var fk=Array.prototype.map,dk=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function xY(e){var t=e.grouping===void 0||e.thousands===void 0?uk:pY(fk.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?uk:mY(fk.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"−":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(f){f=sf(f);var d=f.fill,h=f.align,m=f.sign,p=f.symbol,g=f.zero,x=f.width,w=f.comma,y=f.precision,k=f.trim,b=f.type;b==="n"?(w=!0,b="g"):ck[b]||(y===void 0&&(y=12),k=!0,b="g"),(g||d==="0"&&h==="=")&&(g=!0,d="0",h="=");var _=p==="$"?r:p==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",S=p==="$"?n:/[%p]/.test(b)?s:"",E=ck[b],T=/[defgprs%]/.test(b);y=y===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y));function F(C){var A=_,M=S,V,z,Y;if(b==="c")M=E(C)+M,C="";else{C=+C;var J=C<0||1/C<0;if(C=isNaN(C)?l:E(Math.abs(C),y),k&&(C=gY(C)),J&&+C==0&&m!=="+"&&(J=!1),A=(J?m==="("?m:o:m==="-"||m==="("?"":m)+A,M=(b==="s"?dk[8+ej/3]:"")+M+(J&&m==="("?")":""),T){for(V=-1,z=C.length;++V<z;)if(Y=C.charCodeAt(V),48>Y||Y>57){M=(Y===46?a+C.slice(V+1):C.slice(V))+M,C=C.slice(0,V);break}}}w&&!g&&(C=t(C,1/0));var Q=A.length+C.length+M.length,j=Q<x?new Array(x-Q+1).join(d):"";switch(w&&g&&(C=t(j+C,j.length?x-M.length:1/0),j=""),h){case"<":C=A+C+M+j;break;case"=":C=A+j+C+M;break;case"^":C=j.slice(0,Q=j.length>>1)+A+C+M+j.slice(Q);break;default:C=j+A+C+M;break}return i(C)}return F.toString=function(){return f+""},F}function u(f,d){var h=c((f=sf(f),f.type="f",f)),m=Math.max(-8,Math.min(8,Math.floor(jl(d)/3)))*3,p=Math.pow(10,-m),g=dk[8+m/3];return function(x){return h(p*x)+g}}return{format:c,formatPrefix:u}}var Kd,Tw,tj;wY({thousands:",",grouping:[3],currency:["$",""]});function wY(e){return Kd=xY(e),Tw=Kd.format,tj=Kd.formatPrefix,Kd}function bY(e){return Math.max(0,-jl(Math.abs(e)))}function _Y(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jl(t)/3)))*3-jl(Math.abs(e)))}function SY(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,jl(t)-jl(e))+1}function rj(e,t,r,n){var a=$y(e,t,r),i;switch(n=sf(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=_Y(a,s))&&(n.precision=i),tj(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=SY(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=bY(a))&&(n.precision=i-(n.type==="%")*2);break}}return Tw(n)}function ms(e){var t=e.domain;return e.ticks=function(r){var n=t();return Ry(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return rj(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],l,c,u=10;for(o<s&&(c=s,s=o,o=c,c=a,a=i,i=c);u-- >0;){if(c=My(s,o,r),c===l)return n[a]=s,n[i]=o,t(n);if(c>0)s=Math.floor(s/c)*c,o=Math.ceil(o/c)*c;else if(c<0)s=Math.ceil(s*c)/c,o=Math.floor(o*c)/c;else break;l=c}return e},e}function Sh(){var e=kw();return e.copy=function(){return nd(e,Sh())},ea.apply(e,arguments),ms(e)}function nj(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,bh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return nj(e).unknown(t)},e=arguments.length?Array.from(e,bh):[0,1],ms(r)}function aj(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function hk(e){return Math.log(e)}function pk(e){return Math.exp(e)}function kY(e){return-Math.log(-e)}function EY(e){return-Math.exp(-e)}function TY(e){return isFinite(e)?+("1e"+e):e<0?0:e}function AY(e){return e===10?TY:e===Math.E?Math.exp:t=>Math.pow(e,t)}function OY(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function mk(e){return(t,r)=>-e(-t,r)}function Aw(e){const t=e(hk,pk),r=t.domain;let n=10,a,i;function s(){return a=OY(n),i=AY(n),r()[0]<0?(a=mk(a),i=mk(i),e(kY,EY)):e(hk,pk),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const l=r();let c=l[0],u=l[l.length-1];const f=u<c;f&&([c,u]=[u,c]);let d=a(c),h=a(u),m,p;const g=o==null?10:+o;let x=[];if(!(n%1)&&h-d<g){if(d=Math.floor(d),h=Math.ceil(h),c>0){for(;d<=h;++d)for(m=1;m<n;++m)if(p=d<0?m/i(-d):m*i(d),!(p<c)){if(p>u)break;x.push(p)}}else for(;d<=h;++d)for(m=n-1;m>=1;--m)if(p=d>0?m/i(-d):m*i(d),!(p<c)){if(p>u)break;x.push(p)}x.length*2<g&&(x=Ry(c,u,g))}else x=Ry(d,h,Math.min(h-d,g)).map(i);return f?x.reverse():x},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=sf(l)).precision==null&&(l.trim=!0),l=Tw(l)),o===1/0)return l;const c=Math.max(1,n*o/t.ticks().length);return u=>{let f=u/i(Math.round(a(u)));return f*n<n-.5&&(f*=n),f<=c?l(u):""}},t.nice=()=>r(aj(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function ij(){const e=Aw(nm()).domain([1,10]);return e.copy=()=>nd(e,ij()).base(e.base()),ea.apply(e,arguments),e}function vk(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function gk(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Ow(e){var t=1,r=e(vk(t),gk(t));return r.constant=function(n){return arguments.length?e(vk(t=+n),gk(t)):t},ms(r)}function sj(){var e=Ow(nm());return e.copy=function(){return nd(e,sj()).constant(e.constant())},ea.apply(e,arguments)}function yk(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function CY(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function PY(e){return e<0?-e*e:e*e}function Cw(e){var t=e(Qr,Qr),r=1;function n(){return r===1?e(Qr,Qr):r===.5?e(CY,PY):e(yk(r),yk(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},ms(t)}function Pw(){var e=Cw(nm());return e.copy=function(){return nd(e,Pw()).exponent(e.exponent())},ea.apply(e,arguments),e}function jY(){return Pw.apply(null,arguments).exponent(.5)}function xk(e){return Math.sign(e)*e*e}function NY(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function oj(){var e=kw(),t=[0,1],r=!1,n;function a(i){var s=NY(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(xk(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,bh)).map(xk)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return oj(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ea.apply(a,arguments),ms(a)}function lj(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=MX(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[td(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(ts),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return lj().domain(e).range(t).unknown(n)},ea.apply(i,arguments)}function cj(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(l){return l!=null&&l<=l?a[td(n,l,0,r)]:i}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},s.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,o()):a.slice()},s.invertExtent=function(l){var c=a.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},s.unknown=function(l){return arguments.length&&(i=l),s},s.thresholds=function(){return n.slice()},s.copy=function(){return cj().domain([e,t]).range(a).unknown(i)},ea.apply(ms(s),arguments)}function uj(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[td(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return uj().domain(e).range(t).unknown(r)},ea.apply(a,arguments)}const Av=new Date,Ov=new Date;function mr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const l=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return l;let c;do l.push(c=new Date(+i)),t(i,o),e(i);while(c<i&&i<s);return l},a.filter=i=>mr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Av.setTime(+i),Ov.setTime(+s),e(Av),e(Ov),Math.floor(r(Av,Ov))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const kh=mr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);kh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?mr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):kh);kh.range;const Ja=1e3,Hn=Ja*60,Qa=Hn*60,hi=Qa*24,jw=hi*7,wk=hi*30,Cv=hi*365,$s=mr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ja)},(e,t)=>(t-e)/Ja,e=>e.getUTCSeconds());$s.range;const Nw=mr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ja)},(e,t)=>{e.setTime(+e+t*Hn)},(e,t)=>(t-e)/Hn,e=>e.getMinutes());Nw.range;const Fw=mr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Hn)},(e,t)=>(t-e)/Hn,e=>e.getUTCMinutes());Fw.range;const Iw=mr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ja-e.getMinutes()*Hn)},(e,t)=>{e.setTime(+e+t*Qa)},(e,t)=>(t-e)/Qa,e=>e.getHours());Iw.range;const Dw=mr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Qa)},(e,t)=>(t-e)/Qa,e=>e.getUTCHours());Dw.range;const ad=mr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Hn)/hi,e=>e.getDate()-1);ad.range;const am=mr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hi,e=>e.getUTCDate()-1);am.range;const fj=mr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hi,e=>Math.floor(e/hi));fj.range;function vo(e){return mr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Hn)/jw)}const im=vo(0),Eh=vo(1),FY=vo(2),IY=vo(3),Nl=vo(4),DY=vo(5),RY=vo(6);im.range;Eh.range;FY.range;IY.range;Nl.range;DY.range;RY.range;function go(e){return mr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/jw)}const sm=go(0),Th=go(1),MY=go(2),$Y=go(3),Fl=go(4),LY=go(5),BY=go(6);sm.range;Th.range;MY.range;$Y.range;Fl.range;LY.range;BY.range;const Rw=mr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Rw.range;const Mw=mr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Mw.range;const pi=mr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());pi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:mr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});pi.range;const mi=mr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());mi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:mr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});mi.range;function dj(e,t,r,n,a,i){const s=[[$s,1,Ja],[$s,5,5*Ja],[$s,15,15*Ja],[$s,30,30*Ja],[i,1,Hn],[i,5,5*Hn],[i,15,15*Hn],[i,30,30*Hn],[a,1,Qa],[a,3,3*Qa],[a,6,6*Qa],[a,12,12*Qa],[n,1,hi],[n,2,2*hi],[r,1,jw],[t,1,wk],[t,3,3*wk],[e,1,Cv]];function o(c,u,f){const d=u<c;d&&([c,u]=[u,c]);const h=f&&typeof f.range=="function"?f:l(c,u,f),m=h?h.range(c,+u+1):[];return d?m.reverse():m}function l(c,u,f){const d=Math.abs(u-c)/f,h=xw(([,,g])=>g).right(s,d);if(h===s.length)return e.every($y(c/Cv,u/Cv,f));if(h===0)return kh.every(Math.max($y(c,u,f),1));const[m,p]=s[d/s[h-1][2]<s[h][2]/d?h-1:h];return m.every(p)}return[o,l]}const[UY,WY]=dj(mi,Mw,sm,fj,Dw,Fw),[zY,HY]=dj(pi,Rw,im,ad,Iw,Nw);function Pv(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function jv(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Lc(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function VY(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,l=e.shortMonths,c=Bc(a),u=Uc(a),f=Bc(i),d=Uc(i),h=Bc(s),m=Uc(s),p=Bc(o),g=Uc(o),x=Bc(l),w=Uc(l),y={a:J,A:Q,b:j,B:X,c:null,d:Tk,e:Tk,f:pJ,g:kJ,G:TJ,H:fJ,I:dJ,j:hJ,L:hj,m:mJ,M:vJ,p:ee,q:P,Q:Ck,s:Pk,S:gJ,u:yJ,U:xJ,V:wJ,w:bJ,W:_J,x:null,X:null,y:SJ,Y:EJ,Z:AJ,"%":Ok},k={a:G,A:B,b:q,B:ne,c:null,d:Ak,e:Ak,f:jJ,g:UJ,G:zJ,H:OJ,I:CJ,j:PJ,L:mj,m:NJ,M:FJ,p:ye,q:pe,Q:Ck,s:Pk,S:IJ,u:DJ,U:RJ,V:MJ,w:$J,W:LJ,x:null,X:null,y:BJ,Y:WJ,Z:HJ,"%":Ok},b={a:F,A:C,b:A,B:M,c:V,d:kk,e:kk,f:oJ,g:Sk,G:_k,H:Ek,I:Ek,j:nJ,L:sJ,m:rJ,M:aJ,p:T,q:tJ,Q:cJ,s:uJ,S:iJ,u:YY,U:JY,V:QY,w:XY,W:ZY,x:z,X:Y,y:Sk,Y:_k,Z:eJ,"%":lJ};y.x=_(r,y),y.X=_(n,y),y.c=_(t,y),k.x=_(r,k),k.X=_(n,k),k.c=_(t,k);function _(te,le){return function(Se){var N=[],Re=-1,ae=0,re=te.length,fe,de,Ue;for(Se instanceof Date||(Se=new Date(+Se));++Re<re;)te.charCodeAt(Re)===37&&(N.push(te.slice(ae,Re)),(de=bk[fe=te.charAt(++Re)])!=null?fe=te.charAt(++Re):de=fe==="e"?" ":"0",(Ue=le[fe])&&(fe=Ue(Se,de)),N.push(fe),ae=Re+1);return N.push(te.slice(ae,Re)),N.join("")}}function S(te,le){return function(Se){var N=Lc(1900,void 0,1),Re=E(N,te,Se+="",0),ae,re;if(Re!=Se.length)return null;if("Q"in N)return new Date(N.Q);if("s"in N)return new Date(N.s*1e3+("L"in N?N.L:0));if(le&&!("Z"in N)&&(N.Z=0),"p"in N&&(N.H=N.H%12+N.p*12),N.m===void 0&&(N.m="q"in N?N.q:0),"V"in N){if(N.V<1||N.V>53)return null;"w"in N||(N.w=1),"Z"in N?(ae=jv(Lc(N.y,0,1)),re=ae.getUTCDay(),ae=re>4||re===0?Th.ceil(ae):Th(ae),ae=am.offset(ae,(N.V-1)*7),N.y=ae.getUTCFullYear(),N.m=ae.getUTCMonth(),N.d=ae.getUTCDate()+(N.w+6)%7):(ae=Pv(Lc(N.y,0,1)),re=ae.getDay(),ae=re>4||re===0?Eh.ceil(ae):Eh(ae),ae=ad.offset(ae,(N.V-1)*7),N.y=ae.getFullYear(),N.m=ae.getMonth(),N.d=ae.getDate()+(N.w+6)%7)}else("W"in N||"U"in N)&&("w"in N||(N.w="u"in N?N.u%7:"W"in N?1:0),re="Z"in N?jv(Lc(N.y,0,1)).getUTCDay():Pv(Lc(N.y,0,1)).getDay(),N.m=0,N.d="W"in N?(N.w+6)%7+N.W*7-(re+5)%7:N.w+N.U*7-(re+6)%7);return"Z"in N?(N.H+=N.Z/100|0,N.M+=N.Z%100,jv(N)):Pv(N)}}function E(te,le,Se,N){for(var Re=0,ae=le.length,re=Se.length,fe,de;Re<ae;){if(N>=re)return-1;if(fe=le.charCodeAt(Re++),fe===37){if(fe=le.charAt(Re++),de=b[fe in bk?le.charAt(Re++):fe],!de||(N=de(te,Se,N))<0)return-1}else if(fe!=Se.charCodeAt(N++))return-1}return N}function T(te,le,Se){var N=c.exec(le.slice(Se));return N?(te.p=u.get(N[0].toLowerCase()),Se+N[0].length):-1}function F(te,le,Se){var N=h.exec(le.slice(Se));return N?(te.w=m.get(N[0].toLowerCase()),Se+N[0].length):-1}function C(te,le,Se){var N=f.exec(le.slice(Se));return N?(te.w=d.get(N[0].toLowerCase()),Se+N[0].length):-1}function A(te,le,Se){var N=x.exec(le.slice(Se));return N?(te.m=w.get(N[0].toLowerCase()),Se+N[0].length):-1}function M(te,le,Se){var N=p.exec(le.slice(Se));return N?(te.m=g.get(N[0].toLowerCase()),Se+N[0].length):-1}function V(te,le,Se){return E(te,t,le,Se)}function z(te,le,Se){return E(te,r,le,Se)}function Y(te,le,Se){return E(te,n,le,Se)}function J(te){return s[te.getDay()]}function Q(te){return i[te.getDay()]}function j(te){return l[te.getMonth()]}function X(te){return o[te.getMonth()]}function ee(te){return a[+(te.getHours()>=12)]}function P(te){return 1+~~(te.getMonth()/3)}function G(te){return s[te.getUTCDay()]}function B(te){return i[te.getUTCDay()]}function q(te){return l[te.getUTCMonth()]}function ne(te){return o[te.getUTCMonth()]}function ye(te){return a[+(te.getUTCHours()>=12)]}function pe(te){return 1+~~(te.getUTCMonth()/3)}return{format:function(te){var le=_(te+="",y);return le.toString=function(){return te},le},parse:function(te){var le=S(te+="",!1);return le.toString=function(){return te},le},utcFormat:function(te){var le=_(te+="",k);return le.toString=function(){return te},le},utcParse:function(te){var le=S(te+="",!0);return le.toString=function(){return te},le}}}var bk={"-":"",_:" ",0:"0"},_r=/^\s*\d+/,GY=/^%/,KY=/[\\^$*+?|[\]().{}]/g;function ft(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function qY(e){return e.replace(KY,"\\$&")}function Bc(e){return new RegExp("^(?:"+e.map(qY).join("|")+")","i")}function Uc(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function XY(e,t,r){var n=_r.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function YY(e,t,r){var n=_r.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function JY(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function QY(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function ZY(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function _k(e,t,r){var n=_r.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function Sk(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function eJ(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function tJ(e,t,r){var n=_r.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function rJ(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function kk(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function nJ(e,t,r){var n=_r.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function Ek(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function aJ(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function iJ(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function sJ(e,t,r){var n=_r.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function oJ(e,t,r){var n=_r.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function lJ(e,t,r){var n=GY.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function cJ(e,t,r){var n=_r.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function uJ(e,t,r){var n=_r.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function Tk(e,t){return ft(e.getDate(),t,2)}function fJ(e,t){return ft(e.getHours(),t,2)}function dJ(e,t){return ft(e.getHours()%12||12,t,2)}function hJ(e,t){return ft(1+ad.count(pi(e),e),t,3)}function hj(e,t){return ft(e.getMilliseconds(),t,3)}function pJ(e,t){return hj(e,t)+"000"}function mJ(e,t){return ft(e.getMonth()+1,t,2)}function vJ(e,t){return ft(e.getMinutes(),t,2)}function gJ(e,t){return ft(e.getSeconds(),t,2)}function yJ(e){var t=e.getDay();return t===0?7:t}function xJ(e,t){return ft(im.count(pi(e)-1,e),t,2)}function pj(e){var t=e.getDay();return t>=4||t===0?Nl(e):Nl.ceil(e)}function wJ(e,t){return e=pj(e),ft(Nl.count(pi(e),e)+(pi(e).getDay()===4),t,2)}function bJ(e){return e.getDay()}function _J(e,t){return ft(Eh.count(pi(e)-1,e),t,2)}function SJ(e,t){return ft(e.getFullYear()%100,t,2)}function kJ(e,t){return e=pj(e),ft(e.getFullYear()%100,t,2)}function EJ(e,t){return ft(e.getFullYear()%1e4,t,4)}function TJ(e,t){var r=e.getDay();return e=r>=4||r===0?Nl(e):Nl.ceil(e),ft(e.getFullYear()%1e4,t,4)}function AJ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ft(t/60|0,"0",2)+ft(t%60,"0",2)}function Ak(e,t){return ft(e.getUTCDate(),t,2)}function OJ(e,t){return ft(e.getUTCHours(),t,2)}function CJ(e,t){return ft(e.getUTCHours()%12||12,t,2)}function PJ(e,t){return ft(1+am.count(mi(e),e),t,3)}function mj(e,t){return ft(e.getUTCMilliseconds(),t,3)}function jJ(e,t){return mj(e,t)+"000"}function NJ(e,t){return ft(e.getUTCMonth()+1,t,2)}function FJ(e,t){return ft(e.getUTCMinutes(),t,2)}function IJ(e,t){return ft(e.getUTCSeconds(),t,2)}function DJ(e){var t=e.getUTCDay();return t===0?7:t}function RJ(e,t){return ft(sm.count(mi(e)-1,e),t,2)}function vj(e){var t=e.getUTCDay();return t>=4||t===0?Fl(e):Fl.ceil(e)}function MJ(e,t){return e=vj(e),ft(Fl.count(mi(e),e)+(mi(e).getUTCDay()===4),t,2)}function $J(e){return e.getUTCDay()}function LJ(e,t){return ft(Th.count(mi(e)-1,e),t,2)}function BJ(e,t){return ft(e.getUTCFullYear()%100,t,2)}function UJ(e,t){return e=vj(e),ft(e.getUTCFullYear()%100,t,2)}function WJ(e,t){return ft(e.getUTCFullYear()%1e4,t,4)}function zJ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Fl(e):Fl.ceil(e),ft(e.getUTCFullYear()%1e4,t,4)}function HJ(){return"+0000"}function Ok(){return"%"}function Ck(e){return+e}function Pk(e){return Math.floor(+e/1e3)}var No,gj,yj;VJ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function VJ(e){return No=VY(e),gj=No.format,No.parse,yj=No.utcFormat,No.utcParse,No}function GJ(e){return new Date(e)}function KJ(e){return e instanceof Date?+e:+new Date(+e)}function $w(e,t,r,n,a,i,s,o,l,c){var u=kw(),f=u.invert,d=u.domain,h=c(".%L"),m=c(":%S"),p=c("%I:%M"),g=c("%I %p"),x=c("%a %d"),w=c("%b %d"),y=c("%B"),k=c("%Y");function b(_){return(l(_)<_?h:o(_)<_?m:s(_)<_?p:i(_)<_?g:n(_)<_?a(_)<_?x:w:r(_)<_?y:k)(_)}return u.invert=function(_){return new Date(f(_))},u.domain=function(_){return arguments.length?d(Array.from(_,KJ)):d().map(GJ)},u.ticks=function(_){var S=d();return e(S[0],S[S.length-1],_??10)},u.tickFormat=function(_,S){return S==null?b:c(S)},u.nice=function(_){var S=d();return(!_||typeof _.range!="function")&&(_=t(S[0],S[S.length-1],_??10)),_?d(aj(S,_)):u},u.copy=function(){return nd(u,$w(e,t,r,n,a,i,s,o,l,c))},u}function qJ(){return ea.apply($w(zY,HY,pi,Rw,im,ad,Iw,Nw,$s,gj).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function XJ(){return ea.apply($w(UY,WY,mi,Mw,sm,am,Dw,Fw,$s,yj).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function om(){var e=0,t=1,r,n,a,i,s=Qr,o=!1,l;function c(f){return f==null||isNaN(f=+f)?l:s(a===0?.5:(f=(i(f)-r)*a,o?Math.max(0,Math.min(1,f)):f))}c.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(f){return arguments.length?(o=!!f,c):o},c.interpolator=function(f){return arguments.length?(s=f,c):s};function u(f){return function(d){var h,m;return arguments.length?([h,m]=d,s=f(h,m),c):[s(0),s(1)]}}return c.range=u(pc),c.rangeRound=u(Sw),c.unknown=function(f){return arguments.length?(l=f,c):l},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),c}}function vs(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function xj(){var e=ms(om()(Qr));return e.copy=function(){return vs(e,xj())},_i.apply(e,arguments)}function wj(){var e=Aw(om()).domain([1,10]);return e.copy=function(){return vs(e,wj()).base(e.base())},_i.apply(e,arguments)}function bj(){var e=Ow(om());return e.copy=function(){return vs(e,bj()).constant(e.constant())},_i.apply(e,arguments)}function Lw(){var e=Cw(om());return e.copy=function(){return vs(e,Lw()).exponent(e.exponent())},_i.apply(e,arguments)}function YJ(){return Lw.apply(null,arguments).exponent(.5)}function _j(){var e=[],t=Qr;function r(n){if(n!=null&&!isNaN(n=+n))return t((td(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ts),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>RX(e,i/n))},r.copy=function(){return _j(t).domain(e)},_i.apply(r,arguments)}function lm(){var e=0,t=.5,r=1,n=1,a,i,s,o,l,c=Qr,u,f=!1,d;function h(p){return isNaN(p=+p)?d:(p=.5+((p=+u(p))-i)*(n*p<n*i?o:l),c(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,r]=p,a=u(e=+e),i=u(t=+t),s=u(r=+r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,h):[e,t,r]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(c=p,h):c};function m(p){return function(g){var x,w,y;return arguments.length?([x,w,y]=g,c=lY(p,[x,w,y]),h):[c(0),c(.5),c(1)]}}return h.range=m(pc),h.rangeRound=m(Sw),h.unknown=function(p){return arguments.length?(d=p,h):d},function(p){return u=p,a=p(e),i=p(t),s=p(r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,h}}function Sj(){var e=ms(lm()(Qr));return e.copy=function(){return vs(e,Sj())},_i.apply(e,arguments)}function kj(){var e=Aw(lm()).domain([.1,1,10]);return e.copy=function(){return vs(e,kj()).base(e.base())},_i.apply(e,arguments)}function Ej(){var e=Ow(lm());return e.copy=function(){return vs(e,Ej()).constant(e.constant())},_i.apply(e,arguments)}function Bw(){var e=Cw(lm());return e.copy=function(){return vs(e,Bw()).exponent(e.exponent())},_i.apply(e,arguments)}function JJ(){return Bw.apply(null,arguments).exponent(.5)}const jk=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:tf,scaleDiverging:Sj,scaleDivergingLog:kj,scaleDivergingPow:Bw,scaleDivergingSqrt:JJ,scaleDivergingSymlog:Ej,scaleIdentity:nj,scaleImplicit:Ly,scaleLinear:Sh,scaleLog:ij,scaleOrdinal:ww,scalePoint:yu,scalePow:Pw,scaleQuantile:lj,scaleQuantize:cj,scaleRadial:oj,scaleSequential:xj,scaleSequentialLog:wj,scaleSequentialPow:Lw,scaleSequentialQuantile:_j,scaleSequentialSqrt:YJ,scaleSequentialSymlog:bj,scaleSqrt:jY,scaleSymlog:sj,scaleThreshold:uj,scaleTime:qJ,scaleUtc:XJ,tickFormat:rj},Symbol.toStringTag,{value:"Module"}));var QJ=ic;function ZJ(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],s=t(i);if(s!=null&&(o===void 0?s===s&&!QJ(s):r(s,o)))var o=s,l=i}return l}var Tj=ZJ;function eQ(e,t){return e>t}var tQ=eQ,rQ=Tj,nQ=tQ,aQ=dc;function iQ(e){return e&&e.length?rQ(e,aQ,nQ):void 0}var sQ=iQ;const cm=_t(sQ);function oQ(e,t){return e<t}var lQ=oQ,cQ=Tj,uQ=lQ,fQ=dc;function dQ(e){return e&&e.length?cQ(e,fQ,uQ):void 0}var hQ=dQ;const um=_t(hQ);var pQ=ew,mQ=ps,vQ=I4,gQ=pn;function yQ(e,t){var r=gQ(e)?pQ:vQ;return r(e,mQ(t))}var xQ=yQ,wQ=N4,bQ=xQ;function _Q(e,t){return wQ(bQ(e,t),1)}var SQ=_Q;const kQ=_t(SQ);var EQ=mw;function TQ(e,t){return EQ(e,t)}var AQ=TQ;const fm=_t(AQ);var mc=1e9,OQ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Ww,It=!0,Jn="[DecimalError] ",Hs=Jn+"Invalid argument: ",Uw=Jn+"Exponent out of range: ",vc=Math.floor,Ps=Math.pow,CQ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,_n,vr=1e7,Ot=7,Aj=9007199254740991,Ah=vc(Aj/Ot),De={};De.absoluteValue=De.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};De.comparedTo=De.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};De.decimalPlaces=De.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Ot;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};De.dividedBy=De.div=function(e){return ii(this,new this.constructor(e))};De.dividedToIntegerBy=De.idiv=function(e){var t=this,r=t.constructor;return bt(ii(t,new r(e),0,1),r.precision)};De.equals=De.eq=function(e){return!this.cmp(e)};De.exponent=function(){return ir(this)};De.greaterThan=De.gt=function(e){return this.cmp(e)>0};De.greaterThanOrEqualTo=De.gte=function(e){return this.cmp(e)>=0};De.isInteger=De.isint=function(){return this.e>this.d.length-2};De.isNegative=De.isneg=function(){return this.s<0};De.isPositive=De.ispos=function(){return this.s>0};De.isZero=function(){return this.s===0};De.lessThan=De.lt=function(e){return this.cmp(e)<0};De.lessThanOrEqualTo=De.lte=function(e){return this.cmp(e)<1};De.logarithm=De.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(_n))throw Error(Jn+"NaN");if(r.s<1)throw Error(Jn+(r.s?"NaN":"-Infinity"));return r.eq(_n)?new n(0):(It=!1,t=ii(of(r,i),of(e,i),i),It=!0,bt(t,a))};De.minus=De.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Pj(t,e):Oj(t,(e.s=-e.s,e))};De.modulo=De.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Jn+"NaN");return r.s?(It=!1,t=ii(r,e,0,1).times(e),It=!0,r.minus(t)):bt(new n(r),a)};De.naturalExponential=De.exp=function(){return Cj(this)};De.naturalLogarithm=De.ln=function(){return of(this)};De.negated=De.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};De.plus=De.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Oj(t,e):Pj(t,(e.s=-e.s,e))};De.precision=De.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Hs+e);if(t=ir(a)+1,n=a.d.length-1,r=n*Ot+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};De.squareRoot=De.sqrt=function(){var e,t,r,n,a,i,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(Jn+"NaN")}for(e=ir(o),It=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=Na(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=vc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(a.toString()),r=l.precision,a=s=r+3;;)if(i=n,n=i.plus(ii(o,i,s+2)).times(.5),Na(i.d).slice(0,s)===(t=Na(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(bt(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return It=!0,bt(n,r)};De.times=De.mul=function(e){var t,r,n,a,i,s,o,l,c,u=this,f=u.constructor,d=u.d,h=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,l=d.length,c=h.length,l<c&&(i=d,d=h,h=i,s=l,l=c,c=s),i=[],s=l+c,n=s;n--;)i.push(0);for(n=c;--n>=0;){for(t=0,a=l+n;a>n;)o=i[a]+h[n]*d[a-n-1]+t,i[a--]=o%vr|0,t=o/vr|0;i[a]=(i[a]+t)%vr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,It?bt(e,f.precision):e};De.toDecimalPlaces=De.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:($a(e,0,mc),t===void 0?t=n.rounding:$a(t,0,8),bt(r,e+ir(r)+1,t))};De.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=ro(n,!0):($a(e,0,mc),t===void 0?t=a.rounding:$a(t,0,8),n=bt(new a(n),e+1,t),r=ro(n,!0,e+1)),r};De.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?ro(a):($a(e,0,mc),t===void 0?t=i.rounding:$a(t,0,8),n=bt(new i(a),e+ir(a)+1,t),r=ro(n.abs(),!1,e+ir(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};De.toInteger=De.toint=function(){var e=this,t=e.constructor;return bt(new t(e),ir(e)+1,t.rounding)};De.toNumber=function(){return+this};De.toPower=De.pow=function(e){var t,r,n,a,i,s,o=this,l=o.constructor,c=12,u=+(e=new l(e));if(!e.s)return new l(_n);if(o=new l(o),!o.s){if(e.s<1)throw Error(Jn+"Infinity");return o}if(o.eq(_n))return o;if(n=l.precision,e.eq(_n))return bt(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=u<0?-u:u)<=Aj){for(a=new l(_n),t=Math.ceil(n/Ot+4),It=!1;r%2&&(a=a.times(o),Fk(a.d,t)),r=vc(r/2),r!==0;)o=o.times(o),Fk(o.d,t);return It=!0,e.s<0?new l(_n).div(a):bt(a,n)}}else if(i<0)throw Error(Jn+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,It=!1,a=e.times(of(o,n+c)),It=!0,a=Cj(a),a.s=i,a};De.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=ir(a),n=ro(a,r<=i.toExpNeg||r>=i.toExpPos)):($a(e,1,mc),t===void 0?t=i.rounding:$a(t,0,8),a=bt(new i(a),e,t),r=ir(a),n=ro(a,e<=r||r<=i.toExpNeg,e)),n};De.toSignificantDigits=De.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):($a(e,1,mc),t===void 0?t=n.rounding:$a(t,0,8)),bt(new n(r),e,t)};De.toString=De.valueOf=De.val=De.toJSON=De[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ir(e),r=e.constructor;return ro(e,t<=r.toExpNeg||t>=r.toExpPos)};function Oj(e,t){var r,n,a,i,s,o,l,c,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),It?bt(t,f):t;if(l=e.d,c=t.d,s=e.e,a=t.e,l=l.slice(),i=s-a,i){for(i<0?(n=l,i=-i,o=c.length):(n=c,a=s,o=l.length),s=Math.ceil(f/Ot),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=l.length,i=c.length,o-i<0&&(i=o,n=c,c=l,l=n),r=0;i;)r=(l[--i]=l[i]+c[i]+r)/vr|0,l[i]%=vr;for(r&&(l.unshift(r),++a),o=l.length;l[--o]==0;)l.pop();return t.d=l,t.e=a,It?bt(t,f):t}function $a(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Hs+e)}function Na(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Ot-n.length,r&&(i+=Ri(r)),i+=n;s=e[t],n=s+"",r=Ot-n.length,r&&(i+=Ri(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var ii=function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%vr|0,s=i/vr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,l;if(i!=s)l=i>s?1:-1;else for(o=l=0;o<i;o++)if(n[o]!=a[o]){l=n[o]>a[o]?1:-1;break}return l}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*vr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,l,c,u,f,d,h,m,p,g,x,w,y,k,b,_,S,E,T=n.constructor,F=n.s==a.s?1:-1,C=n.d,A=a.d;if(!n.s)return new T(n);if(!a.s)throw Error(Jn+"Division by zero");for(l=n.e-a.e,S=A.length,b=C.length,h=new T(F),m=h.d=[],c=0;A[c]==(C[c]||0);)++c;if(A[c]>(C[c]||0)&&--l,i==null?w=i=T.precision:s?w=i+(ir(n)-ir(a))+1:w=i,w<0)return new T(0);if(w=w/Ot+2|0,c=0,S==1)for(u=0,A=A[0],w++;(c<b||u)&&w--;c++)y=u*vr+(C[c]||0),m[c]=y/A|0,u=y%A|0;else{for(u=vr/(A[0]+1)|0,u>1&&(A=e(A,u),C=e(C,u),S=A.length,b=C.length),k=S,p=C.slice(0,S),g=p.length;g<S;)p[g++]=0;E=A.slice(),E.unshift(0),_=A[0],A[1]>=vr/2&&++_;do u=0,o=t(A,p,S,g),o<0?(x=p[0],S!=g&&(x=x*vr+(p[1]||0)),u=x/_|0,u>1?(u>=vr&&(u=vr-1),f=e(A,u),d=f.length,g=p.length,o=t(f,p,d,g),o==1&&(u--,r(f,S<d?E:A,d))):(u==0&&(o=u=1),f=A.slice()),d=f.length,d<g&&f.unshift(0),r(p,f,g),o==-1&&(g=p.length,o=t(A,p,S,g),o<1&&(u++,r(p,S<g?E:A,g))),g=p.length):o===0&&(u++,p=[0]),m[c++]=u,o&&p[0]?p[g++]=C[k]||0:(p=[C[k]],g=1);while((k++<b||p[0]!==void 0)&&w--)}return m[0]||m.shift(),h.e=l,bt(h,s?i+ir(h)+1:i)}}();function Cj(e,t){var r,n,a,i,s,o,l=0,c=0,u=e.constructor,f=u.precision;if(ir(e)>16)throw Error(Uw+ir(e));if(!e.s)return new u(_n);for(It=!1,o=f,s=new u(.03125);e.abs().gte(.1);)e=e.times(s),c+=5;for(n=Math.log(Ps(2,c))/Math.LN10*2+5|0,o+=n,r=a=i=new u(_n),u.precision=o;;){if(a=bt(a.times(e),o),r=r.times(++l),s=i.plus(ii(a,r,o)),Na(s.d).slice(0,o)===Na(i.d).slice(0,o)){for(;c--;)i=bt(i.times(i),o);return u.precision=f,t==null?(It=!0,bt(i,f)):i}i=s}}function ir(e){for(var t=e.e*Ot,r=e.d[0];r>=10;r/=10)t++;return t}function Nv(e,t,r){if(t>e.LN10.sd())throw It=!0,r&&(e.precision=r),Error(Jn+"LN10 precision limit exceeded");return bt(new e(e.LN10),t)}function Ri(e){for(var t="";e--;)t+="0";return t}function of(e,t){var r,n,a,i,s,o,l,c,u,f=1,d=10,h=e,m=h.d,p=h.constructor,g=p.precision;if(h.s<1)throw Error(Jn+(h.s?"NaN":"-Infinity"));if(h.eq(_n))return new p(0);if(t==null?(It=!1,c=g):c=t,h.eq(10))return t==null&&(It=!0),Nv(p,c);if(c+=d,p.precision=c,r=Na(m),n=r.charAt(0),i=ir(h),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(e),r=Na(h.d),n=r.charAt(0),f++;i=ir(h),n>1?(h=new p("0."+r),i++):h=new p(n+"."+r.slice(1))}else return l=Nv(p,c+2,g).times(i+""),h=of(new p(n+"."+r.slice(1)),c-d).plus(l),p.precision=g,t==null?(It=!0,bt(h,g)):h;for(o=s=h=ii(h.minus(_n),h.plus(_n),c),u=bt(h.times(h),c),a=3;;){if(s=bt(s.times(u),c),l=o.plus(ii(s,new p(a),c)),Na(l.d).slice(0,c)===Na(o.d).slice(0,c))return o=o.times(2),i!==0&&(o=o.plus(Nv(p,c+2,g).times(i+""))),o=ii(o,new p(f),c),p.precision=g,t==null?(It=!0,bt(o,g)):o;o=l,a+=2}}function Nk(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=vc(r/Ot),e.d=[],n=(r+1)%Ot,r<0&&(n+=Ot),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Ot;n<a;)e.d.push(+t.slice(n,n+=Ot));t=t.slice(n),n=Ot-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),It&&(e.e>Ah||e.e<-Ah))throw Error(Uw+r)}else e.s=0,e.e=0,e.d=[0];return e}function bt(e,t,r){var n,a,i,s,o,l,c,u,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Ot,a=t,c=f[u=0];else{if(u=Math.ceil((n+1)/Ot),i=f.length,u>=i)return e;for(c=i=f[u],s=1;i>=10;i/=10)s++;n%=Ot,a=n-Ot+s}if(r!==void 0&&(i=Ps(10,s-a-1),o=c/i%10|0,l=t<0||f[u+1]!==void 0||c%i,l=r<4?(o||l)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?a>0?c/Ps(10,s-a):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return l?(i=ir(e),f.length=1,t=t-i-1,f[0]=Ps(10,(Ot-t%Ot)%Ot),e.e=vc(-t/Ot)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,i=1,u--):(f.length=u+1,i=Ps(10,Ot-n),f[u]=a>0?(c/Ps(10,s-a)%Ps(10,a)|0)*i:0),l)for(;;)if(u==0){(f[0]+=i)==vr&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=vr)break;f[u--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(It&&(e.e>Ah||e.e<-Ah))throw Error(Uw+ir(e));return e}function Pj(e,t){var r,n,a,i,s,o,l,c,u,f,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new d(e),It?bt(t,h):t;if(l=e.d,f=t.d,n=t.e,c=e.e,l=l.slice(),s=c-n,s){for(u=s<0,u?(r=l,s=-s,o=f.length):(r=f,n=c,o=l.length),a=Math.max(Math.ceil(h/Ot),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=l.length,o=f.length,u=a<o,u&&(o=a),a=0;a<o;a++)if(l[a]!=f[a]){u=l[a]<f[a];break}s=0}for(u&&(r=l,l=f,f=r,t.s=-t.s),o=l.length,a=f.length-o;a>0;--a)l[o++]=0;for(a=f.length;a>s;){if(l[--a]<f[a]){for(i=a;i&&l[--i]===0;)l[i]=vr-1;--l[i],l[a]+=vr}l[a]-=f[a]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,It?bt(t,h):t):new d(0)}function ro(e,t,r){var n,a=ir(e),i=Na(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Ri(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Ri(-a-1)+i,r&&(n=r-s)>0&&(i+=Ri(n))):a>=s?(i+=Ri(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Ri(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Ri(n))),e.s<0?"-"+i:i}function Fk(e,t){if(e.length>t)return e.length=t,!0}function jj(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Hs+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return Nk(s,i.toString())}else if(typeof i!="string")throw Error(Hs+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,CQ.test(i))Nk(s,i);else throw Error(Hs+i)}if(a.prototype=De,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=jj,a.config=a.set=PQ,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function PQ(e){if(!e||typeof e!="object")throw Error(Jn+"Object expected");var t,r,n,a=["precision",1,mc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(vc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Hs+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Hs+r+": "+n);return this}var Ww=jj(OQ);_n=new Ww(1);const xt=Ww;function jQ(e){return DQ(e)||IQ(e)||FQ(e)||NQ()}function NQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FQ(e,t){if(e){if(typeof e=="string")return zy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zy(e,t)}}function IQ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function DQ(e){if(Array.isArray(e))return zy(e)}function zy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var RQ=function(t){return t},Nj={},Fj=function(t){return t===Nj},Ik=function(t){return function r(){return arguments.length===0||arguments.length===1&&Fj(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},MQ=function e(t,r){return t===1?r:Ik(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a.filter(function(o){return o!==Nj}).length;return s>=t?r.apply(void 0,a):e(t-s,Ik(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=a.map(function(f){return Fj(f)?l.shift():f});return r.apply(void 0,jQ(u).concat(l))}))})},dm=function(t){return MQ(t.length,t)},Hy=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},$Q=dm(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),LQ=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return RQ;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce(function(o,l){return l(o)},i.apply(void 0,arguments))}},Vy=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Ij=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r&&i.every(function(o,l){return o===r[l]})||(r=i,n=t.apply(void 0,i)),n}};function BQ(e){var t;return e===0?t=1:t=Math.floor(new xt(e).abs().log(10).toNumber())+1,t}function UQ(e,t,r){for(var n=new xt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var WQ=dm(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),zQ=dm(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),HQ=dm(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const hm={rangeStep:UQ,getDigitCount:BQ,interpolateNumber:WQ,uninterpolateNumber:zQ,uninterpolateTruncation:HQ};function Gy(e){return KQ(e)||GQ(e)||Dj(e)||VQ()}function VQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GQ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function KQ(e){if(Array.isArray(e))return Ky(e)}function lf(e,t){return YQ(e)||XQ(e,t)||Dj(e,t)||qQ()}function qQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dj(e,t){if(e){if(typeof e=="string")return Ky(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ky(e,t)}}function Ky(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XQ(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var s=e[Symbol.iterator](),o;!(n=(o=s.next()).done)&&(r.push(o.value),!(t&&r.length===t));n=!0);}catch(l){a=!0,i=l}finally{try{!n&&s.return!=null&&s.return()}finally{if(a)throw i}}return r}}function YQ(e){if(Array.isArray(e))return e}function Rj(e){var t=lf(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function Mj(e,t,r){if(e.lte(0))return new xt(0);var n=hm.getDigitCount(e.toNumber()),a=new xt(10).pow(n),i=e.div(a),s=n!==1?.05:.1,o=new xt(Math.ceil(i.div(s).toNumber())).add(r).mul(s),l=o.mul(a);return t?l:new xt(Math.ceil(l))}function JQ(e,t,r){var n=1,a=new xt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new xt(10).pow(hm.getDigitCount(e)-1),a=new xt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new xt(Math.floor(e)))}else e===0?a=new xt(Math.floor((t-1)/2)):r||(a=new xt(Math.floor(e)));var s=Math.floor((t-1)/2),o=LQ($Q(function(l){return a.add(new xt(l-s).mul(n)).toNumber()}),Hy);return o(0,t)}function $j(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new xt(0),tickMin:new xt(0),tickMax:new xt(0)};var i=Mj(new xt(t).sub(e).div(r-1),n,a),s;e<=0&&t>=0?s=new xt(0):(s=new xt(e).add(t).div(2),s=s.sub(new xt(s).mod(i)));var o=Math.ceil(s.sub(e).div(i).toNumber()),l=Math.ceil(new xt(t).sub(s).div(i).toNumber()),c=o+l+1;return c>r?$j(e,t,r,n,a+1):(c<r&&(l=t>0?l+(r-c):l,o=t>0?o:o+(r-c)),{step:i,tickMin:s.sub(new xt(o).mul(i)),tickMax:s.add(new xt(l).mul(i))})}function QQ(e){var t=lf(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),o=Rj([r,n]),l=lf(o,2),c=l[0],u=l[1];if(c===-1/0||u===1/0){var f=u===1/0?[c].concat(Gy(Hy(0,a-1).map(function(){return 1/0}))):[].concat(Gy(Hy(0,a-1).map(function(){return-1/0})),[u]);return r>n?Vy(f):f}if(c===u)return JQ(c,a,i);var d=$j(c,u,s,i),h=d.step,m=d.tickMin,p=d.tickMax,g=hm.rangeStep(m,p.add(new xt(.1).mul(h)),h);return r>n?Vy(g):g}function ZQ(e,t){var r=lf(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Rj([n,a]),o=lf(s,2),l=o[0],c=o[1];if(l===-1/0||c===1/0)return[n,a];if(l===c)return[l];var u=Math.max(t,2),f=Mj(new xt(c).sub(l).div(u-1),i,0),d=[].concat(Gy(hm.rangeStep(new xt(l),new xt(c).sub(new xt(.99).mul(f)),f)),[c]);return n>a?Vy(d):d}var eZ=Ij(QQ),tZ=Ij(ZQ),rZ="Invariant failed";function no(e,t){throw new Error(rZ)}var nZ=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Il(e){"@babel/helpers - typeof";return Il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Il(e)}function Oh(){return Oh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oh.apply(this,arguments)}function aZ(e,t){return lZ(e)||oZ(e,t)||sZ(e,t)||iZ()}function iZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sZ(e,t){if(e){if(typeof e=="string")return Dk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dk(e,t)}}function Dk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function lZ(e){if(Array.isArray(e))return e}function cZ(e,t){if(e==null)return{};var r=uZ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function uZ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function fZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uj(n.key),n)}}function hZ(e,t,r){return t&&dZ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pZ(e,t,r){return t=Ch(t),mZ(e,Lj()?Reflect.construct(t,r||[],Ch(e).constructor):t.apply(e,r))}function mZ(e,t){if(t&&(Il(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vZ(e)}function vZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lj(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Lj=function(){return!!e})()}function Ch(e){return Ch=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ch(e)}function gZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qy(e,t)}function qy(e,t){return qy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},qy(e,t)}function Bj(e,t,r){return t=Uj(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uj(e){var t=yZ(e,"string");return Il(t)=="symbol"?t:t+""}function yZ(e,t){if(Il(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Il(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var id=function(e){function t(){return fZ(this,t),pZ(this,t,arguments)}return gZ(t,e),hZ(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,s=n.width,o=n.dataKey,l=n.data,c=n.dataPointFormatter,u=n.xAxis,f=n.yAxis,d=cZ(n,nZ),h=nt(d,!1);this.props.direction==="x"&&u.type!=="number"&&no();var m=l.map(function(p){var g=c(p,o),x=g.x,w=g.y,y=g.value,k=g.errorVal;if(!k)return null;var b=[],_,S;if(Array.isArray(k)){var E=aZ(k,2);_=E[0],S=E[1]}else _=S=k;if(i==="vertical"){var T=u.scale,F=w+a,C=F+s,A=F-s,M=T(y-_),V=T(y+S);b.push({x1:V,y1:C,x2:V,y2:A}),b.push({x1:M,y1:F,x2:V,y2:F}),b.push({x1:M,y1:C,x2:M,y2:A})}else if(i==="horizontal"){var z=f.scale,Y=x+a,J=Y-s,Q=Y+s,j=z(y-_),X=z(y+S);b.push({x1:J,y1:X,x2:Q,y2:X}),b.push({x1:Y,y1:j,x2:Y,y2:X}),b.push({x1:J,y1:j,x2:Q,y2:j})}return Z.createElement(Yt,Oh({className:"recharts-errorBar",key:"bar-".concat(b.map(function(ee){return"".concat(ee.x1,"-").concat(ee.x2,"-").concat(ee.y1,"-").concat(ee.y2)}))},h),b.map(function(ee){return Z.createElement("line",Oh({},ee,{key:"line-".concat(ee.x1,"-").concat(ee.x2,"-").concat(ee.y1,"-").concat(ee.y2)}))}))});return Z.createElement(Yt,{className:"recharts-errorBars"},m)}}])}(Z.Component);Bj(id,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Bj(id,"displayName","ErrorBar");function cf(e){"@babel/helpers - typeof";return cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cf(e)}function Rk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ks(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rk(Object(r),!0).forEach(function(n){xZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xZ(e,t,r){return t=wZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wZ(e){var t=bZ(e,"string");return cf(t)=="symbol"?t:t+""}function bZ(e,t){if(cf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wj=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,s=yn(r,ai);if(!s)return null;var o=ai.defaultProps,l=o!==void 0?ks(ks({},o),s.props):{},c;return s.props&&s.props.payload?c=s.props&&s.props.payload:i==="children"?c=(n||[]).reduce(function(u,f){var d=f.item,h=f.props,m=h.sectors||h.data||[];return u.concat(m.map(function(p){return{type:s.props.iconType||d.props.legendType,value:p.name,color:p.fill,payload:p}}))},[]):c=(n||[]).map(function(u){var f=u.item,d=f.type.defaultProps,h=d!==void 0?ks(ks({},d),f.props):{},m=h.dataKey,p=h.name,g=h.legendType,x=h.hide;return{inactive:x,dataKey:m,type:l.iconType||g||"square",color:zw(f),value:p||m,payload:h}}),ks(ks(ks({},l),ai.getWithHeight(s,a)),{},{payload:c,item:s})};function uf(e){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uf(e)}function Mk(e){return EZ(e)||kZ(e)||SZ(e)||_Z()}function _Z(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SZ(e,t){if(e){if(typeof e=="string")return Xy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xy(e,t)}}function kZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EZ(e){if(Array.isArray(e))return Xy(e)}function Xy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ht(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$k(Object(r),!0).forEach(function(n){hl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$k(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hl(e,t,r){return t=TZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TZ(e){var t=AZ(e,"string");return uf(t)=="symbol"?t:t+""}function AZ(e,t){if(uf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(uf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function On(e,t,r){return tt(e)||tt(t)?r:hr(t)?Gn(e,t,r):Je(t)?t(e):r}function xu(e,t,r,n){var a=kQ(e,function(o){return On(o,t)});if(r==="number"){var i=a.filter(function(o){return Oe(o)||parseFloat(o)});return i.length?[um(i),cm(i)]:[1/0,-1/0]}var s=n?a.filter(function(o){return!tt(o)}):a;return s.map(function(o){return hr(o)||o instanceof Date?o:""})}var OZ=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=-1,o=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(o<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var l=i.range,c=0;c<o;c++){var u=c>0?a[c-1].coordinate:a[o-1].coordinate,f=a[c].coordinate,d=c>=o-1?a[0].coordinate:a[c+1].coordinate,h=void 0;if(pa(f-u)!==pa(d-f)){var m=[];if(pa(d-f)===pa(l[1]-l[0])){h=d;var p=f+l[1]-l[0];m[0]=Math.min(p,(p+u)/2),m[1]=Math.max(p,(p+u)/2)}else{h=u;var g=d+l[1]-l[0];m[0]=Math.min(f,(g+f)/2),m[1]=Math.max(f,(g+f)/2)}var x=[Math.min(f,(h+f)/2),Math.max(f,(h+f)/2)];if(t>x[0]&&t<=x[1]||t>=m[0]&&t<=m[1]){s=a[c].index;break}}else{var w=Math.min(u,d),y=Math.max(u,d);if(t>(w+f)/2&&t<=(y+f)/2){s=a[c].index;break}}}else for(var k=0;k<o;k++)if(k===0&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k>0&&k<o-1&&t>(n[k].coordinate+n[k-1].coordinate)/2&&t<=(n[k].coordinate+n[k+1].coordinate)/2||k===o-1&&t>(n[k].coordinate+n[k-1].coordinate)/2){s=n[k].index;break}return s},zw=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Ht(Ht({},t.type.defaultProps),t.props):t.props,s=i.stroke,o=i.fill,l;switch(a){case"Line":l=s;break;case"Area":case"Radar":l=s&&s!=="none"?s:o;break;default:l=o;break}return l},CZ=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var s={},o=Object.keys(i),l=0,c=o.length;l<c;l++)for(var u=i[o[l]].stackGroups,f=Object.keys(u),d=0,h=f.length;d<h;d++){var m=u[f[d]],p=m.items,g=m.cateAxisId,x=p.filter(function(S){return ri(S.type).indexOf("Bar")>=0});if(x&&x.length){var w=x[0].type.defaultProps,y=w!==void 0?Ht(Ht({},w),x[0].props):x[0].props,k=y.barSize,b=y[g];s[b]||(s[b]=[]);var _=tt(k)?r:k;s[b].push({item:x[0],stackList:x.slice(1),barSize:tt(_)?void 0:to(_,n,0)})}}return s},PZ=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,s=i===void 0?[]:i,o=t.maxBarSize,l=s.length;if(l<1)return null;var c=to(r,a,0,!0),u,f=[];if(s[0].barSize===+s[0].barSize){var d=!1,h=a/l,m=s.reduce(function(k,b){return k+b.barSize||0},0);m+=(l-1)*c,m>=a&&(m-=(l-1)*c,c=0),m>=a&&h>0&&(d=!0,h*=.9,m=l*h);var p=(a-m)/2>>0,g={offset:p-c,size:0};u=s.reduce(function(k,b){var _={item:b.item,position:{offset:g.offset+g.size+c,size:d?h:b.barSize}},S=[].concat(Mk(k),[_]);return g=S[S.length-1].position,b.stackList&&b.stackList.length&&b.stackList.forEach(function(E){S.push({item:E,position:g})}),S},f)}else{var x=to(n,a,0,!0);a-2*x-(l-1)*c<=0&&(c=0);var w=(a-2*x-(l-1)*c)/l;w>1&&(w>>=0);var y=o===+o?Math.min(w,o):w;u=s.reduce(function(k,b,_){var S=[].concat(Mk(k),[{item:b.item,position:{offset:x+(w+c)*_+(w-y)/2,size:y}}]);return b.stackList&&b.stackList.length&&b.stackList.forEach(function(E){S.push({item:E,position:S[S.length-1].position})}),S},f)}return u},jZ=function(t,r,n,a){var i=n.children,s=n.width,o=n.margin,l=s-(o.left||0)-(o.right||0),c=Wj({children:i,legendWidth:l});if(c){var u=a||{},f=u.width,d=u.height,h=c.align,m=c.verticalAlign,p=c.layout;if((p==="vertical"||p==="horizontal"&&m==="middle")&&h!=="center"&&Oe(t[h]))return Ht(Ht({},t),{},hl({},h,t[h]+(f||0)));if((p==="horizontal"||p==="vertical"&&h==="center")&&m!=="middle"&&Oe(t[m]))return Ht(Ht({},t),{},hl({},m,t[m]+(d||0)))}return t},NZ=function(t,r,n){return tt(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},zj=function(t,r,n,a,i){var s=r.props.children,o=Kn(s,id).filter(function(c){return NZ(a,i,c.props.direction)});if(o&&o.length){var l=o.map(function(c){return c.props.dataKey});return t.reduce(function(c,u){var f=On(u,n);if(tt(f))return c;var d=Array.isArray(f)?[um(f),cm(f)]:[f,f],h=l.reduce(function(m,p){var g=On(u,p,0),x=d[0]-Math.abs(Array.isArray(g)?g[0]:g),w=d[1]+Math.abs(Array.isArray(g)?g[1]:g);return[Math.min(x,m[0]),Math.max(w,m[1])]},[1/0,-1/0]);return[Math.min(h[0],c[0]),Math.max(h[1],c[1])]},[1/0,-1/0])}return null},FZ=function(t,r,n,a,i){var s=r.map(function(o){return zj(t,o,n,i,a)}).filter(function(o){return!tt(o)});return s&&s.length?s.reduce(function(o,l){return[Math.min(o[0],l[0]),Math.max(o[1],l[1])]},[1/0,-1/0]):null},Hj=function(t,r,n,a,i){var s=r.map(function(l){var c=l.props.dataKey;return n==="number"&&c&&zj(t,l,c,a)||xu(t,c,n,i)});if(n==="number")return s.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]);var o={};return s.reduce(function(l,c){for(var u=0,f=c.length;u<f;u++)o[c[u]]||(o[c[u]]=!0,l.push(c[u]));return l},[])},Vj=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},Gj=function(t,r,n,a){if(a)return t.map(function(l){return l.coordinate});var i,s,o=t.map(function(l){return l.coordinate===r&&(i=!0),l.coordinate===n&&(s=!0),l.coordinate});return i||o.push(r),s||o.push(n),o},Za=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,s=t.type,o=t.range,l=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,c=(r||n)&&s==="category"&&a.bandwidth?a.bandwidth()/l:0;if(c=t.axisType==="angleAxis"&&(o==null?void 0:o.length)>=2?pa(o[0]-o[1])*2*c:c,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var d=i?i.indexOf(f):f;return{coordinate:a(d)+c,value:f,offset:c}});return u.filter(function(f){return!Qf(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,d){return{coordinate:a(f)+c,value:f,index:d,offset:c}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+c,value:f,offset:c}}):a.domain().map(function(f,d){return{coordinate:a(f)+c,value:i?i[f]:f,index:d,offset:c}})},Fv=new WeakMap,qd=function(t,r){if(typeof r!="function")return t;Fv.has(t)||Fv.set(t,new WeakMap);var n=Fv.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},IZ=function(t,r,n){var a=t.scale,i=t.type,s=t.layout,o=t.axisType;if(a==="auto")return s==="radial"&&o==="radiusAxis"?{scale:tf(),realScaleType:"band"}:s==="radial"&&o==="angleAxis"?{scale:Sh(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:yu(),realScaleType:"point"}:i==="category"?{scale:tf(),realScaleType:"band"}:{scale:Sh(),realScaleType:"linear"};if(eo(a)){var l="scale".concat(Yp(a));return{scale:(jk[l]||yu)(),realScaleType:jk[l]?l:"point"}}return Je(a)?{scale:a}:{scale:yu(),realScaleType:"point"}},Lk=1e-4,DZ=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-Lk,s=Math.max(a[0],a[1])+Lk,o=t(r[0]),l=t(r[n-1]);(o<i||o>s||l<i||l>s)&&t.domain([r[0],r[n-1]])}},RZ=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},MZ=function(t,r){if(!r||r.length!==2||!Oe(r[0])||!Oe(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Oe(t[0])||t[0]<n)&&(i[0]=n),(!Oe(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},$Z=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0,o=0;o<r;++o){var l=Qf(t[o][n][1])?t[o][n][0]:t[o][n][1];l>=0?(t[o][n][0]=i,t[o][n][1]=i+l,i=t[o][n][1]):(t[o][n][0]=s,t[o][n][1]=s+l,s=t[o][n][1])}},LZ=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0;s<r;++s){var o=Qf(t[s][n][1])?t[s][n][0]:t[s][n][1];o>=0?(t[s][n][0]=i,t[s][n][1]=i+o,i=t[s][n][1]):(t[s][n][0]=0,t[s][n][1]=0)}},BZ={sign:$Z,expand:tU,none:Tl,silhouette:rU,wiggle:nU,positive:LZ},UZ=function(t,r,n){var a=r.map(function(o){return o.props.dataKey}),i=BZ[n],s=eU().keys(a).value(function(o,l){return+On(o,l,0)}).order(wy).offset(i);return s(t)},WZ=function(t,r,n,a,i,s){if(!t)return null;var o=s?r.reverse():r,l={},c=o.reduce(function(f,d){var h,m=(h=d.type)!==null&&h!==void 0&&h.defaultProps?Ht(Ht({},d.type.defaultProps),d.props):d.props,p=m.stackId,g=m.hide;if(g)return f;var x=m[n],w=f[x]||{hasStack:!1,stackGroups:{}};if(hr(p)){var y=w.stackGroups[p]||{numericAxisId:n,cateAxisId:a,items:[]};y.items.push(d),w.hasStack=!0,w.stackGroups[p]=y}else w.stackGroups[Zf("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[d]};return Ht(Ht({},f),{},hl({},x,w))},l),u={};return Object.keys(c).reduce(function(f,d){var h=c[d];if(h.hasStack){var m={};h.stackGroups=Object.keys(h.stackGroups).reduce(function(p,g){var x=h.stackGroups[g];return Ht(Ht({},p),{},hl({},g,{numericAxisId:n,cateAxisId:a,items:x.items,stackedData:UZ(t,x.items,i)}))},m)}return Ht(Ht({},f),{},hl({},d,h))},u)},zZ=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,s=r.originalDomain,o=r.allowDecimals,l=n||r.scale;if(l!=="auto"&&l!=="linear")return null;if(i&&a==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var c=t.domain();if(!c.length)return null;var u=eZ(c,i,o);return t.domain([um(u),cm(u)]),{niceTicks:u}}if(i&&a==="number"){var f=t.domain(),d=tZ(f,i,o);return{niceTicks:d}}return null};function Bk(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,s=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!tt(a[t.dataKey])){var o=Z0(r,"value",a[t.dataKey]);if(o)return o.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var l=On(a,tt(s)?t.dataKey:s);return tt(l)?null:t.scale(l)}var Uk=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,s=t.entry,o=t.index;if(r.type==="category")return n[o]?n[o].coordinate+a:null;var l=On(s,r.dataKey,r.domain[o]);return tt(l)?null:r.scale(l)-i/2+a},HZ=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},VZ=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Ht(Ht({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(hr(i)){var s=r[i];if(s){var o=s.items.indexOf(t);return o>=0?s.stackedData[o]:null}}return null},GZ=function(t){return t.reduce(function(r,n){return[um(n.concat([r[0]]).filter(Oe)),cm(n.concat([r[1]]).filter(Oe))]},[1/0,-1/0])},Kj=function(t,r,n){return Object.keys(t).reduce(function(a,i){var s=t[i],o=s.stackedData,l=o.reduce(function(c,u){var f=GZ(u.slice(r,n+1));return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],a[0]),Math.max(l[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},Wk=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,zk=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Yy=function(t,r,n){if(Je(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Oe(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(Wk.test(t[0])){var i=+Wk.exec(t[0])[1];a[0]=r[0]-i}else Je(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Oe(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(zk.test(t[1])){var s=+zk.exec(t[1])[1];a[1]=r[1]+s}else Je(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},Ph=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=gw(r,function(f){return f.coordinate}),s=1/0,o=1,l=i.length;o<l;o++){var c=i[o],u=i[o-1];s=Math.min((c.coordinate||0)-(u.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},Hk=function(t,r,n){return!t||!t.length||fm(t,Gn(n,"type.defaultProps.domain"))?r:t},qj=function(t,r){var n=t.type.defaultProps?Ht(Ht({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,s=n.unit,o=n.formatter,l=n.tooltipType,c=n.chartType,u=n.hide;return Ht(Ht({},nt(t,!1)),{},{dataKey:a,unit:s,formatter:o,name:i||a,color:zw(t),value:On(r,a),type:l,payload:r,chartType:c,hide:u})};function ff(e){"@babel/helpers - typeof";return ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ff(e)}function Vk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vk(Object(r),!0).forEach(function(n){KZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KZ(e,t,r){return t=qZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qZ(e){var t=XZ(e,"string");return ff(t)=="symbol"?t:t+""}function XZ(e,t){if(ff(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ff(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jh=Math.PI/180,YZ=function(t){return t*180/Math.PI},Or=function(t,r,n,a){return{x:t+Math.cos(-jh*a)*n,y:r+Math.sin(-jh*a)*n}},JZ=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-s,2))},QZ=function(t,r){var n=t.x,a=t.y,i=r.cx,s=r.cy,o=JZ({x:n,y:a},{x:i,y:s});if(o<=0)return{radius:o};var l=(n-i)/o,c=Math.acos(l);return a>s&&(c=2*Math.PI-c),{radius:o,angle:YZ(c),angleInRadian:c}},ZZ=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return{startAngle:r-s*360,endAngle:n-s*360}},eee=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),s=Math.floor(a/360),o=Math.min(i,s);return t+o*360},Kk=function(t,r){var n=t.x,a=t.y,i=QZ({x:n,y:a},r),s=i.radius,o=i.angle,l=r.innerRadius,c=r.outerRadius;if(s<l||s>c)return!1;if(s===0)return!0;var u=ZZ(r),f=u.startAngle,d=u.endAngle,h=o,m;if(f<=d){for(;h>d;)h-=360;for(;h<f;)h+=360;m=h>=f&&h<=d}else{for(;h>f;)h-=360;for(;h<d;)h+=360;m=h>=d&&h<=f}return m?Gk(Gk({},r),{},{radius:s,angle:eee(h,r)}):null};function df(e){"@babel/helpers - typeof";return df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(e)}var tee=["offset"];function ree(e){return see(e)||iee(e)||aee(e)||nee()}function nee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aee(e,t){if(e){if(typeof e=="string")return Jy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jy(e,t)}}function iee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function see(e){if(Array.isArray(e))return Jy(e)}function Jy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oee(e,t){if(e==null)return{};var r=lee(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lee(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function qk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function or(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qk(Object(r),!0).forEach(function(n){cee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cee(e,t,r){return t=uee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uee(e){var t=fee(e,"string");return df(t)=="symbol"?t:t+""}function fee(e,t){if(df(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(df(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hf(){return hf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hf.apply(this,arguments)}var dee=function(t){var r=t.value,n=t.formatter,a=tt(t.children)?r:t.children;return Je(n)?n(a):a},hee=function(t,r){var n=pa(r-t),a=Math.min(Math.abs(r-t),360);return n*a},pee=function(t,r,n){var a=t.position,i=t.viewBox,s=t.offset,o=t.className,l=i,c=l.cx,u=l.cy,f=l.innerRadius,d=l.outerRadius,h=l.startAngle,m=l.endAngle,p=l.clockWise,g=(f+d)/2,x=hee(h,m),w=x>=0?1:-1,y,k;a==="insideStart"?(y=h+w*s,k=p):a==="insideEnd"?(y=m-w*s,k=!p):a==="end"&&(y=m+w*s,k=p),k=x<=0?k:!k;var b=Or(c,u,g,y),_=Or(c,u,g,y+(k?1:-1)*359),S="M".concat(b.x,",").concat(b.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(k?0:1,`,
    `).concat(_.x,",").concat(_.y),E=tt(t.id)?Zf("recharts-radial-line-"):t.id;return Z.createElement("text",hf({},n,{dominantBaseline:"central",className:ot("recharts-radial-bar-label",o)}),Z.createElement("defs",null,Z.createElement("path",{id:E,d:S})),Z.createElement("textPath",{xlinkHref:"#".concat(E)},r))},mee=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,s=i.cx,o=i.cy,l=i.innerRadius,c=i.outerRadius,u=i.startAngle,f=i.endAngle,d=(u+f)/2;if(a==="outside"){var h=Or(s,o,c+n,d),m=h.x,p=h.y;return{x:m,y:p,textAnchor:m>=s?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"end"};var g=(l+c)/2,x=Or(s,o,g,d),w=x.x,y=x.y;return{x:w,y,textAnchor:"middle",verticalAnchor:"middle"}},vee=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,s=r,o=s.x,l=s.y,c=s.width,u=s.height,f=u>=0?1:-1,d=f*a,h=f>0?"end":"start",m=f>0?"start":"end",p=c>=0?1:-1,g=p*a,x=p>0?"end":"start",w=p>0?"start":"end";if(i==="top"){var y={x:o+c/2,y:l-f*a,textAnchor:"middle",verticalAnchor:h};return or(or({},y),n?{height:Math.max(l-n.y,0),width:c}:{})}if(i==="bottom"){var k={x:o+c/2,y:l+u+d,textAnchor:"middle",verticalAnchor:m};return or(or({},k),n?{height:Math.max(n.y+n.height-(l+u),0),width:c}:{})}if(i==="left"){var b={x:o-g,y:l+u/2,textAnchor:x,verticalAnchor:"middle"};return or(or({},b),n?{width:Math.max(b.x-n.x,0),height:u}:{})}if(i==="right"){var _={x:o+c+g,y:l+u/2,textAnchor:w,verticalAnchor:"middle"};return or(or({},_),n?{width:Math.max(n.x+n.width-_.x,0),height:u}:{})}var S=n?{width:c,height:u}:{};return i==="insideLeft"?or({x:o+g,y:l+u/2,textAnchor:w,verticalAnchor:"middle"},S):i==="insideRight"?or({x:o+c-g,y:l+u/2,textAnchor:x,verticalAnchor:"middle"},S):i==="insideTop"?or({x:o+c/2,y:l+d,textAnchor:"middle",verticalAnchor:m},S):i==="insideBottom"?or({x:o+c/2,y:l+u-d,textAnchor:"middle",verticalAnchor:h},S):i==="insideTopLeft"?or({x:o+g,y:l+d,textAnchor:w,verticalAnchor:m},S):i==="insideTopRight"?or({x:o+c-g,y:l+d,textAnchor:x,verticalAnchor:m},S):i==="insideBottomLeft"?or({x:o+g,y:l+u-d,textAnchor:w,verticalAnchor:h},S):i==="insideBottomRight"?or({x:o+c-g,y:l+u-d,textAnchor:x,verticalAnchor:h},S):sc(i)&&(Oe(i.x)||Rs(i.x))&&(Oe(i.y)||Rs(i.y))?or({x:o+to(i.x,c),y:l+to(i.y,u),textAnchor:"end",verticalAnchor:"end"},S):or({x:o+c/2,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},S)},gee=function(t){return"cx"in t&&Oe(t.cx)};function Lr(e){var t=e.offset,r=t===void 0?5:t,n=oee(e,tee),a=or({offset:r},n),i=a.viewBox,s=a.position,o=a.value,l=a.children,c=a.content,u=a.className,f=u===void 0?"":u,d=a.textBreakAll;if(!i||tt(o)&&tt(l)&&!R.isValidElement(c)&&!Je(c))return null;if(R.isValidElement(c))return R.cloneElement(c,a);var h;if(Je(c)){if(h=R.createElement(c,a),R.isValidElement(h))return h}else h=dee(a);var m=gee(i),p=nt(a,!0);if(m&&(s==="insideStart"||s==="insideEnd"||s==="end"))return pee(a,h,p);var g=m?mee(a):vee(a);return Z.createElement(vh,hf({className:ot("recharts-label",f)},p,g,{breakAll:d}),h)}Lr.displayName="Label";var Xj=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,s=t.endAngle,o=t.r,l=t.radius,c=t.innerRadius,u=t.outerRadius,f=t.x,d=t.y,h=t.top,m=t.left,p=t.width,g=t.height,x=t.clockWise,w=t.labelViewBox;if(w)return w;if(Oe(p)&&Oe(g)){if(Oe(f)&&Oe(d))return{x:f,y:d,width:p,height:g};if(Oe(h)&&Oe(m))return{x:h,y:m,width:p,height:g}}return Oe(f)&&Oe(d)?{x:f,y:d,width:0,height:0}:Oe(r)&&Oe(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:s||a||0,innerRadius:c||0,outerRadius:u||l||o||0,clockWise:x}:t.viewBox?t.viewBox:{}},yee=function(t,r){return t?t===!0?Z.createElement(Lr,{key:"label-implicit",viewBox:r}):hr(t)?Z.createElement(Lr,{key:"label-implicit",viewBox:r,value:t}):R.isValidElement(t)?t.type===Lr?R.cloneElement(t,{key:"label-implicit",viewBox:r}):Z.createElement(Lr,{key:"label-implicit",content:t,viewBox:r}):Je(t)?Z.createElement(Lr,{key:"label-implicit",content:t,viewBox:r}):sc(t)?Z.createElement(Lr,hf({viewBox:r},t,{key:"label-implicit"})):null:null},xee=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=Xj(t),s=Kn(a,Lr).map(function(l,c){return R.cloneElement(l,{viewBox:r||i,key:"label-".concat(c)})});if(!n)return s;var o=yee(t.label,r||i);return[o].concat(ree(s))};Lr.parseViewBox=Xj;Lr.renderCallByParent=xee;function wee(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var bee=wee;const _ee=_t(bee);function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}var See=["valueAccessor"],kee=["data","dataKey","clockWise","id","textBreakAll"];function Eee(e){return Cee(e)||Oee(e)||Aee(e)||Tee()}function Tee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aee(e,t){if(e){if(typeof e=="string")return Qy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qy(e,t)}}function Oee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Cee(e){if(Array.isArray(e))return Qy(e)}function Qy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Nh(){return Nh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nh.apply(this,arguments)}function Xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xk(Object(r),!0).forEach(function(n){Pee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pee(e,t,r){return t=jee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jee(e){var t=Nee(e,"string");return pf(t)=="symbol"?t:t+""}function Nee(e,t){if(pf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jk(e,t){if(e==null)return{};var r=Fee(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Fee(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Iee=function(t){return Array.isArray(t.value)?_ee(t.value):t.value};function rs(e){var t=e.valueAccessor,r=t===void 0?Iee:t,n=Jk(e,See),a=n.data,i=n.dataKey,s=n.clockWise,o=n.id,l=n.textBreakAll,c=Jk(n,kee);return!a||!a.length?null:Z.createElement(Yt,{className:"recharts-label-list"},a.map(function(u,f){var d=tt(i)?r(u,f):On(u&&u.payload,i),h=tt(o)?{}:{id:"".concat(o,"-").concat(f)};return Z.createElement(Lr,Nh({},nt(u,!0),c,h,{parentViewBox:u.parentViewBox,value:d,textBreakAll:l,viewBox:Lr.parseViewBox(tt(s)?u:Yk(Yk({},u),{},{clockWise:s})),key:"label-".concat(f),index:f}))}))}rs.displayName="LabelList";function Dee(e,t){return e?e===!0?Z.createElement(rs,{key:"labelList-implicit",data:t}):Z.isValidElement(e)||Je(e)?Z.createElement(rs,{key:"labelList-implicit",data:t,content:e}):sc(e)?Z.createElement(rs,Nh({data:t},e,{key:"labelList-implicit"})):null:null}function Ree(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Kn(n,rs).map(function(s,o){return R.cloneElement(s,{data:t,key:"labelList-".concat(o)})});if(!r)return a;var i=Dee(e.label,t);return[i].concat(Eee(a))}rs.renderCallByParent=Ree;function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function Zy(){return Zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zy.apply(this,arguments)}function Qk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qk(Object(r),!0).forEach(function(n){Mee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mee(e,t,r){return t=$ee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ee(e){var t=Lee(e,"string");return mf(t)=="symbol"?t:t+""}function Lee(e,t){if(mf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bee=function(t,r){var n=pa(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},Xd=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,s=t.sign,o=t.isExternal,l=t.cornerRadius,c=t.cornerIsExternal,u=l*(o?1:-1)+a,f=Math.asin(l/u)/jh,d=c?i:i+s*f,h=Or(r,n,u,d),m=Or(r,n,a,d),p=c?i-s*f:i,g=Or(r,n,u*Math.cos(f*jh),p);return{center:h,circleTangency:m,lineTangency:g,theta:f}},Yj=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.startAngle,o=t.endAngle,l=Bee(s,o),c=s+l,u=Or(r,n,i,s),f=Or(r,n,i,c),d="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(s>c),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var h=Or(r,n,a,s),m=Or(r,n,a,c);d+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(s<=c),`,
            `).concat(h.x,",").concat(h.y," Z")}else d+="L ".concat(r,",").concat(n," Z");return d},Uee=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.cornerRadius,o=t.forceCornerRadius,l=t.cornerIsExternal,c=t.startAngle,u=t.endAngle,f=pa(u-c),d=Xd({cx:r,cy:n,radius:i,angle:c,sign:f,cornerRadius:s,cornerIsExternal:l}),h=d.circleTangency,m=d.lineTangency,p=d.theta,g=Xd({cx:r,cy:n,radius:i,angle:u,sign:-f,cornerRadius:s,cornerIsExternal:l}),x=g.circleTangency,w=g.lineTangency,y=g.theta,k=l?Math.abs(c-u):Math.abs(c-u)-p-y;if(k<0)return o?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):Yj({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:c,endAngle:u});var b="M ".concat(m.x,",").concat(m.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(k>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(w.x,",").concat(w.y,`
  `);if(a>0){var _=Xd({cx:r,cy:n,radius:a,angle:c,sign:f,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),S=_.circleTangency,E=_.lineTangency,T=_.theta,F=Xd({cx:r,cy:n,radius:a,angle:u,sign:-f,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),C=F.circleTangency,A=F.lineTangency,M=F.theta,V=l?Math.abs(c-u):Math.abs(c-u)-T-M;if(V<0&&s===0)return"".concat(b,"L").concat(r,",").concat(n,"Z");b+="L".concat(A.x,",").concat(A.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(C.x,",").concat(C.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(V>180),",").concat(+(f>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(E.x,",").concat(E.y,"Z")}else b+="L".concat(r,",").concat(n,"Z");return b},Wee={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Jj=function(t){var r=Zk(Zk({},Wee),t),n=r.cx,a=r.cy,i=r.innerRadius,s=r.outerRadius,o=r.cornerRadius,l=r.forceCornerRadius,c=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,d=r.className;if(s<i||u===f)return null;var h=ot("recharts-sector",d),m=s-i,p=to(o,m,0,!0),g;return p>0&&Math.abs(u-f)<360?g=Uee({cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(p,m/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:f}):g=Yj({cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:u,endAngle:f}),Z.createElement("path",Zy({},nt(r,!0),{className:h,d:g,role:"img"}))};function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function ex(){return ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ex.apply(this,arguments)}function eE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eE(Object(r),!0).forEach(function(n){zee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zee(e,t,r){return t=Hee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hee(e){var t=Vee(e,"string");return vf(t)=="symbol"?t:t+""}function Vee(e,t){if(vf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rE={curveBasisClosed:z7,curveBasisOpen:H7,curveBasis:W7,curveBumpX:O7,curveBumpY:C7,curveLinearClosed:V7,curveLinear:Qp,curveMonotoneX:G7,curveMonotoneY:K7,curveNatural:q7,curveStep:X7,curveStepAfter:J7,curveStepBefore:Y7},Yd=function(t){return t.x===+t.x&&t.y===+t.y},Wc=function(t){return t.x},zc=function(t){return t.y},Gee=function(t,r){if(Je(t))return t;var n="curve".concat(Yp(t));return(n==="curveMonotone"||n==="curveBump")&&r?rE["".concat(n).concat(r==="vertical"?"Y":"X")]:rE[n]||Qp},Kee=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,s=t.baseLine,o=t.layout,l=t.connectNulls,c=l===void 0?!1:l,u=Gee(n,o),f=c?i.filter(function(p){return Yd(p)}):i,d;if(Array.isArray(s)){var h=c?s.filter(function(p){return Yd(p)}):s,m=f.map(function(p,g){return tE(tE({},p),{},{base:h[g]})});return o==="vertical"?d=Bd().y(zc).x1(Wc).x0(function(p){return p.base.x}):d=Bd().x(Wc).y1(zc).y0(function(p){return p.base.y}),d.defined(Yd).curve(u),d(m)}return o==="vertical"&&Oe(s)?d=Bd().y(zc).x1(Wc).x0(s):Oe(s)?d=Bd().x(Wc).y1(zc).y0(s):d=JP().x(Wc).y(zc),d.defined(Yd).curve(u),d(f)},tx=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var s=n&&n.length?Kee(t):a;return R.createElement("path",ex({},nt(t,!1),eh(t),{className:ot("recharts-curve",r),d:s,ref:i}))},Qj={exports:{}},qee="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Xee=qee,Yee=Xee;function Zj(){}function e3(){}e3.resetWarningCache=Zj;var Jee=function(){function e(n,a,i,s,o,l){if(l!==Yee){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:e3,resetWarningCache:Zj};return r.PropTypes=r,r};Qj.exports=Jee();var Qee=Qj.exports;const dt=_t(Qee);var Zee=Object.getOwnPropertyNames,ete=Object.getOwnPropertySymbols,tte=Object.prototype.hasOwnProperty;function nE(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function Jd(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,s=i.get(r),o=i.get(n);if(s&&o)return s===n&&o===r;i.set(r,n),i.set(n,r);var l=e(r,n,a);return i.delete(r),i.delete(n),l}}function aE(e){return Zee(e).concat(ete(e))}var rte=Object.hasOwn||function(e,t){return tte.call(e,t)};function yo(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var nte="__v",ate="__o",ite="_owner",iE=Object.getOwnPropertyDescriptor,sE=Object.keys;function ste(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function ote(e,t){return yo(e.getTime(),t.getTime())}function lte(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function cte(e,t){return e===t}function oE(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),s,o,l=0;(s=i.next())&&!s.done;){for(var c=t.entries(),u=!1,f=0;(o=c.next())&&!o.done;){if(a[f]){f++;continue}var d=s.value,h=o.value;if(r.equals(d[0],h[0],l,f,e,t,r)&&r.equals(d[1],h[1],d[0],h[0],e,t,r)){u=a[f]=!0;break}f++}if(!u)return!1;l++}return!0}var ute=yo;function fte(e,t,r){var n=sE(e),a=n.length;if(sE(t).length!==a)return!1;for(;a-- >0;)if(!t3(e,t,r,n[a]))return!1;return!0}function Hc(e,t,r){var n=aE(e),a=n.length;if(aE(t).length!==a)return!1;for(var i,s,o;a-- >0;)if(i=n[a],!t3(e,t,r,i)||(s=iE(e,i),o=iE(t,i),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function dte(e,t){return yo(e.valueOf(),t.valueOf())}function hte(e,t){return e.source===t.source&&e.flags===t.flags}function lE(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),s,o;(s=i.next())&&!s.done;){for(var l=t.values(),c=!1,u=0;(o=l.next())&&!o.done;){if(!a[u]&&r.equals(s.value,o.value,s.value,o.value,e,t,r)){c=a[u]=!0;break}u++}if(!c)return!1}return!0}function pte(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function mte(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function t3(e,t,r,n){return(n===ite||n===ate||n===nte)&&(e.$$typeof||t.$$typeof)?!0:rte(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var vte="[object Arguments]",gte="[object Boolean]",yte="[object Date]",xte="[object Error]",wte="[object Map]",bte="[object Number]",_te="[object Object]",Ste="[object RegExp]",kte="[object Set]",Ete="[object String]",Tte="[object URL]",Ate=Array.isArray,cE=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,uE=Object.assign,Ote=Object.prototype.toString.call.bind(Object.prototype.toString);function Cte(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,s=e.areNumbersEqual,o=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,d=e.areUrlsEqual;return function(m,p,g){if(m===p)return!0;if(m==null||p==null)return!1;var x=typeof m;if(x!==typeof p)return!1;if(x!=="object")return x==="number"?s(m,p,g):x==="function"?a(m,p,g):!1;var w=m.constructor;if(w!==p.constructor)return!1;if(w===Object)return o(m,p,g);if(Ate(m))return t(m,p,g);if(cE!=null&&cE(m))return f(m,p,g);if(w===Date)return r(m,p,g);if(w===RegExp)return c(m,p,g);if(w===Map)return i(m,p,g);if(w===Set)return u(m,p,g);var y=Ote(m);return y===yte?r(m,p,g):y===Ste?c(m,p,g):y===wte?i(m,p,g):y===kte?u(m,p,g):y===_te?typeof m.then!="function"&&typeof p.then!="function"&&o(m,p,g):y===Tte?d(m,p,g):y===xte?n(m,p,g):y===vte?o(m,p,g):y===gte||y===bte||y===Ete?l(m,p,g):!1}}function Pte(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Hc:ste,areDatesEqual:ote,areErrorsEqual:lte,areFunctionsEqual:cte,areMapsEqual:n?nE(oE,Hc):oE,areNumbersEqual:ute,areObjectsEqual:n?Hc:fte,arePrimitiveWrappersEqual:dte,areRegExpsEqual:hte,areSetsEqual:n?nE(lE,Hc):lE,areTypedArraysEqual:n?Hc:pte,areUrlsEqual:mte};if(r&&(a=uE({},a,r(a))),t){var i=Jd(a.areArraysEqual),s=Jd(a.areMapsEqual),o=Jd(a.areObjectsEqual),l=Jd(a.areSetsEqual);a=uE({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:l})}return a}function jte(e){return function(t,r,n,a,i,s,o){return e(t,r,o)}}function Nte(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(l,c){var u=n(),f=u.cache,d=f===void 0?t?new WeakMap:void 0:f,h=u.meta;return r(l,c,{cache:d,equals:a,meta:h,strict:i})};if(t)return function(l,c){return r(l,c,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(l,c){return r(l,c,s)}}var Fte=gs();gs({strict:!0});gs({circular:!0});gs({circular:!0,strict:!0});gs({createInternalComparator:function(){return yo}});gs({strict:!0,createInternalComparator:function(){return yo}});gs({circular:!0,createInternalComparator:function(){return yo}});gs({circular:!0,createInternalComparator:function(){return yo},strict:!0});function gs(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,s=i===void 0?!1:i,o=Pte(e),l=Cte(o),c=n?n(l):jte(l);return Nte({circular:r,comparator:l,createState:a,equals:c,strict:s})}function Ite(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function fE(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):Ite(a)};requestAnimationFrame(n)}function rx(e){"@babel/helpers - typeof";return rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rx(e)}function Dte(e){return Lte(e)||$te(e)||Mte(e)||Rte()}function Rte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mte(e,t){if(e){if(typeof e=="string")return dE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dE(e,t)}}function dE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $te(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lte(e){if(Array.isArray(e))return e}function Bte(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var s=i,o=Dte(s),l=o[0],c=o.slice(1);if(typeof l=="number"){fE(a.bind(null,c),l);return}a(l),fE(a.bind(null,c));return}rx(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function hE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hE(Object(r),!0).forEach(function(n){r3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r3(e,t,r){return t=Ute(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ute(e){var t=Wte(e,"string");return gf(t)==="symbol"?t:String(t)}function Wte(e,t){if(gf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zte=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},Hte=function(t){return t},Vte=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},wu=function(t,r){return Object.keys(r).reduce(function(n,a){return pE(pE({},n),{},r3({},a,t(a,r[a])))},{})},mE=function(t,r,n){return t.map(function(a){return"".concat(Vte(a)," ").concat(r,"ms ").concat(n)}).join(",")};function Gte(e,t){return Xte(e)||qte(e,t)||n3(e,t)||Kte()}function Kte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qte(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function Xte(e){if(Array.isArray(e))return e}function Yte(e){return Zte(e)||Qte(e)||n3(e)||Jte()}function Jte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n3(e,t){if(e){if(typeof e=="string")return nx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nx(e,t)}}function Qte(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zte(e){if(Array.isArray(e))return nx(e)}function nx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Fh=1e-4,a3=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},i3=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},vE=function(t,r){return function(n){var a=a3(t,r);return i3(a,n)}},ere=function(t,r){return function(n){var a=a3(t,r),i=[].concat(Yte(a.map(function(s,o){return s*o}).slice(1)),[0]);return i3(i,n)}},gE=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],s=r[2],o=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,s=1,o=1;break;case"ease":a=.25,i=.1,s=.25,o=1;break;case"ease-in":a=.42,i=0,s=1,o=1;break;case"ease-out":a=.42,i=0,s=.58,o=1;break;case"ease-in-out":a=0,i=0,s=.58,o=1;break;default:{var l=r[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var c=l[1].split(")")[0].split(",").map(function(g){return parseFloat(g)}),u=Gte(c,4);a=u[0],i=u[1],s=u[2],o=u[3]}}}var f=vE(a,s),d=vE(i,o),h=ere(a,s),m=function(x){return x>1?1:x<0?0:x},p=function(x){for(var w=x>1?1:x,y=w,k=0;k<8;++k){var b=f(y)-w,_=h(y);if(Math.abs(b-w)<Fh||_<Fh)return d(y);y=m(y-b/_)}return d(y)};return p.isStepper=!1,p},tre=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,s=t.dt,o=s===void 0?17:s,l=function(u,f,d){var h=-(u-f)*n,m=d*i,p=d+(h-m)*o/1e3,g=d*o/1e3+u;return Math.abs(g-f)<Fh&&Math.abs(p)<Fh?[f,0]:[g,p]};return l.isStepper=!0,l.dt=o,l},rre=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return gE(a);case"spring":return tre();default:if(a.split("(")[0]==="cubic-bezier")return gE(a)}return typeof a=="function"?a:null};function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function yE(e){return ire(e)||are(e)||s3(e)||nre()}function nre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function are(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ire(e){if(Array.isArray(e))return ix(e)}function xE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xE(Object(r),!0).forEach(function(n){ax(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ax(e,t,r){return t=sre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sre(e){var t=ore(e,"string");return yf(t)==="symbol"?t:String(t)}function ore(e,t){if(yf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lre(e,t){return fre(e)||ure(e,t)||s3(e,t)||cre()}function cre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s3(e,t){if(e){if(typeof e=="string")return ix(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ix(e,t)}}function ix(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ure(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function fre(e){if(Array.isArray(e))return e}var Ih=function(t,r,n){return t+(r-t)*n},sx=function(t){var r=t.from,n=t.to;return r!==n},dre=function e(t,r,n){var a=wu(function(i,s){if(sx(s)){var o=t(s.from,s.to,s.velocity),l=lre(o,2),c=l[0],u=l[1];return kr(kr({},s),{},{from:c,velocity:u})}return s},r);return n<1?wu(function(i,s){return sx(s)?kr(kr({},s),{},{velocity:Ih(s.velocity,a[i].velocity,n),from:Ih(s.from,a[i].from,n)}):s},r):e(t,a,n-1)};const hre=function(e,t,r,n,a){var i=zte(e,t),s=i.reduce(function(g,x){return kr(kr({},g),{},ax({},x,[e[x],t[x]]))},{}),o=i.reduce(function(g,x){return kr(kr({},g),{},ax({},x,{from:e[x],velocity:0,to:t[x]}))},{}),l=-1,c,u,f=function(){return null},d=function(){return wu(function(x,w){return w.from},o)},h=function(){return!Object.values(o).filter(sx).length},m=function(x){c||(c=x);var w=x-c,y=w/r.dt;o=dre(r,o,y),a(kr(kr(kr({},e),t),d())),c=x,h()||(l=requestAnimationFrame(f))},p=function(x){u||(u=x);var w=(x-u)/n,y=wu(function(b,_){return Ih.apply(void 0,yE(_).concat([r(w)]))},s);if(a(kr(kr(kr({},e),t),y)),w<1)l=requestAnimationFrame(f);else{var k=wu(function(b,_){return Ih.apply(void 0,yE(_).concat([r(1)]))},s);a(kr(kr(kr({},e),t),k))}};return f=r.isStepper?m:p,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(l)}}};function Dl(e){"@babel/helpers - typeof";return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dl(e)}var pre=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function mre(e,t){if(e==null)return{};var r=vre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vre(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Iv(e){return wre(e)||xre(e)||yre(e)||gre()}function gre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yre(e,t){if(e){if(typeof e=="string")return ox(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ox(e,t)}}function xre(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wre(e){if(Array.isArray(e))return ox(e)}function ox(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function na(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wE(Object(r),!0).forEach(function(n){tu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tu(e,t,r){return t=o3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o3(n.key),n)}}function Sre(e,t,r){return t&&_re(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function o3(e){var t=kre(e,"string");return Dl(t)==="symbol"?t:String(t)}function kre(e,t){if(Dl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ere(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lx(e,t)}function lx(e,t){return lx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},lx(e,t)}function Tre(e){var t=Are();return function(){var n=Dh(e),a;if(t){var i=Dh(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return cx(this,a)}}function cx(e,t){if(t&&(Dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ux(e)}function ux(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Are(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Dh(e){return Dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dh(e)}var vi=function(e){Ere(r,e);var t=Tre(r);function r(n,a){var i;bre(this,r),i=t.call(this,n,a);var s=i.props,o=s.isActive,l=s.attributeName,c=s.from,u=s.to,f=s.steps,d=s.children,h=s.duration;if(i.handleStyleChange=i.handleStyleChange.bind(ux(i)),i.changeStyle=i.changeStyle.bind(ux(i)),!o||h<=0)return i.state={style:{}},typeof d=="function"&&(i.state={style:u}),cx(i);if(f&&f.length)i.state={style:f[0].style};else if(c){if(typeof d=="function")return i.state={style:c},cx(i);i.state={style:l?tu({},l,c):c}}else i.state={style:{}};return i}return Sre(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,s=a.canBegin;this.mounted=!0,!(!i||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,s=i.isActive,o=i.canBegin,l=i.attributeName,c=i.shouldReAnimate,u=i.to,f=i.from,d=this.state.style;if(o){if(!s){var h={style:l?tu({},l,u):u};this.state&&d&&(l&&d[l]!==u||!l&&d!==u)&&this.setState(h);return}if(!(Fte(a.to,u)&&a.canBegin&&a.isActive)){var m=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var p=m||c?f:a.to;if(this.state&&d){var g={style:l?tu({},l,p):p};(l&&d[l]!==p||!l&&d!==p)&&this.setState(g)}this.runAnimation(na(na({},this.props),{},{from:p,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,s=a.from,o=a.to,l=a.duration,c=a.easing,u=a.begin,f=a.onAnimationEnd,d=a.onAnimationStart,h=hre(s,o,rre(c),l,this.changeStyle),m=function(){i.stopJSAnimation=h()};this.manager.start([d,u,m,l,f])}},{key:"runStepAnimation",value:function(a){var i=this,s=a.steps,o=a.begin,l=a.onAnimationStart,c=s[0],u=c.style,f=c.duration,d=f===void 0?0:f,h=function(p,g,x){if(x===0)return p;var w=g.duration,y=g.easing,k=y===void 0?"ease":y,b=g.style,_=g.properties,S=g.onAnimationEnd,E=x>0?s[x-1]:g,T=_||Object.keys(b);if(typeof k=="function"||k==="spring")return[].concat(Iv(p),[i.runJSAnimation.bind(i,{from:E.style,to:b,duration:w,easing:k}),w]);var F=mE(T,w,k),C=na(na(na({},E.style),b),{},{transition:F});return[].concat(Iv(p),[C,w,S]).filter(Hte)};return this.manager.start([l].concat(Iv(s.reduce(h,[u,Math.max(d,o)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=Bte());var i=a.begin,s=a.duration,o=a.attributeName,l=a.to,c=a.easing,u=a.onAnimationStart,f=a.onAnimationEnd,d=a.steps,h=a.children,m=this.manager;if(this.unSubscribe=m.subscribe(this.handleStyleChange),typeof c=="function"||typeof h=="function"||c==="spring"){this.runJSAnimation(a);return}if(d.length>1){this.runStepAnimation(a);return}var p=o?tu({},o,l):l,g=mE(Object.keys(p),s,c);m.start([u,i,na(na({},p),{},{transition:g}),s,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var s=a.duration;a.attributeName,a.easing;var o=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var l=mre(a,pre),c=R.Children.count(i),u=this.state.style;if(typeof i=="function")return i(u);if(!o||c===0||s<=0)return i;var f=function(h){var m=h.props,p=m.style,g=p===void 0?{}:p,x=m.className,w=R.cloneElement(h,na(na({},l),{},{style:na(na({},g),u),className:x}));return w};return c===1?f(R.Children.only(i)):Z.createElement("div",null,R.Children.map(i,function(d){return f(d)}))}}]),r}(R.PureComponent);vi.displayName="Animate";vi.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};vi.propTypes={from:dt.oneOfType([dt.object,dt.string]),to:dt.oneOfType([dt.object,dt.string]),attributeName:dt.string,duration:dt.number,begin:dt.number,easing:dt.oneOfType([dt.string,dt.func]),steps:dt.arrayOf(dt.shape({duration:dt.number.isRequired,style:dt.object.isRequired,easing:dt.oneOfType([dt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),dt.func]),properties:dt.arrayOf("string"),onAnimationEnd:dt.func})),children:dt.oneOfType([dt.node,dt.func]),isActive:dt.bool,canBegin:dt.bool,onAnimationEnd:dt.func,shouldReAnimate:dt.bool,onAnimationStart:dt.func,onAnimationReStart:dt.func};function xf(e){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(e)}function Rh(){return Rh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rh.apply(this,arguments)}function Ore(e,t){return Nre(e)||jre(e,t)||Pre(e,t)||Cre()}function Cre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pre(e,t){if(e){if(typeof e=="string")return bE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bE(e,t)}}function bE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function Nre(e){if(Array.isArray(e))return e}function _E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function SE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_E(Object(r),!0).forEach(function(n){Fre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_E(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fre(e,t,r){return t=Ire(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ire(e){var t=Dre(e,"string");return xf(t)=="symbol"?t:t+""}function Dre(e,t){if(xf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kE=function(t,r,n,a,i){var s=Math.min(Math.abs(n)/2,Math.abs(a)/2),o=a>=0?1:-1,l=n>=0?1:-1,c=a>=0&&n>=0||a<0&&n<0?1:0,u;if(s>0&&i instanceof Array){for(var f=[0,0,0,0],d=0,h=4;d<h;d++)f[d]=i[d]>s?s:i[d];u="M".concat(t,",").concat(r+o*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(c,",").concat(t+l*f[0],",").concat(r)),u+="L ".concat(t+n-l*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(c,`,
        `).concat(t+n,",").concat(r+o*f[1])),u+="L ".concat(t+n,",").concat(r+a-o*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(c,`,
        `).concat(t+n-l*f[2],",").concat(r+a)),u+="L ".concat(t+l*f[3],",").concat(r+a),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(c,`,
        `).concat(t,",").concat(r+a-o*f[3])),u+="Z"}else if(s>0&&i===+i&&i>0){var m=Math.min(s,i);u="M ".concat(t,",").concat(r+o*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(t+l*m,",").concat(r,`
            L `).concat(t+n-l*m,",").concat(r,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(t+n,",").concat(r+o*m,`
            L `).concat(t+n,",").concat(r+a-o*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(t+n-l*m,",").concat(r+a,`
            L `).concat(t+l*m,",").concat(r+a,`
            A `).concat(m,",").concat(m,",0,0,").concat(c,",").concat(t,",").concat(r+a-o*m," Z")}else u="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return u},Rre=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,s=r.y,o=r.width,l=r.height;if(Math.abs(o)>0&&Math.abs(l)>0){var c=Math.min(i,i+o),u=Math.max(i,i+o),f=Math.min(s,s+l),d=Math.max(s,s+l);return n>=c&&n<=u&&a>=f&&a<=d}return!1},Mre={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Hw=function(t){var r=SE(SE({},Mre),t),n=R.useRef(),a=R.useState(-1),i=Ore(a,2),s=i[0],o=i[1];R.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var k=n.current.getTotalLength();k&&o(k)}catch{}},[]);var l=r.x,c=r.y,u=r.width,f=r.height,d=r.radius,h=r.className,m=r.animationEasing,p=r.animationDuration,g=r.animationBegin,x=r.isAnimationActive,w=r.isUpdateAnimationActive;if(l!==+l||c!==+c||u!==+u||f!==+f||u===0||f===0)return null;var y=ot("recharts-rectangle",h);return w?Z.createElement(vi,{canBegin:s>0,from:{width:u,height:f,x:l,y:c},to:{width:u,height:f,x:l,y:c},duration:p,animationEasing:m,isActive:w},function(k){var b=k.width,_=k.height,S=k.x,E=k.y;return Z.createElement(vi,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,isActive:x,easing:m},Z.createElement("path",Rh({},nt(r,!0),{className:y,d:kE(S,E,b,_,d),ref:n})))}):Z.createElement("path",Rh({},nt(r,!0),{className:y,d:kE(l,c,u,f,d)}))};function fx(){return fx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fx.apply(this,arguments)}var Vw=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,s=ot("recharts-dot",i);return r===+r&&n===+n&&a===+a?R.createElement("circle",fx({},nt(t,!1),eh(t),{className:s,cx:r,cy:n,r:a})):null};function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}var $re=["x","y","top","left","width","height","className"];function dx(){return dx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dx.apply(this,arguments)}function EE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EE(Object(r),!0).forEach(function(n){Bre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bre(e,t,r){return t=Ure(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ure(e){var t=Wre(e,"string");return wf(t)=="symbol"?t:t+""}function Wre(e,t){if(wf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zre(e,t){if(e==null)return{};var r=Hre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Hre(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Vre=function(t,r,n,a,i,s){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(s,",").concat(r,"h").concat(n)},Gre=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.top,o=s===void 0?0:s,l=t.left,c=l===void 0?0:l,u=t.width,f=u===void 0?0:u,d=t.height,h=d===void 0?0:d,m=t.className,p=zre(t,$re),g=Lre({x:n,y:i,top:o,left:c,width:f,height:h},p);return!Oe(n)||!Oe(i)||!Oe(f)||!Oe(h)||!Oe(o)||!Oe(c)?null:Z.createElement("path",dx({},nt(g,!0),{className:ot("recharts-cross",m),d:Vre(n,i,f,h,o,c)}))},Kre=b4,qre=Kre(Object.getPrototypeOf,Object),Xre=qre,Yre=wi,Jre=Xre,Qre=bi,Zre="[object Object]",ene=Function.prototype,tne=Object.prototype,l3=ene.toString,rne=tne.hasOwnProperty,nne=l3.call(Object);function ane(e){if(!Qre(e)||Yre(e)!=Zre)return!1;var t=Jre(e);if(t===null)return!0;var r=rne.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&l3.call(r)==nne}var ine=ane;const sne=_t(ine);var one=wi,lne=bi,cne="[object Boolean]";function une(e){return e===!0||e===!1||lne(e)&&one(e)==cne}var fne=une;const dne=_t(fne);function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function Mh(){return Mh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Mh.apply(this,arguments)}function hne(e,t){return gne(e)||vne(e,t)||mne(e,t)||pne()}function pne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mne(e,t){if(e){if(typeof e=="string")return TE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TE(e,t)}}function TE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vne(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function gne(e){if(Array.isArray(e))return e}function AE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function OE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AE(Object(r),!0).forEach(function(n){yne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yne(e,t,r){return t=xne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xne(e){var t=wne(e,"string");return bf(t)=="symbol"?t:t+""}function wne(e,t){if(bf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CE=function(t,r,n,a,i){var s=n-a,o;return o="M ".concat(t,",").concat(r),o+="L ".concat(t+n,",").concat(r),o+="L ".concat(t+n-s/2,",").concat(r+i),o+="L ".concat(t+n-s/2-a,",").concat(r+i),o+="L ".concat(t,",").concat(r," Z"),o},bne={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},_ne=function(t){var r=OE(OE({},bne),t),n=R.useRef(),a=R.useState(-1),i=hne(a,2),s=i[0],o=i[1];R.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var y=n.current.getTotalLength();y&&o(y)}catch{}},[]);var l=r.x,c=r.y,u=r.upperWidth,f=r.lowerWidth,d=r.height,h=r.className,m=r.animationEasing,p=r.animationDuration,g=r.animationBegin,x=r.isUpdateAnimationActive;if(l!==+l||c!==+c||u!==+u||f!==+f||d!==+d||u===0&&f===0||d===0)return null;var w=ot("recharts-trapezoid",h);return x?Z.createElement(vi,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:d,x:l,y:c},to:{upperWidth:u,lowerWidth:f,height:d,x:l,y:c},duration:p,animationEasing:m,isActive:x},function(y){var k=y.upperWidth,b=y.lowerWidth,_=y.height,S=y.x,E=y.y;return Z.createElement(vi,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,easing:m},Z.createElement("path",Mh({},nt(r,!0),{className:w,d:CE(S,E,k,b,_),ref:n})))}):Z.createElement("g",null,Z.createElement("path",Mh({},nt(r,!0),{className:w,d:CE(l,c,u,f,d)})))},Sne=["option","shapeType","propTransformer","activeClassName","isActive"];function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}function kne(e,t){if(e==null)return{};var r=Ene(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ene(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function PE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $h(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PE(Object(r),!0).forEach(function(n){Tne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tne(e,t,r){return t=Ane(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ane(e){var t=One(e,"string");return _f(t)=="symbol"?t:t+""}function One(e,t){if(_f(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_f(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cne(e,t){return $h($h({},t),e)}function Pne(e,t){return e==="symbols"}function jE(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Z.createElement(Hw,r);case"trapezoid":return Z.createElement(_ne,r);case"sector":return Z.createElement(Jj,r);case"symbols":if(Pne(t))return Z.createElement(cw,r);break;default:return null}}function jne(e){return R.isValidElement(e)?e.props:e}function Nne(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?Cne:n,i=e.activeClassName,s=i===void 0?"recharts-active-shape":i,o=e.isActive,l=kne(e,Sne),c;if(R.isValidElement(t))c=R.cloneElement(t,$h($h({},l),jne(t)));else if(Je(t))c=t(l);else if(sne(t)&&!dne(t)){var u=a(t,l);c=Z.createElement(jE,{shapeType:r,elementProps:u})}else{var f=l;c=Z.createElement(jE,{shapeType:r,elementProps:f})}return o?Z.createElement(Yt,{className:s},c):c}function pm(e,t){return t!=null&&"trapezoids"in e.props}function mm(e,t){return t!=null&&"sectors"in e.props}function Sf(e,t){return t!=null&&"points"in e.props}function Fne(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function Ine(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function Dne(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function Rne(e,t){var r;return pm(e,t)?r=Fne:mm(e,t)?r=Ine:Sf(e,t)&&(r=Dne),r}function Mne(e,t){var r;return pm(e,t)?r="trapezoids":mm(e,t)?r="sectors":Sf(e,t)&&(r="points"),r}function $ne(e,t){if(pm(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(mm(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Sf(e,t)?t.payload:{}}function Lne(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=Mne(r,t),i=$ne(r,t),s=n.filter(function(l,c){var u=fm(i,l),f=r.props[a].filter(function(m){var p=Rne(r,t);return p(m,t)}),d=r.props[a].indexOf(f[f.length-1]),h=c===d;return u&&h}),o=n.indexOf(s[s.length-1]);return o}var Bne=Math.ceil,Une=Math.max;function Wne(e,t,r,n){for(var a=-1,i=Une(Bne((t-e)/(r||1)),0),s=Array(i);i--;)s[n?i:++a]=e,e+=r;return s}var zne=Wne,Hne=B4,NE=1/0,Vne=17976931348623157e292;function Gne(e){if(!e)return e===0?e:0;if(e=Hne(e),e===NE||e===-NE){var t=e<0?-1:1;return t*Vne}return e===e?e:0}var c3=Gne,Kne=zne,qne=rm,Dv=c3;function Xne(e){return function(t,r,n){return n&&typeof n!="number"&&qne(t,r,n)&&(r=n=void 0),t=Dv(t),r===void 0?(r=t,t=0):r=Dv(r),n=n===void 0?t<r?1:-1:Dv(n),Kne(t,r,n,e)}}var Yne=Xne,Jne=Yne,Qne=Jne(),Zne=Qne;const Lh=_t(Zne);function kf(e){"@babel/helpers - typeof";return kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kf(e)}function FE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function IE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FE(Object(r),!0).forEach(function(n){u3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u3(e,t,r){return t=eae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eae(e){var t=tae(e,"string");return kf(t)=="symbol"?t:t+""}function tae(e,t){if(kf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rae=["Webkit","Moz","O","ms"],nae=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=rae.reduce(function(i,s){return IE(IE({},i),{},u3({},s+n,r))},{});return a[t]=r,a};function Rl(e){"@babel/helpers - typeof";return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(e)}function Bh(){return Bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bh.apply(this,arguments)}function DE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DE(Object(r),!0).forEach(function(n){vn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function RE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d3(n.key),n)}}function iae(e,t,r){return t&&RE(e.prototype,t),r&&RE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sae(e,t,r){return t=Uh(t),oae(e,f3()?Reflect.construct(t,r||[],Uh(e).constructor):t.apply(e,r))}function oae(e,t){if(t&&(Rl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lae(e)}function lae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f3=function(){return!!e})()}function Uh(e){return Uh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Uh(e)}function cae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hx(e,t)}function hx(e,t){return hx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},hx(e,t)}function vn(e,t,r){return t=d3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d3(e){var t=uae(e,"string");return Rl(t)=="symbol"?t:t+""}function uae(e,t){if(Rl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var fae=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,s=t.width,o=t.travellerWidth;if(!r||!r.length)return{};var l=r.length,c=yu().domain(Lh(0,l)).range([i,i+s-o]),u=c.domain().map(function(f){return c(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(n),endX:c(a),scale:c,scaleValues:u}},ME=function(t){return t.changedTouches&&!!t.changedTouches.length},Ml=function(e){function t(r){var n;return aae(this,t),n=sae(this,t,[r]),vn(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),vn(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),vn(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,s=a.onDragEnd,o=a.startIndex;s==null||s({endIndex:i,startIndex:o})}),n.detachDragEndListener()}),vn(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),vn(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),vn(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),vn(n,"handleSlideDragStart",function(a){var i=ME(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return cae(t,e),iae(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,s=this.state.scaleValues,o=this.props,l=o.gap,c=o.data,u=c.length-1,f=Math.min(a,i),d=Math.max(a,i),h=t.getIndexInRange(s,f),m=t.getIndexInRange(s,d);return{startIndex:h-h%l,endIndex:m===u?u:m-m%l}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,s=a.tickFormatter,o=a.dataKey,l=On(i[n],o,n);return Je(s)?s(l,n):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,s=a.startX,o=a.endX,l=this.props,c=l.x,u=l.width,f=l.travellerWidth,d=l.startIndex,h=l.endIndex,m=l.onChange,p=n.pageX-i;p>0?p=Math.min(p,c+u-f-o,c+u-f-s):p<0&&(p=Math.max(p,c-s,c-o));var g=this.getIndex({startX:s+p,endX:o+p});(g.startIndex!==d||g.endIndex!==h)&&m&&m(g),this.setState({startX:s+p,endX:o+p,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=ME(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,s=a.movingTravellerId,o=a.endX,l=a.startX,c=this.state[s],u=this.props,f=u.x,d=u.width,h=u.travellerWidth,m=u.onChange,p=u.gap,g=u.data,x={startX:this.state.startX,endX:this.state.endX},w=n.pageX-i;w>0?w=Math.min(w,f+d-h-c):w<0&&(w=Math.max(w,f-c)),x[s]=c+w;var y=this.getIndex(x),k=y.startIndex,b=y.endIndex,_=function(){var E=g.length-1;return s==="startX"&&(o>l?k%p===0:b%p===0)||o<l&&b===E||s==="endX"&&(o>l?b%p===0:k%p===0)||o>l&&b===E};this.setState(vn(vn({},s,c+w),"brushMoveStartX",n.pageX),function(){m&&_()&&m(y)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,s=this.state,o=s.scaleValues,l=s.startX,c=s.endX,u=this.state[a],f=o.indexOf(u);if(f!==-1){var d=f+n;if(!(d===-1||d>=o.length)){var h=o[d];a==="startX"&&h>=c||a==="endX"&&h<=l||this.setState(vn({},a,h),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,l=n.fill,c=n.stroke;return Z.createElement("rect",{stroke:c,fill:l,x:a,y:i,width:s,height:o})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,l=n.data,c=n.children,u=n.padding,f=R.Children.only(c);return f?Z.cloneElement(f,{x:a,y:i,width:s,height:o,margin:u,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,s,o=this,l=this.props,c=l.y,u=l.travellerWidth,f=l.height,d=l.traveller,h=l.ariaLabel,m=l.data,p=l.startIndex,g=l.endIndex,x=Math.max(n,this.props.x),w=Rv(Rv({},nt(this.props,!1)),{},{x,y:c,width:u,height:f}),y=h||"Min value: ".concat((i=m[p])===null||i===void 0?void 0:i.name,", Max value: ").concat((s=m[g])===null||s===void 0?void 0:s.name);return Z.createElement(Yt,{tabIndex:0,role:"slider","aria-label":y,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(b){["ArrowLeft","ArrowRight"].includes(b.key)&&(b.preventDefault(),b.stopPropagation(),o.handleTravellerMoveKeyboard(b.key==="ArrowRight"?1:-1,a))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(d,w))}},{key:"renderSlide",value:function(n,a){var i=this.props,s=i.y,o=i.height,l=i.stroke,c=i.travellerWidth,u=Math.min(n,a)+c,f=Math.max(Math.abs(a-n)-c,0);return Z.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:u,y:s,width:f,height:o})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,s=n.y,o=n.height,l=n.travellerWidth,c=n.stroke,u=this.state,f=u.startX,d=u.endX,h=5,m={pointerEvents:"none",fill:c};return Z.createElement(Yt,{className:"recharts-brush-texts"},Z.createElement(vh,Bh({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,d)-h,y:s+o/2},m),this.getTextOfTick(a)),Z.createElement(vh,Bh({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,d)+l+h,y:s+o/2},m),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,s=n.children,o=n.x,l=n.y,c=n.width,u=n.height,f=n.alwaysShowText,d=this.state,h=d.startX,m=d.endX,p=d.isTextActive,g=d.isSlideMoving,x=d.isTravellerMoving,w=d.isTravellerFocused;if(!a||!a.length||!Oe(o)||!Oe(l)||!Oe(c)||!Oe(u)||c<=0||u<=0)return null;var y=ot("recharts-brush",i),k=Z.Children.count(s)===1,b=nae("userSelect","none");return Z.createElement(Yt,{className:y,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:b},this.renderBackground(),k&&this.renderPanorama(),this.renderSlide(h,m),this.renderTravellerLayer(h,"startX"),this.renderTravellerLayer(m,"endX"),(p||g||x||w||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,s=n.width,o=n.height,l=n.stroke,c=Math.floor(i+o/2)-1;return Z.createElement(Z.Fragment,null,Z.createElement("rect",{x:a,y:i,width:s,height:o,fill:l,stroke:"none"}),Z.createElement("line",{x1:a+1,y1:c,x2:a+s-1,y2:c,fill:"none",stroke:"#fff"}),Z.createElement("line",{x1:a+1,y1:c+2,x2:a+s-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return Z.isValidElement(n)?i=Z.cloneElement(n,a):Je(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,s=n.width,o=n.x,l=n.travellerWidth,c=n.updateId,u=n.startIndex,f=n.endIndex;if(i!==a.prevData||c!==a.prevUpdateId)return Rv({prevData:i,prevTravellerWidth:l,prevUpdateId:c,prevX:o,prevWidth:s},i&&i.length?fae({data:i,width:s,x:o,travellerWidth:l,startIndex:u,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(s!==a.prevWidth||o!==a.prevX||l!==a.prevTravellerWidth)){a.scale.range([o,o+s-l]);var d=a.scale.domain().map(function(h){return a.scale(h)});return{prevData:i,prevTravellerWidth:l,prevUpdateId:c,prevX:o,prevWidth:s,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:d}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,s=0,o=i-1;o-s>1;){var l=Math.floor((s+o)/2);n[l]>a?o=l:s=l}return a>=n[o]?o:s}}])}(R.PureComponent);vn(Ml,"displayName","Brush");vn(Ml,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var dae=vw;function hae(e,t){var r;return dae(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var pae=hae,mae=h4,vae=ps,gae=pae,yae=pn,xae=rm;function wae(e,t,r){var n=yae(e)?mae:gae;return r&&xae(e,t,r)&&(t=void 0),n(e,vae(t))}var bae=wae;const _ae=_t(bae);var Ma=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},$E=D4;function Sae(e,t,r){t=="__proto__"&&$E?$E(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var kae=Sae,Eae=kae,Tae=F4,Aae=ps;function Oae(e,t){var r={};return t=Aae(t),Tae(e,function(n,a,i){Eae(r,a,t(n,a,i))}),r}var Cae=Oae;const Pae=_t(Cae);function jae(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var Nae=jae,Fae=vw;function Iae(e,t){var r=!0;return Fae(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var Dae=Iae,Rae=Nae,Mae=Dae,$ae=ps,Lae=pn,Bae=rm;function Uae(e,t,r){var n=Lae(e)?Rae:Mae;return r&&Bae(e,t,r)&&(t=void 0),n(e,$ae(t))}var Wae=Uae;const h3=_t(Wae);var zae=["x","y"];function Ef(e){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(e)}function px(){return px=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},px.apply(this,arguments)}function LE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Vc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LE(Object(r),!0).forEach(function(n){Hae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hae(e,t,r){return t=Vae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vae(e){var t=Gae(e,"string");return Ef(t)=="symbol"?t:t+""}function Gae(e,t){if(Ef(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ef(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kae(e,t){if(e==null)return{};var r=qae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function qae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Xae(e,t){var r=e.x,n=e.y,a=Kae(e,zae),i="".concat(r),s=parseInt(i,10),o="".concat(n),l=parseInt(o,10),c="".concat(t.height||a.height),u=parseInt(c,10),f="".concat(t.width||a.width),d=parseInt(f,10);return Vc(Vc(Vc(Vc(Vc({},t),a),s?{x:s}:{}),l?{y:l}:{}),{},{height:u,width:d,name:t.name,radius:t.radius})}function BE(e){return Z.createElement(Nne,px({shapeType:"rectangle",propTransformer:Xae,activeClassName:"recharts-active-bar"},e))}var Yae=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=Oe(n)||hB(n);return i?t(n,a):(i||no(),r)}},Jae=["value","background"],p3;function $l(e){"@babel/helpers - typeof";return $l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$l(e)}function Qae(e,t){if(e==null)return{};var r=Zae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Zae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Wh(){return Wh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wh.apply(this,arguments)}function UE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UE(Object(r),!0).forEach(function(n){Hi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v3(n.key),n)}}function tie(e,t,r){return t&&WE(e.prototype,t),r&&WE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rie(e,t,r){return t=zh(t),nie(e,m3()?Reflect.construct(t,r||[],zh(e).constructor):t.apply(e,r))}function nie(e,t){if(t&&($l(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aie(e)}function aie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(m3=function(){return!!e})()}function zh(e){return zh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zh(e)}function iie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mx(e,t)}function mx(e,t){return mx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},mx(e,t)}function Hi(e,t,r){return t=v3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v3(e){var t=sie(e,"string");return $l(t)=="symbol"?t:t+""}function sie(e,t){if($l(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($l(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var sd=function(e){function t(){var r;eie(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=rie(this,t,[].concat(a)),Hi(r,"state",{isAnimationFinished:!1}),Hi(r,"id",Zf("recharts-bar-")),Hi(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),s&&s()}),Hi(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),s&&s()}),r}return iie(t,e),tie(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,s=i.shape,o=i.dataKey,l=i.activeIndex,c=i.activeBar,u=nt(this.props,!1);return n&&n.map(function(f,d){var h=d===l,m=h?c:s,p=tr(tr(tr({},u),f),{},{isActive:h,option:m,index:d,dataKey:o,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Z.createElement(Yt,Wh({className:"recharts-bar-rectangle"},th(a.props,f,d),{key:"rectangle-".concat(f==null?void 0:f.x,"-").concat(f==null?void 0:f.y,"-").concat(f==null?void 0:f.value,"-").concat(d)}),Z.createElement(BE,p))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,s=a.layout,o=a.isAnimationActive,l=a.animationBegin,c=a.animationDuration,u=a.animationEasing,f=a.animationId,d=this.state.prevData;return Z.createElement(vi,{begin:l,duration:c,isActive:o,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var m=h.t,p=i.map(function(g,x){var w=d&&d[x];if(w){var y=da(w.x,g.x),k=da(w.y,g.y),b=da(w.width,g.width),_=da(w.height,g.height);return tr(tr({},g),{},{x:y(m),y:k(m),width:b(m),height:_(m)})}if(s==="horizontal"){var S=da(0,g.height),E=S(m);return tr(tr({},g),{},{y:g.y+g.height-E,height:E})}var T=da(0,g.width),F=T(m);return tr(tr({},g),{},{width:F})});return Z.createElement(Yt,null,n.renderRectanglesStatically(p))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,s=this.state.prevData;return i&&a&&a.length&&(!s||!fm(s,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,s=a.dataKey,o=a.activeIndex,l=nt(this.props.background,!1);return i.map(function(c,u){c.value;var f=c.background,d=Qae(c,Jae);if(!f)return null;var h=tr(tr(tr(tr(tr({},d),{},{fill:"#eee"},f),l),th(n.props,c,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:s,index:u,className:"recharts-bar-background-rectangle"});return Z.createElement(BE,Wh({key:"background-bar-".concat(u),option:n.props.background,isActive:u===o},h))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.data,o=i.xAxis,l=i.yAxis,c=i.layout,u=i.children,f=Kn(u,id);if(!f)return null;var d=c==="vertical"?s[0].height/2:s[0].width/2,h=function(g,x){var w=Array.isArray(g.value)?g.value[1]:g.value;return{x:g.x,y:g.y,value:w,errorVal:On(g,x)}},m={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Z.createElement(Yt,m,f.map(function(p){return Z.cloneElement(p,{key:"error-bar-".concat(a,"-").concat(p.props.dataKey),data:s,xAxis:o,yAxis:l,layout:c,offset:d,dataPointFormatter:h})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,s=n.className,o=n.xAxis,l=n.yAxis,c=n.left,u=n.top,f=n.width,d=n.height,h=n.isAnimationActive,m=n.background,p=n.id;if(a||!i||!i.length)return null;var g=this.state.isAnimationFinished,x=ot("recharts-bar",s),w=o&&o.allowDataOverflow,y=l&&l.allowDataOverflow,k=w||y,b=tt(p)?this.id:p;return Z.createElement(Yt,{className:x},w||y?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(b)},Z.createElement("rect",{x:w?c:c-f/2,y:y?u:u-d/2,width:w?f:f*2,height:y?d:d*2}))):null,Z.createElement(Yt,{className:"recharts-bar-rectangles",clipPath:k?"url(#clipPath-".concat(b,")"):null},m?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(k,b),(!h||g)&&rs.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(R.PureComponent);p3=sd;Hi(sd,"displayName","Bar");Hi(sd,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!hc.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Hi(sd,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,s=e.yAxis,o=e.xAxisTicks,l=e.yAxisTicks,c=e.stackedData,u=e.dataStartIndex,f=e.displayedData,d=e.offset,h=RZ(n,r);if(!h)return null;var m=t.layout,p=r.type.defaultProps,g=p!==void 0?tr(tr({},p),r.props):r.props,x=g.dataKey,w=g.children,y=g.minPointSize,k=m==="horizontal"?s:i,b=c?k.scale.domain():null,_=HZ({numericAxis:k}),S=Kn(w,W4),E=f.map(function(T,F){var C,A,M,V,z,Y;c?C=MZ(c[u+F],b):(C=On(T,x),Array.isArray(C)||(C=[_,C]));var J=Yae(y,p3.defaultProps.minPointSize)(C[1],F);if(m==="horizontal"){var Q,j=[s.scale(C[0]),s.scale(C[1])],X=j[0],ee=j[1];A=Uk({axis:i,ticks:o,bandSize:a,offset:h.offset,entry:T,index:F}),M=(Q=ee??X)!==null&&Q!==void 0?Q:void 0,V=h.size;var P=X-ee;if(z=Number.isNaN(P)?0:P,Y={x:A,y:s.y,width:V,height:s.height},Math.abs(J)>0&&Math.abs(z)<Math.abs(J)){var G=pa(z||J)*(Math.abs(J)-Math.abs(z));M-=G,z+=G}}else{var B=[i.scale(C[0]),i.scale(C[1])],q=B[0],ne=B[1];if(A=q,M=Uk({axis:s,ticks:l,bandSize:a,offset:h.offset,entry:T,index:F}),V=ne-q,z=h.size,Y={x:i.x,y:M,width:i.width,height:z},Math.abs(J)>0&&Math.abs(V)<Math.abs(J)){var ye=pa(V||J)*(Math.abs(J)-Math.abs(V));V+=ye}}return tr(tr(tr({},T),{},{x:A,y:M,width:V,height:z,value:c?C:C[1],payload:T,background:Y},S&&S[F]&&S[F].props),{},{tooltipPayload:[qj(r,T)],tooltipPosition:{x:A+V/2,y:M+z/2}})});return tr({data:E,layout:m},d)});function Tf(e){"@babel/helpers - typeof";return Tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tf(e)}function oie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zE(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g3(n.key),n)}}function lie(e,t,r){return t&&zE(e.prototype,t),r&&zE(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function HE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ca(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HE(Object(r),!0).forEach(function(n){vm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vm(e,t,r){return t=g3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g3(e){var t=cie(e,"string");return Tf(t)=="symbol"?t:t+""}function cie(e,t){if(Tf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uie=function(t,r,n,a,i){var s=t.width,o=t.height,l=t.layout,c=t.children,u=Object.keys(r),f={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:o-n.bottom,bottomMirror:o-n.bottom},d=!!yn(c,sd);return u.reduce(function(h,m){var p=r[m],g=p.orientation,x=p.domain,w=p.padding,y=w===void 0?{}:w,k=p.mirror,b=p.reversed,_="".concat(g).concat(k?"Mirror":""),S,E,T,F,C;if(p.type==="number"&&(p.padding==="gap"||p.padding==="no-gap")){var A=x[1]-x[0],M=1/0,V=p.categoricalDomain.sort(vB);if(V.forEach(function(B,q){q>0&&(M=Math.min((B||0)-(V[q-1]||0),M))}),Number.isFinite(M)){var z=M/A,Y=p.layout==="vertical"?n.height:n.width;if(p.padding==="gap"&&(S=z*Y/2),p.padding==="no-gap"){var J=to(t.barCategoryGap,z*Y),Q=z*Y/2;S=Q-J-(Q-J)/Y*J}}}a==="xAxis"?E=[n.left+(y.left||0)+(S||0),n.left+n.width-(y.right||0)-(S||0)]:a==="yAxis"?E=l==="horizontal"?[n.top+n.height-(y.bottom||0),n.top+(y.top||0)]:[n.top+(y.top||0)+(S||0),n.top+n.height-(y.bottom||0)-(S||0)]:E=p.range,b&&(E=[E[1],E[0]]);var j=IZ(p,i,d),X=j.scale,ee=j.realScaleType;X.domain(x).range(E),DZ(X);var P=zZ(X,ca(ca({},p),{},{realScaleType:ee}));a==="xAxis"?(C=g==="top"&&!k||g==="bottom"&&k,T=n.left,F=f[_]-C*p.height):a==="yAxis"&&(C=g==="left"&&!k||g==="right"&&k,T=f[_]-C*p.width,F=n.top);var G=ca(ca(ca({},p),P),{},{realScaleType:ee,x:T,y:F,scale:X,width:a==="xAxis"?n.width:p.width,height:a==="yAxis"?n.height:p.height});return G.bandSize=Ph(G,P),!p.hide&&a==="xAxis"?f[_]+=(C?-1:1)*G.height:p.hide||(f[_]+=(C?-1:1)*G.width),ca(ca({},h),{},vm({},m,G))},{})},y3=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return{x:Math.min(n,i),y:Math.min(a,s),width:Math.abs(i-n),height:Math.abs(s-a)}},fie=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return y3({x:r,y:n},{x:a,y:i})},x3=function(){function e(t){oie(this,e),this.scale=t}return lie(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(r)+o}default:return this.scale(r)}if(a){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+l}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();vm(x3,"EPS",1e-4);var Gw=function(t){var r=Object.keys(t).reduce(function(n,a){return ca(ca({},n),{},vm({},a,x3.create(t[a])))},{});return ca(ca({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,o=i.position;return Pae(a,function(l,c){return r[c].apply(l,{bandAware:s,position:o})})},isInRange:function(a){return h3(a,function(i,s){return r[s].isInRange(i)})}})};function die(e){return(e%180+180)%180}var hie=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=die(a),s=i*Math.PI/180,o=Math.atan(n/r),l=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(l)},pie=ps,mie=ed,vie=em;function gie(e){return function(t,r,n){var a=Object(t);if(!mie(t)){var i=pie(r);t=vie(t),r=function(o){return i(a[o],o,a)}}var s=e(t,r,n);return s>-1?a[i?t[s]:s]:void 0}}var yie=gie,xie=c3;function wie(e){var t=xie(e),r=t%1;return t===t?r?t-r:t:0}var bie=wie,_ie=A4,Sie=ps,kie=bie,Eie=Math.max;function Tie(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:kie(r);return a<0&&(a=Eie(n+a,0)),_ie(e,Sie(t),a)}var Aie=Tie,Oie=yie,Cie=Aie,Pie=Oie(Cie),jie=Pie;const Nie=_t(jie);var Fie=x5(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),Kw=R.createContext(void 0),qw=R.createContext(void 0),w3=R.createContext(void 0),b3=R.createContext({}),_3=R.createContext(void 0),S3=R.createContext(0),k3=R.createContext(0),VE=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,s=t.clipPathId,o=t.children,l=t.width,c=t.height,u=Fie(i);return Z.createElement(Kw.Provider,{value:n},Z.createElement(qw.Provider,{value:a},Z.createElement(b3.Provider,{value:i},Z.createElement(w3.Provider,{value:u},Z.createElement(_3.Provider,{value:s},Z.createElement(S3.Provider,{value:c},Z.createElement(k3.Provider,{value:l},o)))))))},Iie=function(){return R.useContext(_3)},E3=function(t){var r=R.useContext(Kw);r==null&&no();var n=r[t];return n==null&&no(),n},Die=function(){var t=R.useContext(Kw);return Bi(t)},Rie=function(){var t=R.useContext(qw),r=Nie(t,function(n){return h3(n.domain,Number.isFinite)});return r||Bi(t)},T3=function(t){var r=R.useContext(qw);r==null&&no();var n=r[t];return n==null&&no(),n},Mie=function(){var t=R.useContext(w3);return t},$ie=function(){return R.useContext(b3)},Xw=function(){return R.useContext(k3)},Yw=function(){return R.useContext(S3)};function Ll(e){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(e)}function Lie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O3(n.key),n)}}function Uie(e,t,r){return t&&Bie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wie(e,t,r){return t=Hh(t),zie(e,A3()?Reflect.construct(t,r||[],Hh(e).constructor):t.apply(e,r))}function zie(e,t){if(t&&(Ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hie(e)}function Hie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(A3=function(){return!!e})()}function Hh(e){return Hh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hh(e)}function Vie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vx(e,t)}function vx(e,t){return vx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},vx(e,t)}function GE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function KE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GE(Object(r),!0).forEach(function(n){Jw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jw(e,t,r){return t=O3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O3(e){var t=Gie(e,"string");return Ll(t)=="symbol"?t:t+""}function Gie(e,t){if(Ll(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ll(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Kie(e,t){return Jie(e)||Yie(e,t)||Xie(e,t)||qie()}function qie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xie(e,t){if(e){if(typeof e=="string")return qE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qE(e,t)}}function qE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function Jie(e){if(Array.isArray(e))return e}function gx(){return gx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gx.apply(this,arguments)}var Qie=function(t,r){var n;return Z.isValidElement(t)?n=Z.cloneElement(t,r):Je(t)?n=t(r):n=Z.createElement("line",gx({},r,{className:"recharts-reference-line-line"})),n},Zie=function(t,r,n,a,i,s,o,l,c){var u=i.x,f=i.y,d=i.width,h=i.height;if(n){var m=c.y,p=t.y.apply(m,{position:s});if(Ma(c,"discard")&&!t.y.isInRange(p))return null;var g=[{x:u+d,y:p},{x:u,y:p}];return l==="left"?g.reverse():g}if(r){var x=c.x,w=t.x.apply(x,{position:s});if(Ma(c,"discard")&&!t.x.isInRange(w))return null;var y=[{x:w,y:f+h},{x:w,y:f}];return o==="top"?y.reverse():y}if(a){var k=c.segment,b=k.map(function(_){return t.apply(_,{position:s})});return Ma(c,"discard")&&_ae(b,function(_){return!t.isInRange(_)})?null:b}return null};function ese(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,s=e.shape,o=e.className,l=e.alwaysShow,c=Iie(),u=E3(a),f=T3(i),d=Mie();if(!c||!d)return null;ni(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=Gw({x:u.scale,y:f.scale}),m=hr(t),p=hr(r),g=n&&n.length===2,x=Zie(h,m,p,g,d,e.position,u.orientation,f.orientation,e);if(!x)return null;var w=Kie(x,2),y=w[0],k=y.x,b=y.y,_=w[1],S=_.x,E=_.y,T=Ma(e,"hidden")?"url(#".concat(c,")"):void 0,F=KE(KE({clipPath:T},nt(e,!0)),{},{x1:k,y1:b,x2:S,y2:E});return Z.createElement(Yt,{className:ot("recharts-reference-line",o)},Qie(s,F),Lr.renderCallByParent(e,fie({x1:k,y1:b,x2:S,y2:E})))}var Qw=function(e){function t(){return Lie(this,t),Wie(this,t,arguments)}return Vie(t,e),Uie(t,[{key:"render",value:function(){return Z.createElement(ese,this.props)}}])}(Z.Component);Jw(Qw,"displayName","ReferenceLine");Jw(Qw,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function yx(){return yx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yx.apply(this,arguments)}function Bl(e){"@babel/helpers - typeof";return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(e)}function XE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XE(Object(r),!0).forEach(function(n){gm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rse(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P3(n.key),n)}}function nse(e,t,r){return t&&rse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ase(e,t,r){return t=Vh(t),ise(e,C3()?Reflect.construct(t,r||[],Vh(e).constructor):t.apply(e,r))}function ise(e,t){if(t&&(Bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sse(e)}function sse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(C3=function(){return!!e})()}function Vh(e){return Vh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vh(e)}function ose(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xx(e,t)}function xx(e,t){return xx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},xx(e,t)}function gm(e,t,r){return t=P3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P3(e){var t=lse(e,"string");return Bl(t)=="symbol"?t:t+""}function lse(e,t){if(Bl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Bl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var cse=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,s=Gw({x:a.scale,y:i.scale}),o=s.apply({x:r,y:n},{bandAware:!0});return Ma(t,"discard")&&!s.isInRange(o)?null:o},ym=function(e){function t(){return tse(this,t),ase(this,t,arguments)}return ose(t,e),nse(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,s=n.r,o=n.alwaysShow,l=n.clipPathId,c=hr(a),u=hr(i);if(ni(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!u)return null;var f=cse(this.props);if(!f)return null;var d=f.x,h=f.y,m=this.props,p=m.shape,g=m.className,x=Ma(this.props,"hidden")?"url(#".concat(l,")"):void 0,w=YE(YE({clipPath:x},nt(this.props,!0)),{},{cx:d,cy:h});return Z.createElement(Yt,{className:ot("recharts-reference-dot",g)},t.renderDot(p,w),Lr.renderCallByParent(this.props,{x:d-s,y:h-s,width:2*s,height:2*s}))}}])}(Z.Component);gm(ym,"displayName","ReferenceDot");gm(ym,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});gm(ym,"renderDot",function(e,t){var r;return Z.isValidElement(e)?r=Z.cloneElement(e,t):Je(e)?r=e(t):r=Z.createElement(Vw,yx({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function wx(){return wx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wx.apply(this,arguments)}function Ul(e){"@babel/helpers - typeof";return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ul(e)}function JE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JE(Object(r),!0).forEach(function(n){xm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function use(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fse(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N3(n.key),n)}}function dse(e,t,r){return t&&fse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hse(e,t,r){return t=Gh(t),pse(e,j3()?Reflect.construct(t,r||[],Gh(e).constructor):t.apply(e,r))}function pse(e,t){if(t&&(Ul(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mse(e)}function mse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(j3=function(){return!!e})()}function Gh(e){return Gh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gh(e)}function vse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bx(e,t)}function bx(e,t){return bx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},bx(e,t)}function xm(e,t,r){return t=N3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N3(e){var t=gse(e,"string");return Ul(t)=="symbol"?t:t+""}function gse(e,t){if(Ul(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ul(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yse=function(t,r,n,a,i){var s=i.x1,o=i.x2,l=i.y1,c=i.y2,u=i.xAxis,f=i.yAxis;if(!u||!f)return null;var d=Gw({x:u.scale,y:f.scale}),h={x:t?d.x.apply(s,{position:"start"}):d.x.rangeMin,y:n?d.y.apply(l,{position:"start"}):d.y.rangeMin},m={x:r?d.x.apply(o,{position:"end"}):d.x.rangeMax,y:a?d.y.apply(c,{position:"end"}):d.y.rangeMax};return Ma(i,"discard")&&(!d.isInRange(h)||!d.isInRange(m))?null:y3(h,m)},wm=function(e){function t(){return use(this,t),hse(this,t,arguments)}return vse(t,e),dse(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,s=n.y1,o=n.y2,l=n.className,c=n.alwaysShow,u=n.clipPathId;ni(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=hr(a),d=hr(i),h=hr(s),m=hr(o),p=this.props.shape;if(!f&&!d&&!h&&!m&&!p)return null;var g=yse(f,d,h,m,this.props);if(!g&&!p)return null;var x=Ma(this.props,"hidden")?"url(#".concat(u,")"):void 0;return Z.createElement(Yt,{className:ot("recharts-reference-area",l)},t.renderRect(p,QE(QE({clipPath:x},nt(this.props,!0)),g)),Lr.renderCallByParent(this.props,g))}}])}(Z.Component);xm(wm,"displayName","ReferenceArea");xm(wm,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});xm(wm,"renderRect",function(e,t){var r;return Z.isValidElement(e)?r=Z.cloneElement(e,t):Je(e)?r=e(t):r=Z.createElement(Hw,wx({},t,{className:"recharts-reference-area-rect"})),r});function F3(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function xse(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return hie(n,r)}function wse(e,t,r){var n=r==="width",a=e.x,i=e.y,s=e.width,o=e.height;return t===1?{start:n?a:i,end:n?a+s:i+o}:{start:n?a+s:i+o,end:n?a:i}}function Kh(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function bse(e,t){return F3(e,t+1)}function _se(e,t,r,n,a){for(var i=(n||[]).slice(),s=t.start,o=t.end,l=0,c=1,u=s,f=function(){var m=n==null?void 0:n[l];if(m===void 0)return{v:F3(n,c)};var p=l,g,x=function(){return g===void 0&&(g=r(m,p)),g},w=m.coordinate,y=l===0||Kh(e,w,x,u,o);y||(l=0,u=s,c+=1),y&&(u=w+e*(x()/2+a),l+=c)},d;c<=i.length;)if(d=f(),d)return d.v;return[]}function Af(e){"@babel/helpers - typeof";return Af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Af(e)}function ZE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZE(Object(r),!0).forEach(function(n){Sse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sse(e,t,r){return t=kse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kse(e){var t=Ese(e,"string");return Af(t)=="symbol"?t:t+""}function Ese(e,t){if(Af(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tse(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,o=t.start,l=t.end,c=function(d){var h=i[d],m,p=function(){return m===void 0&&(m=r(h,d)),m};if(d===s-1){var g=e*(h.coordinate+e*p()/2-l);i[d]=h=Dr(Dr({},h),{},{tickCoord:g>0?h.coordinate-g*e:h.coordinate})}else i[d]=h=Dr(Dr({},h),{},{tickCoord:h.coordinate});var x=Kh(e,h.tickCoord,p,o,l);x&&(l=h.tickCoord-e*(p()/2+a),i[d]=Dr(Dr({},h),{},{isShow:!0}))},u=s-1;u>=0;u--)c(u);return i}function Ase(e,t,r,n,a,i){var s=(n||[]).slice(),o=s.length,l=t.start,c=t.end;if(i){var u=n[o-1],f=r(u,o-1),d=e*(u.coordinate+e*f/2-c);s[o-1]=u=Dr(Dr({},u),{},{tickCoord:d>0?u.coordinate-d*e:u.coordinate});var h=Kh(e,u.tickCoord,function(){return f},l,c);h&&(c=u.tickCoord-e*(f/2+a),s[o-1]=Dr(Dr({},u),{},{isShow:!0}))}for(var m=i?o-1:o,p=function(w){var y=s[w],k,b=function(){return k===void 0&&(k=r(y,w)),k};if(w===0){var _=e*(y.coordinate-e*b()/2-l);s[w]=y=Dr(Dr({},y),{},{tickCoord:_<0?y.coordinate-_*e:y.coordinate})}else s[w]=y=Dr(Dr({},y),{},{tickCoord:y.coordinate});var S=Kh(e,y.tickCoord,b,l,c);S&&(l=y.tickCoord+e*(b()/2+a),s[w]=Dr(Dr({},y),{},{isShow:!0}))},g=0;g<m;g++)p(g);return s}function Zw(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,s=e.minTickGap,o=e.orientation,l=e.interval,c=e.tickFormatter,u=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(Oe(l)||hc.isSsr)return bse(a,typeof l=="number"&&Oe(l)?l:0);var d=[],h=o==="top"||o==="bottom"?"width":"height",m=u&&h==="width"?gu(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},p=function(y,k){var b=Je(c)?c(y.value,k):y.value;return h==="width"?xse(gu(b,{fontSize:t,letterSpacing:r}),m,f):gu(b,{fontSize:t,letterSpacing:r})[h]},g=a.length>=2?pa(a[1].coordinate-a[0].coordinate):1,x=wse(i,g,h);return l==="equidistantPreserveStart"?_se(g,x,p,a,s):(l==="preserveStart"||l==="preserveStartEnd"?d=Ase(g,x,p,a,s,l==="preserveStartEnd"):d=Tse(g,x,p,a,s),d.filter(function(w){return w.isShow}))}var Ose=["viewBox"],Cse=["viewBox"],Pse=["ticks"];function Wl(e){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function rl(){return rl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rl.apply(this,arguments)}function eT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eT(Object(r),!0).forEach(function(n){eb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mv(e,t){if(e==null)return{};var r=jse(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jse(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Nse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D3(n.key),n)}}function Fse(e,t,r){return t&&tT(e.prototype,t),r&&tT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ise(e,t,r){return t=qh(t),Dse(e,I3()?Reflect.construct(t,r||[],qh(e).constructor):t.apply(e,r))}function Dse(e,t){if(t&&(Wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rse(e)}function Rse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(I3=function(){return!!e})()}function qh(e){return qh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qh(e)}function Mse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_x(e,t)}function _x(e,t){return _x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},_x(e,t)}function eb(e,t,r){return t=D3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D3(e){var t=$se(e,"string");return Wl(t)=="symbol"?t:t+""}function $se(e,t){if(Wl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var gc=function(e){function t(r){var n;return Nse(this,t),n=Ise(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return Mse(t,e),Fse(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,s=Mv(n,Ose),o=this.props,l=o.viewBox,c=Mv(o,Cse);return!fl(i,l)||!fl(s,c)||!fl(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,s=a.y,o=a.width,l=a.height,c=a.orientation,u=a.tickSize,f=a.mirror,d=a.tickMargin,h,m,p,g,x,w,y=f?-1:1,k=n.tickSize||u,b=Oe(n.tickCoord)?n.tickCoord:n.coordinate;switch(c){case"top":h=m=n.coordinate,g=s+ +!f*l,p=g-y*k,w=p-y*d,x=b;break;case"left":p=g=n.coordinate,m=i+ +!f*o,h=m-y*k,x=h-y*d,w=b;break;case"right":p=g=n.coordinate,m=i+ +f*o,h=m+y*k,x=h+y*d,w=b;break;default:h=m=n.coordinate,g=s+ +f*l,p=g+y*k,w=p+y*d,x=b;break}return{line:{x1:h,y1:p,x2:m,y2:g},tick:{x,y:w}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s;switch(a){case"left":s=i?"start":"end";break;case"right":s=i?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s="end";switch(a){case"left":case"right":s="middle";break;case"top":s=i?"start":"end";break;default:s=i?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,l=n.orientation,c=n.mirror,u=n.axisLine,f=sr(sr(sr({},nt(this.props,!1)),nt(u,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var d=+(l==="top"&&!c||l==="bottom"&&c);f=sr(sr({},f),{},{x1:a,y1:i+d*o,x2:a+s,y2:i+d*o})}else{var h=+(l==="left"&&!c||l==="right"&&c);f=sr(sr({},f),{},{x1:a+h*s,y1:i,x2:a+h*s,y2:i+o})}return Z.createElement("line",rl({},f,{className:ot("recharts-cartesian-axis-line",Gn(u,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var s=this,o=this.props,l=o.tickLine,c=o.stroke,u=o.tick,f=o.tickFormatter,d=o.unit,h=Zw(sr(sr({},this.props),{},{ticks:n}),a,i),m=this.getTickTextAnchor(),p=this.getTickVerticalAnchor(),g=nt(this.props,!1),x=nt(u,!1),w=sr(sr({},g),{},{fill:"none"},nt(l,!1)),y=h.map(function(k,b){var _=s.getTickLineCoord(k),S=_.line,E=_.tick,T=sr(sr(sr(sr({textAnchor:m,verticalAnchor:p},g),{},{stroke:"none",fill:c},x),E),{},{index:b,payload:k,visibleTicksCount:h.length,tickFormatter:f});return Z.createElement(Yt,rl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(k.value,"-").concat(k.coordinate,"-").concat(k.tickCoord)},th(s.props,k,b)),l&&Z.createElement("line",rl({},w,S,{className:ot("recharts-cartesian-axis-tick-line",Gn(l,"className"))})),u&&t.renderTickItem(u,T,"".concat(Je(f)?f(k.value,b):k.value).concat(d||"")))});return Z.createElement("g",{className:"recharts-cartesian-axis-ticks"},y)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,s=a.width,o=a.height,l=a.ticksGenerator,c=a.className,u=a.hide;if(u)return null;var f=this.props,d=f.ticks,h=Mv(f,Pse),m=d;return Je(l)&&(m=d&&d.length>0?l(this.props):l(h)),s<=0||o<=0||!m||!m.length?null:Z.createElement(Yt,{className:ot("recharts-cartesian-axis",c),ref:function(g){n.layerReference=g}},i&&this.renderAxisLine(),this.renderTicks(m,this.state.fontSize,this.state.letterSpacing),Lr.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var s,o=ot(a.className,"recharts-cartesian-axis-tick-value");return Z.isValidElement(n)?s=Z.cloneElement(n,sr(sr({},a),{},{className:o})):Je(n)?s=n(sr(sr({},a),{},{className:o})):s=Z.createElement(vh,rl({},a,{className:"recharts-cartesian-axis-tick-value"}),i),s}}])}(R.Component);eb(gc,"displayName","CartesianAxis");eb(gc,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Lse=["x1","y1","x2","y2","key"],Bse=["offset"];function ao(e){"@babel/helpers - typeof";return ao=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ao(e)}function rT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rT(Object(r),!0).forEach(function(n){Use(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Use(e,t,r){return t=Wse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wse(e){var t=zse(e,"string");return ao(t)=="symbol"?t:t+""}function zse(e,t){if(ao(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ao(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ls(){return Ls=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ls.apply(this,arguments)}function nT(e,t){if(e==null)return{};var r=Hse(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Hse(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Vse=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,s=t.width,o=t.height,l=t.ry;return Z.createElement("rect",{x:a,y:i,ry:l,width:s,height:o,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function R3(e,t){var r;if(Z.isValidElement(e))r=Z.cloneElement(e,t);else if(Je(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,s=t.y2,o=t.key,l=nT(t,Lse),c=nt(l,!1);c.offset;var u=nT(c,Bse);r=Z.createElement("line",Ls({},u,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:o}))}return r}function Gse(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(o,l){var c=Br(Br({},e),{},{x1:t,y1:o,x2:t+r,y2:o,key:"line-".concat(l),index:l});return R3(a,c)});return Z.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function Kse(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(o,l){var c=Br(Br({},e),{},{x1:o,y1:t,x2:o,y2:t+r,key:"line-".concat(l),index:l});return R3(a,c)});return Z.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function qse(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,s=e.height,o=e.horizontalPoints,l=e.horizontal,c=l===void 0?!0:l;if(!c||!t||!t.length)return null;var u=o.map(function(d){return Math.round(d+a-a)}).sort(function(d,h){return d-h});a!==u[0]&&u.unshift(0);var f=u.map(function(d,h){var m=!u[h+1],p=m?a+s-d:u[h+1]-d;if(p<=0)return null;var g=h%t.length;return Z.createElement("rect",{key:"react-".concat(h),y:d,x:n,height:p,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function Xse(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,s=e.y,o=e.width,l=e.height,c=e.verticalPoints;if(!r||!n||!n.length)return null;var u=c.map(function(d){return Math.round(d+i-i)}).sort(function(d,h){return d-h});i!==u[0]&&u.unshift(0);var f=u.map(function(d,h){var m=!u[h+1],p=m?i+o-d:u[h+1]-d;if(p<=0)return null;var g=h%n.length;return Z.createElement("rect",{key:"react-".concat(h),x:d,y:s,width:p,height:l,stroke:"none",fill:n[g],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Z.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var Yse=function(t,r){var n=t.xAxis,a=t.width,i=t.height,s=t.offset;return Gj(Zw(Br(Br(Br({},gc.defaultProps),n),{},{ticks:Za(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,r)},Jse=function(t,r){var n=t.yAxis,a=t.width,i=t.height,s=t.offset;return Gj(Zw(Br(Br(Br({},gc.defaultProps),n),{},{ticks:Za(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,r)},Fo={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Xh(e){var t,r,n,a,i,s,o=Xw(),l=Yw(),c=$ie(),u=Br(Br({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Fo.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Fo.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Fo.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Fo.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Fo.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:Fo.verticalFill,x:Oe(e.x)?e.x:c.left,y:Oe(e.y)?e.y:c.top,width:Oe(e.width)?e.width:c.width,height:Oe(e.height)?e.height:c.height}),f=u.x,d=u.y,h=u.width,m=u.height,p=u.syncWithTicks,g=u.horizontalValues,x=u.verticalValues,w=Die(),y=Rie();if(!Oe(h)||h<=0||!Oe(m)||m<=0||!Oe(f)||f!==+f||!Oe(d)||d!==+d)return null;var k=u.verticalCoordinatesGenerator||Yse,b=u.horizontalCoordinatesGenerator||Jse,_=u.horizontalPoints,S=u.verticalPoints;if((!_||!_.length)&&Je(b)){var E=g&&g.length,T=b({yAxis:y?Br(Br({},y),{},{ticks:E?g:y.ticks}):void 0,width:o,height:l,offset:c},E?!0:p);ni(Array.isArray(T),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(ao(T),"]")),Array.isArray(T)&&(_=T)}if((!S||!S.length)&&Je(k)){var F=x&&x.length,C=k({xAxis:w?Br(Br({},w),{},{ticks:F?x:w.ticks}):void 0,width:o,height:l,offset:c},F?!0:p);ni(Array.isArray(C),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(ao(C),"]")),Array.isArray(C)&&(S=C)}return Z.createElement("g",{className:"recharts-cartesian-grid"},Z.createElement(Vse,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),Z.createElement(Gse,Ls({},u,{offset:c,horizontalPoints:_,xAxis:w,yAxis:y})),Z.createElement(Kse,Ls({},u,{offset:c,verticalPoints:S,xAxis:w,yAxis:y})),Z.createElement(qse,Ls({},u,{horizontalPoints:_})),Z.createElement(Xse,Ls({},u,{verticalPoints:S})))}Xh.displayName="CartesianGrid";var Qse=["type","layout","connectNulls","ref"],Zse=["key"];function zl(e){"@babel/helpers - typeof";return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zl(e)}function aT(e,t){if(e==null)return{};var r=eoe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function eoe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function bu(){return bu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bu.apply(this,arguments)}function iT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iT(Object(r),!0).forEach(function(n){ua(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Io(e){return aoe(e)||noe(e)||roe(e)||toe()}function toe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function roe(e,t){if(e){if(typeof e=="string")return Sx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sx(e,t)}}function noe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function aoe(e){if(Array.isArray(e))return Sx(e)}function Sx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ioe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sT(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$3(n.key),n)}}function soe(e,t,r){return t&&sT(e.prototype,t),r&&sT(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ooe(e,t,r){return t=Yh(t),loe(e,M3()?Reflect.construct(t,r||[],Yh(e).constructor):t.apply(e,r))}function loe(e,t){if(t&&(zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return coe(e)}function coe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(M3=function(){return!!e})()}function Yh(e){return Yh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yh(e)}function uoe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kx(e,t)}function kx(e,t){return kx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},kx(e,t)}function ua(e,t,r){return t=$3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $3(e){var t=foe(e,"string");return zl(t)=="symbol"?t:t+""}function foe(e,t){if(zl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var gi=function(e){function t(){var r;ioe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=ooe(this,t,[].concat(a)),ua(r,"state",{isAnimationFinished:!0,totalLength:0}),ua(r,"generateSimpleStrokeDasharray",function(s,o){return"".concat(o,"px ").concat(s-o,"px")}),ua(r,"getStrokeDasharray",function(s,o,l){var c=l.reduce(function(x,w){return x+w});if(!c)return r.generateSimpleStrokeDasharray(o,s);for(var u=Math.floor(s/c),f=s%c,d=o-s,h=[],m=0,p=0;m<l.length;p+=l[m],++m)if(p+l[m]>f){h=[].concat(Io(l.slice(0,m)),[f-p]);break}var g=h.length%2===0?[0,d]:[d];return[].concat(Io(t.repeat(l,u)),Io(h),g).map(function(x){return"".concat(x,"px")}).join(", ")}),ua(r,"id",Zf("recharts-line-")),ua(r,"pathRef",function(s){r.mainCurve=s}),ua(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),ua(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return uoe(t,e),soe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.points,o=i.xAxis,l=i.yAxis,c=i.layout,u=i.children,f=Kn(u,id);if(!f)return null;var d=function(p,g){return{x:p.x,y:p.y,value:p.value,errorVal:On(p.payload,g)}},h={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Z.createElement(Yt,h,f.map(function(m){return Z.cloneElement(m,{key:"bar-".concat(m.props.dataKey),data:s,xAxis:o,yAxis:l,layout:c,dataPointFormatter:d})}))}},{key:"renderDots",value:function(n,a,i){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var o=this.props,l=o.dot,c=o.points,u=o.dataKey,f=nt(this.props,!1),d=nt(l,!0),h=c.map(function(p,g){var x=mn(mn(mn({key:"dot-".concat(g),r:3},f),d),{},{index:g,cx:p.x,cy:p.y,value:p.value,dataKey:u,payload:p.payload,points:c});return t.renderDotItem(l,x)}),m={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return Z.createElement(Yt,bu({className:"recharts-line-dots",key:"dots"},m),h)}},{key:"renderCurveStatically",value:function(n,a,i,s){var o=this.props,l=o.type,c=o.layout,u=o.connectNulls;o.ref;var f=aT(o,Qse),d=mn(mn(mn({},nt(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},s),{},{type:l,layout:c,connectNulls:u});return Z.createElement(tx,bu({},d,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,s=this.props,o=s.points,l=s.strokeDasharray,c=s.isAnimationActive,u=s.animationBegin,f=s.animationDuration,d=s.animationEasing,h=s.animationId,m=s.animateNewValues,p=s.width,g=s.height,x=this.state,w=x.prevPoints,y=x.totalLength;return Z.createElement(vi,{begin:u,duration:f,isActive:c,easing:d,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(k){var b=k.t;if(w){var _=w.length/o.length,S=o.map(function(A,M){var V=Math.floor(M*_);if(w[V]){var z=w[V],Y=da(z.x,A.x),J=da(z.y,A.y);return mn(mn({},A),{},{x:Y(b),y:J(b)})}if(m){var Q=da(p*2,A.x),j=da(g/2,A.y);return mn(mn({},A),{},{x:Q(b),y:j(b)})}return mn(mn({},A),{},{x:A.x,y:A.y})});return i.renderCurveStatically(S,n,a)}var E=da(0,y),T=E(b),F;if(l){var C="".concat(l).split(/[,\s]+/gim).map(function(A){return parseFloat(A)});F=i.getStrokeDasharray(T,y,C)}else F=i.generateSimpleStrokeDasharray(y,T);return i.renderCurveStatically(o,n,a,{strokeDasharray:F})})}},{key:"renderCurve",value:function(n,a){var i=this.props,s=i.points,o=i.isAnimationActive,l=this.state,c=l.prevPoints,u=l.totalLength;return o&&s&&s.length&&(!c&&u>0||!fm(c,s))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,s=a.dot,o=a.points,l=a.className,c=a.xAxis,u=a.yAxis,f=a.top,d=a.left,h=a.width,m=a.height,p=a.isAnimationActive,g=a.id;if(i||!o||!o.length)return null;var x=this.state.isAnimationFinished,w=o.length===1,y=ot("recharts-line",l),k=c&&c.allowDataOverflow,b=u&&u.allowDataOverflow,_=k||b,S=tt(g)?this.id:g,E=(n=nt(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},T=E.r,F=T===void 0?3:T,C=E.strokeWidth,A=C===void 0?2:C,M=EB(s)?s:{},V=M.clipDot,z=V===void 0?!0:V,Y=F*2+A;return Z.createElement(Yt,{className:y},k||b?Z.createElement("defs",null,Z.createElement("clipPath",{id:"clipPath-".concat(S)},Z.createElement("rect",{x:k?d:d-h/2,y:b?f:f-m/2,width:k?h:h*2,height:b?m:m*2})),!z&&Z.createElement("clipPath",{id:"clipPath-dots-".concat(S)},Z.createElement("rect",{x:d-Y/2,y:f-Y/2,width:h+Y,height:m+Y}))):null,!w&&this.renderCurve(_,S),this.renderErrorBar(_,S),(w||s)&&this.renderDots(_,z,S),(!p||x)&&rs.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(Io(n),[0]):n,s=[],o=0;o<a;++o)s=[].concat(Io(s),Io(i));return s}},{key:"renderDotItem",value:function(n,a){var i;if(Z.isValidElement(n))i=Z.cloneElement(n,a);else if(Je(n))i=n(a);else{var s=a.key,o=aT(a,Zse),l=ot("recharts-line-dot",typeof n!="boolean"?n.className:"");i=Z.createElement(Vw,bu({key:s},o,{className:l}))}return i}}])}(R.PureComponent);ua(gi,"displayName","Line");ua(gi,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!hc.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});ua(gi,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,s=e.dataKey,o=e.bandSize,l=e.displayedData,c=e.offset,u=t.layout,f=l.map(function(d,h){var m=On(d,s);return u==="horizontal"?{x:Bk({axis:r,ticks:a,bandSize:o,entry:d,index:h}),y:tt(m)?null:n.scale(m),value:m,payload:d}:{x:tt(m)?null:r.scale(m),y:Bk({axis:n,ticks:i,bandSize:o,entry:d,index:h}),value:m,payload:d}});return mn({points:f,layout:u},c)});function Hl(e){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function doe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hoe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,U3(n.key),n)}}function poe(e,t,r){return t&&hoe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function moe(e,t,r){return t=Jh(t),voe(e,L3()?Reflect.construct(t,r||[],Jh(e).constructor):t.apply(e,r))}function voe(e,t){if(t&&(Hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return goe(e)}function goe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(L3=function(){return!!e})()}function Jh(e){return Jh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jh(e)}function yoe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ex(e,t)}function Ex(e,t){return Ex=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Ex(e,t)}function B3(e,t,r){return t=U3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U3(e){var t=xoe(e,"string");return Hl(t)=="symbol"?t:t+""}function xoe(e,t){if(Hl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Tx(){return Tx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tx.apply(this,arguments)}function woe(e){var t=e.xAxisId,r=Xw(),n=Yw(),a=E3(t);return a==null?null:R.createElement(gc,Tx({},a,{className:ot("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(s){return Za(s,!0)}}))}var Vl=function(e){function t(){return doe(this,t),moe(this,t,arguments)}return yoe(t,e),poe(t,[{key:"render",value:function(){return R.createElement(woe,this.props)}}])}(R.Component);B3(Vl,"displayName","XAxis");B3(Vl,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Gl(e){"@babel/helpers - typeof";return Gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gl(e)}function boe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H3(n.key),n)}}function Soe(e,t,r){return t&&_oe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function koe(e,t,r){return t=Qh(t),Eoe(e,W3()?Reflect.construct(t,r||[],Qh(e).constructor):t.apply(e,r))}function Eoe(e,t){if(t&&(Gl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Toe(e)}function Toe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(W3=function(){return!!e})()}function Qh(e){return Qh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qh(e)}function Aoe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ax(e,t)}function Ax(e,t){return Ax=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Ax(e,t)}function z3(e,t,r){return t=H3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H3(e){var t=Ooe(e,"string");return Gl(t)=="symbol"?t:t+""}function Ooe(e,t){if(Gl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Ox(){return Ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ox.apply(this,arguments)}var Coe=function(t){var r=t.yAxisId,n=Xw(),a=Yw(),i=T3(r);return i==null?null:R.createElement(gc,Ox({},i,{className:ot("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(o){return Za(o,!0)}}))},Kl=function(e){function t(){return boe(this,t),koe(this,t,arguments)}return Aoe(t,e),Soe(t,[{key:"render",value:function(){return R.createElement(Coe,this.props)}}])}(R.Component);z3(Kl,"displayName","YAxis");z3(Kl,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function oT(e){return Foe(e)||Noe(e)||joe(e)||Poe()}function Poe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function joe(e,t){if(e){if(typeof e=="string")return Cx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cx(e,t)}}function Noe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Foe(e){if(Array.isArray(e))return Cx(e)}function Cx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Px=function(t,r,n,a,i){var s=Kn(t,Qw),o=Kn(t,ym),l=[].concat(oT(s),oT(o)),c=Kn(t,wm),u="".concat(a,"Id"),f=a[0],d=r;if(l.length&&(d=l.reduce(function(p,g){if(g.props[u]===n&&Ma(g.props,"extendDomain")&&Oe(g.props[f])){var x=g.props[f];return[Math.min(p[0],x),Math.max(p[1],x)]}return p},d)),c.length){var h="".concat(f,"1"),m="".concat(f,"2");d=c.reduce(function(p,g){if(g.props[u]===n&&Ma(g.props,"extendDomain")&&Oe(g.props[h])&&Oe(g.props[m])){var x=g.props[h],w=g.props[m];return[Math.min(p[0],x,w),Math.max(p[1],x,w)]}return p},d)}return i&&i.length&&(d=i.reduce(function(p,g){return Oe(g)?[Math.min(p[0],g),Math.max(p[1],g)]:p},d)),d},V3={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,f,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new a(u,f||l,d),m=r?r+c:c;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],h]:l._events[m].push(h):(l._events[m]=h,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,f;if(this._eventsCount===0)return c;for(f in u=this._events)t.call(u,f)&&c.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=r?r+c:c,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,h=f.length,m=new Array(h);d<h;d++)m[d]=f[d].fn;return m},o.prototype.listenerCount=function(c){var u=r?r+c:c,f=this._events[u];return f?f.fn?1:f.length:0},o.prototype.emit=function(c,u,f,d,h,m){var p=r?r+c:c;if(!this._events[p])return!1;var g=this._events[p],x=arguments.length,w,y;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),x){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,f),!0;case 4:return g.fn.call(g.context,u,f,d),!0;case 5:return g.fn.call(g.context,u,f,d,h),!0;case 6:return g.fn.call(g.context,u,f,d,h,m),!0}for(y=1,w=new Array(x-1);y<x;y++)w[y-1]=arguments[y];g.fn.apply(g.context,w)}else{var k=g.length,b;for(y=0;y<k;y++)switch(g[y].once&&this.removeListener(c,g[y].fn,void 0,!0),x){case 1:g[y].fn.call(g[y].context);break;case 2:g[y].fn.call(g[y].context,u);break;case 3:g[y].fn.call(g[y].context,u,f);break;case 4:g[y].fn.call(g[y].context,u,f,d);break;default:if(!w)for(b=1,w=new Array(x-1);b<x;b++)w[b-1]=arguments[b];g[y].fn.apply(g[y].context,w)}}return!0},o.prototype.on=function(c,u,f){return i(this,c,u,f,!1)},o.prototype.once=function(c,u,f){return i(this,c,u,f,!0)},o.prototype.removeListener=function(c,u,f,d){var h=r?r+c:c;if(!this._events[h])return this;if(!u)return s(this,h),this;var m=this._events[h];if(m.fn)m.fn===u&&(!d||m.once)&&(!f||m.context===f)&&s(this,h);else{for(var p=0,g=[],x=m.length;p<x;p++)(m[p].fn!==u||d&&!m[p].once||f&&m[p].context!==f)&&g.push(m[p]);g.length?this._events[h]=g.length===1?g[0]:g:s(this,h)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(V3);var Ioe=V3.exports;const Doe=_t(Ioe);var $v=new Doe,Lv="recharts.syncMouseEvents";function Of(e){"@babel/helpers - typeof";return Of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Of(e)}function Roe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Moe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,G3(n.key),n)}}function $oe(e,t,r){return t&&Moe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bv(e,t,r){return t=G3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G3(e){var t=Loe(e,"string");return Of(t)=="symbol"?t:t+""}function Loe(e,t){if(Of(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Of(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Boe=function(){function e(){Roe(this,e),Bv(this,"activeIndex",0),Bv(this,"coordinateList",[]),Bv(this,"layout","horizontal")}return $oe(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,s=r.container,o=s===void 0?null:s,l=r.layout,c=l===void 0?null:l,u=r.offset,f=u===void 0?null:u,d=r.mouseHandlerCallback,h=d===void 0?null:d;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=o??this.container,this.layout=c??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=h??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,s=a.y,o=a.height,l=this.coordinateList[this.activeIndex].coordinate,c=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=i+l+c,d=s+this.offset.top+o/2+u;this.mouseHandlerCallback({pageX:f,pageY:d})}}}])}();function Uoe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Oe(n)&&Oe(a))return!0}return!1}function Woe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function K3(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,s=Or(t,r,n,a),o=Or(t,r,n,i);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function zoe(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var o=t.cx,l=t.cy,c=t.innerRadius,u=t.outerRadius,f=t.angle,d=Or(o,l,c,f),h=Or(o,l,u,f);n=d.x,a=d.y,i=h.x,s=h.y}else return K3(t);return[{x:n,y:a},{x:i,y:s}]}function Cf(e){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cf(e)}function lT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lT(Object(r),!0).forEach(function(n){Hoe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hoe(e,t,r){return t=Voe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Voe(e){var t=Goe(e,"string");return Cf(t)=="symbol"?t:t+""}function Goe(e,t){if(Cf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Koe(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,s=e.activeCoordinate,o=e.activePayload,l=e.offset,c=e.activeTooltipIndex,u=e.tooltipAxisBandSize,f=e.layout,d=e.chartName,h=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!h||!i||!s||d!=="ScatterChart"&&a!=="axis")return null;var m,p=tx;if(d==="ScatterChart")m=s,p=Gre;else if(d==="BarChart")m=Woe(f,s,l,u),p=Hw;else if(f==="radial"){var g=K3(s),x=g.cx,w=g.cy,y=g.radius,k=g.startAngle,b=g.endAngle;m={cx:x,cy:w,startAngle:k,endAngle:b,innerRadius:y,outerRadius:y},p=Jj}else m={points:zoe(f,s,l)},p=tx;var _=Qd(Qd(Qd(Qd({stroke:"#ccc",pointerEvents:"none"},l),m),nt(h,!1)),{},{payload:o,payloadIndex:c,className:ot("recharts-tooltip-cursor",h.className)});return R.isValidElement(h)?R.cloneElement(h,_):R.createElement(p,_)}var qoe=["item"],Xoe=["children","className","width","height","style","compact","title","desc"];function ql(e){"@babel/helpers - typeof";return ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(e)}function nl(){return nl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nl.apply(this,arguments)}function cT(e,t){return Qoe(e)||Joe(e,t)||X3(e,t)||Yoe()}function Yoe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Joe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function Qoe(e){if(Array.isArray(e))return e}function uT(e,t){if(e==null)return{};var r=Zoe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Zoe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ele(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tle(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y3(n.key),n)}}function rle(e,t,r){return t&&tle(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nle(e,t,r){return t=Zh(t),ale(e,q3()?Reflect.construct(t,r||[],Zh(e).constructor):t.apply(e,r))}function ale(e,t){if(t&&(ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ile(e)}function ile(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(q3=function(){return!!e})()}function Zh(e){return Zh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zh(e)}function sle(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jx(e,t)}function jx(e,t){return jx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jx(e,t)}function Xl(e){return cle(e)||lle(e)||X3(e)||ole()}function ole(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X3(e,t){if(e){if(typeof e=="string")return Nx(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nx(e,t)}}function lle(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cle(e){if(Array.isArray(e))return Nx(e)}function Nx(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function me(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fT(Object(r),!0).forEach(function(n){We(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function We(e,t,r){return t=Y3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y3(e){var t=ule(e,"string");return ql(t)=="symbol"?t:t+""}function ule(e,t){if(ql(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ql(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fle={xAxis:["bottom","top"],yAxis:["left","right"]},dle={width:"100%",height:"100%"},J3={x:0,y:0};function Zd(e){return e}var hle=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},ple=function(t,r,n,a){var i=r.find(function(u){return u&&u.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var s=i.coordinate,o=a.radius;return me(me(me({},a),Or(a.cx,a.cy,o,s)),{},{angle:s,radius:o})}var l=i.coordinate,c=a.angle;return me(me(me({},a),Or(a.cx,a.cy,l,c)),{},{angle:c,radius:l})}return J3},bm=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,s=(n??[]).reduce(function(o,l){var c=l.props.data;return c&&c.length?[].concat(Xl(o),Xl(c)):o},[]);return s.length>0?s:t&&t.length&&Oe(a)&&Oe(i)?t.slice(a,i+1):[]};function Q3(e){return e==="number"?[0,"auto"]:void 0}var Fx=function(t,r,n,a){var i=t.graphicalItems,s=t.tooltipAxis,o=bm(r,t);return n<0||!i||!i.length||n>=o.length?null:i.reduce(function(l,c){var u,f=(u=c.props.data)!==null&&u!==void 0?u:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var d;if(s.dataKey&&!s.allowDuplicatedCategory){var h=f===void 0?o:f;d=Z0(h,s.dataKey,a)}else d=f&&f[n]||o[n];return d?[].concat(Xl(l),[qj(c,d)]):l},[])},dT=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},s=hle(i,n),o=t.orderedTooltipTicks,l=t.tooltipAxis,c=t.tooltipTicks,u=OZ(s,o,c,l);if(u>=0&&c){var f=c[u]&&c[u].value,d=Fx(t,r,u,f),h=ple(n,o,u,i);return{activeTooltipIndex:u,activeLabel:f,activePayload:d,activeCoordinate:h}}return null},mle=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,s=r.axisIdKey,o=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,u=t.layout,f=t.children,d=t.stackOffset,h=Vj(u,i);return n.reduce(function(m,p){var g,x=p.type.defaultProps!==void 0?me(me({},p.type.defaultProps),p.props):p.props,w=x.type,y=x.dataKey,k=x.allowDataOverflow,b=x.allowDuplicatedCategory,_=x.scale,S=x.ticks,E=x.includeHidden,T=x[s];if(m[T])return m;var F=bm(t.data,{graphicalItems:a.filter(function(P){var G,B=s in P.props?P.props[s]:(G=P.type.defaultProps)===null||G===void 0?void 0:G[s];return B===T}),dataStartIndex:l,dataEndIndex:c}),C=F.length,A,M,V;Uoe(x.domain,k,w)&&(A=Yy(x.domain,null,k),h&&(w==="number"||_!=="auto")&&(V=xu(F,y,"category")));var z=Q3(w);if(!A||A.length===0){var Y,J=(Y=x.domain)!==null&&Y!==void 0?Y:z;if(y){if(A=xu(F,y,w),w==="category"&&h){var Q=mB(A);b&&Q?(M=A,A=Lh(0,C)):b||(A=Hk(J,A,p).reduce(function(P,G){return P.indexOf(G)>=0?P:[].concat(Xl(P),[G])},[]))}else if(w==="category")b?A=A.filter(function(P){return P!==""&&!tt(P)}):A=Hk(J,A,p).reduce(function(P,G){return P.indexOf(G)>=0||G===""||tt(G)?P:[].concat(Xl(P),[G])},[]);else if(w==="number"){var j=FZ(F,a.filter(function(P){var G,B,q=s in P.props?P.props[s]:(G=P.type.defaultProps)===null||G===void 0?void 0:G[s],ne="hide"in P.props?P.props.hide:(B=P.type.defaultProps)===null||B===void 0?void 0:B.hide;return q===T&&(E||!ne)}),y,i,u);j&&(A=j)}h&&(w==="number"||_!=="auto")&&(V=xu(F,y,"category"))}else h?A=Lh(0,C):o&&o[T]&&o[T].hasStack&&w==="number"?A=d==="expand"?[0,1]:Kj(o[T].stackGroups,l,c):A=Hj(F,a.filter(function(P){var G=s in P.props?P.props[s]:P.type.defaultProps[s],B="hide"in P.props?P.props.hide:P.type.defaultProps.hide;return G===T&&(E||!B)}),w,u,!0);if(w==="number")A=Px(f,A,T,i,S),J&&(A=Yy(J,A,k));else if(w==="category"&&J){var X=J,ee=A.every(function(P){return X.indexOf(P)>=0});ee&&(A=X)}}return me(me({},m),{},We({},T,me(me({},x),{},{axisType:i,domain:A,categoricalDomain:V,duplicateDomain:M,originalDomain:(g=x.domain)!==null&&g!==void 0?g:z,isCategorical:h,layout:u})))},{})},vle=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,s=r.axisIdKey,o=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,u=t.layout,f=t.children,d=bm(t.data,{graphicalItems:n,dataStartIndex:l,dataEndIndex:c}),h=d.length,m=Vj(u,i),p=-1;return n.reduce(function(g,x){var w=x.type.defaultProps!==void 0?me(me({},x.type.defaultProps),x.props):x.props,y=w[s],k=Q3("number");if(!g[y]){p++;var b;return m?b=Lh(0,h):o&&o[y]&&o[y].hasStack?(b=Kj(o[y].stackGroups,l,c),b=Px(f,b,y,i)):(b=Yy(k,Hj(d,n.filter(function(_){var S,E,T=s in _.props?_.props[s]:(S=_.type.defaultProps)===null||S===void 0?void 0:S[s],F="hide"in _.props?_.props.hide:(E=_.type.defaultProps)===null||E===void 0?void 0:E.hide;return T===y&&!F}),"number",u),a.defaultProps.allowDataOverflow),b=Px(f,b,y,i)),me(me({},g),{},We({},y,me(me({axisType:i},a.defaultProps),{},{hide:!0,orientation:Gn(fle,"".concat(i,".").concat(p%2),null),domain:b,originalDomain:k,isCategorical:m,layout:u})))}return g},{})},gle=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,s=r.graphicalItems,o=r.stackGroups,l=r.dataStartIndex,c=r.dataEndIndex,u=t.children,f="".concat(a,"Id"),d=Kn(u,i),h={};return d&&d.length?h=mle(t,{axes:d,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:o,dataStartIndex:l,dataEndIndex:c}):s&&s.length&&(h=vle(t,{Axis:i,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:o,dataStartIndex:l,dataEndIndex:c})),h},yle=function(t){var r=Bi(t),n=Za(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:gw(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Ph(r,n)}},hT=function(t){var r=t.children,n=t.defaultShowTooltip,a=yn(r,Ml),i=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(s=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},xle=function(t){return!t||!t.length?!1:t.some(function(r){var n=ri(r&&r.type);return n&&n.indexOf("Bar")>=0})},pT=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},wle=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,s=i===void 0?{}:i,o=t.yAxisMap,l=o===void 0?{}:o,c=n.width,u=n.height,f=n.children,d=n.margin||{},h=yn(f,Ml),m=yn(f,ai),p=Object.keys(l).reduce(function(b,_){var S=l[_],E=S.orientation;return!S.mirror&&!S.hide?me(me({},b),{},We({},E,b[E]+S.width)):b},{left:d.left||0,right:d.right||0}),g=Object.keys(s).reduce(function(b,_){var S=s[_],E=S.orientation;return!S.mirror&&!S.hide?me(me({},b),{},We({},E,Gn(b,"".concat(E))+S.height)):b},{top:d.top||0,bottom:d.bottom||0}),x=me(me({},g),p),w=x.bottom;h&&(x.bottom+=h.props.height||Ml.defaultProps.height),m&&r&&(x=jZ(x,a,n,r));var y=c-x.left-x.right,k=u-x.top-x.bottom;return me(me({brushBottom:w},x),{},{width:Math.max(y,0),height:Math.max(k,0)})},ble=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},_le=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,s=t.validateTooltipEventTypes,o=s===void 0?["axis"]:s,l=t.axisComponents,c=t.legendContent,u=t.formatAxisMap,f=t.defaultProps,d=function(x,w){var y=w.graphicalItems,k=w.stackGroups,b=w.offset,_=w.updateId,S=w.dataStartIndex,E=w.dataEndIndex,T=x.barSize,F=x.layout,C=x.barGap,A=x.barCategoryGap,M=x.maxBarSize,V=pT(F),z=V.numericAxisName,Y=V.cateAxisName,J=xle(y),Q=[];return y.forEach(function(j,X){var ee=bm(x.data,{graphicalItems:[j],dataStartIndex:S,dataEndIndex:E}),P=j.type.defaultProps!==void 0?me(me({},j.type.defaultProps),j.props):j.props,G=P.dataKey,B=P.maxBarSize,q=P["".concat(z,"Id")],ne=P["".concat(Y,"Id")],ye={},pe=l.reduce(function(K,ue){var ve=w["".concat(ue.axisType,"Map")],ke=P["".concat(ue.axisType,"Id")];ve&&ve[ke]||ue.axisType==="zAxis"||no();var Be=ve[ke];return me(me({},K),{},We(We({},ue.axisType,Be),"".concat(ue.axisType,"Ticks"),Za(Be)))},ye),te=pe[Y],le=pe["".concat(Y,"Ticks")],Se=k&&k[q]&&k[q].hasStack&&VZ(j,k[q].stackGroups),N=ri(j.type).indexOf("Bar")>=0,Re=Ph(te,le),ae=[],re=J&&CZ({barSize:T,stackGroups:k,totalSize:ble(pe,Y)});if(N){var fe,de,Ue=tt(B)?M:B,at=(fe=(de=Ph(te,le,!0))!==null&&de!==void 0?de:Ue)!==null&&fe!==void 0?fe:0;ae=PZ({barGap:C,barCategoryGap:A,bandSize:at!==Re?at:Re,sizeList:re[ne],maxBarSize:Ue}),at!==Re&&(ae=ae.map(function(K){return me(me({},K),{},{position:me(me({},K.position),{},{offset:K.position.offset-at/2})})}))}var I=j&&j.type&&j.type.getComposedData;I&&Q.push({props:me(me({},I(me(me({},pe),{},{displayedData:ee,props:x,dataKey:G,item:j,bandSize:Re,barPosition:ae,offset:b,stackedData:Se,layout:F,dataStartIndex:S,dataEndIndex:E}))),{},We(We(We({key:j.key||"item-".concat(X)},z,pe[z]),Y,pe[Y]),"animationId",_)),childIndex:OB(j,x.children),item:j})}),Q},h=function(x,w){var y=x.props,k=x.dataStartIndex,b=x.dataEndIndex,_=x.updateId;if(!M2({props:y}))return null;var S=y.children,E=y.layout,T=y.stackOffset,F=y.data,C=y.reverseStackOrder,A=pT(E),M=A.numericAxisName,V=A.cateAxisName,z=Kn(S,n),Y=WZ(F,z,"".concat(M,"Id"),"".concat(V,"Id"),T,C),J=l.reduce(function(P,G){var B="".concat(G.axisType,"Map");return me(me({},P),{},We({},B,gle(y,me(me({},G),{},{graphicalItems:z,stackGroups:G.axisType===M&&Y,dataStartIndex:k,dataEndIndex:b}))))},{}),Q=wle(me(me({},J),{},{props:y,graphicalItems:z}),w==null?void 0:w.legendBBox);Object.keys(J).forEach(function(P){J[P]=u(y,J[P],Q,P.replace("Map",""),r)});var j=J["".concat(V,"Map")],X=yle(j),ee=d(y,me(me({},J),{},{dataStartIndex:k,dataEndIndex:b,updateId:_,graphicalItems:z,stackGroups:Y,offset:Q}));return me(me({formattedGraphicalItems:ee,graphicalItems:z,offset:Q,stackGroups:Y},X),J)},m=function(g){function x(w){var y,k,b;return ele(this,x),b=nle(this,x,[w]),We(b,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),We(b,"accessibilityManager",new Boe),We(b,"handleLegendBBoxUpdate",function(_){if(_){var S=b.state,E=S.dataStartIndex,T=S.dataEndIndex,F=S.updateId;b.setState(me({legendBBox:_},h({props:b.props,dataStartIndex:E,dataEndIndex:T,updateId:F},me(me({},b.state),{},{legendBBox:_}))))}}),We(b,"handleReceiveSyncEvent",function(_,S,E){if(b.props.syncId===_){if(E===b.eventEmitterSymbol&&typeof b.props.syncMethod!="function")return;b.applySyncEvent(S)}}),We(b,"handleBrushChange",function(_){var S=_.startIndex,E=_.endIndex;if(S!==b.state.dataStartIndex||E!==b.state.dataEndIndex){var T=b.state.updateId;b.setState(function(){return me({dataStartIndex:S,dataEndIndex:E},h({props:b.props,dataStartIndex:S,dataEndIndex:E,updateId:T},b.state))}),b.triggerSyncEvent({dataStartIndex:S,dataEndIndex:E})}}),We(b,"handleMouseEnter",function(_){var S=b.getMouseInfo(_);if(S){var E=me(me({},S),{},{isTooltipActive:!0});b.setState(E),b.triggerSyncEvent(E);var T=b.props.onMouseEnter;Je(T)&&T(E,_)}}),We(b,"triggeredAfterMouseMove",function(_){var S=b.getMouseInfo(_),E=S?me(me({},S),{},{isTooltipActive:!0}):{isTooltipActive:!1};b.setState(E),b.triggerSyncEvent(E);var T=b.props.onMouseMove;Je(T)&&T(E,_)}),We(b,"handleItemMouseEnter",function(_){b.setState(function(){return{isTooltipActive:!0,activeItem:_,activePayload:_.tooltipPayload,activeCoordinate:_.tooltipPosition||{x:_.cx,y:_.cy}}})}),We(b,"handleItemMouseLeave",function(){b.setState(function(){return{isTooltipActive:!1}})}),We(b,"handleMouseMove",function(_){_.persist(),b.throttleTriggeredAfterMouseMove(_)}),We(b,"handleMouseLeave",function(_){b.throttleTriggeredAfterMouseMove.cancel();var S={isTooltipActive:!1};b.setState(S),b.triggerSyncEvent(S);var E=b.props.onMouseLeave;Je(E)&&E(S,_)}),We(b,"handleOuterEvent",function(_){var S=AB(_),E=Gn(b.props,"".concat(S));if(S&&Je(E)){var T,F;/.*touch.*/i.test(S)?F=b.getMouseInfo(_.changedTouches[0]):F=b.getMouseInfo(_),E((T=F)!==null&&T!==void 0?T:{},_)}}),We(b,"handleClick",function(_){var S=b.getMouseInfo(_);if(S){var E=me(me({},S),{},{isTooltipActive:!0});b.setState(E),b.triggerSyncEvent(E);var T=b.props.onClick;Je(T)&&T(E,_)}}),We(b,"handleMouseDown",function(_){var S=b.props.onMouseDown;if(Je(S)){var E=b.getMouseInfo(_);S(E,_)}}),We(b,"handleMouseUp",function(_){var S=b.props.onMouseUp;if(Je(S)){var E=b.getMouseInfo(_);S(E,_)}}),We(b,"handleTouchMove",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&b.throttleTriggeredAfterMouseMove(_.changedTouches[0])}),We(b,"handleTouchStart",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&b.handleMouseDown(_.changedTouches[0])}),We(b,"handleTouchEnd",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&b.handleMouseUp(_.changedTouches[0])}),We(b,"handleDoubleClick",function(_){var S=b.props.onDoubleClick;if(Je(S)){var E=b.getMouseInfo(_);S(E,_)}}),We(b,"handleContextMenu",function(_){var S=b.props.onContextMenu;if(Je(S)){var E=b.getMouseInfo(_);S(E,_)}}),We(b,"triggerSyncEvent",function(_){b.props.syncId!==void 0&&$v.emit(Lv,b.props.syncId,_,b.eventEmitterSymbol)}),We(b,"applySyncEvent",function(_){var S=b.props,E=S.layout,T=S.syncMethod,F=b.state.updateId,C=_.dataStartIndex,A=_.dataEndIndex;if(_.dataStartIndex!==void 0||_.dataEndIndex!==void 0)b.setState(me({dataStartIndex:C,dataEndIndex:A},h({props:b.props,dataStartIndex:C,dataEndIndex:A,updateId:F},b.state)));else if(_.activeTooltipIndex!==void 0){var M=_.chartX,V=_.chartY,z=_.activeTooltipIndex,Y=b.state,J=Y.offset,Q=Y.tooltipTicks;if(!J)return;if(typeof T=="function")z=T(Q,_);else if(T==="value"){z=-1;for(var j=0;j<Q.length;j++)if(Q[j].value===_.activeLabel){z=j;break}}var X=me(me({},J),{},{x:J.left,y:J.top}),ee=Math.min(M,X.x+X.width),P=Math.min(V,X.y+X.height),G=Q[z]&&Q[z].value,B=Fx(b.state,b.props.data,z),q=Q[z]?{x:E==="horizontal"?Q[z].coordinate:ee,y:E==="horizontal"?P:Q[z].coordinate}:J3;b.setState(me(me({},_),{},{activeLabel:G,activeCoordinate:q,activePayload:B,activeTooltipIndex:z}))}else b.setState(_)}),We(b,"renderCursor",function(_){var S,E=b.state,T=E.isTooltipActive,F=E.activeCoordinate,C=E.activePayload,A=E.offset,M=E.activeTooltipIndex,V=E.tooltipAxisBandSize,z=b.getTooltipEventType(),Y=(S=_.props.active)!==null&&S!==void 0?S:T,J=b.props.layout,Q=_.key||"_recharts-cursor";return Z.createElement(Koe,{key:Q,activeCoordinate:F,activePayload:C,activeTooltipIndex:M,chartName:r,element:_,isActive:Y,layout:J,offset:A,tooltipAxisBandSize:V,tooltipEventType:z})}),We(b,"renderPolarAxis",function(_,S,E){var T=Gn(_,"type.axisType"),F=Gn(b.state,"".concat(T,"Map")),C=_.type.defaultProps,A=C!==void 0?me(me({},C),_.props):_.props,M=F&&F[A["".concat(T,"Id")]];return R.cloneElement(_,me(me({},M),{},{className:ot(T,M.className),key:_.key||"".concat(S,"-").concat(E),ticks:Za(M,!0)}))}),We(b,"renderPolarGrid",function(_){var S=_.props,E=S.radialLines,T=S.polarAngles,F=S.polarRadius,C=b.state,A=C.radiusAxisMap,M=C.angleAxisMap,V=Bi(A),z=Bi(M),Y=z.cx,J=z.cy,Q=z.innerRadius,j=z.outerRadius;return R.cloneElement(_,{polarAngles:Array.isArray(T)?T:Za(z,!0).map(function(X){return X.coordinate}),polarRadius:Array.isArray(F)?F:Za(V,!0).map(function(X){return X.coordinate}),cx:Y,cy:J,innerRadius:Q,outerRadius:j,key:_.key||"polar-grid",radialLines:E})}),We(b,"renderLegend",function(){var _=b.state.formattedGraphicalItems,S=b.props,E=S.children,T=S.width,F=S.height,C=b.props.margin||{},A=T-(C.left||0)-(C.right||0),M=Wj({children:E,formattedGraphicalItems:_,legendWidth:A,legendContent:c});if(!M)return null;var V=M.item,z=uT(M,qoe);return R.cloneElement(V,me(me({},z),{},{chartWidth:T,chartHeight:F,margin:C,onBBoxUpdate:b.handleLegendBBoxUpdate}))}),We(b,"renderTooltip",function(){var _,S=b.props,E=S.children,T=S.accessibilityLayer,F=yn(E,xn);if(!F)return null;var C=b.state,A=C.isTooltipActive,M=C.activeCoordinate,V=C.activePayload,z=C.activeLabel,Y=C.offset,J=(_=F.props.active)!==null&&_!==void 0?_:A;return R.cloneElement(F,{viewBox:me(me({},Y),{},{x:Y.left,y:Y.top}),active:J,label:z,payload:J?V:[],coordinate:M,accessibilityLayer:T})}),We(b,"renderBrush",function(_){var S=b.props,E=S.margin,T=S.data,F=b.state,C=F.offset,A=F.dataStartIndex,M=F.dataEndIndex,V=F.updateId;return R.cloneElement(_,{key:_.key||"_recharts-brush",onChange:qd(b.handleBrushChange,_.props.onChange),data:T,x:Oe(_.props.x)?_.props.x:C.left,y:Oe(_.props.y)?_.props.y:C.top+C.height+C.brushBottom-(E.bottom||0),width:Oe(_.props.width)?_.props.width:C.width,startIndex:A,endIndex:M,updateId:"brush-".concat(V)})}),We(b,"renderReferenceElement",function(_,S,E){if(!_)return null;var T=b,F=T.clipPathId,C=b.state,A=C.xAxisMap,M=C.yAxisMap,V=C.offset,z=_.type.defaultProps||{},Y=_.props,J=Y.xAxisId,Q=J===void 0?z.xAxisId:J,j=Y.yAxisId,X=j===void 0?z.yAxisId:j;return R.cloneElement(_,{key:_.key||"".concat(S,"-").concat(E),xAxis:A[Q],yAxis:M[X],viewBox:{x:V.left,y:V.top,width:V.width,height:V.height},clipPathId:F})}),We(b,"renderActivePoints",function(_){var S=_.item,E=_.activePoint,T=_.basePoint,F=_.childIndex,C=_.isRange,A=[],M=S.props.key,V=S.item.type.defaultProps!==void 0?me(me({},S.item.type.defaultProps),S.item.props):S.item.props,z=V.activeDot,Y=V.dataKey,J=me(me({index:F,dataKey:Y,cx:E.x,cy:E.y,r:4,fill:zw(S.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},nt(z,!1)),eh(z));return A.push(x.renderActiveDot(z,J,"".concat(M,"-activePoint-").concat(F))),T?A.push(x.renderActiveDot(z,me(me({},J),{},{cx:T.x,cy:T.y}),"".concat(M,"-basePoint-").concat(F))):C&&A.push(null),A}),We(b,"renderGraphicChild",function(_,S,E){var T=b.filterFormatItem(_,S,E);if(!T)return null;var F=b.getTooltipEventType(),C=b.state,A=C.isTooltipActive,M=C.tooltipAxis,V=C.activeTooltipIndex,z=C.activeLabel,Y=b.props.children,J=yn(Y,xn),Q=T.props,j=Q.points,X=Q.isRange,ee=Q.baseLine,P=T.item.type.defaultProps!==void 0?me(me({},T.item.type.defaultProps),T.item.props):T.item.props,G=P.activeDot,B=P.hide,q=P.activeBar,ne=P.activeShape,ye=!!(!B&&A&&J&&(G||q||ne)),pe={};F!=="axis"&&J&&J.props.trigger==="click"?pe={onClick:qd(b.handleItemMouseEnter,_.props.onClick)}:F!=="axis"&&(pe={onMouseLeave:qd(b.handleItemMouseLeave,_.props.onMouseLeave),onMouseEnter:qd(b.handleItemMouseEnter,_.props.onMouseEnter)});var te=R.cloneElement(_,me(me({},T.props),pe));function le(ue){return typeof M.dataKey=="function"?M.dataKey(ue.payload):null}if(ye)if(V>=0){var Se,N;if(M.dataKey&&!M.allowDuplicatedCategory){var Re=typeof M.dataKey=="function"?le:"payload.".concat(M.dataKey.toString());Se=Z0(j,Re,z),N=X&&ee&&Z0(ee,Re,z)}else Se=j==null?void 0:j[V],N=X&&ee&&ee[V];if(ne||q){var ae=_.props.activeIndex!==void 0?_.props.activeIndex:V;return[R.cloneElement(_,me(me(me({},T.props),pe),{},{activeIndex:ae})),null,null]}if(!tt(Se))return[te].concat(Xl(b.renderActivePoints({item:T,activePoint:Se,basePoint:N,childIndex:V,isRange:X})))}else{var re,fe=(re=b.getItemByXY(b.state.activeCoordinate))!==null&&re!==void 0?re:{graphicalItem:te},de=fe.graphicalItem,Ue=de.item,at=Ue===void 0?_:Ue,I=de.childIndex,K=me(me(me({},T.props),pe),{},{activeIndex:I});return[R.cloneElement(at,K),null,null]}return X?[te,null,null]:[te,null]}),We(b,"renderCustomized",function(_,S,E){return R.cloneElement(_,me(me({key:"recharts-customized-".concat(E)},b.props),b.state))}),We(b,"renderMap",{CartesianGrid:{handler:Zd,once:!0},ReferenceArea:{handler:b.renderReferenceElement},ReferenceLine:{handler:Zd},ReferenceDot:{handler:b.renderReferenceElement},XAxis:{handler:Zd},YAxis:{handler:Zd},Brush:{handler:b.renderBrush,once:!0},Bar:{handler:b.renderGraphicChild},Line:{handler:b.renderGraphicChild},Area:{handler:b.renderGraphicChild},Radar:{handler:b.renderGraphicChild},RadialBar:{handler:b.renderGraphicChild},Scatter:{handler:b.renderGraphicChild},Pie:{handler:b.renderGraphicChild},Funnel:{handler:b.renderGraphicChild},Tooltip:{handler:b.renderCursor,once:!0},PolarGrid:{handler:b.renderPolarGrid,once:!0},PolarAngleAxis:{handler:b.renderPolarAxis},PolarRadiusAxis:{handler:b.renderPolarAxis},Customized:{handler:b.renderCustomized}}),b.clipPathId="".concat((y=w.id)!==null&&y!==void 0?y:Zf("recharts"),"-clip"),b.throttleTriggeredAfterMouseMove=U4(b.triggeredAfterMouseMove,(k=w.throttleDelay)!==null&&k!==void 0?k:1e3/60),b.state={},b}return sle(x,g),rle(x,[{key:"componentDidMount",value:function(){var y,k;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(y=this.props.margin.left)!==null&&y!==void 0?y:0,top:(k=this.props.margin.top)!==null&&k!==void 0?k:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var y=this.props,k=y.children,b=y.data,_=y.height,S=y.layout,E=yn(k,xn);if(E){var T=E.props.defaultIndex;if(!(typeof T!="number"||T<0||T>this.state.tooltipTicks.length-1)){var F=this.state.tooltipTicks[T]&&this.state.tooltipTicks[T].value,C=Fx(this.state,b,T,F),A=this.state.tooltipTicks[T].coordinate,M=(this.state.offset.top+_)/2,V=S==="horizontal",z=V?{x:A,y:M}:{y:A,x:M},Y=this.state.formattedGraphicalItems.find(function(Q){var j=Q.item;return j.type.name==="Scatter"});Y&&(z=me(me({},z),Y.props.points[T].tooltipPosition),C=Y.props.points[T].tooltipPayload);var J={activeTooltipIndex:T,isTooltipActive:!0,activeLabel:F,activePayload:C,activeCoordinate:z};this.setState(J),this.renderCursor(E),this.accessibilityManager.setIndex(T)}}}},{key:"getSnapshotBeforeUpdate",value:function(y,k){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==k.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==y.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==y.margin){var b,_;this.accessibilityManager.setDetails({offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0}})}return null}},{key:"componentDidUpdate",value:function(y){fy([yn(y.children,xn)],[yn(this.props.children,xn)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var y=yn(this.props.children,xn);if(y&&typeof y.props.shared=="boolean"){var k=y.props.shared?"axis":"item";return o.indexOf(k)>=0?k:i}return i}},{key:"getMouseInfo",value:function(y){if(!this.container)return null;var k=this.container,b=k.getBoundingClientRect(),_=eX(b),S={chartX:Math.round(y.pageX-_.left),chartY:Math.round(y.pageY-_.top)},E=b.width/k.offsetWidth||1,T=this.inRange(S.chartX,S.chartY,E);if(!T)return null;var F=this.state,C=F.xAxisMap,A=F.yAxisMap,M=this.getTooltipEventType(),V=dT(this.state,this.props.data,this.props.layout,T);if(M!=="axis"&&C&&A){var z=Bi(C).scale,Y=Bi(A).scale,J=z&&z.invert?z.invert(S.chartX):null,Q=Y&&Y.invert?Y.invert(S.chartY):null;return me(me({},S),{},{xValue:J,yValue:Q},V)}return V?me(me({},S),V):null}},{key:"inRange",value:function(y,k){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,_=this.props.layout,S=y/b,E=k/b;if(_==="horizontal"||_==="vertical"){var T=this.state.offset,F=S>=T.left&&S<=T.left+T.width&&E>=T.top&&E<=T.top+T.height;return F?{x:S,y:E}:null}var C=this.state,A=C.angleAxisMap,M=C.radiusAxisMap;if(A&&M){var V=Bi(A);return Kk({x:S,y:E},V)}return null}},{key:"parseEventsOfWrapper",value:function(){var y=this.props.children,k=this.getTooltipEventType(),b=yn(y,xn),_={};b&&k==="axis"&&(b.props.trigger==="click"?_={onClick:this.handleClick}:_={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var S=eh(this.props,this.handleOuterEvent);return me(me({},S),_)}},{key:"addListener",value:function(){$v.on(Lv,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){$v.removeListener(Lv,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(y,k,b){for(var _=this.state.formattedGraphicalItems,S=0,E=_.length;S<E;S++){var T=_[S];if(T.item===y||T.props.key===y.key||k===ri(T.item.type)&&b===T.childIndex)return T}return null}},{key:"renderClipPath",value:function(){var y=this.clipPathId,k=this.state.offset,b=k.left,_=k.top,S=k.height,E=k.width;return Z.createElement("defs",null,Z.createElement("clipPath",{id:y},Z.createElement("rect",{x:b,y:_,height:S,width:E})))}},{key:"getXScales",value:function(){var y=this.state.xAxisMap;return y?Object.entries(y).reduce(function(k,b){var _=cT(b,2),S=_[0],E=_[1];return me(me({},k),{},We({},S,E.scale))},{}):null}},{key:"getYScales",value:function(){var y=this.state.yAxisMap;return y?Object.entries(y).reduce(function(k,b){var _=cT(b,2),S=_[0],E=_[1];return me(me({},k),{},We({},S,E.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(y){var k;return(k=this.state.xAxisMap)===null||k===void 0||(k=k[y])===null||k===void 0?void 0:k.scale}},{key:"getYScaleByAxisId",value:function(y){var k;return(k=this.state.yAxisMap)===null||k===void 0||(k=k[y])===null||k===void 0?void 0:k.scale}},{key:"getItemByXY",value:function(y){var k=this.state,b=k.formattedGraphicalItems,_=k.activeItem;if(b&&b.length)for(var S=0,E=b.length;S<E;S++){var T=b[S],F=T.props,C=T.item,A=C.type.defaultProps!==void 0?me(me({},C.type.defaultProps),C.props):C.props,M=ri(C.type);if(M==="Bar"){var V=(F.data||[]).find(function(Q){return Rre(y,Q)});if(V)return{graphicalItem:T,payload:V}}else if(M==="RadialBar"){var z=(F.data||[]).find(function(Q){return Kk(y,Q)});if(z)return{graphicalItem:T,payload:z}}else if(pm(T,_)||mm(T,_)||Sf(T,_)){var Y=Lne({graphicalItem:T,activeTooltipItem:_,itemData:A.data}),J=A.activeIndex===void 0?Y:A.activeIndex;return{graphicalItem:me(me({},T),{},{childIndex:J}),payload:Sf(T,_)?A.data[Y]:T.props.data[Y]}}}return null}},{key:"render",value:function(){var y=this;if(!M2(this))return null;var k=this.props,b=k.children,_=k.className,S=k.width,E=k.height,T=k.style,F=k.compact,C=k.title,A=k.desc,M=uT(k,Xoe),V=nt(M,!1);if(F)return Z.createElement(VE,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement(hy,nl({},V,{width:S,height:E,title:C,desc:A}),this.renderClipPath(),L2(b,this.renderMap)));if(this.props.accessibilityLayer){var z,Y;V.tabIndex=(z=this.props.tabIndex)!==null&&z!==void 0?z:0,V.role=(Y=this.props.role)!==null&&Y!==void 0?Y:"application",V.onKeyDown=function(Q){y.accessibilityManager.keyboardEvent(Q)},V.onFocus=function(){y.accessibilityManager.focus()}}var J=this.parseEventsOfWrapper();return Z.createElement(VE,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Z.createElement("div",nl({className:ot("recharts-wrapper",_),style:me({position:"relative",cursor:"default",width:S,height:E},T)},J,{ref:function(j){y.container=j}}),Z.createElement(hy,nl({},V,{width:S,height:E,title:C,desc:A,style:dle}),this.renderClipPath(),L2(b,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(R.Component);We(m,"displayName",r),We(m,"defaultProps",me({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),We(m,"getDerivedStateFromProps",function(g,x){var w=g.dataKey,y=g.data,k=g.children,b=g.width,_=g.height,S=g.layout,E=g.stackOffset,T=g.margin,F=x.dataStartIndex,C=x.dataEndIndex;if(x.updateId===void 0){var A=hT(g);return me(me(me({},A),{},{updateId:0},h(me(me({props:g},A),{},{updateId:0}),x)),{},{prevDataKey:w,prevData:y,prevWidth:b,prevHeight:_,prevLayout:S,prevStackOffset:E,prevMargin:T,prevChildren:k})}if(w!==x.prevDataKey||y!==x.prevData||b!==x.prevWidth||_!==x.prevHeight||S!==x.prevLayout||E!==x.prevStackOffset||!fl(T,x.prevMargin)){var M=hT(g),V={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},z=me(me({},dT(x,y,S)),{},{updateId:x.updateId+1}),Y=me(me(me({},M),V),z);return me(me(me({},Y),h(me({props:g},Y),x)),{},{prevDataKey:w,prevData:y,prevWidth:b,prevHeight:_,prevLayout:S,prevStackOffset:E,prevMargin:T,prevChildren:k})}if(!fy(k,x.prevChildren)){var J,Q,j,X,ee=yn(k,Ml),P=ee&&(J=(Q=ee.props)===null||Q===void 0?void 0:Q.startIndex)!==null&&J!==void 0?J:F,G=ee&&(j=(X=ee.props)===null||X===void 0?void 0:X.endIndex)!==null&&j!==void 0?j:C,B=P!==F||G!==C,q=!tt(y),ne=q&&!B?x.updateId:x.updateId+1;return me(me({updateId:ne},h(me(me({props:g},x),{},{updateId:ne,dataStartIndex:P,dataEndIndex:G}),x)),{},{prevChildren:k,dataStartIndex:P,dataEndIndex:G})}return null}),We(m,"renderActiveDot",function(g,x,w){var y;return R.isValidElement(g)?y=R.cloneElement(g,x):Je(g)?y=g(x):y=Z.createElement(Vw,x),Z.createElement(Yt,{className:"recharts-active-dot",key:w},y)});var p=R.forwardRef(function(x,w){return Z.createElement(m,nl({},x,{ref:w}))});return p.displayName=m.displayName,p},ep=_le({chartName:"LineChart",GraphicalChild:gi,axisComponents:[{axisType:"xAxis",AxisComp:Vl},{axisType:"yAxis",AxisComp:Kl}],formatAxisMap:uie});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var tp={};tp.version="0.18.5";var Z3=1252,Sle=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],tb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},rb=function(e){Sle.indexOf(e)!=-1&&(Z3=tb[0]=e)};function kle(){rb(1252)}var ma=function(e){rb(e)};function nb(){ma(1200),kle()}function mT(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Ele(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function eN(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ru=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Ele(e.slice(2)):t==254&&r==255?eN(e.slice(2)):t==65279?e.slice(1):e},e0=function(t){return String.fromCharCode(t)},vT=function(t){return String.fromCharCode(t)},Pf,Vi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function jf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Vi.charAt(i)+Vi.charAt(s)+Vi.charAt(o)+Vi.charAt(l);return t}function Cn(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=Vi.indexOf(e.charAt(c++)),s=Vi.indexOf(e.charAt(c++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Vi.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Vi.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Si=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function is(e){return Qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function gT(e){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Sn=function(t){return Qe?Si(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function _m(e){if(typeof ArrayBuffer>"u")return Sn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function ys(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Tle(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ab(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var xr=Qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Si(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Ale(e){for(var t=[],r=0,n=e.length+250,a=is(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=is(65535),n=65530)}return t.push(a.slice(0,r)),xr(t)}var en=/\u0000/g,nu=/[\u0001-\u0006]/g;function pl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function va(e,t){var r=""+e;return r.length>=t?r:Vt("0",t-r.length)+r}function ib(e,t){var r=""+e;return r.length>=t?r:Vt(" ",t-r.length)+r}function rp(e,t){var r=""+e;return r.length>=t?r:r+Vt(" ",t-r.length)}function Ole(e,t){var r=""+Math.round(e);return r.length>=t?r:Vt("0",t-r.length)+r}function Cle(e,t){var r=""+e;return r.length>=t?r:Vt("0",t-r.length)+r}var yT=Math.pow(2,32);function Do(e,t){if(e>yT||e<-yT)return Ole(e,t);var r=Math.round(e);return Cle(r,t)}function np(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var xT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Uv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ple(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},wT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},jle={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ap(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,c=0,u=0,f=Math.floor(a);c<t&&(f=Math.floor(a),o=f*s+i,u=f*c+l,!(a-f<5e-8));)a=1/(a-f),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function Bs(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=Mle(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var tN=new Date(1899,11,31,0,0,0),Nle=tN.getTime(),Fle=new Date(1900,2,1,0,0,0);function rN(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Fle&&(r+=24*60*60*1e3),(r-(Nle+(e.getTimezoneOffset()-tN.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function sb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ile(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Dle(e){var t=e<0?12:11,r=sb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Rle(e){var t=sb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Nf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Dle(e):t===10?r=e.toFixed(10).substr(0,12):r=Rle(e),sb(Ile(r.toUpperCase()))}function io(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Nf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Qn(14,rN(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Mle(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function $le(e,t,r,n){var a="",i=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Uv[r.m-1][1];case 5:return Uv[r.m-1][0];default:return Uv[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return xT[r.q][0];default:return xT[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?va(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=va(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?va(l,c):"";return u}function Gi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var nN=/%/g;function Lle(e,t,r){var n=t.replace(nN,""),a=t.length-n.length;return si(e,n,r*Math.pow(10,2*a))+Vt("%",a)}function Ble(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return si(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function aN(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+aN(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var iN=/# (\?+)( ?)\/( ?)(\d+)/;function Ule(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Vt(" ",e[1].length+1+e[4].length):ib(s,e[1].length)+e[2]+"/"+e[3]+va(o,e[4].length))}function Wle(e,t,r){return r+(t===0?"":""+t)+Vt(" ",e[1].length+2+e[4].length)}var sN=/^#*0*\.([0#]+)/,oN=/\).*[0#]/,lN=/\(###\) ###\\?-####/;function Yr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function bT(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function _T(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function zle(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Hle(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Rn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(oN)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Rn("n",n,r):"("+Rn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ble(e,t,r);if(t.indexOf("%")!==-1)return Lle(e,t,r);if(t.indexOf("E")!==-1)return aN(t,r);if(t.charCodeAt(0)===36)return"$"+Rn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Do(l,t.length);if(t.match(/^[#?]+$/))return a=Do(r,0),a==="0"&&(a=""),a.length>t.length?a:Yr(t.substr(0,t.length-a.length))+a;if(i=t.match(iN))return Ule(i,l,c);if(t.match(/^#+0+$/))return c+Do(l,t.length-t.indexOf("0"));if(i=t.match(sN))return a=bT(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Yr(i[1])).replace(/\.$/,"."+Yr(i[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Vt("0",Yr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+bT(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Gi(Do(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Rn(e,t,-r):Gi(""+(Math.floor(r)+zle(r,i[1].length)))+"."+va(_T(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Rn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=pl(Rn(e,t.replace(/[\\-]/g,""),r)),s=0,pl(pl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<a.length?a.charAt(s++):m==="0"?"0":""}));if(t.match(lN))return a=Rn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=ap(l,Math.pow(10,s)-1,!1),a=""+c,u=si("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=rp(o[2],s),u.length<i[4].length&&(u=Yr(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=ap(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ib(o[1],s)+i[2]+"/"+i[3]+rp(o[2],s):Vt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Do(r,0),t.length<=a.length?a:Yr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,d=t.length-a.length-f;return Yr(t.substr(0,f)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=_T(r,i[1].length),r<0?"-"+Rn(e,t,-r):Gi(Hle(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?va(0,3-m.length):"")+m})+"."+va(s,i[1].length);switch(t){case"###,##0.00":return Rn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Gi(Do(l,0));return h!=="0"?c+h:"";case"###,###.00":return Rn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Rn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Vle(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return si(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Gle(e,t,r){var n=t.replace(nN,""),a=t.length-n.length;return si(e,n,r*Math.pow(10,2*a))+Vt("%",a)}function cN(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+cN(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Aa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(oN)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Aa("n",n,r):"("+Aa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Vle(e,t,r);if(t.indexOf("%")!==-1)return Gle(e,t,r);if(t.indexOf("E")!==-1)return cN(t,r);if(t.charCodeAt(0)===36)return"$"+Aa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+va(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Yr(t.substr(0,t.length-a.length))+a;if(i=t.match(iN))return Wle(i,l,c);if(t.match(/^#+0+$/))return c+va(l,t.length-t.indexOf("0"));if(i=t.match(sN))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Yr(i[1])).replace(/\.$/,"."+Yr(i[1])),a=a.replace(/\.(\d*)$/,function(m,p){return"."+p+Vt("0",Yr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Gi(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Aa(e,t,-r):Gi(""+r)+"."+Vt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Aa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=pl(Aa(e,t.replace(/[\\-]/g,""),r)),s=0,pl(pl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<a.length?a.charAt(s++):m==="0"?"0":""}));if(t.match(lN))return a=Aa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=ap(l,Math.pow(10,s)-1,!1),a=""+c,u=si("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=rp(o[2],s),u.length<i[4].length&&(u=Yr(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=ap(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ib(o[1],s)+i[2]+"/"+i[3]+rp(o[2],s):Vt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Yr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,d=t.length-a.length-f;return Yr(t.substr(0,f)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Aa(e,t,-r):Gi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?va(0,3-m.length):"")+m})+"."+va(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Gi(""+l);return h!=="0"?c+h:"";default:if(t.match(/\.[0#?]*$/))return Aa(e,t.slice(0,t.lastIndexOf(".")),r)+Yr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function si(e,t,r){return(r|0)===r?Aa(e,t,r):Rn(e,t,r)}function Kle(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var uN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":np(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(uN))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function qle(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",c,u,f,d="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!np(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=Bs(t,r,e.charAt(s+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Bs(t,r),c==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(c==null&&(c=Bs(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",d="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",s+=5,d="h"):e.substr(s,5).toUpperCase()==="上午/下午"?(c!=null&&(p.v=c.H>=12?"下午":"上午"),p.t="T",s+=5,d="h"):(p.t="t",++s),c==null&&p.t==="T")return"";a[a.length]=p,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(uN)){if(c==null&&(c=Bs(t,r),c==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",yc(e)||(a[a.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var g=0,x=0,w;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=d,l="h",g<1&&(g=1);break;case"s":(w=a[s].v.match(/\.0+$/))&&(x=Math.max(x,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[s].v.match(/[Hh]/)&&(g=1),g<2&&a[s].v.match(/[Mm]/)&&(g=2),g<3&&a[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",k;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=$le(a[s].t.charCodeAt(0),a[s].v,c,x),a[s].t="t";break;case"n":case"?":for(k=s+1;a[k]!=null&&((o=a[k].t)==="?"||o==="D"||(o===" "||o==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[s].v+=a[k].v,a[k]={v:"",t:";"},++k;y+=a[s].v,s=k-1;break;case"G":a[s].t="t",a[s].v=io(t,r);break}var b="",_,S;if(y.length>0){y.charCodeAt(0)==40?(_=t<0&&y.charCodeAt(0)===45?-t:t,S=si("n",y,_)):(_=t<0&&n>1?-t:t,S=si("n",y,_),_<0&&a[0]&&a[0].t=="t"&&(S=S.substr(1),a[0].v="-"+a[0].v)),k=S.length-1;var E=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){E=s;break}var T=a.length;if(E===a.length&&S.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(k>=a[s].v.length-1?(k-=a[s].v.length,a[s].v=S.substr(k+1,a[s].v.length)):k<0?a[s].v="":(a[s].v=S.substr(0,k+1),k=-1),a[s].t="t",T=s);k>=0&&T<a.length&&(a[T].v=S.substr(0,k+1)+a[T].v)}else if(E!==a.length&&S.indexOf("E")===-1){for(k=S.indexOf(".")-1,s=E;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===E?a[s].v.indexOf(".")-1:a[s].v.length-1,b=a[s].v.substr(u+1);u>=0;--u)k>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(b=S.charAt(k--)+b);a[s].v=b,a[s].t="t",T=s}for(k>=0&&T<a.length&&(a[T].v=S.substr(0,k+1)+a[T].v),k=S.indexOf(".")+1,s=E;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==E)){for(u=a[s].v.indexOf(".")>-1&&s===E?a[s].v.indexOf(".")+1:0,b=a[s].v.substr(0,u);u<a[s].v.length;++u)k<S.length&&(b+=S.charAt(k++));a[s].v=b,a[s].t="t",T=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(_=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=si(a[s].t,a[s].v,_),a[s].t="t");var F="";for(s=0;s!==a.length;++s)a[s]!=null&&(F+=a[s].v);return F}var ST=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function kT(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Xle(e,t){var r=Kle(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(ST),o=r[1].match(ST);return kT(t,s)?[n,r[0]]:kT(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Qn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[e],n==null&&(n=r.table&&r.table[wT[e]]||ze[wT[e]]),n==null&&(n=jle[e]||"General");break}if(np(n,0))return io(t,r);t instanceof Date&&(t=rN(t,r.date1904));var a=Xle(n,t);if(np(a[1]))return io(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return qle(a[1],t,r,a[0])}function oi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ze[r]==null){t<0&&(t=r);continue}if(ze[r]==e){t=r;break}}t<0&&(t=391)}return ze[t]=e,t}function Sm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&oi(e[t],t)}function xc(){ze=Ple()}var Yle={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},fN=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Jle(e){var t=typeof e=="number"?ze[e]:e;return t=t.replace(fN,"(\\d+)"),new RegExp("^"+t+"$")}function Qle(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(fN)||[]).forEach(function(f,d){var h=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":s=h;break;case"s":l=h;break;case"m":s>=0?o=h:a=h;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&i==-1?u:c+"T"+u}var Zle=function(){var e={};e.version="1.2.0";function t(){for(var S=0,E=new Array(256),T=0;T!=256;++T)S=T,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,E[T]=S;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(S){var E=0,T=0,F=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)C[F]=S[F];for(F=0;F!=256;++F)for(T=S[F],E=256+F;E<4096;E+=256)T=C[E]=T>>>8^S[T&255];var A=[];for(F=1;F!=16;++F)A[F-1]=typeof Int32Array<"u"?C.subarray(F*256,F*256+256):C.slice(F*256,F*256+256);return A}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],c=a[4],u=a[5],f=a[6],d=a[7],h=a[8],m=a[9],p=a[10],g=a[11],x=a[12],w=a[13],y=a[14];function k(S,E){for(var T=E^-1,F=0,C=S.length;F<C;)T=T>>>8^r[(T^S.charCodeAt(F++))&255];return~T}function b(S,E){for(var T=E^-1,F=S.length-15,C=0;C<F;)T=y[S[C++]^T&255]^w[S[C++]^T>>8&255]^x[S[C++]^T>>16&255]^g[S[C++]^T>>>24]^p[S[C++]]^m[S[C++]]^h[S[C++]]^d[S[C++]]^f[S[C++]]^u[S[C++]]^c[S[C++]]^l[S[C++]]^o[S[C++]]^s[S[C++]]^i[S[C++]]^r[S[C++]];for(F+=15;C<F;)T=T>>>8^r[(T^S[C++])&255];return~T}function _(S,E){for(var T=E^-1,F=0,C=S.length,A=0,M=0;F<C;)A=S.charCodeAt(F++),A<128?T=T>>>8^r[(T^A)&255]:A<2048?(T=T>>>8^r[(T^(192|A>>6&31))&255],T=T>>>8^r[(T^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,M=S.charCodeAt(F++)&1023,T=T>>>8^r[(T^(240|A>>8&7))&255],T=T>>>8^r[(T^(128|A>>2&63))&255],T=T>>>8^r[(T^(128|M>>6&15|(A&3)<<4))&255],T=T>>>8^r[(T^(128|M&63))&255]):(T=T>>>8^r[(T^(224|A>>12&15))&255],T=T>>>8^r[(T^(128|A>>6&63))&255],T=T>>>8^r[(T^(128|A&63))&255]);return~T}return e.table=r,e.bstr=k,e.buf=b,e.str=_,e}(),Le=function(){var t={};t.version="1.2.1";function r(O,U){for(var D=O.split("/"),L=U.split("/"),W=0,H=0,se=Math.min(D.length,L.length);W<se;++W){if(H=D[W].length-L[W].length)return H;if(D[W]!=L[W])return D[W]<L[W]?-1:1}return D.length-L.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var U=O.lastIndexOf("/");return U===-1?O:O.slice(0,U+1)}function a(O){if(O.charAt(O.length-1)=="/")return a(O.slice(0,-1));var U=O.lastIndexOf("/");return U===-1?O:O.slice(U+1)}function i(O,U){typeof U=="string"&&(U=new Date(U));var D=U.getHours();D=D<<6|U.getMinutes(),D=D<<5|U.getSeconds()>>>1,O.write_shift(2,D);var L=U.getFullYear()-1980;L=L<<4|U.getMonth()+1,L=L<<5|U.getDate(),O.write_shift(2,L)}function s(O){var U=O.read_shift(2)&65535,D=O.read_shift(2)&65535,L=new Date,W=D&31;D>>>=5;var H=D&15;D>>>=4,L.setMilliseconds(0),L.setFullYear(D+1980),L.setMonth(H-1),L.setDate(W);var se=U&31;U>>>=5;var ge=U&63;return U>>>=6,L.setHours(U),L.setMinutes(ge),L.setSeconds(se<<1),L}function o(O){Tr(O,0);for(var U={},D=0;O.l<=O.length-4;){var L=O.read_shift(2),W=O.read_shift(2),H=O.l+W,se={};switch(L){case 21589:D=O.read_shift(1),D&1&&(se.mtime=O.read_shift(4)),W>5&&(D&2&&(se.atime=O.read_shift(4)),D&4&&(se.ctime=O.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}O.l=H,U[L]=se}return U}var l;function c(){return l||(l={})}function u(O,U){if(O[0]==80&&O[1]==75)return Xb(O,U);if((O[0]|32)==109&&(O[1]|32)==105)return bI(O,U);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var D=3,L=512,W=0,H=0,se=0,ge=0,ie=0,oe=[],ce=O.slice(0,512);Tr(ce,0);var we=f(ce);switch(D=we[0],D){case 3:L=512;break;case 4:L=4096;break;case 0:if(we[1]==0)return Xb(O,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}L!==512&&(ce=O.slice(0,L),Tr(ce,28));var Pe=O.slice(0,L);d(ce,D);var Fe=ce.read_shift(4,"i");if(D===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);ce.l+=4,se=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),ge=ce.read_shift(4,"i"),W=ce.read_shift(4,"i"),ie=ce.read_shift(4,"i"),H=ce.read_shift(4,"i");for(var Ee=-1,Ne=0;Ne<109&&(Ee=ce.read_shift(4,"i"),!(Ee<0));++Ne)oe[Ne]=Ee;var Ke=h(O,L);g(ie,H,Ke,L,oe);var Dt=w(Ke,se,oe,L);Dt[se].name="!Directory",W>0&&ge!==M&&(Dt[ge].name="!MiniFAT"),Dt[oe[0]].name="!FAT",Dt.fat_addrs=oe,Dt.ssz=L;var Rt={},jr=[],Sc=[],kc=[];y(se,Dt,Ke,jr,W,Rt,Sc,ge),m(Sc,kc,jr),jr.shift();var Ec={FileIndex:Sc,FullPaths:kc};return U&&U.raw&&(Ec.raw={header:Pe,sectors:Ke}),Ec}function f(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(V,"Header Signature: "),O.l+=16;var U=O.read_shift(2,"u");return[O.read_shift(2,"u"),U]}function d(O,U){var D=9;switch(O.l+=2,D=O.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function h(O,U){for(var D=Math.ceil(O.length/U)-1,L=[],W=1;W<D;++W)L[W-1]=O.slice(W*U,(W+1)*U);return L[D-1]=O.slice(D*U),L}function m(O,U,D){for(var L=0,W=0,H=0,se=0,ge=0,ie=D.length,oe=[],ce=[];L<ie;++L)oe[L]=ce[L]=L,U[L]=D[L];for(;ge<ce.length;++ge)L=ce[ge],W=O[L].L,H=O[L].R,se=O[L].C,oe[L]===L&&(W!==-1&&oe[W]!==W&&(oe[L]=oe[W]),H!==-1&&oe[H]!==H&&(oe[L]=oe[H])),se!==-1&&(oe[se]=L),W!==-1&&L!=oe[L]&&(oe[W]=oe[L],ce.lastIndexOf(W)<ge&&ce.push(W)),H!==-1&&L!=oe[L]&&(oe[H]=oe[L],ce.lastIndexOf(H)<ge&&ce.push(H));for(L=1;L<ie;++L)oe[L]===L&&(H!==-1&&oe[H]!==H?oe[L]=oe[H]:W!==-1&&oe[W]!==W&&(oe[L]=oe[W]));for(L=1;L<ie;++L)if(O[L].type!==0){if(ge=L,ge!=oe[ge])do ge=oe[ge],U[L]=U[ge]+"/"+U[L];while(ge!==0&&oe[ge]!==-1&&ge!=oe[ge]);oe[L]=-1}for(U[0]+="/",L=1;L<ie;++L)O[L].type!==2&&(U[L]+="/")}function p(O,U,D){for(var L=O.start,W=O.size,H=[],se=L;D&&W>0&&se>=0;)H.push(U.slice(se*A,se*A+A)),W-=A,se=Ns(D,se*4);return H.length===0?he(0):xr(H).slice(0,O.size)}function g(O,U,D,L,W){var H=M;if(O===M){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var se=D[O],ge=(L>>>2)-1;if(!se)return;for(var ie=0;ie<ge&&(H=Ns(se,ie*4))!==M;++ie)W.push(H);g(Ns(se,L-4),U-1,D,L,W)}}function x(O,U,D,L,W){var H=[],se=[];W||(W=[]);var ge=L-1,ie=0,oe=0;for(ie=U;ie>=0;){W[ie]=!0,H[H.length]=ie,se.push(O[ie]);var ce=D[Math.floor(ie*4/L)];if(oe=ie*4&ge,L<4+oe)throw new Error("FAT boundary crossed: "+ie+" 4 "+L);if(!O[ce])break;ie=Ns(O[ce],oe)}return{nodes:H,data:RT([se])}}function w(O,U,D,L){var W=O.length,H=[],se=[],ge=[],ie=[],oe=L-1,ce=0,we=0,Pe=0,Fe=0;for(ce=0;ce<W;++ce)if(ge=[],Pe=ce+U,Pe>=W&&(Pe-=W),!se[Pe]){ie=[];var Ee=[];for(we=Pe;we>=0;){Ee[we]=!0,se[we]=!0,ge[ge.length]=we,ie.push(O[we]);var Ne=D[Math.floor(we*4/L)];if(Fe=we*4&oe,L<4+Fe)throw new Error("FAT boundary crossed: "+we+" 4 "+L);if(!O[Ne]||(we=Ns(O[Ne],Fe),Ee[we]))break}H[Pe]={nodes:ge,data:RT([ie])}}return H}function y(O,U,D,L,W,H,se,ge){for(var ie=0,oe=L.length?2:0,ce=U[O].data,we=0,Pe=0,Fe;we<ce.length;we+=128){var Ee=ce.slice(we,we+128);Tr(Ee,64),Pe=Ee.read_shift(2),Fe=hb(Ee,0,Pe-oe),L.push(Fe);var Ne={name:Fe,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},Ke=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Ke!==0&&(Ne.ct=k(Ee,Ee.l-8));var Dt=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Dt!==0&&(Ne.mt=k(Ee,Ee.l-8)),Ne.start=Ee.read_shift(4,"i"),Ne.size=Ee.read_shift(4,"i"),Ne.size<0&&Ne.start<0&&(Ne.size=Ne.type=0,Ne.start=M,Ne.name=""),Ne.type===5?(ie=Ne.start,W>0&&ie!==M&&(U[ie].name="!StreamData")):Ne.size>=4096?(Ne.storage="fat",U[Ne.start]===void 0&&(U[Ne.start]=x(D,Ne.start,U.fat_addrs,U.ssz)),U[Ne.start].name=Ne.name,Ne.content=U[Ne.start].data.slice(0,Ne.size)):(Ne.storage="minifat",Ne.size<0?Ne.size=0:ie!==M&&Ne.start!==M&&U[ie]&&(Ne.content=p(Ne,U[ie].data,(U[ge]||{}).data))),Ne.content&&Tr(Ne.content,0),H[Fe]=Ne,se.push(Ne)}}function k(O,U){return new Date((bn(O,U+4)/1e7*Math.pow(2,32)+bn(O,U)/1e7-11644473600)*1e3)}function b(O,U){return c(),u(l.readFileSync(O),U)}function _(O,U){var D=U&&U.type;switch(D||Qe&&Buffer.isBuffer(O)&&(D="buffer"),D||"base64"){case"file":return b(O,U);case"base64":return u(Sn(Cn(O)),U);case"binary":return u(Sn(O),U)}return u(O,U)}function S(O,U){var D=U||{},L=D.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=L+"/",O.FileIndex[0]={name:L,type:5}),D.CLSID&&(O.FileIndex[0].clsid=D.CLSID),E(O)}function E(O){var U="Sh33tJ5";if(!Le.find(O,"/"+U)){var D=he(4);D[0]=55,D[1]=D[3]=50,D[2]=54,O.FileIndex.push({name:U,type:2,content:D,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+U),T(O)}}function T(O,U){S(O);for(var D=!1,L=!1,W=O.FullPaths.length-1;W>=0;--W){var H=O.FileIndex[W];switch(H.type){case 0:L?D=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(H.R*H.L*H.C)&&(D=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!U)){var se=new Date(1987,1,19),ge=0,ie=Object.create?Object.create(null):{},oe=[];for(W=0;W<O.FullPaths.length;++W)ie[O.FullPaths[W]]=!0,O.FileIndex[W].type!==0&&oe.push([O.FullPaths[W],O.FileIndex[W]]);for(W=0;W<oe.length;++W){var ce=n(oe[W][0]);L=ie[ce],L||(oe.push([ce,{name:a(ce).replace("/",""),type:1,clsid:Y,ct:se,mt:se,content:null}]),ie[ce]=!0)}for(oe.sort(function(Fe,Ee){return r(Fe[0],Ee[0])}),O.FullPaths=[],O.FileIndex=[],W=0;W<oe.length;++W)O.FullPaths[W]=oe[W][0],O.FileIndex[W]=oe[W][1];for(W=0;W<oe.length;++W){var we=O.FileIndex[W],Pe=O.FullPaths[W];if(we.name=a(Pe).replace("/",""),we.L=we.R=we.C=-(we.color=1),we.size=we.content?we.content.length:0,we.start=0,we.clsid=we.clsid||Y,W===0)we.C=oe.length>1?1:-1,we.size=0,we.type=5;else if(Pe.slice(-1)=="/"){for(ge=W+1;ge<oe.length&&n(O.FullPaths[ge])!=Pe;++ge);for(we.C=ge>=oe.length?-1:ge,ge=W+1;ge<oe.length&&n(O.FullPaths[ge])!=n(Pe);++ge);we.R=ge>=oe.length?-1:ge,we.type=1}else n(O.FullPaths[W+1]||"")==n(Pe)&&(we.R=W+1),we.type=2}}}function F(O,U){var D=U||{};if(D.fileType=="mad")return _I(O,D);switch(T(O),D.fileType){case"zip":return mI(O,D)}var L=function(Fe){for(var Ee=0,Ne=0,Ke=0;Ke<Fe.FileIndex.length;++Ke){var Dt=Fe.FileIndex[Ke];if(Dt.content){var Rt=Dt.content.length;Rt>0&&(Rt<4096?Ee+=Rt+63>>6:Ne+=Rt+511>>9)}}for(var jr=Fe.FullPaths.length+3>>2,Sc=Ee+7>>3,kc=Ee+127>>7,Ec=Sc+Ne+jr+kc,bs=Ec+127>>7,Nm=bs<=109?0:Math.ceil((bs-109)/127);Ec+bs+Nm+127>>7>bs;)Nm=++bs<=109?0:Math.ceil((bs-109)/127);var Wa=[1,Nm,bs,kc,jr,Ne,Ee,0];return Fe.FileIndex[0].size=Ee<<6,Wa[7]=(Fe.FileIndex[0].start=Wa[0]+Wa[1]+Wa[2]+Wa[3]+Wa[4]+Wa[5])+(Wa[6]+7>>3),Wa}(O),W=he(L[7]<<9),H=0,se=0;{for(H=0;H<8;++H)W.write_shift(1,z[H]);for(H=0;H<8;++H)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),H=0;H<3;++H)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,L[2]),W.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:M),W.write_shift(4,L[3]),W.write_shift(-4,L[1]?L[0]-1:M),W.write_shift(4,L[1]),H=0;H<109;++H)W.write_shift(-4,H<L[2]?L[1]+H:-1)}if(L[1])for(se=0;se<L[1];++se){for(;H<236+se*127;++H)W.write_shift(-4,H<L[2]?L[1]+H:-1);W.write_shift(-4,se===L[1]-1?M:se+1)}var ge=function(Fe){for(se+=Fe;H<se-1;++H)W.write_shift(-4,H+1);Fe&&(++H,W.write_shift(-4,M))};for(se=H=0,se+=L[1];H<se;++H)W.write_shift(-4,J.DIFSECT);for(se+=L[2];H<se;++H)W.write_shift(-4,J.FATSECT);ge(L[3]),ge(L[4]);for(var ie=0,oe=0,ce=O.FileIndex[0];ie<O.FileIndex.length;++ie)ce=O.FileIndex[ie],ce.content&&(oe=ce.content.length,!(oe<4096)&&(ce.start=se,ge(oe+511>>9)));for(ge(L[6]+7>>3);W.l&511;)W.write_shift(-4,J.ENDOFCHAIN);for(se=H=0,ie=0;ie<O.FileIndex.length;++ie)ce=O.FileIndex[ie],ce.content&&(oe=ce.content.length,!(!oe||oe>=4096)&&(ce.start=se,ge(oe+63>>6)));for(;W.l&511;)W.write_shift(-4,J.ENDOFCHAIN);for(H=0;H<L[4]<<2;++H){var we=O.FullPaths[H];if(!we||we.length===0){for(ie=0;ie<17;++ie)W.write_shift(4,0);for(ie=0;ie<3;++ie)W.write_shift(4,-1);for(ie=0;ie<12;++ie)W.write_shift(4,0);continue}ce=O.FileIndex[H],H===0&&(ce.start=ce.size?ce.start-1:M);var Pe=H===0&&D.root||ce.name;if(oe=2*(Pe.length+1),W.write_shift(64,Pe,"utf16le"),W.write_shift(2,oe),W.write_shift(1,ce.type),W.write_shift(1,ce.color),W.write_shift(-4,ce.L),W.write_shift(-4,ce.R),W.write_shift(-4,ce.C),ce.clsid)W.write_shift(16,ce.clsid,"hex");else for(ie=0;ie<4;++ie)W.write_shift(4,0);W.write_shift(4,ce.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,ce.start),W.write_shift(4,ce.size),W.write_shift(4,0)}for(H=1;H<O.FileIndex.length;++H)if(ce=O.FileIndex[H],ce.size>=4096)if(W.l=ce.start+1<<9,Qe&&Buffer.isBuffer(ce.content))ce.content.copy(W,W.l,0,ce.size),W.l+=ce.size+511&-512;else{for(ie=0;ie<ce.size;++ie)W.write_shift(1,ce.content[ie]);for(;ie&511;++ie)W.write_shift(1,0)}for(H=1;H<O.FileIndex.length;++H)if(ce=O.FileIndex[H],ce.size>0&&ce.size<4096)if(Qe&&Buffer.isBuffer(ce.content))ce.content.copy(W,W.l,0,ce.size),W.l+=ce.size+63&-64;else{for(ie=0;ie<ce.size;++ie)W.write_shift(1,ce.content[ie]);for(;ie&63;++ie)W.write_shift(1,0)}if(Qe)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function C(O,U){var D=O.FullPaths.map(function(ie){return ie.toUpperCase()}),L=D.map(function(ie){var oe=ie.split("/");return oe[oe.length-(ie.slice(-1)=="/"?2:1)]}),W=!1;U.charCodeAt(0)===47?(W=!0,U=D[0].slice(0,-1)+U):W=U.indexOf("/")!==-1;var H=U.toUpperCase(),se=W===!0?D.indexOf(H):L.indexOf(H);if(se!==-1)return O.FileIndex[se];var ge=!H.match(nu);for(H=H.replace(en,""),ge&&(H=H.replace(nu,"!")),se=0;se<D.length;++se)if((ge?D[se].replace(nu,"!"):D[se]).replace(en,"")==H||(ge?L[se].replace(nu,"!"):L[se]).replace(en,"")==H)return O.FileIndex[se];return null}var A=64,M=-2,V="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:V,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(O,U,D){c();var L=F(O,D);l.writeFileSync(U,L)}function j(O){for(var U=new Array(O.length),D=0;D<O.length;++D)U[D]=String.fromCharCode(O[D]);return U.join("")}function X(O,U){var D=F(O,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,D),D;case"binary":return typeof D=="string"?D:j(D);case"base64":return jf(typeof D=="string"?D:j(D));case"buffer":if(Qe)return Buffer.isBuffer(D)?D:Si(D);case"array":return typeof D=="string"?Sn(D):D}return D}var ee;function P(O){try{var U=O.InflateRaw,D=new U;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)ee=O;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function G(O,U){if(!ee)return Kb(O,U);var D=ee.InflateRaw,L=new D,W=L._processChunk(O.slice(O.l),L._finishFlushFlag);return O.l+=L.bytesRead,W}function B(O){return ee?ee.deflateRawSync(O):je(O)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(O){var U=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(U>>16|U>>8|U)&255}for(var te=typeof Uint8Array<"u",le=te?new Uint8Array(256):[],Se=0;Se<256;++Se)le[Se]=pe(Se);function N(O,U){var D=le[O&255];return U<=8?D>>>8-U:(D=D<<8|le[O>>8&255],U<=16?D>>>16-U:(D=D<<8|le[O>>16&255],D>>>24-U))}function Re(O,U){var D=U&7,L=U>>>3;return(O[L]|(D<=6?0:O[L+1]<<8))>>>D&3}function ae(O,U){var D=U&7,L=U>>>3;return(O[L]|(D<=5?0:O[L+1]<<8))>>>D&7}function re(O,U){var D=U&7,L=U>>>3;return(O[L]|(D<=4?0:O[L+1]<<8))>>>D&15}function fe(O,U){var D=U&7,L=U>>>3;return(O[L]|(D<=3?0:O[L+1]<<8))>>>D&31}function de(O,U){var D=U&7,L=U>>>3;return(O[L]|(D<=1?0:O[L+1]<<8))>>>D&127}function Ue(O,U,D){var L=U&7,W=U>>>3,H=(1<<D)-1,se=O[W]>>>L;return D<8-L||(se|=O[W+1]<<8-L,D<16-L)||(se|=O[W+2]<<16-L,D<24-L)||(se|=O[W+3]<<24-L),se&H}function at(O,U,D){var L=U&7,W=U>>>3;return L<=5?O[W]|=(D&7)<<L:(O[W]|=D<<L&255,O[W+1]=(D&7)>>8-L),U+3}function I(O,U,D){var L=U&7,W=U>>>3;return D=(D&1)<<L,O[W]|=D,U+1}function K(O,U,D){var L=U&7,W=U>>>3;return D<<=L,O[W]|=D&255,D>>>=8,O[W+1]=D,U+8}function ue(O,U,D){var L=U&7,W=U>>>3;return D<<=L,O[W]|=D&255,D>>>=8,O[W+1]=D&255,O[W+2]=D>>>8,U+16}function ve(O,U){var D=O.length,L=2*D>U?2*D:U+5,W=0;if(D>=U)return O;if(Qe){var H=gT(L);if(O.copy)O.copy(H);else for(;W<O.length;++W)H[W]=O[W];return H}else if(te){var se=new Uint8Array(L);if(se.set)se.set(O);else for(;W<D;++W)se[W]=O[W];return se}return O.length=L,O}function ke(O){for(var U=new Array(O),D=0;D<O;++D)U[D]=0;return U}function Be(O,U,D){var L=1,W=0,H=0,se=0,ge=0,ie=O.length,oe=te?new Uint16Array(32):ke(32);for(H=0;H<32;++H)oe[H]=0;for(H=ie;H<D;++H)O[H]=0;ie=O.length;var ce=te?new Uint16Array(ie):ke(ie);for(H=0;H<ie;++H)oe[W=O[H]]++,L<W&&(L=W),ce[H]=0;for(oe[0]=0,H=1;H<=L;++H)oe[H+16]=ge=ge+oe[H-1]<<1;for(H=0;H<ie;++H)ge=O[H],ge!=0&&(ce[H]=oe[ge+16]++);var we=0;for(H=0;H<ie;++H)if(we=O[H],we!=0)for(ge=N(ce[H],L)>>L-we,se=(1<<L+4-we)-1;se>=0;--se)U[ge|se<<we]=we&15|H<<4;return L}var Me=te?new Uint16Array(512):ke(512),Ce=te?new Uint16Array(32):ke(32);if(!te){for(var $e=0;$e<512;++$e)Me[$e]=0;for($e=0;$e<32;++$e)Ce[$e]=0}(function(){for(var O=[],U=0;U<32;U++)O.push(5);Be(O,Ce,32);var D=[];for(U=0;U<=143;U++)D.push(8);for(;U<=255;U++)D.push(9);for(;U<=279;U++)D.push(7);for(;U<=287;U++)D.push(8);Be(D,Me,288)})();var ct=function(){for(var U=te?new Uint8Array(32768):[],D=0,L=0;D<ye.length-1;++D)for(;L<ye[D+1];++L)U[L]=D;for(;L<32768;++L)U[L]=29;var W=te?new Uint8Array(259):[];for(D=0,L=0;D<ne.length-1;++D)for(;L<ne[D+1];++L)W[L]=D;function H(ge,ie){for(var oe=0;oe<ge.length;){var ce=Math.min(65535,ge.length-oe),we=oe+ce==ge.length;for(ie.write_shift(1,+we),ie.write_shift(2,ce),ie.write_shift(2,~ce&65535);ce-- >0;)ie[ie.l++]=ge[oe++]}return ie.l}function se(ge,ie){for(var oe=0,ce=0,we=te?new Uint16Array(32768):[];ce<ge.length;){var Pe=Math.min(65535,ge.length-ce);if(Pe<10){for(oe=at(ie,oe,+(ce+Pe==ge.length)),oe&7&&(oe+=8-(oe&7)),ie.l=oe/8|0,ie.write_shift(2,Pe),ie.write_shift(2,~Pe&65535);Pe-- >0;)ie[ie.l++]=ge[ce++];oe=ie.l*8;continue}oe=at(ie,oe,+(ce+Pe==ge.length)+2);for(var Fe=0;Pe-- >0;){var Ee=ge[ce];Fe=(Fe<<5^Ee)&32767;var Ne=-1,Ke=0;if((Ne=we[Fe])&&(Ne|=ce&-32768,Ne>ce&&(Ne-=32768),Ne<ce))for(;ge[Ne+Ke]==ge[ce+Ke]&&Ke<250;)++Ke;if(Ke>2){Ee=W[Ke],Ee<=22?oe=K(ie,oe,le[Ee+1]>>1)-1:(K(ie,oe,3),oe+=5,K(ie,oe,le[Ee-23]>>5),oe+=3);var Dt=Ee<8?0:Ee-4>>2;Dt>0&&(ue(ie,oe,Ke-ne[Ee]),oe+=Dt),Ee=U[ce-Ne],oe=K(ie,oe,le[Ee]>>3),oe-=3;var Rt=Ee<4?0:Ee-2>>1;Rt>0&&(ue(ie,oe,ce-Ne-ye[Ee]),oe+=Rt);for(var jr=0;jr<Ke;++jr)we[Fe]=ce&32767,Fe=(Fe<<5^ge[ce])&32767,++ce;Pe-=Ke-1}else Ee<=143?Ee=Ee+48:oe=I(ie,oe,1),oe=K(ie,oe,le[Ee]),we[Fe]=ce&32767,++ce}oe=K(ie,oe,0)-1}return ie.l=(oe+7)/8|0,ie.l}return function(ie,oe){return ie.length<8?H(ie,oe):se(ie,oe)}}();function je(O){var U=he(50+Math.floor(O.length*1.1)),D=ct(O,U);return U.slice(0,D)}var Ge=te?new Uint16Array(32768):ke(32768),Zt=te?new Uint16Array(32768):ke(32768),yt=te?new Uint16Array(128):ke(128),Sa=1,_c=1;function md(O,U){var D=fe(O,U)+257;U+=5;var L=fe(O,U)+1;U+=5;var W=re(O,U)+4;U+=4;for(var H=0,se=te?new Uint8Array(19):ke(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,oe=te?new Uint8Array(8):ke(8),ce=te?new Uint8Array(8):ke(8),we=se.length,Pe=0;Pe<W;++Pe)se[q[Pe]]=H=ae(O,U),ie<H&&(ie=H),oe[H]++,U+=3;var Fe=0;for(oe[0]=0,Pe=1;Pe<=ie;++Pe)ce[Pe]=Fe=Fe+oe[Pe-1]<<1;for(Pe=0;Pe<we;++Pe)(Fe=se[Pe])!=0&&(ge[Pe]=ce[Fe]++);var Ee=0;for(Pe=0;Pe<we;++Pe)if(Ee=se[Pe],Ee!=0){Fe=le[ge[Pe]]>>8-Ee;for(var Ne=(1<<7-Ee)-1;Ne>=0;--Ne)yt[Fe|Ne<<Ee]=Ee&7|Pe<<3}var Ke=[];for(ie=1;Ke.length<D+L;)switch(Fe=yt[de(O,U)],U+=Fe&7,Fe>>>=3){case 16:for(H=3+Re(O,U),U+=2,Fe=Ke[Ke.length-1];H-- >0;)Ke.push(Fe);break;case 17:for(H=3+ae(O,U),U+=3;H-- >0;)Ke.push(0);break;case 18:for(H=11+de(O,U),U+=7;H-- >0;)Ke.push(0);break;default:Ke.push(Fe),ie<Fe&&(ie=Fe);break}var Dt=Ke.slice(0,D),Rt=Ke.slice(D);for(Pe=D;Pe<286;++Pe)Dt[Pe]=0;for(Pe=L;Pe<30;++Pe)Rt[Pe]=0;return Sa=Be(Dt,Ge,286),_c=Be(Rt,Zt,30),U}function vd(O,U){if(O[0]==3&&!(O[1]&3))return[is(U),2];for(var D=0,L=0,W=gT(U||1<<18),H=0,se=W.length>>>0,ge=0,ie=0;!(L&1);){if(L=ae(O,D),D+=3,L>>>1)L>>1==1?(ge=9,ie=5):(D=md(O,D),ge=Sa,ie=_c);else{D&7&&(D+=8-(D&7));var oe=O[D>>>3]|O[(D>>>3)+1]<<8;if(D+=32,oe>0)for(!U&&se<H+oe&&(W=ve(W,H+oe),se=W.length);oe-- >0;)W[H++]=O[D>>>3],D+=8;continue}for(;;){!U&&se<H+32767&&(W=ve(W,H+32767),se=W.length);var ce=Ue(O,D,ge),we=L>>>1==1?Me[ce]:Ge[ce];if(D+=we&15,we>>>=4,!(we>>>8&255))W[H++]=we;else{if(we==256)break;we-=257;var Pe=we<8?0:we-4>>2;Pe>5&&(Pe=0);var Fe=H+ne[we];Pe>0&&(Fe+=Ue(O,D,Pe),D+=Pe),ce=Ue(O,D,ie),we=L>>>1==1?Ce[ce]:Zt[ce],D+=we&15,we>>>=4;var Ee=we<4?0:we-2>>1,Ne=ye[we];for(Ee>0&&(Ne+=Ue(O,D,Ee),D+=Ee),!U&&se<Fe&&(W=ve(W,Fe+100),se=W.length);H<Fe;)W[H]=W[H-Ne],++H}}}return U?[W,D+7>>>3]:[W.slice(0,H),D+7>>>3]}function Kb(O,U){var D=O.slice(O.l||0),L=vd(D,U);return O.l+=L[1],L[0]}function qb(O,U){if(O)typeof console<"u"&&console.error(U);else throw new Error(U)}function Xb(O,U){var D=O;Tr(D,0);var L=[],W=[],H={FileIndex:L,FullPaths:W};S(H,{root:U.root});for(var se=D.length-4;(D[se]!=80||D[se+1]!=75||D[se+2]!=5||D[se+3]!=6)&&se>=0;)--se;D.l=se+4,D.l+=4;var ge=D.read_shift(2);D.l+=6;var ie=D.read_shift(4);for(D.l=ie,se=0;se<ge;++se){D.l+=20;var oe=D.read_shift(4),ce=D.read_shift(4),we=D.read_shift(2),Pe=D.read_shift(2),Fe=D.read_shift(2);D.l+=8;var Ee=D.read_shift(4),Ne=o(D.slice(D.l+we,D.l+we+Pe));D.l+=we+Pe+Fe;var Ke=D.l;D.l=Ee+4,pI(D,oe,ce,H,Ne),D.l=Ke}return H}function pI(O,U,D,L,W){O.l+=2;var H=O.read_shift(2),se=O.read_shift(2),ge=s(O);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var ie=O.read_shift(4),oe=O.read_shift(4),ce=O.read_shift(4),we=O.read_shift(2),Pe=O.read_shift(2),Fe="",Ee=0;Ee<we;++Ee)Fe+=String.fromCharCode(O[O.l++]);if(Pe){var Ne=o(O.slice(O.l,O.l+Pe));(Ne[21589]||{}).mt&&(ge=Ne[21589].mt),((W||{})[21589]||{}).mt&&(ge=W[21589].mt)}O.l+=Pe;var Ke=O.slice(O.l,O.l+oe);switch(se){case 8:Ke=G(O,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var Dt=!1;H&8&&(ie=O.read_shift(4),ie==134695760&&(ie=O.read_shift(4),Dt=!0),oe=O.read_shift(4),ce=O.read_shift(4)),oe!=U&&qb(Dt,"Bad compressed size: "+U+" != "+oe),ce!=D&&qb(Dt,"Bad uncompressed size: "+D+" != "+ce),jm(L,Fe,Ke,{unsafe:!0,mt:ge})}function mI(O,U){var D=U||{},L=[],W=[],H=he(1),se=D.compression?8:0,ge=0,ie=0,oe=0,ce=0,we=0,Pe=O.FullPaths[0],Fe=Pe,Ee=O.FileIndex[0],Ne=[],Ke=0;for(ie=1;ie<O.FullPaths.length;++ie)if(Fe=O.FullPaths[ie].slice(Pe.length),Ee=O.FileIndex[ie],!(!Ee.size||!Ee.content||Fe=="Sh33tJ5")){var Dt=ce,Rt=he(Fe.length);for(oe=0;oe<Fe.length;++oe)Rt.write_shift(1,Fe.charCodeAt(oe)&127);Rt=Rt.slice(0,Rt.l),Ne[we]=Zle.buf(Ee.content,0);var jr=Ee.content;se==8&&(jr=B(jr)),H=he(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,ge),H.write_shift(2,se),Ee.mt?i(H,Ee.mt):H.write_shift(4,0),H.write_shift(-4,Ne[we]),H.write_shift(4,jr.length),H.write_shift(4,Ee.content.length),H.write_shift(2,Rt.length),H.write_shift(2,0),ce+=H.length,L.push(H),ce+=Rt.length,L.push(Rt),ce+=jr.length,L.push(jr),H=he(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,ge),H.write_shift(2,se),H.write_shift(4,0),H.write_shift(-4,Ne[we]),H.write_shift(4,jr.length),H.write_shift(4,Ee.content.length),H.write_shift(2,Rt.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,Dt),Ke+=H.l,W.push(H),Ke+=Rt.length,W.push(Rt),++we}return H=he(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,we),H.write_shift(2,we),H.write_shift(4,Ke),H.write_shift(4,ce),H.write_shift(2,0),xr([xr(L),xr(W),H])}var gd={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vI(O,U){if(O.ctype)return O.ctype;var D=O.name||"",L=D.match(/\.([^\.]+)$/);return L&&gd[L[1]]||U&&(L=(D=U).match(/[\.\\]([^\.\\])+$/),L&&gd[L[1]])?gd[L[1]]:"application/octet-stream"}function gI(O){for(var U=jf(O),D=[],L=0;L<U.length;L+=76)D.push(U.slice(L,L+76));return D.join(`\r
`)+`\r
`}function yI(O){var U=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var ce=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],L=U.split(`\r
`),W=0;W<L.length;++W){var H=L[W];if(H.length==0){D.push("");continue}for(var se=0;se<H.length;){var ge=76,ie=H.slice(se,se+ge);ie.charAt(ge-1)=="="?ge--:ie.charAt(ge-2)=="="?ge-=2:ie.charAt(ge-3)=="="&&(ge-=3),ie=H.slice(se,se+ge),se+=ge,se<H.length&&(ie+="="),D.push(ie)}}return D.join(`\r
`)}function xI(O){for(var U=[],D=0;D<O.length;++D){for(var L=O[D];D<=O.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+O[++D];U.push(L)}for(var W=0;W<U.length;++W)U[W]=U[W].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Sn(U.join(`\r
`))}function wI(O,U,D){for(var L="",W="",H="",se,ge=0;ge<10;++ge){var ie=U[ge];if(!ie||ie.match(/^\s*$/))break;var oe=ie.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":L=oe[2].trim();break;case"content-type":H=oe[2].trim();break;case"content-transfer-encoding":W=oe[2].trim();break}}switch(++ge,W.toLowerCase()){case"base64":se=Sn(Cn(U.slice(ge).join("")));break;case"quoted-printable":se=xI(U.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var ce=jm(O,L.slice(D.length),se,{unsafe:!0});H&&(ce.ctype=H)}function bI(O,U){if(j(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=U&&U.root||"",L=(Qe&&Buffer.isBuffer(O)?O.toString("binary"):j(O)).split(`\r
`),W=0,H="";for(W=0;W<L.length;++W)if(H=L[W],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),D||(D=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),H.slice(0,D.length)!=D););var se=(L[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ge="--"+(se[1]||""),ie=[],oe=[],ce={FileIndex:ie,FullPaths:oe};S(ce);var we,Pe=0;for(W=0;W<L.length;++W){var Fe=L[W];Fe!==ge&&Fe!==ge+"--"||(Pe++&&wI(ce,L.slice(we,W),D),we=W)}return ce}function _I(O,U){var D=U||{},L=D.boundary||"SheetJS";L="------="+L;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],H=O.FullPaths[0],se=H,ge=O.FileIndex[0],ie=1;ie<O.FullPaths.length;++ie)if(se=O.FullPaths[ie].slice(H.length),ge=O.FileIndex[ie],!(!ge.size||!ge.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ke){return"_x"+Ke.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ke){return"_u"+Ke.charCodeAt(0).toString(16)+"_"});for(var oe=ge.content,ce=Qe&&Buffer.isBuffer(oe)?oe.toString("binary"):j(oe),we=0,Pe=Math.min(1024,ce.length),Fe=0,Ee=0;Ee<=Pe;++Ee)(Fe=ce.charCodeAt(Ee))>=32&&Fe<128&&++we;var Ne=we>=Pe*4/5;W.push(L),W.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+se),W.push("Content-Transfer-Encoding: "+(Ne?"quoted-printable":"base64")),W.push("Content-Type: "+vI(ge,se)),W.push(""),W.push(Ne?yI(ce):gI(ce))}return W.push(L+`--\r
`),W.join(`\r
`)}function SI(O){var U={};return S(U,O),U}function jm(O,U,D,L){var W=L&&L.unsafe;W||S(O);var H=!W&&Le.find(O,U);if(!H){var se=O.FullPaths[0];U.slice(0,se.length)==se?se=U:(se.slice(-1)!="/"&&(se+="/"),se=(se+U).replace("//","/")),H={name:a(U),type:2},O.FileIndex.push(H),O.FullPaths.push(se),W||Le.utils.cfb_gc(O)}return H.content=D,H.size=D?D.length:0,L&&(L.CLSID&&(H.clsid=L.CLSID),L.mt&&(H.mt=L.mt),L.ct&&(H.ct=L.ct)),H}function kI(O,U){S(O);var D=Le.find(O,U);if(D){for(var L=0;L<O.FileIndex.length;++L)if(O.FileIndex[L]==D)return O.FileIndex.splice(L,1),O.FullPaths.splice(L,1),!0}return!1}function EI(O,U,D){S(O);var L=Le.find(O,U);if(L){for(var W=0;W<O.FileIndex.length;++W)if(O.FileIndex[W]==L)return O.FileIndex[W].name=a(D),O.FullPaths[W]=D,!0}return!1}function TI(O){T(O,!0)}return t.find=C,t.read=_,t.parse=u,t.write=X,t.writeFile=Q,t.utils={cfb_new:SI,cfb_add:jm,cfb_del:kI,cfb_mov:EI,cfb_gc:TI,ReadShift:_u,CheckField:FN,prep_blob:Tr,bconcat:xr,use_zlib:P,_deflateRaw:je,_inflateRaw:Kb,consts:J},t}();function ece(e){return typeof e=="string"?_m(e):Array.isArray(e)?Tle(e):e}function od(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=_m(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Fa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([ece(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=ys(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function tce(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Kt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ET(e,t){for(var r=[],n=Kt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function km(e){for(var t=[],r=Kt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Em(e){for(var t=[],r=Kt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function rce(e){for(var t=[],r=Kt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var ip=new Date(1899,11,30,0,0,0);function pr(e,t){var r=e.getTime(),n=ip.getTime()+(e.getTimezoneOffset()-ip.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var dN=new Date,nce=ip.getTime()+(dN.getTimezoneOffset()-ip.getTimezoneOffset())*6e4,TT=dN.getTimezoneOffset();function Tm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+nce),t.getTimezoneOffset()!==TT&&t.setTime(t.getTime()+(t.getTimezoneOffset()-TT)*6e4),t}function ace(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var AT=new Date("2017-02-19T19:06:09.000Z"),hN=isNaN(AT.getFullYear())?new Date("2/19/17"):AT,ice=hN.getFullYear()==2017;function jt(e,t){var r=new Date(e);if(ice)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(hN.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function so(e,t){if(Qe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Fa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Fa(eN(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Fa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Fa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Nt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Nt(e[r]));return t}function Vt(e,t){for(var r="";r.length<t;)r+=e;return r}function xa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var sce=["january","february","march","april","may","june","july","august","september","october","november","december"];function Yl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&sce.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var oce=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function pN(e){return e?e.content&&e.type?so(e.content,!0):e.data?ru(e.data):e.asNodeBuffer&&Qe?ru(e.asNodeBuffer().toString("binary")):e.asBinary?ru(e.asBinary()):e._data&&e._data.getContent?ru(so(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function mN(e){if(!e)return null;if(e.data)return mT(e.data);if(e.asNodeBuffer&&Qe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?mT(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function lce(e){return e&&e.name.slice(-4)===".bin"?mN(e):pN(e)}function Ln(e,t){for(var r=e.FullPaths||Kt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function ob(e,t){var r=Ln(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function rr(e,t,r){if(!r)return lce(ob(e,t));if(!t)return null;try{return rr(e,t)}catch{return null}}function kn(e,t,r){if(!r)return pN(ob(e,t));if(!t)return null;try{return kn(e,t)}catch{return null}}function cce(e,t,r){return mN(ob(e,t))}function OT(e){for(var t=e.FullPaths||Kt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ye(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Qe?n=Si(r):n=Ale(r),Le.utils.cfb_add(e,t,n)}Le.utils.cfb_add(e,t,r)}else e.file(t,r)}function lb(){return Le.utils.cfb_new()}function vN(e,t){switch(t.type){case"base64":return Le.read(e,{type:"base64"});case"binary":return Le.read(e,{type:"binary"});case"buffer":case"array":return Le.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function au(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Qt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,uce=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,CT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,fce=/<[^>]*>/g,Kr=Qt.match(CT)?CT:fce,dce=/<\w*:/,hce=/<(\/?)\w+:/;function Ve(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(uce),o=0,l="",c=0,u="",f="",d=1;if(s)for(c=0;c!=s.length;++c){for(f=s[c],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(d=(a=f.charCodeAt(i+1))==34||a==39?1:0,l=f.slice(i+1+d,f.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var h=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[h]&&u.slice(o-3,o)=="ext")continue;n[h]=l,n[h.toLowerCase()]=l}}return n}function Ba(e){return e.replace(hce,"<$1")}var gN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},cb=km(gN),st=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,l){return gN[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),ub=/[&<>'"]/g,pce=/[\u0000-\u0008\u000b-\u001f]/g;function mt(e){var t=e+"";return t.replace(ub,function(r){return cb[r]}).replace(pce,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function PT(e){return mt(e).replace(/ /g,"_x0020_")}var yN=/[\u0000-\u001f]/g;function fb(e){var t=e+"";return t.replace(ub,function(r){return cb[r]}).replace(/\n/g,"<br/>").replace(yN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function mce(e){var t=e+"";return t.replace(ub,function(r){return cb[r]}).replace(yN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var jT=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function vce(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ct(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wv(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function NT(e){var t=is(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function FT(e){return Si(e,"binary").toString("utf8")}var t0="foo bar bazâð£",wt=Qe&&(FT(t0)==Wv(t0)&&FT||NT(t0)==Wv(t0)&&NT)||Wv,Fa=Qe?function(e){return Si(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Ff=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),xN=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),gce=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),yce=/<\/?(?:vt:)?variant>/g,xce=/<(?:vt:)([^>]*)>([\s\S]*)</;function IT(e,t){var r=Ve(e),n=e.match(gce(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(yce,"").match(xce);s&&a.push({v:wt(s[2]),t:s[1]})}),a}var wN=/(^\s|\s$|\n)/;function Ar(e,t){return"<"+e+(t.match(wN)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function If(e){return Kt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Te(e,t,r){return"<"+e+(r!=null?If(r):"")+(t!=null?(t.match(wN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ix(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function wce(e,t){switch(typeof e){case"string":var r=Te("vt:lpwstr",mt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Te((e|0)==e?"vt:i4":"vt:r8",mt(String(e)));case"boolean":return Te("vt:bool",e?"true":"false")}if(e instanceof Date)return Te("vt:filetime",Ix(e));throw new Error("Unable to serialize "+e)}function db(e){if(Qe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return wt(ys(ab(e)));throw new Error("Bad input format: expected Buffer or string")}var Df=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,fr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],wn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bce(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function _ce(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var DT=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},RT=Qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Si(t)})):DT(e)}:DT,MT=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ei(e,a)));return n.join("").replace(en,"")},hb=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(en,""):MT(e,t,r)}:MT,$T=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},bN=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):$T(e,t,r)}:$T,LT=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Uo(e,a)));return n.join("")},ld=Qe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):LT(t,r,n)}:LT,_N=function(e,t){var r=bn(e,t);return r>0?ld(e,t+4,t+4+r-1):""},SN=_N,kN=function(e,t){var r=bn(e,t);return r>0?ld(e,t+4,t+4+r-1):""},EN=kN,TN=function(e,t){var r=2*bn(e,t);return r>0?ld(e,t+4,t+4+r-1):""},AN=TN,ON=function(t,r){var n=bn(t,r);return n>0?hb(t,r+4,r+4+n):""},CN=ON,PN=function(e,t){var r=bn(e,t);return r>0?ld(e,t+4,t+4+r):""},jN=PN,NN=function(e,t){return bce(e,t)},sp=NN,pb=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Qe&&(SN=function(t,r){if(!Buffer.isBuffer(t))return _N(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},EN=function(t,r){if(!Buffer.isBuffer(t))return kN(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},AN=function(t,r){if(!Buffer.isBuffer(t))return TN(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},CN=function(t,r){if(!Buffer.isBuffer(t))return ON(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},jN=function(t,r){if(!Buffer.isBuffer(t))return PN(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},sp=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):NN(t,r)},pb=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Uo=function(e,t){return e[t]},ei=function(e,t){return e[t+1]*256+e[t]},Sce=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},bn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ns=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},kce=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function _u(e,t){var r="",n,a,i=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ei(this,c)),c+=2;e*=2;break;case"utf8":r=ld(this,this.l,this.l+e);break;case"utf16le":e*=2,r=hb(this,this.l,this.l+e);break;case"wstr":return _u.call(this,e,"dbcs");case"lpstr-ansi":r=SN(this,this.l),e=4+bn(this,this.l);break;case"lpstr-cp":r=EN(this,this.l),e=4+bn(this,this.l);break;case"lpwstr":r=AN(this,this.l),e=4+2*bn(this,this.l);break;case"lpp4":e=4+bn(this,this.l),r=CN(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+bn(this,this.l),r=jN(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Uo(this,this.l+e++))!==0;)i.push(e0(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=ei(this,this.l+e))!==0;)i.push(e0(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Uo(this,c),this.l=c+1,o=_u.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(e0(ei(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Uo(this,c),this.l=c+1,o=_u.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(e0(Uo(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=Uo(this,this.l),this.l++,n;case 2:return n=(t==="i"?Sce:ei)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ns:kce)(this,this.l),this.l+=4,n):(a=bn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=sp(this,this.l):a=sp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=bN(this,this.l,e);break}}return this.l+=e,r}var Ece=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Tce=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Ace=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Oce(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)Ace(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Ece(this,t,this.l);break;case 8:if(n=8,r==="f"){_ce(this,t,this.l);break}case 16:break;case-4:n=4,Tce(this,t,this.l);break}return this.l+=n,this}function FN(e,t){var r=bN(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Tr(e,t){e.l=t,e.read_shift=_u,e.chk=FN,e.write_shift=Oce}function Gr(e,t){e.l+=t}function he(e){var t=is(e);return Tr(t,0),t}function ki(e,t,r){if(e){var n,a,i;Tr(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Uf[o]||Uf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;l=e.l+i;var u=c.f&&c.f(e,i,r);if(e.l=l,t(u,c,o))return}}}function dn(){var e=[],t=Qe?256:2048,r=function(c){var u=he(c);return Tr(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},s=function(){return a(),xr(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function xe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Uf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&pb(r)&&e.push(r)}}function Su(e,t,r){var n=Nt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function BT(e,t,r){var n=Nt(e);return n.s=Su(n.s,t.s,r),n.e=Su(n.e,t.s,r),n}function ku(e,t){if(e.cRel&&e.c<0)for(e=Nt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Nt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=He(e);return!e.cRel&&e.cRel!=null&&(r=jce(r)),!e.rRel&&e.rRel!=null&&(r=Cce(r)),r}function zv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+$t(e.s.c)+":"+(e.e.cRel?"":"$")+$t(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Jt(e.s.r)+":"+(e.e.rRel?"":"$")+Jt(e.e.r):ku(e.s,t.biff)+":"+ku(e.e,t.biff)}function mb(e){return parseInt(Pce(e),10)-1}function Jt(e){return""+(e+1)}function Cce(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Pce(e){return e.replace(/\$(\d+)$/,"$1")}function vb(e){for(var t=Nce(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function $t(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function jce(e){return e.replace(/^([A-Z])/,"$$$1")}function Nce(e){return e.replace(/^\$([A-Z])/,"$1")}function Fce(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Lt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function He(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function hn(e){var t=e.indexOf(":");return t==-1?{s:Lt(e),e:Lt(e)}:{s:Lt(e.slice(0,t)),e:Lt(e.slice(t+1))}}function Xe(e,t){return typeof t>"u"||typeof t=="number"?Xe(e.s,e.e):(typeof e!="string"&&(e=He(e)),typeof t!="string"&&(t=He(t)),e==t?e:e+":"+t)}function lt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function UT(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Qn(e.z,r?pr(t):t)}catch{}try{return e.w=Qn((e.XF||{}).numFmtId||(r?14:0),r?pr(t):t)}catch{return""+t}}function yi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ei[e.v]||e.v:t==null?UT(e,e.v):UT(e,t))}function xs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function IN(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Lt(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=lt(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[f].length;++d)if(!(typeof t[f][d]>"u")){var h={v:t[f][d]},m=s+f,p=o+d;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),t[f][d]&&typeof t[f][d]=="object"&&!Array.isArray(t[f][d])&&!(t[f][d]instanceof Date))h=t[f][d];else if(Array.isArray(h.v)&&(h.f=t[f][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||ze[14],n.cellDates?(h.t="d",h.w=Qn(h.z,pr(h.v))):(h.t="n",h.v=pr(h.v),h.w=Qn(h.z,h.v))):h.t="s";if(a)i[m]||(i[m]=[]),i[m][p]&&i[m][p].z&&(h.z=i[m][p].z),i[m][p]=h;else{var g=He({c:p,r:m});i[g]&&i[g].z&&(h.z=i[g].z),i[g]=h}}}return c.s.c<1e7&&(i["!ref"]=Xe(c)),i}function wc(e,t){return IN(null,e,t)}function Ice(e){return e.read_shift(4,"i")}function wa(e,t){return t||(t=he(4)),t.write_shift(4,e),t}function Hr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wr(e,t){var r=!1;return t==null&&(r=!0,t=he(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Dce(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Rce(e,t){return t||(t=he(4)),t.write_shift(2,0),t.write_shift(2,0),t}function gb(e,t){var r=e.l,n=e.read_shift(1),a=Hr(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(Dce(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function Mce(e,t){var r=!1;return t==null&&(r=!0,t=he(15+4*e.t.length)),t.write_shift(1,0),wr(e.t,t),r?t.slice(0,t.l):t}var $ce=gb;function Lce(e,t){var r=!1;return t==null&&(r=!0,t=he(23+4*e.t.length)),t.write_shift(1,1),wr(e.t,t),t.write_shift(4,1),Rce({},t),r?t.slice(0,t.l):t}function ta(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function wo(e,t){return t==null&&(t=he(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function bo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function _o(e,t){return t==null&&(t=he(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Bce=Hr,DN=wr;function yb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function op(e,t){var r=!1;return t==null&&(r=!0,t=he(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Uce=Hr,Dx=yb,xb=op;function wb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?sp([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ns(t,0)>>2;return r?a/100:a}function RN(e,t){t==null&&(t=he(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function MN(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Wce(e,t){return t||(t=he(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var So=MN,bc=Wce;function Wr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function oo(e,t){return(t||he(8)).write_shift(8,e,"f")}function zce(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Vs[a];c&&(t.rgb=Mf(c));break;case 2:t.rgb=Mf([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function lp(e,t){if(t||(t=he(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Hce(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Vce(e,t){t||(t=he(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function $N(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Gce(e){return $N(e,1)}function Kce(e){return $N(e,2)}var bb=2,nn=3,r0=11,WT=12,cp=19,n0=64,qce=65,Xce=71,Yce=4108,Jce=4126,gr=80,LN=81,Qce=[gr,LN],Rx={1:{n:"CodePage",t:bb},2:{n:"Category",t:gr},3:{n:"PresentationFormat",t:gr},4:{n:"ByteCount",t:nn},5:{n:"LineCount",t:nn},6:{n:"ParagraphCount",t:nn},7:{n:"SlideCount",t:nn},8:{n:"NoteCount",t:nn},9:{n:"HiddenCount",t:nn},10:{n:"MultimediaClipCount",t:nn},11:{n:"ScaleCrop",t:r0},12:{n:"HeadingPairs",t:Yce},13:{n:"TitlesOfParts",t:Jce},14:{n:"Manager",t:gr},15:{n:"Company",t:gr},16:{n:"LinksUpToDate",t:r0},17:{n:"CharacterCount",t:nn},19:{n:"SharedDoc",t:r0},22:{n:"HyperlinksChanged",t:r0},23:{n:"AppVersion",t:nn,p:"version"},24:{n:"DigSig",t:qce},26:{n:"ContentType",t:gr},27:{n:"ContentStatus",t:gr},28:{n:"Language",t:gr},29:{n:"Version",t:gr},255:{},2147483648:{n:"Locale",t:cp},2147483651:{n:"Behavior",t:cp},1919054434:{}},Mx={1:{n:"CodePage",t:bb},2:{n:"Title",t:gr},3:{n:"Subject",t:gr},4:{n:"Author",t:gr},5:{n:"Keywords",t:gr},6:{n:"Comments",t:gr},7:{n:"Template",t:gr},8:{n:"LastAuthor",t:gr},9:{n:"RevNumber",t:gr},10:{n:"EditTime",t:n0},11:{n:"LastPrinted",t:n0},12:{n:"CreatedDate",t:n0},13:{n:"ModifiedDate",t:n0},14:{n:"PageCount",t:nn},15:{n:"WordCount",t:nn},16:{n:"CharCount",t:nn},17:{n:"Thumbnail",t:Xce},18:{n:"Application",t:gr},19:{n:"DocSecurity",t:nn},255:{},2147483648:{n:"Locale",t:cp},2147483651:{n:"Behavior",t:cp},1919054434:{}},zT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Zce=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function eue(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var tue=eue([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Vs=Nt(tue),Ei={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},BN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},$x={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},a0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function _b(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function rue(e){var t=_b();if(!e||!e.match)return t;var r={};if((e.match(Kr)||[]).forEach(function(n){var a=Ve(n);switch(a[0].replace(dce,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[$x[a.ContentType]]!==void 0&&t[$x[a.ContentType]].push(a.PartName);break}}),t.xmlns!==fr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function UN(e,t){var r=rce($x),n=[],a;n[n.length]=Qt,n[n.length]=Te("Types",null,{xmlns:fr.CT,"xmlns:xsd":fr.xsd,"xmlns:xsi":fr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Te("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=Te("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:a0[l][t.bookType]||a0[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Te("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:a0[l][t.bookType]||a0[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Te("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ze={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Rf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Eu(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Kr)||[]).forEach(function(a){var i=Ve(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:au(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function ml(e){var t=[Qt,Te("Relationships",null,{xmlns:fr.RELS})];return Kt(e["!id"]).forEach(function(r){t[t.length]=Te("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function pt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Ze.HLINK,Ze.XPATH,Ze.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var nue="application/vnd.oasis.opendocument.spreadsheet";function aue(e,t){for(var r=db(e),n,a;n=Df.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ve(n[0],!1),a.path=="/"&&a.type!==nue)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function iue(e){var t=[Qt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function HT(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function sue(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function oue(e){var t=[Qt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(HT(e[r][0],e[r][1])),t.push(sue("",e[r][0]));return t.push(HT("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function WN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+tp.version+"</meta:generator></office:meta></office:document-meta>"}var qn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],lue=function(){for(var e=new Array(qn.length),t=0;t<qn.length;++t){var r=qn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function zN(e){var t={};e=wt(e);for(var r=0;r<qn.length;++r){var n=qn[r],a=e.match(lue[r]);a!=null&&a.length>0&&(t[n[1]]=st(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=jt(t[n[1]]))}return t}function Hv(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=mt(t),n[n.length]=r?Te(e,t,r):Ar(e,t))}function HN(e,t){var r=t||{},n=[Qt,Te("cp:coreProperties",null,{"xmlns:cp":fr.CORE_PROPS,"xmlns:dc":fr.dc,"xmlns:dcterms":fr.dcterms,"xmlns:dcmitype":fr.dcmitype,"xmlns:xsi":fr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Hv("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ix(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Hv("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ix(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=qn.length;++i){var s=qn[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Hv(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Gs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],VN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function GN(e,t,r,n){var a=[];if(typeof e=="string")a=IT(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(u){return{v:u}}));var s=typeof t=="string"?IT(t,n).map(function(u){return u.v}):t,o=0,l=0;if(s.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function cue(e,t,r){var n={};return t||(t={}),e=wt(e),Gs.forEach(function(a){var i=(e.match(Ff(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=st(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&GN(n.HeadingPairs,n.TitlesOfParts,t,r),t}function KN(e){var t=[],r=Te;return e||(e={}),e.Application="SheetJS",t[t.length]=Qt,t[t.length]=Te("Properties",null,{xmlns:fr.EXT_PROPS,"xmlns:vt":fr.vt}),Gs.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=mt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+mt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var uue=/<[^>]+>[^<]*/g;function fue(e,t){var r={},n="",a=e.match(uue);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=Ve(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=st(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=st(u);break;case"bool":r[n]=Ct(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=jt(u);break;case"cy":case"error":r[n]=st(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function qN(e){var t=[Qt,Te("Properties",null,{xmlns:fr.CUST_PROPS,"xmlns:vt":fr.vt})];if(!e)return t.join("");var r=1;return Kt(e).forEach(function(a){++r,t[t.length]=Te("property",wce(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:mt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Lx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Vv;function due(e,t,r){Vv||(Vv=km(Lx)),t=Vv[t]||t,e[t]=r}function hue(e,t){var r=[];return Kt(Lx).map(function(n){for(var a=0;a<qn.length;++a)if(qn[a][1]==n)return qn[a];for(a=0;a<Gs.length;++a)if(Gs[a][1]==n)return Gs[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Ar(Lx[n[1]]||n[1],a))}}),Te("DocumentProperties",r.join(""),{xmlns:wn.o})}function pue(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Kt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<qn.length;++s)if(i==qn[s][1])return;for(s=0;s<Gs.length;++s)if(i==Gs[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(Te(PT(i),o,{"dt:dt":l}))}}),t&&Kt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Te(PT(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+wn.o+'">'+a.join("")+"</"+n+">"}function Sb(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function mue(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=he(8);return s.write_shift(4,n),s.write_shift(4,a),s}function XN(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function YN(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function JN(e,t,r){return t===31?YN(e):XN(e,t,r)}function Bx(e,t,r){return JN(e,t,r===!1?0:4)}function vue(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return JN(e,t,0)}function gue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(en,""),e.l-a&2&&(e.l+=2)}return r}function yue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(en,"");return r}function xue(e){var t=e.l,r=up(e,LN);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=up(e,nn);return[r,n]}function wue(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(xue(e));return r}function VT(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(en,"").replace(nu,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function QN(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function bue(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function up(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==WT&&n!==t&&Qce.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===WT?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return XN(e,n,4).replace(en,"");case 31:return YN(e);case 64:return Sb(e);case 65:return QN(e);case 71:return bue(e);case 80:return Bx(e,n,!i.raw).replace(en,"");case 81:return vue(e,n).replace(en,"");case 4108:return wue(e);case 4126:case 4127:return n==4127?gue(e):yue(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function GT(e,t){var r=he(4),n=he(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=he(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=mue(t);break;case 31:case 80:for(n=he(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return xr([r,n])}function KT(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,l=-1,c={};for(s=0;s!=a;++s){var u=e.read_shift(4),f=e.read_shift(4);i[s]=[u,f+r]}i.sort(function(w,y){return w[1]-y[1]});var d={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var m=t[i[s][0]];if(d[m.n]=up(e,m.t,{raw:!0}),m.p==="version"&&(d[m.n]=String(d[m.n]>>16)+"."+("0000"+String(d[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(d[m.n]){case 0:d[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ma(o=d[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[m.n])}}else if(i[s][0]===1){if(o=d.CodePage=up(e,bb),ma(o),l!==-1){var p=e.l;e.l=i[l][1],c=VT(e,o),e.l=p}}else if(i[s][0]===0){if(o===0){l=s,e.l=i[s+1][1];continue}c=VT(e,o)}else{var g=c[i[s][0]],x;switch(e[e.l]){case 65:e.l+=4,x=QN(e);break;case 30:e.l+=4,x=Bx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Bx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=qt(e,4);break;case 64:e.l+=4,x=jt(Sb(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[g]=x}}return e.l=r+n,d}var ZN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function _ue(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function qT(e,t,r){var n=he(8),a=[],i=[],s=8,o=0,l=he(8),c=he(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),s+=8+l.length,!t){c=he(8),c.write_shift(4,0),a.unshift(c);var u=[he(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(l=he(8+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=xr(u),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(ZN.indexOf(e[o][0])>-1||VN.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],h=0;if(t){h=+t[e[o][0]];var m=r[h];if(m.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}l=GT(m.t,d)}else{var g=_ue(d);g==-1&&(g=31,d=String(d)),l=GT(g,d)}i.push(l),c=he(8),c.write_shift(4,t?h:2+o),a.push(c),s+=8+l.length}var x=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,x),x+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),xr([n].concat(a).concat(i))}function XT(e,t,r){var n=e.content;if(!n)return{};Tr(n,0);var a,i,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Le.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),l=n.read_shift(4));var f=KT(n,t),d={SystemIdentifier:c};for(var h in f)d[h]=f[h];if(d.FMTID=i,a===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=KT(n,null)}catch{}for(h in m)d[h]=m[h];return d.FMTID=[i,s],d}function YT(e,t,r,n,a,i){var s=he(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Le.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=qT(e,r,n);if(o.push(l),a){var c=qT(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(c)}return xr(o)}function Oi(e,t){return e.read_shift(t),null}function Sue(e,t){t||(t=he(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function kue(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function qt(e,t){return e.read_shift(t)===1}function Jr(e,t){return t||(t=he(2)),t.write_shift(2,+!!e),t}function nr(e){return e.read_shift(2,"u")}function Bn(e,t){return t||(t=he(2)),t.write_shift(2,e),t}function eF(e,t){return kue(e,t,nr)}function Eue(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function tF(e,t,r){return r||(r=he(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function cd(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function Tue(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,o,l={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*s),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Aue(e){var t=e.t||"",r=he(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=he(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return xr(a)}function lo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ud(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):lo(e,n,r)}function ko(e,t,r){if(r.biff>5)return ud(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function rF(e,t,r){return r||(r=he(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Oue(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Cue(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(en,"");return n&&(e.l+=24),a}function Pue(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(en,"");return r+s}function jue(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Cue(e);case"0303000000000000c000000000000046":return Pue(e);default:throw new Error("Unsupported Moniker "+r)}}function i0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(en,""):"";return r}function JT(e,t){t||(t=he(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Nue(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,l,c="",u,f;a&16&&(i=i0(e,r-e.l)),a&128&&(s=i0(e,r-e.l)),(a&257)===257&&(o=i0(e,r-e.l)),(a&257)===1&&(l=jue(e,r-e.l)),a&8&&(c=i0(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=Sb(e)),e.l=r;var d=s||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return u&&(h.guid=u),f&&(h.time=f),i&&(h.Tooltip=i),h}function Fue(e){var t=he(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),JT(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&JT(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function nF(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function aF(e,t){var r=nF(e);return r[3]=0,r}function Ua(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function co(e,t,r,n){return n||(n=he(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Iue(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Due(e,t,r){return t===0?"":ko(e,t,r)}function Rue(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function iF(e){var t=e.read_shift(2),r=wb(e);return[t,r]}function Mue(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=cd(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Am(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function sF(e,t){return t||(t=he(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function oF(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var $ue=oF;function lF(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Lue(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Bue(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ir(e){e.l+=2,e.l+=e.read_shift(2)}var Uue={0:Ir,4:Ir,5:Ir,6:Ir,7:Bue,8:Ir,9:Ir,10:Ir,11:Ir,12:Ir,13:Lue,14:Ir,15:Ir,16:Ir,17:Ir,18:Ir,19:Ir,20:Ir,21:lF};function Wue(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(Uue[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function s0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function kb(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=he(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function zue(e,t){return t===0||e.read_shift(2),1200}function Hue(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=ko(e,0,r);return e.read_shift(t+n-e.l),a}function Vue(e,t){var r=!t||t.biff==8,n=he(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Gue(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Kue(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=cd(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function que(e,t){var r=!t||t.biff>=8?2:1,n=he(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Xue(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(Tue(e));return i.Count=n,i.Unique=a,i}function Yue(e,t){var r=he(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Aue(e[a]);var i=xr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function Jue(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Que(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Zue(e){var t=Iue(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function efe(e){return e.read_shift(2),e.read_shift(4)}function QT(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function tfe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function rfe(){var e=he(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function nfe(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function afe(e){var t=he(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function ife(){}function sfe(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=cd(e,0,r),n}function ofe(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=he(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function lfe(e){var t=Ua(e);return t.isst=e.read_shift(4),t}function cfe(e,t,r,n){var a=he(10);return co(e,t,n,a),a.write_shift(4,r),a}function ufe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ua(e);r.biff==2&&e.l++;var i=ud(e,n-e.l,r);return a.val=i,a}function ffe(e,t,r,n,a){var i=!a||a.biff==8,s=he(8+ +i+(1+i)*r.length);return co(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function dfe(e,t,r){var n=e.read_shift(2),a=ko(e,0,r);return[n,a]}function hfe(e,t,r,n){var a=r&&r.biff==5;n||(n=he(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var pfe=ko;function ZT(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c:l}}}function mfe(e,t){var r=t.biff==8||!t.biff?4:2,n=he(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function vfe(e){var t=e.read_shift(2),r=e.read_shift(2),n=iF(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function gfe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(iF(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function yfe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function xfe(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=Zce[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function wfe(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=xfe(e,t,n.fStyle,r),n}function eA(e,t,r,n){var a=r&&r.biff==5;n||(n=he(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function bfe(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function _fe(e){var t=he(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function tA(e,t,r){var n=Ua(e);(r.biff==2||t==9)&&++e.l;var a=Eue(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Sfe(e,t,r,n,a,i){var s=he(8);return co(e,t,n,s),tF(r,i,s),s}function kfe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ua(e),a=Wr(e);return n.val=a,n}function Efe(e,t,r,n){var a=he(14);return co(e,t,n,a),oo(r,a),a}var rA=Due;function Tfe(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=lo(e,i),o=[];n>e.l;)o.push(ud(e));return[i,a,s,o]}function nA(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=Mue(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var Afe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function aA(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=lo(e,s,r);a&32&&(c=Afe[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:Wpe(e,u,r,o);return{chKey:i,Name:c,itab:l,rgce:f}}function cF(e,t,r){if(r.biff<8)return Ofe(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Rue(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Ofe(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=cd(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Cfe(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=lo(e,n,r),s=lo(e,a,r);return[i,s]}function Pfe(e,t,r){var n=oF(e);e.l++;var a=e.read_shift(1);return t-=8,[zpe(e,t,r),a,n]}function iA(e,t,r){var n=$ue(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Bpe(e,t,r)]}function jfe(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Nfe(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=ko(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function Ffe(e,t,r){return Nfe(e,t,r)}function Ife(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Am(e));return r}function Dfe(e){var t=he(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)sF(e[r],t);return t}function Rfe(e,t,r){if(r&&r.biff<8)return $fe(e,t,r);var n=lF(e),a=Wue(e,t-22,n[1]);return{cmo:n,ft:a}}var Mfe={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function $fe(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((Mfe[n]||Gr)(e,t,r)),{cmo:[a,n,i],ft:s}}function Lfe(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=Oue(e,6,r);var o=e.read_shift(2);e.read_shift(2),nr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=lo(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Bfe(e,t){var r=Am(e);e.l+=16;var n=Nue(e,t-24);return[r,n]}function Ufe(e){var t=he(24),r=Lt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return xr([t,Fue(e[1])])}function Wfe(e,t){e.read_shift(2);var r=Am(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(en,""),[r,n]}function zfe(e){var t=e[1].Tooltip,r=he(10+2*(t.length+1));r.write_shift(2,2048);var n=Lt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Hfe(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=zT[r]||r,r=e.read_shift(2),t[1]=zT[r]||r,t}function Vfe(e){return e||(e=he(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Gfe(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aF(e));return r}function Kfe(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(aF(e));return r}function qfe(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function uF(e,t,r){if(!r.cellStyles)return Gr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Xfe(e,t){var r=he(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Yfe(e,t){var r={};return t<32||(e.l+=16,r.header=Wr(e),r.footer=Wr(e),e.l+=2),r}function Jfe(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function Qfe(e){for(var t=he(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Zfe=Ua,ede=eF,tde=ud;function rde(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function nde(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ua(e);++e.l;var a=ko(e,t-7,r);return n.t="str",n.val=a,n}function ade(e){var t=Ua(e);++e.l;var r=Wr(e);return t.t="n",t.val=r,t}function ide(e,t,r){var n=he(15);return pd(n,e,t),n.write_shift(8,r,"f"),n}function sde(e){var t=Ua(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function ode(e,t,r){var n=he(9);return pd(n,e,t),n.write_shift(2,r),n}function lde(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function cde(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function ude(e,t,r){var n=e.l+t,a=Ua(e),i=e.read_shift(2),s=lo(e,i,r);return e.l=n,a.t="str",a.val=s,a}var fde=[2,3,48,49,131,139,140,245],Ux=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=km({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=is(1);switch(l.type){case"base64":u=Sn(Cn(o));break;case"binary":u=Sn(o);break;case"buffer":case"array":u=o;break}Tr(u,0);var f=u.read_shift(1),d=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var x=u.read_shift(2),w=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var y=[],k={},b=Math.min(u.length,f==2?521:g-10-(h?264:0)),_=m?32:11;u.l<b&&u[u.l]!=13;)switch(k={},k.name=Pf.utils.decode(w,u.slice(u.l,u.l+_)).replace(/[\u0000\r\n].*$/g,""),u.l+=_,k.type=String.fromCharCode(u.read_shift(1)),f!=2&&!m&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),f==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&y.push(k),f!=2&&(u.l+=m?13:14),k.type){case"B":(!h||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var S=0,E=0;for(c[0]=[],E=0;E!=y.length;++E)c[0][E]=y[E].name;for(;p-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,c[++S]=[],E=0,E=0;E!=y.length;++E){var T=u.slice(u.l,u.l+y[E].len);u.l+=y[E].len,Tr(T,0);var F=Pf.utils.decode(w,T);switch(y[E].type){case"C":F.trim().length&&(c[S][E]=F.replace(/\s+$/,""));break;case"D":F.length===8?c[S][E]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):c[S][E]=F;break;case"F":c[S][E]=parseFloat(F.trim());break;case"+":case"I":c[S][E]=m?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":c[S][E]=!0;break;case"N":case"F":c[S][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[S][E]="##MEMO##"+(m?parseInt(F.trim(),10):T.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(c[S][E]=+F||0);break;case"@":c[S][E]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":c[S][E]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":c[S][E]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][E]=-T.read_shift(-8,"f");break;case"B":if(h&&y[E].len==8){c[S][E]=T.read_shift(8,"f");break}case"G":case"P":T.l+=y[E].len;break;case"0":if(y[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[E].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=wc(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function a(o,l){try{return xs(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&ma(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=dn(),f=hp(o,{header:1,raw:!0,cellDates:!0}),d=f[0],h=f.slice(1),m=o["!cols"]||[],p=0,g=0,x=0,w=1;for(p=0;p<d.length;++p){if(((m[p]||{}).DBF||{}).name){d[p]=m[p].DBF.name,++x;continue}if(d[p]!=null){if(++x,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(g=0;g<1024;++g)if(d.indexOf(d[p]+"_"+g)==-1){d[p]+="_"+g;break}}}}var y=lt(o["!ref"]),k=[],b=[],_=[];for(p=0;p<=y.e.c-y.s.c;++p){var S="",E="",T=0,F=[];for(g=0;g<h.length;++g)h[g][p]!=null&&F.push(h[g][p]);if(F.length==0||d[p]==null){k[p]="?";continue}for(g=0;g<F.length;++g){switch(typeof F[g]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=F[g]instanceof Date?"D":"C";break;default:E="C"}T=Math.max(T,String(F[g]).length),S=S&&S!=E?"C":E}T>250&&(T=250),E=((m[p]||{}).DBF||{}).type,E=="C"&&m[p].DBF.len>T&&(T=m[p].DBF.len),S=="B"&&E=="N"&&(S="N",_[p]=m[p].DBF.dec,T=m[p].DBF.len),b[p]=S=="C"||E=="N"?T:i[S]||0,w+=b[p],k[p]=S}var C=u.next(32);for(C.write_shift(4,318902576),C.write_shift(4,h.length),C.write_shift(2,296+32*x),C.write_shift(2,w),p=0;p<4;++p)C.write_shift(4,0);for(C.write_shift(4,0|(+t[Z3]||3)<<8),p=0,g=0;p<d.length;++p)if(d[p]!=null){var A=u.next(32),M=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,M,"sbcs"),A.write_shift(1,k[p]=="?"?"C":k[p],"sbcs"),A.write_shift(4,g),A.write_shift(1,b[p]||i[k[p]]||0),A.write_shift(1,_[p]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),g+=b[p]||i[k[p]]||0}var V=u.next(264);for(V.write_shift(4,13),p=0;p<65;++p)V.write_shift(4,0);for(p=0;p<h.length;++p){var z=u.next(w);for(z.write_shift(1,0),g=0;g<d.length;++g)if(d[g]!=null)switch(k[g]){case"L":z.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":z.write_shift(8,h[p][g]||0,"f");break;case"N":var Y="0";for(typeof h[p][g]=="number"&&(Y=h[p][g].toFixed(_[g]||0)),x=0;x<b[g]-Y.length;++x)z.write_shift(1,32);z.write_shift(1,Y,"sbcs");break;case"D":h[p][g]?(z.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var J=String(h[p][g]!=null?h[p][g]:"").slice(0,b[g]);for(z.write_shift(1,J,"sbcs"),x=0;x<b[g]-J.length;++x)z.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),fF=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Kt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,h){var m=e[h];return typeof m=="number"?vT(m):m},n=function(d,h,m){var p=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?d:vT(p)};e["|"]=254;function a(d,h){switch(h.type){case"base64":return i(Cn(d),h);case"binary":return i(d,h);case"buffer":return i(Qe&&Buffer.isBuffer(d)?d.toString("binary"):ys(d),h);case"array":return i(so(d),h)}throw new Error("Unrecognized type "+h.type)}function i(d,h){var m=d.split(/[\n\r]+/),p=-1,g=-1,x=0,w=0,y=[],k=[],b=null,_={},S=[],E=[],T=[],F=0,C;for(+h.codepage>=0&&ma(+h.codepage);x!==m.length;++x){F=0;var A=m[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),M=A.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),V=M[0],z;if(A.length>0)switch(V){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&k.push(A.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,J=!1,Q=!1,j=!1,X=-1,ee=-1;for(w=1;w<M.length;++w)switch(M[w].charAt(0)){case"A":break;case"X":g=parseInt(M[w].slice(1))-1,J=!0;break;case"Y":for(p=parseInt(M[w].slice(1))-1,J||(g=0),C=y.length;C<=p;++C)y[C]=[];break;case"K":z=M[w].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(xa(z))?isNaN(Yl(z).getDate())||(z=jt(z)):(z=xa(z),b!==null&&yc(b)&&(z=Tm(z))),Y=!0;break;case"E":j=!0;var P=vl(M[w].slice(1),{r:p,c:g});y[p][g]=[y[p][g],P];break;case"S":Q=!0,y[p][g]=[y[p][g],"S5S"];break;case"G":break;case"R":X=parseInt(M[w].slice(1))-1;break;case"C":ee=parseInt(M[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}if(Y&&(y[p][g]&&y[p][g].length==2?y[p][g][0]=z:y[p][g]=z,b=null),Q){if(j)throw new Error("SYLK shared formula cannot have own formula");var G=X>-1&&y[X][ee];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");y[p][g][1]=CF(G[1],{r:p-X,c:g-ee})}break;case"F":var B=0;for(w=1;w<M.length;++w)switch(M[w].charAt(0)){case"X":g=parseInt(M[w].slice(1))-1,++B;break;case"Y":for(p=parseInt(M[w].slice(1))-1,C=y.length;C<=p;++C)y[C]=[];break;case"M":F=parseInt(M[w].slice(1))/20;break;case"F":break;case"G":break;case"P":b=k[parseInt(M[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=M[w].slice(1).split(" "),C=parseInt(T[0],10);C<=parseInt(T[1],10);++C)F=parseInt(T[2],10),E[C-1]=F===0?{hidden:!0}:{wch:F},ss(E[C-1]);break;case"C":g=parseInt(M[w].slice(1))-1,E[g]||(E[g]={});break;case"R":p=parseInt(M[w].slice(1))-1,S[p]||(S[p]={}),F>0?(S[p].hpt=F,S[p].hpx=Ql(F)):F===0&&(S[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}B<1&&(b=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+A)}}return S.length>0&&(_["!rows"]=S),E.length>0&&(_["!cols"]=E),h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),[y,_]}function s(d,h){var m=a(d,h),p=m[0],g=m[1],x=wc(p,h);return Kt(g).forEach(function(w){x[w]=g[w]}),x}function o(d,h){return xs(s(d,h),h)}function l(d,h,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(d.t){case"n":g+=d.v||0,d.f&&!d.F&&(g+=";E"+Pb(d.f,{r:m,c:p}));break;case"b":g+=d.v?"TRUE":"FALSE";break;case"e":g+=d.w||d.v;break;case"d":g+='"'+(d.w||d.v)+'"';break;case"s":g+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(d,h){h.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=$f(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Lf(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&d.push(g)})}function u(d,h){h.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*Bf(m.hpx)+";"),g.length>2&&d.push(g+"R"+(p+1))})}function f(d,h){var m=["ID;PWXL;N;E"],p=[],g=lt(d["!ref"]),x,w=Array.isArray(d),y=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&c(m,d["!cols"]),d["!rows"]&&u(m,d["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var k=g.s.r;k<=g.e.r;++k)for(var b=g.s.c;b<=g.e.c;++b){var _=He({r:k,c:b});x=w?(d[k]||[])[b]:d[_],!(!x||x.v==null&&(!x.f||x.F))&&p.push(l(x,d,k,b))}return m.join(y)+y+p.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:s,from_sheet:f}}(),dF=function(){function e(i,s){switch(s.type){case"base64":return t(Cn(i),s);case"binary":return t(i,s);case"buffer":return t(Qe&&Buffer.isBuffer(i)?i.toString("binary"):ys(i),s);case"array":return t(so(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),h=d[0],m=d[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][c]=!0:p==="FALSE"?f[l][c]=!1:isNaN(xa(m))?isNaN(Yl(m).getDate())?f[l][c]=m:f[l][c]=jt(m):f[l][c]=xa(m),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function r(i,s){return wc(e(i,s),s)}function n(i,s){return xs(r(i,s),s)}var a=function(){var i=function(l,c,u,f,d){l.push(c),l.push(u+","+f),l.push('"'+d.replace(/"/g,'""')+'"')},s=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=lt(l["!ref"]),f,d=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){s(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var p=He({r:h,c:m});if(f=d?(l[h]||[])[m]:l[p],!f){s(c,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?s(c,1,0,"="+f.f):s(c,1,0,""):s(c,0,g,"V");break;case"b":s(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Qn(f.z||ze[14],pr(jt(f.v)))),s(c,0,f.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var x=`\r
`,w=c.join(x);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),hF=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var h=f.split(`
`),m=-1,p=-1,g=0,x=[];g!==h.length;++g){var w=h[g].trim().split(":");if(w[0]==="cell"){var y=Lt(w[1]);if(x.length<=y.r)for(m=x.length;m<=y.r;++m)x[m]||(x[m]=[]);switch(m=y.r,p=y.c,w[2]){case"t":x[m][p]=e(w[3]);break;case"v":x[m][p]=+w[3];break;case"vtf":var k=w[w.length-1];case"vtc":switch(w[3]){case"nl":x[m][p]=!!+w[4];break;default:x[m][p]=+w[4];break}w[2]=="vtf"&&(x[m][p]=[x[m][p],k])}}}return d&&d.sheetRows&&(x=x.slice(0,d.sheetRows)),x}function n(f,d){return wc(r(f,d),d)}function a(f,d){return xs(n(f,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var d=[],h=[],m,p="",g=hn(f["!ref"]),x=Array.isArray(f),w=g.s.r;w<=g.e.r;++w)for(var y=g.s.c;y<=g.e.c;++y)if(p=He({r:w,c:y}),m=x?(f[w]||[])[y]:f[p],!(!m||m.v==null||m.t==="z")){switch(h=["cell",p,"t"],m.t){case"s":case"str":h.push(t(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=t(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var k=pr(jt(m.v));h[2]="vtc",h[3]="nd",h[4]=""+k,h[5]=m.w||Qn(m.z||ze[14],k);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(f){return[i,s,o,s,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),Jl=function(){function e(u,f,d,h,m){m.raw?f[d][h]=u:u===""||(u==="TRUE"?f[d][h]=!0:u==="FALSE"?f[d][h]=!1:isNaN(xa(u))?isNaN(Yl(u).getDate())?f[d][h]=u:f[d][h]=jt(u):f[d][h]=xa(u))}function t(u,f){var d=f||{},h=[];if(!u||u.length===0)return h;for(var m=u.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,x=0,w=0;w<=p;++w)x=m[w].indexOf(" "),x==-1?x=m[w].length:x++,g=Math.max(g,x);for(w=0;w<=p;++w){h[w]=[];var y=0;for(e(m[w].slice(0,g).trim(),h,w,y,d),y=1;y<=(m[w].length-g)/10+1;++y)e(m[w].slice(g+(y-1)*10,g+y*10).trim(),h,w,y,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},d=!1,h=0,m=0;h<u.length;++h)(m=u.charCodeAt(h))==34?d=!d:!d&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[m.pop()[1]]||44}function i(u,f){var d=f||{},h="",m=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):d&&d.FS?h=d.FS:h=a(u.slice(0,1024));var g=0,x=0,w=0,y=0,k=0,b=h.charCodeAt(0),_=!1,S=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var T=d.dateNF!=null?Jle(d.dateNF):null;function F(){var C=u.slice(y,k),A={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)A.t="z";else if(d.raw)A.t="s",A.v=C;else if(C.trim().length===0)A.t="s",A.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(A.t="s",A.v=C.slice(2,-1).replace(/""/g,'"')):The(C)?(A.t="n",A.f=C.slice(1)):(A.t="s",A.v=C);else if(C=="TRUE")A.t="b",A.v=!0;else if(C=="FALSE")A.t="b",A.v=!1;else if(!isNaN(w=xa(C)))A.t="n",d.cellText!==!1&&(A.w=C),A.v=w;else if(!isNaN(Yl(C).getDate())||T&&C.match(T)){A.z=d.dateNF||ze[14];var M=0;T&&C.match(T)&&(C=Qle(C,d.dateNF,C.match(T)||[]),M=1),d.cellDates?(A.t="d",A.v=jt(C,M)):(A.t="n",A.v=pr(jt(C,M))),d.cellText!==!1&&(A.w=Qn(A.z,A.v instanceof Date?pr(A.v):A.v)),d.cellNF||delete A.z}else A.t="s",A.v=C;if(A.t=="z"||(d.dense?(m[g]||(m[g]=[]),m[g][x]=A):m[He({c:x,r:g})]=A),y=k+1,E=u.charCodeAt(y),p.e.c<x&&(p.e.c=x),p.e.r<g&&(p.e.r=g),S==b)++x;else if(x=0,++g,d.sheetRows&&d.sheetRows<=g)return!0}e:for(;k<u.length;++k)switch(S=u.charCodeAt(k)){case 34:E===34&&(_=!_);break;case b:case 10:case 13:if(!_&&F())break e;break}return k-y>0&&F(),m["!ref"]=Xe(p),m}function s(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):wc(t(u,f),f)}function o(u,f){var d="",h=f.type=="string"?[0,0,0,0]:$b(u,f);switch(f.type){case"base64":d=Cn(u);break;case"binary":d=u;break;case"buffer":f.codepage==65001?d=u.toString("utf8"):f.codepage&&typeof Pf<"u"||(d=Qe&&Buffer.isBuffer(u)?u.toString("binary"):ys(u));break;case"array":d=so(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=wt(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=wt(d):f.type=="binary"&&typeof Pf<"u",d.slice(0,19)=="socialcalc:version:"?hF.to_sheet(f.type=="string"?d:wt(d),f):s(d,f)}function l(u,f){return xs(o(u,f),f)}function c(u){for(var f=[],d=lt(u["!ref"]),h,m=Array.isArray(u),p=d.s.r;p<=d.e.r;++p){for(var g=[],x=d.s.c;x<=d.e.c;++x){var w=He({r:p,c:x});if(h=m?(u[p]||[])[x]:u[w],!h||h.v==null){g.push("          ");continue}for(var y=(h.w||(yi(h),h.w)||"").slice(0,10);y.length<10;)y+=" ";g.push(y+(x===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function dde(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=fF.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Jl.to_workbook(e,t)}}var Ks=function(){function e(P,G,B){if(P){Tr(P,P.l||0);for(var q=B.Enum||X;P.l<P.length;){var ne=P.read_shift(2),ye=q[ne]||q[65535],pe=P.read_shift(2),te=P.l+pe,le=ye.f&&ye.f(P,pe,B);if(P.l=te,G(le,ye,ne))return}}}function t(P,G){switch(G.type){case"base64":return r(Sn(Cn(P)),G);case"binary":return r(Sn(P),G);case"buffer":case"array":return r(P,G)}throw"Unsupported type "+G.type}function r(P,G){if(!P)return P;var B=G||{},q=B.dense?[]:{},ne="Sheet1",ye="",pe=0,te={},le=[],Se=[],N={s:{r:0,c:0},e:{r:0,c:0}},Re=B.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)B.Enum=X,e(P,function(de,Ue,at){switch(at){case 0:B.vers=de,de>=4096&&(B.qpro=!0);break;case 6:N=de;break;case 204:de&&(ye=de);break;case 222:ye=de;break;case 15:case 51:B.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:at==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=B.dateNF||ze[14],B.cellDates&&(de[1].t="d",de[1].v=Tm(de[1].v))),B.qpro&&de[3]>pe&&(q["!ref"]=Xe(N),te[ne]=q,le.push(ne),q=B.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},pe=de[3],ne=ye||"Sheet"+(pe+1),ye="");var I=B.dense?(q[de[0].r]||[])[de[0].c]:q[He(de[0])];if(I){I.t=de[1].t,I.v=de[1].v,de[1].z!=null&&(I.z=de[1].z),de[1].f!=null&&(I.f=de[1].f);break}B.dense?(q[de[0].r]||(q[de[0].r]=[]),q[de[0].r][de[0].c]=de[1]):q[He(de[0])]=de[1];break}},B);else if(P[2]==26||P[2]==14)B.Enum=ee,P[2]==14&&(B.qpro=!0,P.l=0),e(P,function(de,Ue,at){switch(at){case 204:ne=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>pe&&(q["!ref"]=Xe(N),te[ne]=q,le.push(ne),q=B.dense?[]:{},N={s:{r:0,c:0},e:{r:0,c:0}},pe=de[3],ne="Sheet"+(pe+1)),Re>0&&de[0].r>=Re)break;B.dense?(q[de[0].r]||(q[de[0].r]=[]),q[de[0].r][de[0].c]=de[1]):q[He(de[0])]=de[1],N.e.c<de[0].c&&(N.e.c=de[0].c),N.e.r<de[0].r&&(N.e.r=de[0].r);break;case 27:de[14e3]&&(Se[de[14e3][0]]=de[14e3][1]);break;case 1537:Se[de[0]]=de[1],de[0]==pe&&(ne=de[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(q["!ref"]=Xe(N),te[ye||ne]=q,le.push(ye||ne),!Se.length)return{SheetNames:le,Sheets:te};for(var ae={},re=[],fe=0;fe<Se.length;++fe)te[le[fe]]?(re.push(Se[fe]||le[fe]),ae[Se[fe]]=te[Se[fe]]||te[le[fe]]):(re.push(Se[fe]),ae[Se[fe]]={"!ref":"A1"});return{SheetNames:re,Sheets:ae}}function n(P,G){var B=G||{};if(+B.codepage>=0&&ma(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var q=dn(),ne=lt(P["!ref"]),ye=Array.isArray(P),pe=[];Ae(q,0,i(1030)),Ae(q,6,l(ne));for(var te=Math.min(ne.e.r,8191),le=ne.s.r;le<=te;++le)for(var Se=Jt(le),N=ne.s.c;N<=ne.e.c;++N){le===ne.s.r&&(pe[N]=$t(N));var Re=pe[N]+Se,ae=ye?(P[le]||[])[N]:P[Re];if(!(!ae||ae.t=="z"))if(ae.t=="n")(ae.v|0)==ae.v&&ae.v>=-32768&&ae.v<=32767?Ae(q,13,h(le,N,ae.v)):Ae(q,14,p(le,N,ae.v));else{var re=yi(ae);Ae(q,15,f(le,N,re.slice(0,239)))}}return Ae(q,1),q.end()}function a(P,G){var B=G||{};if(+B.codepage>=0&&ma(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var q=dn();Ae(q,0,s(P));for(var ne=0,ye=0;ne<P.SheetNames.length;++ne)(P.Sheets[P.SheetNames[ne]]||{})["!ref"]&&Ae(q,27,j(P.SheetNames[ne],ye++));var pe=0;for(ne=0;ne<P.SheetNames.length;++ne){var te=P.Sheets[P.SheetNames[ne]];if(!(!te||!te["!ref"])){for(var le=lt(te["!ref"]),Se=Array.isArray(te),N=[],Re=Math.min(le.e.r,8191),ae=le.s.r;ae<=Re;++ae)for(var re=Jt(ae),fe=le.s.c;fe<=le.e.c;++fe){ae===le.s.r&&(N[fe]=$t(fe));var de=N[fe]+re,Ue=Se?(te[ae]||[])[fe]:te[de];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")Ae(q,23,F(ae,fe,pe,Ue.v));else{var at=yi(Ue);Ae(q,22,S(ae,fe,pe,at.slice(0,239)))}}++pe}}return Ae(q,1),q.end()}function i(P){var G=he(2);return G.write_shift(2,P),G}function s(P){var G=he(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var B=0,q=0,ne=0,ye=0;ye<P.SheetNames.length;++ye){var pe=P.SheetNames[ye],te=P.Sheets[pe];if(!(!te||!te["!ref"])){++ne;var le=hn(te["!ref"]);B<le.e.r&&(B=le.e.r),q<le.e.c&&(q=le.e.c)}}return B>8191&&(B=8191),G.write_shift(2,B),G.write_shift(1,ne),G.write_shift(1,q),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(P,G,B){var q={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&B.qpro?(q.s.c=P.read_shift(1),P.l++,q.s.r=P.read_shift(2),q.e.c=P.read_shift(1),P.l++,q.e.r=P.read_shift(2),q):(q.s.c=P.read_shift(2),q.s.r=P.read_shift(2),G==12&&B.qpro&&(P.l+=2),q.e.c=P.read_shift(2),q.e.r=P.read_shift(2),G==12&&B.qpro&&(P.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function l(P){var G=he(8);return G.write_shift(2,P.s.c),G.write_shift(2,P.s.r),G.write_shift(2,P.e.c),G.write_shift(2,P.e.r),G}function c(P,G,B){var q=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(q[0].c=P.read_shift(1),q[3]=P.read_shift(1),q[0].r=P.read_shift(2),P.l+=2):(q[2]=P.read_shift(1),q[0].c=P.read_shift(2),q[0].r=P.read_shift(2)),q}function u(P,G,B){var q=P.l+G,ne=c(P,G,B);if(ne[1].t="s",B.vers==20768){P.l++;var ye=P.read_shift(1);return ne[1].v=P.read_shift(ye,"utf8"),ne}return B.qpro&&P.l++,ne[1].v=P.read_shift(q-P.l,"cstr"),ne}function f(P,G,B){var q=he(7+B.length);q.write_shift(1,255),q.write_shift(2,G),q.write_shift(2,P),q.write_shift(1,39);for(var ne=0;ne<q.length;++ne){var ye=B.charCodeAt(ne);q.write_shift(1,ye>=128?95:ye)}return q.write_shift(1,0),q}function d(P,G,B){var q=c(P,G,B);return q[1].v=P.read_shift(2,"i"),q}function h(P,G,B){var q=he(7);return q.write_shift(1,255),q.write_shift(2,G),q.write_shift(2,P),q.write_shift(2,B,"i"),q}function m(P,G,B){var q=c(P,G,B);return q[1].v=P.read_shift(8,"f"),q}function p(P,G,B){var q=he(13);return q.write_shift(1,255),q.write_shift(2,G),q.write_shift(2,P),q.write_shift(8,B,"f"),q}function g(P,G,B){var q=P.l+G,ne=c(P,G,B);if(ne[1].v=P.read_shift(8,"f"),B.qpro)P.l=q;else{var ye=P.read_shift(2);k(P.slice(P.l,P.l+ye),ne),P.l+=ye}return ne}function x(P,G,B){var q=G&32768;return G&=-32769,G=(q?P:0)+(G>=8192?G-16384:G),(q?"":"$")+(B?$t(G):Jt(G))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(P,G){Tr(P,0);for(var B=[],q=0,ne="",ye="",pe="",te="";P.l<P.length;){var le=P[P.l++];switch(le){case 0:B.push(P.read_shift(8,"f"));break;case 1:ye=x(G[0].c,P.read_shift(2),!0),ne=x(G[0].r,P.read_shift(2),!1),B.push(ye+ne);break;case 2:{var Se=x(G[0].c,P.read_shift(2),!0),N=x(G[0].r,P.read_shift(2),!1);ye=x(G[0].c,P.read_shift(2),!0),ne=x(G[0].r,P.read_shift(2),!1),B.push(Se+N+":"+ye+ne)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(P.read_shift(2));break;case 6:{for(var Re="";le=P[P.l++];)Re+=String.fromCharCode(le);B.push('"'+Re.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:te=B.pop(),pe=B.pop(),B.push(["AND","OR"][le-20]+"("+pe+","+te+")");break;default:if(le<32&&y[le])te=B.pop(),pe=B.pop(),B.push(pe+y[le]+te);else if(w[le]){if(q=w[le][1],q==69&&(q=P[P.l++]),q>B.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+B.join("|")+"|");return}var ae=B.slice(-q);B.length-=q,B.push(w[le][0]+"("+ae.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}B.length==1?G[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function b(P){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=P.read_shift(2),G[3]=P[P.l++],G[0].c=P[P.l++],G}function _(P,G){var B=b(P);return B[1].t="s",B[1].v=P.read_shift(G-4,"cstr"),B}function S(P,G,B,q){var ne=he(6+q.length);ne.write_shift(2,P),ne.write_shift(1,B),ne.write_shift(1,G),ne.write_shift(1,39);for(var ye=0;ye<q.length;++ye){var pe=q.charCodeAt(ye);ne.write_shift(1,pe>=128?95:pe)}return ne.write_shift(1,0),ne}function E(P,G){var B=b(P);B[1].v=P.read_shift(2);var q=B[1].v>>1;if(B[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return B[1].v=q,B}function T(P,G){var B=b(P),q=P.read_shift(4),ne=P.read_shift(4),ye=P.read_shift(2);if(ye==65535)return q===0&&ne===3221225472?(B[1].t="e",B[1].v=15):q===0&&ne===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var pe=ye&32768;return ye=(ye&32767)-16446,B[1].v=(1-pe*2)*(ne*Math.pow(2,ye+32)+q*Math.pow(2,ye)),B}function F(P,G,B,q){var ne=he(14);if(ne.write_shift(2,P),ne.write_shift(1,B),ne.write_shift(1,G),q==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var ye=0,pe=0,te=0,le=0;return q<0&&(ye=1,q=-q),pe=Math.log2(q)|0,q/=Math.pow(2,pe-31),le=q>>>0,le&2147483648||(q/=2,++pe,le=q>>>0),q-=le,le|=2147483648,le>>>=0,q*=Math.pow(2,32),te=q>>>0,ne.write_shift(4,te),ne.write_shift(4,le),pe+=16383+(ye?32768:0),ne.write_shift(2,pe),ne}function C(P,G){var B=T(P);return P.l+=G-14,B}function A(P,G){var B=b(P),q=P.read_shift(4);return B[1].v=q>>6,B}function M(P,G){var B=b(P),q=P.read_shift(8,"f");return B[1].v=q,B}function V(P,G){var B=M(P);return P.l+=G-10,B}function z(P,G){return P[P.l+G-1]==0?P.read_shift(G,"cstr"):""}function Y(P,G){var B=P[P.l++];B>G-1&&(B=G-1);for(var q="";q.length<B;)q+=String.fromCharCode(P[P.l++]);return q}function J(P,G,B){if(!(!B.qpro||G<21)){var q=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var ne=P.read_shift(G-21,"cstr");return[q,ne]}}function Q(P,G){for(var B={},q=P.l+G;P.l<q;){var ne=P.read_shift(2);if(ne==14e3){for(B[ne]=[0,""],B[ne][0]=P.read_shift(2);P[P.l];)B[ne][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return B}function j(P,G){var B=he(5+P.length);B.write_shift(2,14e3),B.write_shift(2,G);for(var q=0;q<P.length;++q){var ne=P.charCodeAt(q);B[B.l++]=ne>127?95:ne}return B[B.l++]=0,B}var X={0:{n:"BOF",f:nr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:_},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:V},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function hde(e){var t={},r=e.match(Kr),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Ve(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=tb[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var pde=function(){var e=Ff("t"),t=Ff("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:st(s[1])},l=i.match(t);return l&&(o.s=hde(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),mde=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),vde=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,gde=/<(?:\w+:)?r>/,yde=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Eb(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=st(wt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=wt(e),r&&(n.h=fb(n.t))):e.match(gde)&&(n.r=wt(e),n.t=st(wt((e.replace(yde,"").match(vde)||[]).join("").replace(Kr,""))),r&&(n.h=mde(pde(n.r)))),n):{t:""}}var xde=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wde=/<(?:\w+:)?(?:si|sstItem)>/g,bde=/<\/(?:\w+:)?(?:si|sstItem)>/;function _de(e,t){var r=[],n="";if(!e)return r;var a=e.match(xde);if(a){n=a[2].replace(wde,"").split(bde);for(var i=0;i!=n.length;++i){var s=Eb(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=Ve(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var Sde=/^\s|\s$|[\t\n\r]/;function pF(e,t){if(!t.bookSST)return"";var r=[Qt];r[r.length]=Te("sst",null,{xmlns:xo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(Sde)&&(i+=' xml:space="preserve"'),i+=">"+mt(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function kde(e){return[e.read_shift(4),e.read_shift(4)]}function Ede(e,t){var r=[],n=!1;return ki(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Tde(e,t){return t||(t=he(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Ade=Mce;function Ode(e){var t=dn();xe(t,159,Tde(e));for(var r=0;r<e.length;++r)xe(t,19,Ade(e[r]));return xe(t,160),t.end()}function mF(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function li(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Cde(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=li(e,4),t.U=li(e,4),t.W=li(e,4),t}function Pde(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function jde(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Pde(e));return t}function Nde(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Fde(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=li(e,4),t.U=li(e,4),t.W=li(e,4),t}function Ide(e){var t=Fde(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function vF(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function gF(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Dde(e){var t=li(e);switch(t.Minor){case 2:return[t.Minor,Rde(e)];case 3:return[t.Minor,Mde()];case 4:return[t.Minor,$de(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Rde(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=vF(e,r),a=gF(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Mde(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $de(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Kr,function(i){var s=Ve(i);switch(Ba(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function Lde(e,t){var r={},n=r.EncryptionVersionInfo=li(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=vF(e,a),t-=a,r.EncryptionVerifier=gF(e,t),r}function Bde(e){var t={},r=t.EncryptionVersionInfo=li(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Tb(e){var t=0,r,n=mF(e),a=n.length+1,i,s,o,l,c;for(r=is(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var yF=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=mF(s),l=i(o),c=o.length,u=is(16),f=0;f!=16;++f)u[f]=0;var d,h,m;for((c&1)===1&&(d=l>>8,u[c]=a(e[0],d),--c,d=l&255,h=o[o.length-1],u[c]=a(h,d));c>0;)--c,d=l>>8,u[c]=a(o[c],d),--c,d=l&255,u[c]=a(o[c],d);for(c=15,m=15-o.length;m>0;)d=l>>8,u[c]=a(e[m],d),--c,--m,d=l&255,u[c]=a(o[c],d),--c,--m;return u}}(),Ude=function(e,t,r,n,a){a||(a=t),n||(n=yF(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},Wde=function(e){var t=0,r=yF(e);return function(n){var a=Ude("",n,t,r);return t=a[1],a[0]}};function zde(e,t,r,n){var a={key:nr(e),verificationBytes:nr(e)};return r.password&&(a.verifier=Tb(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Wde(r.password)),a}function Hde(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Bde(e):n.Data=Lde(e,t),n}function Vde(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Hde(e,t-2,n):zde(e,r.biff>=8?t:t-2,r,n),n}var xF=function(){function e(a,i){switch(i.type){case"base64":return t(Cn(a),i);case"binary":return t(a,i);case"buffer":return t(Qe&&Buffer.isBuffer(a)?a.toString("binary"):ys(a),i);case"array":return t(so(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,h=0,m,p=-1;m=d.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(h,d.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var x={v:g,t:"s"};Array.isArray(o)?o[f][p]=x:o[He({r:f,c:p})]=x}break}h=d.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=Xe(c),o}function r(a,i){return xs(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=lt(a["!ref"]),o,l=Array.isArray(a),c=s.s.r;c<=s.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var f=He({r:c,c:u});o=l?(a[c]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(yi(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Gde(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Mf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Kde(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,l=0,c=a+i;switch(l=s/(c>1?2-c:c),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,l,c/2]}function qde(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,s[0]+=a,s[1]+=l;break;case 1:l=a*(2-o),s[0]+=l,s[1]+=a;break;case 2:l=a*(o-2),s[1]+=a,s[2]+=l;break;case 3:l=a*(4-o),s[1]+=l,s[2]+=a;break;case 4:l=a*(o-4),s[2]+=a,s[0]+=l;break;case 5:l=a*(6-o),s[2]+=l,s[0]+=a;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function fp(e,t){if(t===0)return e;var r=Kde(Gde(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Mf(qde(r))}var wF=6,Xde=15,Yde=1,Ur=wF;function $f(e){return Math.floor((e+Math.round(128/Ur)/256)*Ur)}function Lf(e){return Math.floor((e-5)/Ur*100+.5)/100}function dp(e){return Math.round((e*Ur+5)/Ur*256)/256}function Gv(e){return dp(Lf($f(e)))}function Ab(e){var t=Math.abs(e-Gv(e)),r=Ur;if(t>.005)for(Ur=Yde;Ur<Xde;++Ur)Math.abs(e-Gv(e))<=t&&(t=Math.abs(e-Gv(e)),r=Ur);Ur=r}function ss(e){e.width?(e.wpx=$f(e.width),e.wch=Lf(e.wpx),e.MDW=Ur):e.wpx?(e.wch=Lf(e.wpx),e.width=dp(e.wch),e.MDW=Ur):typeof e.wch=="number"&&(e.width=dp(e.wch),e.wpx=$f(e.width),e.MDW=Ur),e.customWidth&&delete e.customWidth}var Jde=96,bF=Jde;function Bf(e){return e*96/bF}function Ql(e){return e*bF/96}var Qde={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Zde(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Kr)||[]).forEach(function(s){var o=Ve(s);switch(Ba(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Ct(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Ct(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function e0e(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Kr)||[]).forEach(function(s){var o=Ve(s);switch(Ba(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function t0e(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Kr)||[]).forEach(function(s){var o=Ve(s);switch(Ba(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=wt(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Ct(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Ct(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Ct(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Ct(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Ct(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Ct(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Ct(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=tb[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Ct(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Vs[a.color.index];a.color.index==81&&(l=Vs[1]),l||(l=Vs[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=fp(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function r0e(e,t,r){t.NumberFmt=[];for(var n=Kt(ze),a=0;a<n.length;++a)t.NumberFmt[n[a]]=ze[n[a]];var i=e[0].match(Kr);if(i)for(a=0;a<i.length;++a){var s=Ve(i[a]);switch(Ba(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=st(wt(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}oi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function n0e(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Te("numFmt",null,{numFmtId:n,formatCode:mt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Te("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var o0=["numFmtId","fillId","fontId","borderId","xfId"],l0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function a0e(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Kr)||[]).forEach(function(i){var s=Ve(i),o=0;switch(Ba(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<o0.length;++o)n[o0[o]]&&(n[o0[o]]=parseInt(n[o0[o]],10));for(o=0;o<l0.length;++o)n[l0[o]]&&(n[l0[o]]=Ct(n[l0[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=Ct(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function i0e(e){var t=[];return t[t.length]=Te("cellXfs",null),e.forEach(function(r){t[t.length]=Te("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Te("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var s0e=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&r0e(f,u,c),(f=o.match(a))&&t0e(f,u,l,c),(f=o.match(n))&&e0e(f,u,l,c),(f=o.match(i))&&Zde(f,u,l,c),(f=o.match(r))&&a0e(f,u,c),u}}();function _F(e,t){var r=[Qt,Te("styleSheet",null,{xmlns:xo[0],"xmlns:vt":fr.vt})],n;return e.SSF&&(n=n0e(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=i0e(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function o0e(e,t){var r=e.read_shift(2),n=Hr(e);return[r,n]}function l0e(e,t,r){r||(r=he(6+4*t.length)),r.write_shift(2,e),wr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function c0e(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=Hce(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=zce(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Hr(e),n}function u0e(e,t){t||(t=he(25+4*32)),t.write_shift(2,e.sz*20),Vce(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),lp(e.color,t);var n=0;return n=2,t.write_shift(1,n),wr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var f0e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Kv,d0e=Gr;function sA(e,t){t||(t=he(4*3+8*7+16*1)),Kv||(Kv=km(f0e));var r=Kv[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(lp({auto:1},t),lp({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function h0e(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function SF(e,t,r){r||(r=he(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Gc(e,t){return t||(t=he(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var p0e=Gr;function m0e(e,t){return t||(t=he(51)),t.write_shift(1,0),Gc(null,t),Gc(null,t),Gc(null,t),Gc(null,t),Gc(null,t),t.length>t.l?t.slice(0,t.l):t}function v0e(e,t){return t||(t=he(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),op(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function g0e(e,t,r){var n=he(2052);return n.write_shift(4,e),op(t,n),op(r,n),n.length>n.l?n.slice(0,n.l):n}function y0e(e,t,r){var n={};n.NumberFmt=[];for(var a in ze)n.NumberFmt[a]=ze[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return ki(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],oi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=fp(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(u),s=!0;break;case 38:i.pop(),s=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function x0e(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(xe(e,615,wa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&xe(e,44,l0e(a,t[a]))}),xe(e,616))}}function w0e(e){var t=1;xe(e,611,wa(t)),xe(e,43,u0e({sz:12,color:{theme:1},name:"Calibri",family:2})),xe(e,612)}function b0e(e){var t=2;xe(e,603,wa(t)),xe(e,45,sA({patternType:"none"})),xe(e,45,sA({patternType:"gray125"})),xe(e,604)}function _0e(e){var t=1;xe(e,613,wa(t)),xe(e,46,m0e()),xe(e,614)}function S0e(e){var t=1;xe(e,626,wa(t)),xe(e,47,SF({numFmtId:0},65535)),xe(e,627)}function k0e(e,t){xe(e,617,wa(t.length)),t.forEach(function(r){xe(e,47,SF(r,0))}),xe(e,618)}function E0e(e){var t=1;xe(e,619,wa(t)),xe(e,48,v0e({xfId:0,name:"Normal"})),xe(e,620)}function T0e(e){var t=0;xe(e,505,wa(t)),xe(e,506)}function A0e(e){var t=0;xe(e,508,g0e(t,"TableStyleMedium9","PivotStyleMedium4")),xe(e,509)}function O0e(e,t){var r=dn();return xe(r,278),x0e(r,e.SSF),w0e(r),b0e(r),_0e(r),S0e(r),k0e(r,t.cellXfs),E0e(r),T0e(r),A0e(r),xe(r,279),r.end()}var C0e=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function P0e(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Kr)||[]).forEach(function(a){var i=Ve(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[C0e.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function j0e(){}function N0e(){}var F0e=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,I0e=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,D0e=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function R0e(e,t,r){t.themeElements={};var n;[["clrScheme",F0e,P0e],["fontScheme",I0e,j0e],["fmtScheme",D0e,N0e]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var M0e=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function kF(e,t){(!e||e.length===0)&&(e=Ob());var r,n={};if(!(r=e.match(M0e)))throw new Error("themeElements not found in theme");return R0e(r[0],n,t),n.raw=e,n}function Ob(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Qt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $0e(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=vN(i,{type:"array"})}catch{return}var o=kn(s,"theme/theme/theme1.xml",!0);if(o)return kF(o,r)}}function L0e(e){return e.read_shift(4)}function B0e(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=U0e(e,4);break;case 2:t.xclrValue=nF(e);break;case 3:t.xclrValue=L0e(e);break;case 4:e.l+=4;break}return e.l+=8,t}function U0e(e,t){return Gr(e,t)}function W0e(e,t){return Gr(e,t)}function z0e(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=B0e(e);break;case 6:n[1]=W0e(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function H0e(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(z0e(e,r-e.l));return{ixfe:n,ext:i}}function V0e(e,t){t.forEach(function(r){switch(r[0]){}})}function G0e(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Hr(e)}}function K0e(e){var t=he(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),wr(e.name,t),t.slice(0,t.l)}function q0e(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function X0e(e){var t=he(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Y0e(e,t){var r=he(8+2*t.length);return r.write_shift(4,e),wr(t,r),r.slice(0,r.l)}function J0e(e){return e.l+=4,e.read_shift(4)!=0}function Q0e(e,t){var r=he(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Z0e(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return ki(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!c.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function ehe(){var e=dn();return xe(e,332),xe(e,334,wa(1)),xe(e,335,K0e({name:"XLDAPR",version:12e4,flags:3496657072})),xe(e,336),xe(e,339,Y0e(1,"XLDAPR")),xe(e,52),xe(e,35,wa(514)),xe(e,4096,wa(0)),xe(e,4097,Bn(1)),xe(e,36),xe(e,53),xe(e,340),xe(e,337,Q0e(1)),xe(e,51,X0e([[1,0]])),xe(e,338),xe(e,333),e.end()}function the(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(Kr,function(o){var l=Ve(o);switch(Ba(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function EF(){var e=[Qt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function rhe(e){var t=[];if(!e)return t;var r=1;return(e.match(Kr)||[]).forEach(function(n){var a=Ve(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function nhe(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=He(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function ahe(e,t,r){var n=[];return ki(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function ihe(e,t,r,n){if(!e)return e;var a=n||{},i=!1;ki(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function she(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var al=1024;function TF(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Te("xml",null,{"xmlns:v":wn.v,"xmlns:o":wn.o,"xmlns:x":wn.x,"xmlns:mv":wn.mv}).replace(/\/>/,">"),Te("o:shapelayout",Te("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Te("v:shapetype",[Te("v:stroke",null,{joinstyle:"miter"}),Te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];al<e*1e3;)al+=1e3;return t.forEach(function(i){var s=Lt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Te("v:fill",l,o),u={on:"t",obscured:"t"};++al,a=a.concat(["<v:shape"+If({id:"_x0000_s"+al,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Te("v:shadow",null,u),Te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ar("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Ar("x:AutoFill","False"),Ar("x:Row",String(s.r)),Ar("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function oA(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=Lt(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var l=lt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Xe(l);c!==e["!ref"]&&(e["!ref"]=c)}i.c||(i.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function ohe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ve(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Lt(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&Eb(f[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function AF(e){var t=[Qt,Te("comments",null,{xmlns:xo[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=mt(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(mt(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(Ar("t",mt(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(Ar("t",mt(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function lhe(e,t){var r=[],n=!1,a={},i=0;return e.replace(Kr,function(o,l){var c=Ve(o);switch(Ba(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":a.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function che(e,t,r){var n=[Qt,Te("ThreadedComments",null,{xmlns:fr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Te("threadedComment",Ar("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function uhe(e,t){var r=[],n=!1;return e.replace(Kr,function(i){var s=Ve(i);switch(Ba(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function fhe(e){var t=[Qt,Te("personList",null,{xmlns:fr.TCMNT,"xmlns:x":xo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Te("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function dhe(e){var t={};t.iauthor=e.read_shift(4);var r=So(e);return t.rfx=r.s,t.ref=He(r.s),e.l+=16,t}function hhe(e,t){return t==null&&(t=he(36)),t.write_shift(4,e[1].iauthor),bc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var phe=Hr;function mhe(e){return wr(e.slice(0,54))}function vhe(e,t){var r=[],n=[],a={},i=!1;return ki(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function ghe(e){var t=dn(),r=[];return xe(t,628),xe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),xe(t,632,mhe(a.a)))})}),xe(t,631),xe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Lt(n[0]),e:Lt(n[0])};xe(t,635,hhe([i,a])),a.t&&a.t.length>0&&xe(t,637,Lce(a)),xe(t,636),delete a.iauthor})}),xe(t,634),xe(t,629),t.end()}var yhe="application/vnd.ms-office.vbaProject";function xhe(e){var t=Le.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Le.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Le.write(t)}function whe(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Le.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var OF=["xlsb","xlsm","xlam","biff8","xla"];function bhe(){return{"!type":"dialog"}}function _he(){return{"!type":"dialog"}}function She(){return{"!type":"macro"}}function khe(){return{"!type":"macro"}}var vl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+$t(u)+(l?"":"$")+Jt(c)}return function(a,i){return t=i,a.replace(e,r)}}(),Cb=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Pb=function(){return function(t,r){return t.replace(Cb,function(n,a,i,s,o,l){var c=vb(s)-(i?0:r.c),u=mb(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",d=c==0?"":i?c+1:"["+c+"]";return a+"R"+f+"C"+d})}}();function CF(e,t){return e.replace(Cb,function(r,n,a,i,s,o){return n+(a=="$"?a+i:$t(vb(i)+t.c))+(s=="$"?s+o:Jt(mb(o)+t.r))})}function Ehe(e,t,r){var n=hn(t),a=n.s,i=Lt(r),s={r:i.r-a.r,c:i.c-a.c};return CF(e,s)}function The(e){return e.length!=1}function lA(e){return e.replace(/_xlfn\./g,"")}function er(e){e.l+=1}function os(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function PF(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return jF(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=os(e),o=os(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function jF(e){var t=os(e),r=os(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Ahe(e,t,r){if(r.biff<8)return jF(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=os(e),s=os(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function NF(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Ohe(e);var n=e.read_shift(r&&r.biff==12?4:2),a=os(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Ohe(e){var t=os(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Che(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Phe(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return jhe(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function jhe(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Nhe(e,t,r){var n=(e[e.l++]&96)>>5,a=PF(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Fhe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=PF(e,i,r);return[n,a,s]}function Ihe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Dhe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Rhe(e,t,r){var n=(e[e.l++]&96)>>5,a=Ahe(e,t-1,r);return[n,a]}function Mhe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function cA(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function $he(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Lhe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Bhe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Uhe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Whe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function FF(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function zhe(e){return e.read_shift(2),FF(e)}function Hhe(e){return e.read_shift(2),FF(e)}function Vhe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=NF(e,0,r);return[n,a]}function Ghe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Phe(e,0,r);return[n,a]}function Khe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=NF(e,0,r);return[n,a,i]}function qhe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Jpe[a],RF[a],n]}function Xhe(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Yhe(e);return[a,(i[0]===0?RF:Ype)[i[1]]]}function Yhe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Jhe(e,t,r){e.l+=r&&r.biff==2?3:4}function Qhe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Zhe(e){return e.l++,Ei[e.read_shift(1)]}function epe(e){return e.l++,e.read_shift(2)}function tpe(e){return e.l++,e.read_shift(1)!==0}function rpe(e){return e.l++,Wr(e)}function npe(e,t,r){return e.l++,cd(e,t-1,r)}function ape(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=qt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ei[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wr(e);break;case 2:r[1]=ko(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ipe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?So:Am)(e));return a}function spe(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=ape(e,r.biff);return s}function ope(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function lpe(e,t,r){if(r.biff==5)return cpe(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function cpe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function upe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function fpe(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function dpe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function hpe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var ppe=Gr,mpe=Gr,vpe=Gr;function fd(e,t,r){return e.l+=2,[Che(e)]}function jb(e){return e.l+=6,[]}var gpe=fd,ype=jb,xpe=jb,wpe=fd;function IF(e){return e.l+=2,[nr(e),e.read_shift(2)&1]}var bpe=fd,_pe=IF,Spe=jb,kpe=fd,Epe=fd,Tpe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Ape(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=Tpe[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Ope(e){return e.l+=2,[e.read_shift(4)]}function Cpe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Ppe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function jpe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Npe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Fpe(e){return e.l+=4,[0,0]}var uA={1:{n:"PtgExp",f:Qhe},2:{n:"PtgTbl",f:vpe},3:{n:"PtgAdd",f:er},4:{n:"PtgSub",f:er},5:{n:"PtgMul",f:er},6:{n:"PtgDiv",f:er},7:{n:"PtgPower",f:er},8:{n:"PtgConcat",f:er},9:{n:"PtgLt",f:er},10:{n:"PtgLe",f:er},11:{n:"PtgEq",f:er},12:{n:"PtgGe",f:er},13:{n:"PtgGt",f:er},14:{n:"PtgNe",f:er},15:{n:"PtgIsect",f:er},16:{n:"PtgUnion",f:er},17:{n:"PtgRange",f:er},18:{n:"PtgUplus",f:er},19:{n:"PtgUminus",f:er},20:{n:"PtgPercent",f:er},21:{n:"PtgParen",f:er},22:{n:"PtgMissArg",f:er},23:{n:"PtgStr",f:npe},26:{n:"PtgSheet",f:Cpe},27:{n:"PtgEndSheet",f:Ppe},28:{n:"PtgErr",f:Zhe},29:{n:"PtgBool",f:tpe},30:{n:"PtgInt",f:epe},31:{n:"PtgNum",f:rpe},32:{n:"PtgArray",f:Mhe},33:{n:"PtgFunc",f:qhe},34:{n:"PtgFuncVar",f:Xhe},35:{n:"PtgName",f:ope},36:{n:"PtgRef",f:Vhe},37:{n:"PtgArea",f:Nhe},38:{n:"PtgMemArea",f:upe},39:{n:"PtgMemErr",f:ppe},40:{n:"PtgMemNoMem",f:mpe},41:{n:"PtgMemFunc",f:fpe},42:{n:"PtgRefErr",f:dpe},43:{n:"PtgAreaErr",f:Ihe},44:{n:"PtgRefN",f:Ghe},45:{n:"PtgAreaN",f:Rhe},46:{n:"PtgMemAreaN",f:jpe},47:{n:"PtgMemNoMemN",f:Npe},57:{n:"PtgNameX",f:lpe},58:{n:"PtgRef3d",f:Khe},59:{n:"PtgArea3d",f:Fhe},60:{n:"PtgRefErr3d",f:hpe},61:{n:"PtgAreaErr3d",f:Dhe},255:{}},Ipe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Dpe={1:{n:"PtgElfLel",f:IF},2:{n:"PtgElfRw",f:kpe},3:{n:"PtgElfCol",f:gpe},6:{n:"PtgElfRwV",f:Epe},7:{n:"PtgElfColV",f:wpe},10:{n:"PtgElfRadical",f:bpe},11:{n:"PtgElfRadicalS",f:Spe},13:{n:"PtgElfColS",f:ype},15:{n:"PtgElfColSV",f:xpe},16:{n:"PtgElfRadicalLel",f:_pe},25:{n:"PtgList",f:Ape},29:{n:"PtgSxName",f:Ope},255:{}},Rpe={0:{n:"PtgAttrNoop",f:Fpe},1:{n:"PtgAttrSemi",f:Whe},2:{n:"PtgAttrIf",f:Bhe},4:{n:"PtgAttrChoose",f:$he},8:{n:"PtgAttrGoto",f:Lhe},16:{n:"PtgAttrSum",f:Jhe},32:{n:"PtgAttrBaxcel",f:cA},33:{n:"PtgAttrBaxcel",f:cA},64:{n:"PtgAttrSpace",f:zhe},65:{n:"PtgAttrSpaceSemi",f:Hhe},128:{n:"PtgAttrIfError",f:Uhe},255:{}};function dd(e,t,r,n){if(n.biff<8)return Gr(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=spe(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=ipe(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Gr(e,t)),i}function hd(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=uA[i]||uA[Ipe[i]],(i===24||i===25)&&(a=(i===24?Dpe:Rpe)[e[e.l+1]]),!a||!a.f?Gr(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Mpe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var $pe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Lpe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function DF(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function fA(e,t,r){var n=DF(e,t,r);return n=="#REF"?n:Lpe(n,r)}function Mr(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],l,c,u,f=0,d=0,h,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",x=0,w=e[0].length;x<w;++x){var y=e[0][x];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Vt(" ",e[0][p][1][1]);break;case 1:g=Vt("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+g,p=-1}o.push(c+$pe[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Su(y[1][1],s,a),o.push(ku(u,i));break;case"PtgRefN":u=r?Su(y[1][1],r,a):y[1][1],o.push(ku(u,i));break;case"PtgRef3d":f=y[1][1],u=Su(y[1][2],s,a),m=fA(n,f,a),o.push(m+"!"+ku(u,i));break;case"PtgFunc":case"PtgFuncVar":var k=y[1][0],b=y[1][1];k||(k=0),k&=127;var _=k==0?[]:o.slice(-k);o.length-=k,b==="User"&&(b=_.shift()),o.push(b+"("+_.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":h=BT(y[1][1],r?{s:r}:s,a),o.push(zv(h,a));break;case"PtgArea":h=BT(y[1][1],s,a),o.push(zv(h,a));break;case"PtgArea3d":f=y[1][1],h=y[1][2],m=fA(n,f,a),o.push(m+"!"+zv(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var S=(n.names||[])[d-1]||(n[0]||[])[d],E=S?S.Name:"SH33TJSNAME"+String(d);E&&E.slice(0,6)=="_xlfn."&&!a.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var T=y[1][1];d=y[1][2];var F;if(a.biff<=5)T<0&&(T=-T),n[T]&&(F=n[T][d]);else{var C="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][d]&&n[T][d].itab>0&&(C=n.SheetNames[n[T][d].itab-1]+"!"):C=n.SheetNames[d-1]+"!"),n[T]&&n[T][d])C+=n[T][d].Name;else if(n[0]&&n[0][d])C+=n[0][d].Name;else{var A=(DF(n,T,a)||"").split(";;");A[d-1]?C=A[d-1]:C+="SH33TJSERRX"}o.push(C);break}F||(F={Name:"SH33TJSERRY"}),o.push(F.Name);break;case"PtgParen":var M="(",V=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:M=Vt(" ",e[0][p][1][1])+M;break;case 3:M=Vt("\r",e[0][p][1][1])+M;break;case 4:V=Vt(" ",e[0][p][1][1])+V;break;case 5:V=Vt("\r",e[0][p][1][1])+V;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(M+o.pop()+V);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var z={c:r.c,r:r.r};if(n.sharedf[He(u)]){var Y=n.sharedf[He(u)];o.push(Mr(Y,s,z,n,a))}else{var J=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Mr(c[1],s,z,n,a)),J=!0;break}J||o.push(y[1])}break;case"PtgArray":o.push("{"+Mpe(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&Q.indexOf(e[0][x][0])==-1){y=e[0][p];var j=!0;switch(y[1][0]){case 4:j=!1;case 0:g=Vt(" ",y[1][1]);break;case 5:j=!1;case 1:g=Vt("\r",y[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((j?g:"")+o.pop()+(j?"":g)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Bpe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Gr(e,t-2)];var o=hd(e,s,r);return t!==s+a&&(i=dd(e,t-s-a,o,r)),e.l=n,[o,i]}function Upe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Gr(e,t-2)];var o=hd(e,s,r);return t!==s+a&&(i=dd(e,t-s-a,o,r)),e.l=n,[o,i]}function Wpe(e,t,r,n){var a=e.l+t,i=hd(e,n,r),s;return a!==e.l&&(s=dd(e,a-e.l,i,r)),[i,s]}function zpe(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=hd(e,i,r);return i==65535?[[],Gr(e,t-2)]:(t!==i+2&&(a=dd(e,n-i-2,s,r)),[s,a])}function Hpe(e){var t;if(ei(e,e.l+6)!==65535)return[Wr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Vpe(e){if(e==null){var t=he(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return oo(e);return oo(0)}function qv(e,t,r){var n=e.l+t,a=Ua(e);r.biff==2&&++e.l;var i=Hpe(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Upe(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function Gpe(e,t,r,n,a){var i=co(t,r,a),s=Vpe(e.v),o=he(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=he(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var f=xr([i,s,o,c]);return f}function Om(e,t,r){var n=e.read_shift(4),a=hd(e,n,r),i=e.read_shift(4),s=i>0?dd(e,i,a,r):null;return[a,s]}var Kpe=Om,Cm=Om,qpe=Om,Xpe=Om,Ype={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},RF={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Jpe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function dA(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Qpe(e){var t="of:="+e.replace(Cb,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Xv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Zpe(e){return e.replace(/\./,"!")}var Tu={},gl={},Au=typeof Map<"u";function Nb(e,t,r){var n=0,a=e.length;if(r){if(Au?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Au?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Au?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Pm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ur=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Lf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=dp(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function qs(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ws(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){oi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function MF(e,t,r,n,a,i){try{n.cellNF&&(e.z=ze[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=jt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ze[t]==null&&oi(Yle[t]||"General",t),e.t==="e")e.w=e.w||Ei[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Nf(e.v);else if(e.t==="d"){var s=pr(e.v);(s|0)===s?e.w=s.toString(10):e.w=Nf(s)}else{if(e.v===void 0)return"";e.w=io(e.v,gl)}else e.t==="d"?e.w=Qn(t,pr(e.v),gl):e.w=Qn(t,e.v,gl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=fp(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=fp(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function eme(e,t,r){if(e&&e["!ref"]){var n=lt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function tme(e,t){var r=lt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Xe(r))}var rme=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,nme=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ame=/<(?:\w:)?hyperlink [^>]*>/mg,ime=/"(\w*:\w*)"/,sme=/<(?:\w:)?col\b[^>]*[\/]?>/g,ome=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,lme=/<(?:\w:)?pageMargins[^>]*\/>/g,$F=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,cme=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ume=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function fme(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(nme);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var d=c.match($F);d?Fb(d[0],o,a,r):(d=c.match(cme))&&hme(d[0],d[1]||"",o,a,r);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=c.slice(h,h+50).match(ime);m&&tme(o,m[1])}var p=c.match(ume);p&&p[1]&&Tme(p[1],a);var g=[];if(t.cellStyles){var x=c.match(sme);x&&bme(g,x)}f&&Cme(f[1],o,t,l,i,s);var w=u.match(ome);w&&(o["!autofilter"]=Sme(w[0]));var y=[],k=u.match(rme);if(k)for(h=0;h!=k.length;++h)y[h]=lt(k[h].slice(k[h].indexOf('"')+1));var b=u.match(ame);b&&yme(o,b,n);var _=u.match(lme);if(_&&(o["!margins"]=xme(Ve(_[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Xe(l)),t.sheetRows>0&&o["!ref"]){var S=lt(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Xe(S))}return g.length>0&&(o["!cols"]=g),y.length>0&&(o["!merges"]=y),o}function dme(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Xe(e[r])+'"/>';return t+"</mergeCells>"}function Fb(e,t,r,n){var a=Ve(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=st(wt(a.codeName)))}function hme(e,t,r,n,a){Fb(e.slice(0,e.indexOf(">")),r,n,a)}function pme(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,s.codeName=Fa(mt(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Te("outlinePr",null,c)}!i&&!o||(a[a.length]=Te("sheetPr",o,s))}var mme=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vme=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function gme(e){var t={sheet:1};return mme.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),vme.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Tb(e.password).toString(16).toUpperCase()),Te("sheetProtection",null,t)}function yme(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Ve(wt(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+st(i.location))):(i.Target="#"+st(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=lt(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=He({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function xme(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function wme(e){return qs(e),Te("pageMargins",null,e)}function bme(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ve(t[n],!0);a.hidden&&(a.hidden=Ct(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Ab(a.width)),ss(a);i<=s;)e[i++]=Nt(a)}}function _me(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Te("col",null,Pm(a,n)));return r[r.length]="</cols>",r.join("")}function Sme(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function kme(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Xe(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=hn(a);s.s.r==s.e.r&&(s.e.r=hn(t["!ref"]).e.r,a=Xe(s));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Te("autoFilter",null,{ref:a})}var Eme=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Tme(e,t){t.Views||(t.Views=[{}]),(e.match(Eme)||[]).forEach(function(r,n){var a=Ve(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Ct(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function Ame(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Te("sheetViews",Te("sheetView",null,a),{})}function Ome(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ei[e.v];break;case"d":n&&n.cellDates?a=jt(e.v,-1).toISOString():(e=Nt(e),e.t="n",a=""+(e.v=pr(jt(e.v)))),typeof e.z>"u"&&(e.z=ze[14]);break;default:a=e.v;break}var o=Ar("v",mt(a)),l={r:t},c=ws(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Ar("v",""+Nb(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Te("f",mt(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Te("c",o,l)}var Cme=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Ff("v"),s=Ff("f");return function(l,c,u,f,d,h){for(var m=0,p="",g=[],x=[],w=0,y=0,k=0,b="",_,S,E=0,T=0,F,C,A=0,M=0,V=Array.isArray(h.CellXf),z,Y=[],J=[],Q=Array.isArray(c),j=[],X={},ee=!1,P=!!u.sheetStubs,G=l.split(t),B=0,q=G.length;B!=q;++B){p=G[B].trim();var ne=p.length;if(ne!==0){var ye=0;e:for(m=0;m<ne;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(S=Ve(p.slice(ye,m),!0),E=S.r!=null?parseInt(S.r,10):E+1,T=-1,u.sheetRows&&u.sheetRows<E)continue;X={},ee=!1,S.ht&&(ee=!0,X.hpt=parseFloat(S.ht),X.hpx=Ql(X.hpt)),S.hidden=="1"&&(ee=!0,X.hidden=!0),S.outlineLevel!=null&&(ee=!0,X.level=+S.outlineLevel),ee&&(j[E-1]=X)}break;case"<":ye=m;break}if(ye>=m)break;if(S=Ve(p.slice(ye,m),!0),E=S.r!=null?parseInt(S.r,10):E+1,T=-1,!(u.sheetRows&&u.sheetRows<E)){f.s.r>E-1&&(f.s.r=E-1),f.e.r<E-1&&(f.e.r=E-1),u&&u.cellStyles&&(X={},ee=!1,S.ht&&(ee=!0,X.hpt=parseFloat(S.ht),X.hpx=Ql(X.hpt)),S.hidden=="1"&&(ee=!0,X.hidden=!0),S.outlineLevel!=null&&(ee=!0,X.level=+S.outlineLevel),ee&&(j[E-1]=X)),g=p.slice(m).split(e);for(var pe=0;pe!=g.length&&g[pe].trim().charAt(0)=="<";++pe);for(g=g.slice(pe),m=0;m!=g.length;++m)if(p=g[m].trim(),p.length!==0){if(x=p.match(r),w=m,y=0,k=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,x!=null&&x.length===2){for(w=0,b=x[1],y=0;y!=b.length&&!((k=b.charCodeAt(y)-64)<1||k>26);++y)w=26*w+k;--w,T=w}else++T;for(y=0;y!=p.length&&p.charCodeAt(y)!==62;++y);if(++y,S=Ve(p.slice(0,y),!0),S.r||(S.r=He({r:E-1,c:T})),b=p.slice(y),_={t:""},(x=b.match(i))!=null&&x[1]!==""&&(_.v=st(x[1])),u.cellFormula){if((x=b.match(s))!=null&&x[1]!==""){if(_.f=st(wt(x[1])).replace(/\r\n/g,`
`),u.xlfn||(_.f=lA(_.f)),x[0].indexOf('t="array"')>-1)_.F=(b.match(a)||[])[1],_.F.indexOf(":")>-1&&Y.push([lt(_.F),_.F]);else if(x[0].indexOf('t="shared"')>-1){C=Ve(x[0]);var te=st(wt(x[1]));u.xlfn||(te=lA(te)),J[parseInt(C.si,10)]=[C,te,S.r]}}else(x=b.match(/<f[^>]*\/>/))&&(C=Ve(x[0]),J[C.si]&&(_.f=Ehe(J[C.si][1],J[C.si][2],S.r)));var le=Lt(S.r);for(y=0;y<Y.length;++y)le.r>=Y[y][0].s.r&&le.r<=Y[y][0].e.r&&le.c>=Y[y][0].s.c&&le.c<=Y[y][0].e.c&&(_.F=Y[y][1])}if(S.t==null&&_.v===void 0)if(_.f||_.F)_.v=0,_.t="n";else if(P)_.t="z";else continue;else _.t=S.t||"n";switch(f.s.c>T&&(f.s.c=T),f.e.c<T&&(f.e.c=T),_.t){case"n":if(_.v==""||_.v==null){if(!P)continue;_.t="z"}else _.v=parseFloat(_.v);break;case"s":if(typeof _.v>"u"){if(!P)continue;_.t="z"}else F=Tu[parseInt(_.v,10)],_.v=F.t,_.r=F.r,u.cellHTML&&(_.h=F.h);break;case"str":_.t="s",_.v=_.v!=null?wt(_.v):"",u.cellHTML&&(_.h=fb(_.v));break;case"inlineStr":x=b.match(n),_.t="s",x!=null&&(F=Eb(x[1]))?(_.v=F.t,u.cellHTML&&(_.h=F.h)):_.v="";break;case"b":_.v=Ct(_.v);break;case"d":u.cellDates?_.v=jt(_.v,1):(_.v=pr(jt(_.v,1)),_.t="n");break;case"e":(!u||u.cellText!==!1)&&(_.w=_.v),_.v=BN[_.v];break}if(A=M=0,z=null,V&&S.s!==void 0&&(z=h.CellXf[S.s],z!=null&&(z.numFmtId!=null&&(A=z.numFmtId),u.cellStyles&&z.fillId!=null&&(M=z.fillId))),MF(_,A,M,u,d,h),u.cellDates&&V&&_.t=="n"&&yc(ze[A])&&(_.t="d",_.v=Tm(_.v)),S.cm&&u.xlmeta){var Se=(u.xlmeta.Cell||[])[+S.cm-1];Se&&Se.type=="XLDAPR"&&(_.D=!0)}if(Q){var N=Lt(S.r);c[N.r]||(c[N.r]=[]),c[N.r][N.c]=_}else c[S.r]=_}}}}j.length>0&&(c["!rows"]=j)}}();function Pme(e,t,r,n){var a=[],i=[],s=lt(e["!ref"]),o="",l,c="",u=[],f=0,d=0,h=e["!rows"],m=Array.isArray(e),p={r:c},g,x=-1;for(d=s.s.c;d<=s.e.c;++d)u[d]=$t(d);for(f=s.s.r;f<=s.e.r;++f){for(i=[],c=Jt(f),d=s.s.c;d<=s.e.c;++d){l=u[d]+c;var w=m?(e[f]||[])[d]:e[l];w!==void 0&&(o=Ome(w,l,e,t))!=null&&i.push(o)}(i.length>0||h&&h[f])&&(p={r:c},h&&h[f]&&(g=h[f],g.hidden&&(p.hidden=1),x=-1,g.hpx?x=Bf(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(p.ht=x,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),a[a.length]=Te("row",i.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},g=h[f],g.hidden&&(p.hidden=1),x=-1,g.hpx?x=Bf(g.hpx):g.hpt&&(x=g.hpt),x>-1&&(p.ht=x,p.customHeight=1),g.level&&(p.outlineLevel=g.level),a[a.length]=Te("row","",p));return a.join("")}function LF(e,t,r,n){var a=[Qt,Te("worksheet",null,{xmlns:xo[0],"xmlns:r":fr.r})],i=r.SheetNames[e],s=0,o="",l=r.Sheets[i];l==null&&(l={});var c=l["!ref"]||"A1",u=lt(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Xe(u)}n||(n={}),l["!comments"]=[];var f=[];pme(l,r,e,t,a),a[a.length]=Te("dimension",null,{ref:c}),a[a.length]=Ame(l,t,e,r),t.sheetFormat&&(a[a.length]=Te("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=_me(l,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=Pme(l,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=gme(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=kme(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=dme(l["!merges"]));var d=-1,h,m=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=pt(n,-1,mt(p[1].Target).replace(/#.*$/,""),Ze.HLINK),h["r:id"]="rId"+m),(d=p[1].Target.indexOf("#"))>-1&&(h.location=mt(p[1].Target.slice(d+1))),p[1].Tooltip&&(h.tooltip=mt(p[1].Tooltip)),a[a.length]=Te("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=wme(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Ar("ignoredErrors",Te("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(m=pt(n,-1,"../drawings/drawing"+(e+1)+".xml",Ze.DRAW),a[a.length]=Te("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=f),l["!comments"].length>0&&(m=pt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ze.VML),a[a.length]=Te("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function jme(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Nme(e,t,r){var n=he(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Bf(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,d=-1,h=u<<10;h<u+1<<10;++h){c.c=h;var m=Array.isArray(r)?(r[c.r]||[])[c.c]:r[He(c)];m&&(f<0&&(f=h),d=h)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,d))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function Fme(e,t,r,n){var a=Nme(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&xe(e,0,a)}var Ime=So,Dme=bc;function Rme(){}function Mme(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Bce(e),r}function $me(e,t,r){r==null&&(r=he(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return lp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),DN(e,r),r.slice(0,r.l)}function Lme(e){var t=ta(e);return[t]}function Bme(e,t,r){return r==null&&(r=he(8)),wo(t,r)}function Ume(e){var t=bo(e);return[t]}function Wme(e,t,r){return r==null&&(r=he(4)),_o(t,r)}function zme(e){var t=ta(e),r=e.read_shift(1);return[t,r,"b"]}function Hme(e,t,r){return r==null&&(r=he(9)),wo(t,r),r.write_shift(1,e.v?1:0),r}function Vme(e){var t=bo(e),r=e.read_shift(1);return[t,r,"b"]}function Gme(e,t,r){return r==null&&(r=he(5)),_o(t,r),r.write_shift(1,e.v?1:0),r}function Kme(e){var t=ta(e),r=e.read_shift(1);return[t,r,"e"]}function qme(e,t,r){return r==null&&(r=he(9)),wo(t,r),r.write_shift(1,e.v),r}function Xme(e){var t=bo(e),r=e.read_shift(1);return[t,r,"e"]}function Yme(e,t,r){return r==null&&(r=he(8)),_o(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Jme(e){var t=ta(e),r=e.read_shift(4);return[t,r,"s"]}function Qme(e,t,r){return r==null&&(r=he(12)),wo(t,r),r.write_shift(4,t.v),r}function Zme(e){var t=bo(e),r=e.read_shift(4);return[t,r,"s"]}function eve(e,t,r){return r==null&&(r=he(8)),_o(t,r),r.write_shift(4,t.v),r}function tve(e){var t=ta(e),r=Wr(e);return[t,r,"n"]}function rve(e,t,r){return r==null&&(r=he(16)),wo(t,r),oo(e.v,r),r}function BF(e){var t=bo(e),r=Wr(e);return[t,r,"n"]}function nve(e,t,r){return r==null&&(r=he(12)),_o(t,r),oo(e.v,r),r}function ave(e){var t=ta(e),r=wb(e);return[t,r,"n"]}function ive(e,t,r){return r==null&&(r=he(12)),wo(t,r),RN(e.v,r),r}function sve(e){var t=bo(e),r=wb(e);return[t,r,"n"]}function ove(e,t,r){return r==null&&(r=he(8)),_o(t,r),RN(e.v,r),r}function lve(e){var t=ta(e),r=gb(e);return[t,r,"is"]}function cve(e){var t=ta(e),r=Hr(e);return[t,r,"str"]}function uve(e,t,r){return r==null&&(r=he(12+4*e.v.length)),wo(t,r),wr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function fve(e){var t=bo(e),r=Hr(e);return[t,r,"str"]}function dve(e,t,r){return r==null&&(r=he(8+4*e.v.length)),_o(t,r),wr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hve(e,t,r){var n=e.l+t,a=ta(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Cm(e,n-e.l,r);s[3]=Mr(o,null,a,r.supbooks,r)}else e.l=n;return s}function pve(e,t,r){var n=e.l+t,a=ta(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Cm(e,n-e.l,r);s[3]=Mr(o,null,a,r.supbooks,r)}else e.l=n;return s}function mve(e,t,r){var n=e.l+t,a=ta(e);a.r=r["!row"];var i=Wr(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Cm(e,n-e.l,r);s[3]=Mr(o,null,a,r.supbooks,r)}else e.l=n;return s}function vve(e,t,r){var n=e.l+t,a=ta(e);a.r=r["!row"];var i=Hr(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Cm(e,n-e.l,r);s[3]=Mr(o,null,a,r.supbooks,r)}else e.l=n;return s}var gve=So,yve=bc;function xve(e,t){return t==null&&(t=he(4)),t.write_shift(4,e),t}function wve(e,t){var r=e.l+t,n=So(e),a=yb(e),i=Hr(e),s=Hr(e),o=Hr(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function bve(e,t){var r=he(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));bc({s:Lt(e[0]),e:Lt(e[0])},r),xb("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return wr(a||"",r),wr(e[1].Tooltip||"",r),wr("",r),r.slice(0,r.l)}function _ve(){}function Sve(e,t,r){var n=e.l+t,a=MN(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=Kpe(e,n-e.l,r);s[1]=o}else e.l=n;return s}function kve(e,t,r){var n=e.l+t,a=So(e),i=[a];if(r.cellFormula){var s=Xpe(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function Eve(e,t,r){r==null&&(r=he(18));var n=Pm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var UF=["left","right","top","bottom","header","footer"];function Tve(e){var t={};return UF.forEach(function(r){t[r]=Wr(e)}),t}function Ave(e,t){return t==null&&(t=he(6*8)),qs(e),UF.forEach(function(r){oo(e[r],t)}),t}function Ove(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Cve(e,t,r){r==null&&(r=he(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Pve(e){var t=he(24);return t.write_shift(4,4),t.write_shift(4,1),bc(e,t),t}function jve(e,t){return t==null&&(t=he(16*4+2)),t.write_shift(2,e.password?Tb(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Nve(){}function Fve(){}function Ive(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,d=!1,h,m,p,g,x,w,y,k,b,_=[];o.biff=12,o["!row"]=0;var S=0,E=!1,T=[],F={},C=o.supbooks||a.supbooks||[[]];if(C.sharedf=F,C.arrayf=T,C.SheetNames=a.SheetNames||a.Sheets.map(function(Q){return Q.name}),!o.supbooks&&(o.supbooks=C,a.Names))for(var A=0;A<a.Names.length;++A)C[0][A+1]=a.Names[A];var M=[],V=[],z=!1;Uf[16]={n:"BrtShortReal",f:BF};var Y;if(ki(e,function(j,X,ee){if(!d)switch(ee){case 148:c=j;break;case 0:h=j,o.sheetRows&&o.sheetRows<=h.r&&(d=!0),k=Jt(g=h.r),o["!row"]=h.r,(j.hidden||j.hpt||j.level!=null)&&(j.hpt&&(j.hpx=Ql(j.hpt)),V[j.r]=j);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:j[2]},j[2]){case"n":m.v=j[1];break;case"s":y=Tu[j[1]],m.v=y.t,m.r=y.r;break;case"b":m.v=!!j[1];break;case"e":m.v=j[1],o.cellText!==!1&&(m.w=Ei[m.v]);break;case"str":m.t="s",m.v=j[1];break;case"is":m.t="s",m.v=j[1].t;break}if((p=s.CellXf[j[0].iStyleRef])&&MF(m,p.numFmtId,null,o,i,s),x=j[0].c==-1?x+1:j[0].c,o.dense?(l[g]||(l[g]=[]),l[g][x]=m):l[$t(x)+k]=m,o.cellFormula){for(E=!1,S=0;S<T.length;++S){var P=T[S];h.r>=P[0].s.r&&h.r<=P[0].e.r&&x>=P[0].s.c&&x<=P[0].e.c&&(m.F=Xe(P[0]),E=!0)}!E&&j.length>3&&(m.f=j[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),o.cellDates&&p&&m.t=="n"&&yc(ze[p.numFmtId])){var G=Bs(m.v);G&&(m.t="d",m.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}Y&&(Y.type=="XLDAPR"&&(m.D=!0),Y=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;m={t:"z",v:void 0},x=j[0].c==-1?x+1:j[0].c,o.dense?(l[g]||(l[g]=[]),l[g][x]=m):l[$t(x)+k]=m,u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),Y&&(Y.type=="XLDAPR"&&(m.D=!0),Y=void 0);break;case 176:_.push(j);break;case 49:Y=((o.xlmeta||{}).Cell||[])[j-1];break;case 494:var B=n["!id"][j.relId];for(B?(j.Target=B.Target,j.loc&&(j.Target+="#"+j.loc),j.Rel=B):j.relId==""&&(j.Target="#"+j.loc),g=j.rfx.s.r;g<=j.rfx.e.r;++g)for(x=j.rfx.s.c;x<=j.rfx.e.c;++x)o.dense?(l[g]||(l[g]=[]),l[g][x]||(l[g][x]={t:"z",v:void 0}),l[g][x].l=j):(w=He({c:x,r:g}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=j);break;case 426:if(!o.cellFormula)break;T.push(j),b=o.dense?l[g][x]:l[$t(x)+k],b.f=Mr(j[1],u,{r:h.r,c:x},C,o),b.F=Xe(j[0]);break;case 427:if(!o.cellFormula)break;F[He(j[0].s)]=j[1],b=o.dense?l[g][x]:l[$t(x)+k],b.f=Mr(j[1],u,{r:h.r,c:x},C,o);break;case 60:if(!o.cellStyles)break;for(;j.e>=j.s;)M[j.e--]={width:j.w/256,hidden:!!(j.flags&1),level:j.level},z||(z=!0,Ab(j.w/256)),ss(M[j.e+1]);break;case 161:l["!autofilter"]={ref:Xe(j)};break;case 476:l["!margins"]=j;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),j.name&&(a.Sheets[r].CodeName=j.name),(j.above||j.left)&&(l["!outline"]={above:j.above,left:j.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),j.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!X.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Xe(c||u)),o.sheetRows&&l["!ref"]){var J=lt(l["!ref"]);o.sheetRows<=+J.e.r&&(J.e.r=o.sheetRows-1,J.e.r>u.e.r&&(J.e.r=u.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>u.e.c&&(J.e.c=u.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Xe(J))}return _.length>0&&(l["!merges"]=_),M.length>0&&(l["!cols"]=M),V.length>0&&(l["!rows"]=V),l}function Dve(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Nt(t),t.z=t.z||ze[14],t.v=pr(jt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=ws(a.cellXfs,t,a),t.l&&i["!links"].push([He(l),t.l]),t.c&&i["!comments"].push([He(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Nb(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?xe(e,18,eve(t,l)):xe(e,7,Qme(t,l))):(l.t="str",s?xe(e,17,dve(t,l)):xe(e,6,uve(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?xe(e,13,ove(t,l)):xe(e,2,ive(t,l)):s?xe(e,16,nve(t,l)):xe(e,5,rve(t,l)),!0;case"b":return l.t="b",s?xe(e,15,Gme(t,l)):xe(e,4,Hme(t,l)),!0;case"e":return l.t="e",s?xe(e,14,Yme(t,l)):xe(e,3,qme(t,l)),!0}return s?xe(e,12,Wme(t,l)):xe(e,1,Bme(t,l)),!0}function Rve(e,t,r,n){var a=lt(t["!ref"]||"A1"),i,s="",o=[];xe(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=c;++u){s=Jt(u),Fme(e,t,a,u);var f=!1;if(u<=a.e.r)for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(o[d]=$t(d)),i=o[d]+s;var h=l?(t[u]||[])[d]:t[i];if(!h){f=!1;continue}f=Dve(e,h,u,d,n,t,f)}}xe(e,146)}function Mve(e,t){!t||!t["!merges"]||(xe(e,177,xve(t["!merges"].length)),t["!merges"].forEach(function(r){xe(e,176,yve(r))}),xe(e,178))}function $ve(e,t){!t||!t["!cols"]||(xe(e,390),t["!cols"].forEach(function(r,n){r&&xe(e,60,Eve(n,r))}),xe(e,391))}function Lve(e,t){!t||!t["!ref"]||(xe(e,648),xe(e,649,Pve(lt(t["!ref"]))),xe(e,650))}function Bve(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=pt(r,-1,n[1].Target.replace(/#.*$/,""),Ze.HLINK);xe(e,494,bve(n,a))}}),delete t["!links"]}function Uve(e,t,r,n){if(t["!comments"].length>0){var a=pt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ze.VML);xe(e,551,xb("rId"+a)),t["!legacy"]=a}}function Wve(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Xe(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=hn(i);o.s.r==o.e.r&&(o.e.r=hn(t["!ref"]).e.r,i=Xe(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),xe(e,161,bc(lt(i))),xe(e,162)}}function zve(e,t,r){xe(e,133),xe(e,137,Cve(t,r)),xe(e,138),xe(e,134)}function Hve(e,t){t["!protect"]&&xe(e,535,jve(t["!protect"]))}function Vve(e,t,r,n){var a=dn(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=lt(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],xe(a,129),(r.vbaraw||s["!outline"])&&xe(a,147,$me(o,s["!outline"])),xe(a,148,Dme(l)),zve(a,s,r.Workbook),$ve(a,s),Rve(a,s,e,t),Hve(a,s),Wve(a,s,r,e),Mve(a,s),Bve(a,s,n),s["!margins"]&&xe(a,476,Ave(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Lve(a,s),Uve(a,s,e,n),xe(a,130),a.end()}function Gve(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=st((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function Kve(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=Gve(f);u.s.r=u.s.c=0,u.e.c=o,c=$t(o),d[0].forEach(function(h,m){s[c+Jt(m)]={t:"n",v:h,z:d[1]},l=m}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=Xe(u)),s}function qve(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match($F);return o&&Fb(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Xve(e,t){e.l+=10;var r=Hr(e);return{name:r}}function Yve(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ki(e,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Ib=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Jve=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Qve=[],Zve=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function hA(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Ct(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function pA(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ct(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function WF(e){pA(e.WBProps,Ib),pA(e.CalcPr,Zve),hA(e.WBView,Jve),hA(e.Sheets,Qve),gl.date1904=Ct(e.WBProps.date1904)}function ege(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ct(e.Workbook.WBProps.date1904)?"true":"false"}var tge="][*?/\\".split("");function zF(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return tge.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function rge(e,t,r){e.forEach(function(n,a){zF(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function nge(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];rge(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)eme(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var age=/<\w+:workbook/;function ige(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(Kr,function(l,c){var u=Ve(l);switch(Ba(u[0])){case"<?xml":break;case"<workbook":l.match(age)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ib.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Ct(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=wt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=st(wt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=wt(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Ct(u.hidden||"0")&&(i.Hidden=!0),s=c+l.length;break;case"</definedName>":i.Ref=st(wt(e.slice(s,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),xo.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return WF(r),r}function HF(e){var t=[Qt];t[t.length]=Te("workbook",null,{xmlns:xo[0],"xmlns:r":fr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ib.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Te("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:mt(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Te("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Te("definedName",mt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function sge(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Dx(e),r.name=Hr(e),r}function oge(e,t){return t||(t=he(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),xb(e.strRelID,t),wr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function lge(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Hr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function cge(e,t){t||(t=he(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),DN(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function uge(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function fge(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=Uce(e),s=qpe(e,0,r),o=yb(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function dge(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Uf[16]={n:"BrtFRTArchID$",f:uge},ki(e,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Mr(l.Ptg,null,null,s,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),WF(r),r.Names=i,r.supbooks=s,r}function hge(e,t){xe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};xe(e,156,oge(a))}xe(e,144)}function pge(e,t){t||(t=he(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return wr("SheetJS",t),wr(tp.version,t),wr(tp.version,t),wr("7262",t),t.length>t.l?t.slice(0,t.l):t}function mge(e,t){t||(t=he(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function vge(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(xe(e,135),xe(e,158,mge(a)),xe(e,136))}}function gge(e,t){var r=dn();return xe(r,131),xe(r,128,pge()),xe(r,153,cge(e.Workbook&&e.Workbook.WBProps||null)),vge(r,e),hge(r,e),xe(r,132),r.end()}function yge(e,t,r){return t.slice(-4)===".bin"?dge(e,r):ige(e,r)}function xge(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Ive(e,n,r,a,i,s,o):fme(e,n,r,a,i,s,o)}function wge(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Yve(e,n,r,a,i):qve(e,n,r,a,i)}function bge(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?She():khe()}function _ge(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?bhe():_he()}function Sge(e,t,r,n){return t.slice(-4)===".bin"?y0e(e,r,n):s0e(e,r,n)}function kge(e,t,r){return kF(e,r)}function Ege(e,t,r){return t.slice(-4)===".bin"?Ede(e,r):_de(e,r)}function Tge(e,t,r){return t.slice(-4)===".bin"?vhe(e,r):ohe(e,r)}function Age(e,t,r){return t.slice(-4)===".bin"?ahe(e):rhe(e)}function Oge(e,t,r,n){return r.slice(-4)===".bin"?ihe(e,t,r,n):void 0}function Cge(e,t,r){return t.slice(-4)===".bin"?Z0e(e,t,r):the(e,t,r)}function Pge(e,t,r){return(t.slice(-4)===".bin"?gge:HF)(e)}function jge(e,t,r,n,a){return(t.slice(-4)===".bin"?Vve:LF)(e,r,n,a)}function Nge(e,t,r){return(t.slice(-4)===".bin"?O0e:_F)(e,r)}function Fge(e,t,r){return(t.slice(-4)===".bin"?Ode:pF)(e,r)}function Ige(e,t,r){return(t.slice(-4)===".bin"?ghe:AF)(e)}function Dge(e){return(e.slice(-4)===".bin"?ehe:EF)()}var VF=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,GF=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function aa(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(VF),i,s,o,l;if(a)for(l=0;l!=a.length;++l)i=a[l].match(GF),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function Rge(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(VF),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(GF),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Ou;function Mge(e,t){var r=Ou[e]||st(e);return r==="General"?io(t):Qn(r,t)}function $ge(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Ct(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=jt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[st(t)]=a}function Lge(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ei[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Nf(e.v):e.w=io(e.v):e.w=Mge(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Ou[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&yc(n)){var a=Bs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function Bge(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Qde[n.Pattern]||n.Pattern)}e[t.ID]=t}function Uge(e,t,r,n,a,i,s,o,l,c){var u="General",f=n.StyleID,d={};c=c||{};var h=[],m=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&s&&(f=s.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&h.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ct(e);break;case"String":n.t="s",n.r=jT(st(e)),n.v=e.indexOf("<")>-1?st(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(jt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=st(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=BN[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=jT(t||e));break}if(Lge(n,u,c),c.cellFormula!==!1)if(n.Formula){var p=st(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=vl(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=vl("RC:RC",a):n.ArrayRange&&(n.F=vl(n.ArrayRange,a),l.push([lt(n.F),n.F]))}else for(m=0;m<l.length;++m)a.r>=l[m][0].s.r&&a.r<=l[m][0].e.r&&a.c>=l[m][0].s.c&&a.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(h.forEach(function(g){!d.patternType&&g.patternType&&(d.patternType=g.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Wge(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Yv(e,t){var r=t||{};xc();var n=ru(db(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=wt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Nt(r);return s.type="string",Jl.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ue){a.indexOf("<"+Ue)>=0&&(i=!0)}),i)return Aye(n,r);Ou={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],d=r.dense?[]:{},h="",m={},p={},g=aa('<Data ss:Type="String">'),x=0,w=0,y=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},_={},S="",E=0,T=[],F={},C={},A=0,M=[],V=[],z={},Y=[],J,Q=!1,j=[],X=[],ee={},P=0,G=0,B={Sheets:[],WBProps:{date1904:!1}},q={};Df.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";o=Df.exec(n);)switch(o[3]=(ne=o[3]).toLowerCase()){case"data":if(ne=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?Uge(n.slice(x,o.index),S,g,l[l.length-1][0]=="comment"?z:m,{c:w,r:y},b,Y[w],p,j,r):(S="",g=aa(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(V.length>0&&(m.c=V),(!r.sheetRows||r.sheetRows>y)&&m.v!==void 0&&(r.dense?(d[y]||(d[y]=[]),d[y][w]=m):d[$t(w)+Jt(y)]=m),m.HRef&&(m.l={Target:st(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(P=w+(parseInt(m.MergeAcross,10)|0),G=y+(parseInt(m.MergeDown,10)|0),T.push({s:{c:w,r:y},e:{c:P,r:G}})),!r.sheetStubs)m.MergeAcross?w=P+1:++w;else if(m.MergeAcross||m.MergeDown){for(var ye=w;ye<=P;++ye)for(var pe=y;pe<=G;++pe)(ye>w||pe>y)&&(r.dense?(d[pe]||(d[pe]=[]),d[pe][ye]={t:"z"}):d[$t(ye)+Jt(pe)]={t:"z"});w=P+1}else++w;else m=Rge(o[0]),m.Index&&(w=+m.Index-1),w<k.s.c&&(k.s.c=w),w>k.e.c&&(k.e.c=w),o[0].slice(-2)==="/>"&&++w,V=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<k.s.r&&(k.s.r=y),y>k.e.r&&(k.e.r=y),o[0].slice(-2)==="/>"&&(p=aa(o[0]),p.Index&&(y=+p.Index-1)),w=0,++y):(p=aa(o[0]),p.Index&&(y=+p.Index-1),ee={},(p.AutoFitHeight=="0"||p.Height)&&(ee.hpx=parseInt(p.Height,10),ee.hpt=Bf(ee.hpx),X[y]=ee),p.Hidden=="1"&&(ee.hidden=!0,X[y]=ee));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(h),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(d["!ref"]=Xe(k),r.sheetRows&&r.sheetRows<=k.e.r&&(d["!fullref"]=d["!ref"],k.e.r=r.sheetRows-1,d["!ref"]=Xe(k))),T.length&&(d["!merges"]=T),Y.length>0&&(d["!cols"]=Y),X.length>0&&(d["!rows"]=X),u[h]=d}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,l.push([o[3],!1]),c=aa(o[0]),h=st(c.Name),d=r.dense?[]:{},T=[],j=[],X=[],q={name:h,Hidden:0},B.Sheets.push(q);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Y=[],Q=!1}break;case"style":o[1]==="/"?Bge(b,_,r):_=aa(o[0]);break;case"numberformat":_.nf=st(aa(o[0]).Format||"General"),Ou[_.nf]&&(_.nf=Ou[_.nf]);for(var te=0;te!=392&&ze[te]!=_.nf;++te);if(te==392){for(te=57;te!=392;++te)if(ze[te]==null){oi(_.nf,te);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(J=aa(o[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!Q&&J.wpx>10){Q=!0,Ur=wF;for(var le=0;le<Y.length;++le)Y[le]&&ss(Y[le])}Q&&ss(J),Y[J.Index-1||Y.length]=J;for(var Se=0;Se<+J.Span;++Se)Y[Y.length]=Nt(J);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var N=Ve(o[0]),Re={Name:N.Name,Ref:vl(N.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(Re.Sheet=B.Sheets.length-1),B.Names.push(Re);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;_.Interior=aa(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?due(F,ne,n.slice(A,o.index)):A=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));Wge(z),V.push(z)}else l.push([o[3],!1]),c=aa(o[0]),z={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ae=aa(o[0]);d["!autofilter"]={ref:vl(ae.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return xA(n,r);var re=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:re=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:re=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:re=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:re=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(A,o.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else A=o.index+o[0].length;break;case"header":d["!margins"]||qs(d["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(d["!margins"].header=+Ve(o[0]).Margin);break;case"footer":d["!margins"]||qs(d["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(d["!margins"].footer=+Ve(o[0]).Margin);break;case"pagemargins":var fe=Ve(o[0]);d["!margins"]||qs(d["!margins"]={},"xlml"),isNaN(+fe.Top)||(d["!margins"].top=+fe.Top),isNaN(+fe.Left)||(d["!margins"].left=+fe.Left),isNaN(+fe.Right)||(d["!margins"].right=+fe.Right),isNaN(+fe.Bottom)||(d["!margins"].bottom=+fe.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:re=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:re=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:re=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:re=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:re=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:re=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:re=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:re=!1}break;case"smarttags":break;default:re=!1;break}if(re||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?$ge(C,ne,M,n.slice(A,o.index)):(M=o,A=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var de={};return!r.bookSheets&&!r.bookProps&&(de.Sheets=u),de.SheetNames=f,de.Workbook=B,de.SSF=Nt(ze),de.Props=F,de.Custprops=C,de}function Wx(e,t){switch(Rb(t=t||{}),t.type||"base64"){case"base64":return Yv(Cn(e),t);case"binary":case"buffer":case"file":return Yv(e,t);case"array":return Yv(ys(e),t)}}function zge(e,t){var r=[];return e.Props&&r.push(hue(e.Props,t)),e.Custprops&&r.push(pue(e.Props,e.Custprops)),r.join("")}function Hge(){return""}function Vge(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Te("NumberFormat",null,{"ss:Format":mt(ze[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Te("Style",i.join(""),s))}),Te("Styles",r.join(""))}function KF(e){return Te("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Pb(e.Ref,{r:0,c:0})})}function Gge(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(KF(a)))}return Te("Names",r.join(""))}function Kge(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(KF(o)))}return i.join("")}function qge(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Te("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Te("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Te("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Te("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Ar("ProtectContents","True")),e["!protect"].objects&&a.push(Ar("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Ar("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Ar("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Ar("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Te("WorksheetOptions",a.join(""),{xmlns:wn.x})}function Xge(e){return e.map(function(t){var r=vce(t.t||""),n=Te("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Te("Comment",n,{"ss:Author":t.a})}).join("")}function Yge(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+mt(Pb(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Lt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=mt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=mt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",d=String(e.v);break;case"b":f="Boolean",d=e.v?"1":"0";break;case"e":f="Error",d=Ei[e.v];break;case"d":f="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ze[14]);break;case"s":f="String",d=mce(e.v||"");break}var h=ws(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var m=e.v!=null?d:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=Xge(e.c)),Te("Cell",p,o)}function Jge(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ql(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Qge(e,t,r,n){if(!e["!ref"])return"";var a=lt(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,x){ss(g);var w=!!g.width,y=Pm(x,g),k={"ss:Index":x+1};w&&(k["ss:Width"]=$f(y.width)),g.hidden&&(k["ss:Hidden"]="1"),o.push(Te("Column",null,k))});for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var u=[Jge(c,(e["!rows"]||[])[c])],f=a.s.c;f<=a.e.c;++f){var d=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>f)&&!(i[s].s.r>c)&&!(i[s].e.c<f)&&!(i[s].e.r<c)){(i[s].s.c!=f||i[s].s.r!=c)&&(d=!0);break}if(!d){var h={r:c,c:f},m=He(h),p=l?(e[c]||[])[f]:e[m];u.push(Yge(p,m,e,t,r,n,h))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function Zge(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?Kge(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Qge(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(qge(i,t,e,r)),n.join("")}function eye(e,t){t||(t={}),e.SSF||(e.SSF=Nt(ze)),e.SSF&&(xc(),Sm(e.SSF),t.revssf=Em(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ws(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(zge(e,t)),r.push(Hge()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Te("Worksheet",Zge(n,t,e),{"ss:Name":mt(e.SheetNames[n])}));return r[2]=Vge(e,t),r[3]=Gge(e),Qt+Te("Workbook",r.join(""),{xmlns:wn.ss,"xmlns:o":wn.o,"xmlns:x":wn.x,"xmlns:ss":wn.ss,"xmlns:dt":wn.dt,"xmlns:html":wn.html})}function tye(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Gce(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Kce(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var rye=[60,1084,2066,2165,2175];function nye(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var l=ei(r,r.l),c=zx[l],u=0;c!=null&&rye.indexOf(l)>-1;)i=ei(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),s.push(o),r.l+=4+i,c=zx[l=ei(r,r.l)];var f=xr(s);Tr(f,0);var d=0;f.lens=[];for(var h=0;h<s.length;++h)f.lens.push(d),d+=s[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Ea(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ze[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ei[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Nf(e.v):e.w=io(e.v):e.w=Qn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&yc(ze[n]||String(n))){var a=Bs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function c0(e,t,r){return{v:e,ixfe:t,t:r}}function aye(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,l=[],c="",u={},f,d="",h,m,p,g,x={},w=[],y,k,b=[],_=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},T=function(je){return je<8?Vs[je]:je<64&&_[je-8]||Vs[je]},F=function(je,Ge,Zt){var yt=Ge.XF.data;if(!(!yt||!yt.patternType||!Zt||!Zt.cellStyles)){Ge.s={},Ge.s.patternType=yt.patternType;var Sa;(Sa=Mf(T(yt.icvFore)))&&(Ge.s.fgColor={rgb:Sa}),(Sa=Mf(T(yt.icvBack)))&&(Ge.s.bgColor={rgb:Sa})}},C=function(je,Ge,Zt){if(!(ee>1)&&!(Zt.sheetRows&&je.r>=Zt.sheetRows)){if(Zt.cellStyles&&Ge.XF&&Ge.XF.data&&F(je,Ge,Zt),delete Ge.ixfe,delete Ge.XF,f=je,d=He(je),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),je.r<s.s.r&&(s.s.r=je.r),je.c<s.s.c&&(s.s.c=je.c),je.r+1>s.e.r&&(s.e.r=je.r+1),je.c+1>s.e.c&&(s.e.c=je.c+1),Zt.cellFormula&&Ge.f){for(var yt=0;yt<w.length;++yt)if(!(w[yt][0].s.c>je.c||w[yt][0].s.r>je.r)&&!(w[yt][0].e.c<je.c||w[yt][0].e.r<je.r)){Ge.F=Xe(w[yt][0]),(w[yt][0].s.c!=je.c||w[yt][0].s.r!=je.r)&&delete Ge.f,Ge.f&&(Ge.f=""+Mr(w[yt][1],s,je,j,A));break}}Zt.dense?(a[je.r]||(a[je.r]=[]),a[je.r][je.c]=Ge):a[d]=Ge}},A={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var M,V=[],z=[],Y=[],J=[],Q=!1,j=[];j.SheetNames=A.snames,j.sharedf=A.sharedf,j.arrayf=A.arrayf,j.names=[],j.XTI=[];var X=0,ee=0,P=0,G=[],B=[],q;A.codepage=1200,ma(1200);for(var ne=!1;e.l<e.length-1;){var ye=e.l,pe=e.read_shift(2);if(pe===0&&X===10)break;var te=e.l===e.length?0:e.read_shift(2),le=zx[pe];if(le&&le.f){if(t.bookSheets&&X===133&&pe!==133)break;if(X=pe,le.r===2||le.r==12){var Se=e.read_shift(2);if(te-=2,!A.enc&&Se!==pe&&((Se&255)<<8|Se>>8)!==pe)throw new Error("rt mismatch: "+Se+"!="+pe);le.r==12&&(e.l+=10,te-=10)}var N={};if(pe===10?N=le.f(e,te,A):N=nye(pe,le,e,te,A),ee==0&&[9,521,1033,2057].indexOf(X)===-1)continue;switch(pe){case 34:r.opts.Date1904=S.WBProps.date1904=N;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=N,!t.password)throw new Error("File is password-protected");if(N.valid==null)throw new Error("Encryption scheme unsupported");if(!N.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=N;break;case 66:var Re=Number(N);switch(Re){case 21010:Re=1200;break;case 32768:Re=1e4;break;case 32769:Re=1252;break}ma(A.codepage=Re),ne=!0;break;case 317:A.rrtabid=N;break;case 25:A.winlocked=N;break;case 439:r.opts.RefreshAll=N;break;case 12:r.opts.CalcCount=N;break;case 16:r.opts.CalcDelta=N;break;case 17:r.opts.CalcIter=N;break;case 13:r.opts.CalcMode=N;break;case 14:r.opts.CalcPrecision=N;break;case 95:r.opts.CalcSaveRecalc=N;break;case 15:A.CalcRefMode=N;break;case 2211:r.opts.FullCalc=N;break;case 129:N.fDialog&&(a["!type"]="dialog"),N.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),N.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:b.push(N);break;case 430:j.push([N]),j[j.length-1].XTI=[];break;case 35:case 547:j[j.length-1].push(N);break;case 24:case 536:q={Name:N.Name,Ref:Mr(N.rgce,s,null,j,A)},N.itab>0&&(q.Sheet=N.itab-1),j.names.push(q),j[0]||(j[0]=[],j[0].XTI=[]),j[j.length-1].push(N),N.Name=="_xlnm._FilterDatabase"&&N.itab>0&&N.rgce&&N.rgce[0]&&N.rgce[0][0]&&N.rgce[0][0][0]=="PtgArea3d"&&(B[N.itab-1]={ref:Xe(N.rgce[0][0][1][2])});break;case 22:A.ExternCount=N;break;case 23:j.length==0&&(j[0]=[],j[0].XTI=[]),j[j.length-1].XTI=j[j.length-1].XTI.concat(N),j.XTI=j.XTI.concat(N);break;case 2196:if(A.biff<8)break;q!=null&&(q.Comment=N[1]);break;case 18:a["!protect"]=N;break;case 19:N!==0&&A.WTF&&console.error("Password verifier: "+N);break;case 133:i[N.pos]=N,A.snames.push(N.name);break;case 10:{if(--ee)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Xe(s),t.sheetRows&&t.sheetRows<=s.e.r){var ae=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Xe(s),s.e.r=ae}s.e.r++,s.e.c++}V.length>0&&(a["!merges"]=V),z.length>0&&(a["!objects"]=z),Y.length>0&&(a["!cols"]=Y),J.length>0&&(a["!rows"]=J),S.Sheets.push(E)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[N.BIFFVer]||8),A.biffguess=N.BIFFVer==0,N.BIFFVer==0&&N.dt==4096&&(A.biff=5,ne=!0,ma(A.codepage=28591)),A.biff==8&&N.BIFFVer==0&&N.dt==16&&(A.biff=2),ee++)break;if(a=t.dense?[]:{},A.biff<8&&!ne&&(ne=!0,ma(A.codepage=t.codepage||1252)),A.biff<5||N.BIFFVer==0&&N.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var re={pos:e.l-te,name:c};i[re.pos]=re,A.snames.push(c)}else c=(i[ye]||{name:""}).name;N.dt==32&&(a["!type"]="chart"),N.dt==64&&(a["!type"]="macro"),V=[],z=[],A.arrayf=w=[],Y=[],J=[],Q=!1,E={Hidden:(i[ye]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[N.r]||[])[N.c]:a[He({c:N.c,r:N.r})])&&++N.c,y={ixfe:N.ixfe,XF:b[N.ixfe]||{},v:N.val,t:"n"},P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C({c:N.c,r:N.r},y,t);break;case 5:case 517:y={ixfe:N.ixfe,XF:b[N.ixfe],v:N.val,t:N.t},P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C({c:N.c,r:N.r},y,t);break;case 638:y={ixfe:N.ixfe,XF:b[N.ixfe],v:N.rknum,t:"n"},P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C({c:N.c,r:N.r},y,t);break;case 189:for(var fe=N.c;fe<=N.C;++fe){var de=N.rkrec[fe-N.c][0];y={ixfe:de,XF:b[de],v:N.rkrec[fe-N.c][1],t:"n"},P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C({c:fe,r:N.r},y,t)}break;case 6:case 518:case 1030:{if(N.val=="String"){o=N;break}if(y=c0(N.val,N.cell.ixfe,N.tt),y.XF=b[y.ixfe],t.cellFormula){var Ue=N.formula;if(Ue&&Ue[0]&&Ue[0][0]&&Ue[0][0][0]=="PtgExp"){var at=Ue[0][0][1][0],I=Ue[0][0][1][1],K=He({r:at,c:I});x[K]?y.f=""+Mr(N.formula,s,N.cell,j,A):y.F=((t.dense?(a[at]||[])[I]:a[K])||{}).F}else y.f=""+Mr(N.formula,s,N.cell,j,A)}P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C(N.cell,y,t),o=N}break;case 7:case 519:if(o)o.val=N,y=c0(N,o.cell.ixfe,"s"),y.XF=b[y.ixfe],t.cellFormula&&(y.f=""+Mr(o.formula,s,o.cell,j,A)),P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(N);var ue=He(N[0].s);if(h=t.dense?(a[N[0].s.r]||[])[N[0].s.c]:a[ue],t.cellFormula&&h){if(!o||!ue||!h)break;h.f=""+Mr(N[1],s,N[0],j,A),h.F=Xe(N[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;x[He(o.cell)]=N[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[He(o.cell)],(h||{}).f=""+Mr(N[0],s,f,j,A)}}break;case 253:y=c0(l[N.isst].t,N.ixfe,"s"),l[N.isst].h&&(y.h=l[N.isst].h),y.XF=b[y.ixfe],P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C({c:N.c,r:N.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:N.ixfe,XF:b[N.ixfe],t:"z"},P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C({c:N.c,r:N.r},y,t));break;case 190:if(t.sheetStubs)for(var ve=N.c;ve<=N.C;++ve){var ke=N.ixfe[ve-N.c];y={ixfe:ke,XF:b[ke],t:"z"},P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C({c:ve,r:N.r},y,t)}break;case 214:case 516:case 4:y=c0(N.val,N.ixfe,"s"),y.XF=b[y.ixfe],P>0&&(y.z=G[y.ixfe>>8&63]),Ea(y,t,r.opts.Date1904),C({c:N.c,r:N.r},y,t);break;case 0:case 512:ee===1&&(s=N);break;case 252:l=N;break;case 1054:if(A.biff==4){G[P++]=N[1];for(var Be=0;Be<P+163&&ze[Be]!=N[1];++Be);Be>=163&&oi(N[1],P+163)}else oi(N[1],N[0]);break;case 30:{G[P++]=N;for(var Me=0;Me<P+163&&ze[Me]!=N;++Me);Me>=163&&oi(N,P+163)}break;case 229:V=V.concat(N);break;case 93:z[N.cmo[0]]=A.lastobj=N;break;case 438:A.lastobj.TxO=N;break;case 127:A.lastobj.ImData=N;break;case 440:for(g=N[0].s.r;g<=N[0].e.r;++g)for(p=N[0].s.c;p<=N[0].e.c;++p)h=t.dense?(a[g]||[])[p]:a[He({c:p,r:g})],h&&(h.l=N[1]);break;case 2048:for(g=N[0].s.r;g<=N[0].e.r;++g)for(p=N[0].s.c;p<=N[0].e.c;++p)h=t.dense?(a[g]||[])[p]:a[He({c:p,r:g})],h&&h.l&&(h.l.Tooltip=N[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;h=t.dense?(a[N[0].r]||[])[N[0].c]:a[He(N[0])];var Ce=z[N[2]];h||(t.dense?(a[N[0].r]||(a[N[0].r]=[]),h=a[N[0].r][N[0].c]={t:"z"}):h=a[He(N[0])]={t:"z"},s.e.r=Math.max(s.e.r,N[0].r),s.s.r=Math.min(s.s.r,N[0].r),s.e.c=Math.max(s.e.c,N[0].c),s.s.c=Math.min(s.s.c,N[0].c)),h.c||(h.c=[]),m={a:N[1],t:Ce.TxO.t},h.c.push(m)}break;case 2173:V0e(b[N.ixfe],N.ext);break;case 125:{if(!A.cellStyles)break;for(;N.e>=N.s;)Y[N.e--]={width:N.w/256,level:N.level||0,hidden:!!(N.flags&1)},Q||(Q=!0,Ab(N.w/256)),ss(Y[N.e+1])}break;case 520:{var $e={};N.level!=null&&(J[N.r]=$e,$e.level=N.level),N.hidden&&(J[N.r]=$e,$e.hidden=!0),N.hpt&&(J[N.r]=$e,$e.hpt=N.hpt,$e.hpx=Ql(N.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||qs(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=N;break;case 161:a["!margins"]||qs(a["!margins"]={}),a["!margins"].header=N.header,a["!margins"].footer=N.footer;break;case 574:N.RTL&&(S.Views[0].RTL=!0);break;case 146:_=N;break;case 2198:M=N;break;case 140:k=N;break;case 442:c?E.CodeName=N||E.name:S.WBProps.CodeName=N||"ThisWorkbook";break}}else le||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),e.l+=te}return r.SheetNames=Kt(i).sort(function(ct,je){return Number(ct)-Number(je)}).map(function(ct){return i[ct].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&B.forEach(function(ct,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=ct}),r.Strings=l,r.SSF=Nt(ze),A.enc&&(r.Encryption=A.enc),M&&(r.Themes=M),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),j.names.length>0&&(S.Names=j.names),r.Workbook=S,r}var Cu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function iye(e,t,r){var n=Le.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=XT(n,Rx,Cu.DSI);for(var i in a)t[i]=a[i]}catch(c){if(r.WTF)throw c}var s=Le.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=XT(s,Mx,Cu.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(GN(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function sye(e,t){var r=[],n=[],a=[],i=0,s,o=ET(Rx,"n"),l=ET(Mx,"n");if(e.Props)for(s=Kt(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Kt(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var c=[];for(i=0;i<a.length;++i)ZN.indexOf(a[i][0])>-1||VN.indexOf(a[i][0])>-1||a[i][1]!=null&&c.push(a[i]);n.length&&Le.utils.cfb_add(t,"/SummaryInformation",YT(n,Cu.SI,l,Mx)),(r.length||c.length)&&Le.utils.cfb_add(t,"/DocumentSummaryInformation",YT(r,Cu.DSI,o,Rx,c.length?c:null,Cu.UDI))}function qF(e,t){t||(t={}),Rb(t),nb(),t.codepage&&rb(t.codepage);var r,n;if(e.FullPaths){if(Le.find(e,"/encryption"))throw new Error("File is password-protected");r=Le.find(e,"!CompObj"),n=Le.find(e,"/Workbook")||Le.find(e,"/Book")}else{switch(t.type){case"base64":e=Sn(Cn(e));break;case"binary":e=Sn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Tr(e,0),n={content:e}}var a,i;if(r&&tye(r),t.bookProps&&!t.bookSheets)a={};else{var s=Qe?"buffer":"array";if(n&&n.content)a=aye(n.content,t);else if((i=Le.find(e,"PerfectOffice_MAIN"))&&i.content)a=Ks.to_workbook(i.content,(t.type=s,t));else if((i=Le.find(e,"NativeContent_MAIN"))&&i.content)a=Ks.to_workbook(i.content,(t.type=s,t));else throw(i=Le.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Le.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=xhe(e))}var o={};return e.FullPaths&&iye(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function oye(e,t){var r=t||{},n=Le.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Le.utils.cfb_add(n,a,XF(e,r)),r.biff==8&&(e.Props||e.Custprops)&&sye(e,n),r.biff==8&&e.vbaraw&&whe(n,Le.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Uf={0:{f:jme},1:{f:Lme},2:{f:ave},3:{f:Kme},4:{f:zme},5:{f:tve},6:{f:cve},7:{f:Jme},8:{f:vve},9:{f:mve},10:{f:hve},11:{f:pve},12:{f:Ume},13:{f:sve},14:{f:Xme},15:{f:Vme},16:{f:BF},17:{f:fve},18:{f:Zme},19:{f:gb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:fge},40:{},42:{},43:{f:c0e},44:{f:o0e},45:{f:d0e},46:{f:p0e},47:{f:h0e},48:{},49:{f:Ice},50:{},51:{f:q0e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:uF},62:{f:lve},63:{f:nhe},64:{f:Nve},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ove},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Mme},148:{f:Ime,p:16},151:{f:_ve},152:{},153:{f:lge},154:{},155:{},156:{f:sge},157:{},158:{},159:{T:1,f:kde},160:{T:-1},161:{T:1,f:So},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:gve},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:G0e},336:{T:-1},337:{f:J0e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Sve},427:{f:kve},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Tve},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Rme},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wve},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:phe},633:{T:1},634:{T:-1},635:{T:1,f:dhe},636:{T:-1},637:{f:$ce},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Xve},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Fve},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},zx={6:{f:qv},10:{f:Oi},12:{f:nr},13:{f:nr},14:{f:qt},15:{f:qt},16:{f:Wr},17:{f:qt},18:{f:qt},19:{f:nr},20:{f:rA},21:{f:rA},23:{f:cF},24:{f:aA},25:{f:qt},26:{},27:{},28:{f:Ffe},29:{},34:{f:qt},35:{f:nA},38:{f:Wr},39:{f:Wr},40:{f:Wr},41:{f:Wr},42:{f:qt},43:{f:qt},47:{f:Vde},49:{f:sfe},51:{f:nr},60:{},61:{f:tfe},64:{f:qt},65:{f:ife},66:{f:nr},77:{},80:{},81:{},82:{},85:{f:nr},89:{},90:{},91:{},92:{f:Hue},93:{f:Rfe},94:{},95:{f:qt},96:{},97:{},99:{f:qt},125:{f:uF},128:{f:bfe},129:{f:Gue},130:{f:nr},131:{f:qt},132:{f:qt},133:{f:Kue},134:{},140:{f:Hfe},141:{f:nr},144:{},146:{f:Kfe},151:{},152:{},153:{},154:{},155:{},156:{f:nr},157:{},158:{},160:{f:ede},161:{f:Yfe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:gfe},190:{f:yfe},193:{f:Oi},197:{},198:{},199:{},200:{},201:{},202:{f:qt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:nr},220:{},221:{f:qt},222:{},224:{f:wfe},225:{f:zue},226:{f:Oi},227:{},229:{f:Ife},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Xue},253:{f:lfe},255:{f:Jue},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:eF},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qt},353:{f:Oi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Tfe},431:{f:qt},432:{},433:{},434:{},437:{},438:{f:Lfe},439:{f:qt},440:{f:Bfe},441:{},442:{f:ud},443:{},444:{f:nr},445:{},446:{},448:{f:Oi},449:{f:efe,r:2},450:{f:Oi},512:{f:ZT},513:{f:Zfe},515:{f:kfe},516:{f:ufe},517:{f:tA},519:{f:tde},520:{f:Que},523:{},545:{f:iA},549:{f:QT},566:{},574:{f:nfe},638:{f:vfe},659:{},1048:{},1054:{f:dfe},1084:{},1212:{f:Pfe},2048:{f:Wfe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:s0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Oi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:qfe,r:12},2173:{f:H0e,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Cfe,r:12},2197:{},2198:{f:$0e,r:12},2199:{},2200:{},2201:{},2202:{f:jfe,r:12},2203:{f:Oi},2204:{},2205:{},2206:{},2207:{},2211:{f:Zue},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:nr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Jfe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Gfe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ZT},1:{},2:{f:sde},3:{f:ade},4:{f:nde},5:{f:tA},7:{f:lde},8:{},9:{f:s0},11:{},22:{f:nr},30:{f:pfe},31:{},32:{},33:{f:iA},36:{},37:{f:QT},50:{f:cde},62:{},52:{},67:{},68:{f:nr},69:{},86:{},126:{},127:{f:rde},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:ude},223:{},234:{},354:{},421:{},518:{f:qv},521:{f:s0},536:{f:aA},547:{f:nA},561:{},579:{},1030:{f:qv},1033:{f:s0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ae(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&pb(r)&&e.push(r)}}function lye(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Ae(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function pd(e,t,r){return e||(e=he(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function cye(e,t,r,n){var a=he(9);return pd(a,e,t),tF(r,n||"b",a),a}function uye(e,t,r){var n=he(8+2*r.length);return pd(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function fye(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?pr(jt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Ae(e,2,ode(r,n,a)):Ae(e,3,ide(r,n,a));return;case"b":case"e":Ae(e,5,cye(r,n,t.v,t.t));return;case"s":case"str":Ae(e,4,uye(r,n,(t.v||"").slice(0,255)));return}Ae(e,1,pd(null,r,n))}function dye(e,t,r,n){var a=Array.isArray(t),i=lt(t["!ref"]||"A1"),s,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Xe(i)}for(var c=i.s.r;c<=i.e.r;++c){o=Jt(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=$t(u)),s=l[u]+o;var f=a?(t[c]||[])[u]:t[s];f&&fye(e,f,c,u)}}}function hye(e,t){for(var r=t||{},n=dn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ae(n,r.biff==4?1033:r.biff==3?521:9,kb(e,16,r)),dye(n,e.Sheets[e.SheetNames[a]],a,r),Ae(n,10),n.end()}function pye(e,t,r){Ae(e,49,ofe({sz:12,name:"Arial"},r))}function mye(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ae(e,1054,hfe(a,t[a],r))})}function vye(e,t){var r=he(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ae(e,2151,r),r=he(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),sF(lt(t["!ref"]||"A1"),r),r.write_shift(4,4),Ae(e,2152,r)}function gye(e,t){for(var r=0;r<16;++r)Ae(e,224,eA({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ae(e,224,eA(n,0,t))})}function yye(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ae(e,440,Ufe(n)),n[1].Tooltip&&Ae(e,2048,zfe(n))}delete t["!links"]}function xye(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Ae(e,125,Xfe(Pm(a,n),a))})}}function wye(e,t,r,n,a){var i=16+ws(a.cellXfs,t,a);if(t.v==null&&!t.bf){Ae(e,513,co(r,n,i));return}if(t.bf)Ae(e,6,Gpe(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?pr(jt(t.v)):t.v;Ae(e,515,Efe(r,n,s,i));break;case"b":case"e":Ae(e,517,Sfe(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Nb(a.Strings,t.v,a.revStrings);Ae(e,253,cfe(r,n,o,i))}else Ae(e,516,ffe(r,n,(t.v||"").slice(0,255),i,a));break;default:Ae(e,513,co(r,n,i))}}function bye(e,t,r){var n=dn(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(i),c=t.biff==8,u,f="",d=[],h=lt(i["!ref"]||"A1"),m=c?65536:16384;if(h.e.c>255||h.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Ae(n,2057,kb(r,16,t)),Ae(n,13,Bn(1)),Ae(n,12,Bn(100)),Ae(n,15,Jr(!0)),Ae(n,17,Jr(!1)),Ae(n,16,oo(.001)),Ae(n,95,Jr(!0)),Ae(n,42,Jr(!1)),Ae(n,43,Jr(!1)),Ae(n,130,Bn(1)),Ae(n,128,_fe()),Ae(n,131,Jr(!1)),Ae(n,132,Jr(!1)),c&&xye(n,i["!cols"]),Ae(n,512,mfe(h,t)),c&&(i["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=Jt(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(d[g]=$t(g)),u=d[g]+f;var x=l?(i[p]||[])[g]:i[u];x&&(wye(n,x,p,g,t),c&&x.l&&i["!links"].push([u,x.l]))}}var w=o.CodeName||o.name||a;return c&&Ae(n,574,afe((s.Views||[])[0])),c&&(i["!merges"]||[]).length&&Ae(n,229,Dfe(i["!merges"])),c&&yye(n,i),Ae(n,442,rF(w)),c&&vye(n,i),Ae(n,10),n.end()}function _ye(e,t,r){var n=dn(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ae(n,2057,kb(e,5,r)),r.bookType=="xla"&&Ae(n,135),Ae(n,225,o?Bn(1200):null),Ae(n,193,Sue(2)),l&&Ae(n,191),l&&Ae(n,192),Ae(n,226),Ae(n,92,Vue("SheetJS",r)),Ae(n,66,Bn(o?1200:1252)),o&&Ae(n,353,Bn(0)),o&&Ae(n,448),Ae(n,317,Qfe(e.SheetNames.length)),o&&e.vbaraw&&Ae(n,211),o&&e.vbaraw){var c=s.CodeName||"ThisWorkbook";Ae(n,442,rF(c))}Ae(n,156,Bn(17)),Ae(n,25,Jr(!1)),Ae(n,18,Jr(!1)),Ae(n,19,Bn(0)),o&&Ae(n,431,Jr(!1)),o&&Ae(n,444,Bn(0)),Ae(n,61,rfe()),Ae(n,64,Jr(!1)),Ae(n,141,Bn(0)),Ae(n,34,Jr(ege(e)=="true")),Ae(n,14,Jr(!0)),o&&Ae(n,439,Jr(!1)),Ae(n,218,Bn(0)),pye(n,e,r),mye(n,e.SSF,r),gye(n,r),o&&Ae(n,352,Jr(!1));var u=n.end(),f=dn();o&&Ae(f,140,Vfe()),o&&r.Strings&&lye(f,252,Yue(r.Strings)),Ae(f,10);var d=f.end(),h=dn(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=u.length+m+d.length;for(p=0;p<e.SheetNames.length;++p){var x=i[p]||{};Ae(h,133,que({pos:g,hs:x.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var w=h.end();if(m!=w.length)throw new Error("BS8 "+m+" != "+w.length);var y=[];return u.length&&y.push(u),w.length&&y.push(w),d.length&&y.push(d),xr(y)}function Sye(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Nt(ze)),e&&e.SSF&&(xc(),Sm(e.SSF),r.revssf=Em(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Mb(r),r.cellXfs=[],ws(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=bye(a,r,e);return n.unshift(_ye(e,n,r)),xr(n)}function XF(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=hn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return Sye(e,t);case 4:case 3:case 2:return hye(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function mA(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,l=oce(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<l.length;++s){var p=l[s].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var x=p.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var w=x[o].trim();if(w.match(/<t[dh]/i)){for(var y=w,k=0;y.charAt(0)=="<"&&(k=y.indexOf(">"))>-1;)y=y.slice(k+1);for(var b=0;b<m.length;++b){var _=m[b];_.s.c==u&&_.s.r<c&&c<=_.e.r&&(u=_.e.c+1,b=-1)}var S=Ve(w.slice(0,w.indexOf(">")));d=S.colspan?+S.colspan:1,((f=+S.rowspan)>1||d>1)&&m.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+d-1}});var E=S.t||S["data-t"]||"";if(!y.length){u+=d;continue}if(y=xN(y),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!y.length){u+=d;continue}var T={t:"s",v:y};r.raw||!y.trim().length||E=="s"||(y==="TRUE"?T={t:"b",v:!0}:y==="FALSE"?T={t:"b",v:!1}:isNaN(xa(y))?isNaN(Yl(y).getDate())||(T={t:"d",v:jt(y)},r.cellDates||(T={t:"n",v:pr(T.v)}),T.z=r.dateNF||ze[14]):T={t:"n",v:xa(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=T):n[He({r:c,c:u})]=T,u+=d}}}}return n["!ref"]=Xe(h),m.length&&(n["!merges"]=m),n}function kye(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>s)&&!(a[c].e.r<r||a[c].e.c<s)){if(a[c].s.r<r||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=He({r,c:s}),f=n.dense?(e[r]||[])[s]:e[u],d=f&&f.v!=null&&(f.h||fb(f.w||(yi(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),h.id=(n.id||"sjs")+"-"+u,i.push(Te("td",d,h))}}var m="<tr>";return m+i.join("")+"</tr>"}var Eye='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Tye="</body></html>";function Aye(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return xs(mA(r[0],t),t);var n=Bb();return r.forEach(function(a,i){Ub(n,mA(a,t),"Sheet"+(i+1))}),n}function Oye(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function YF(e,t){var r=t||{},n=r.header!=null?r.header:Eye,a=r.footer!=null?r.footer:Tye,i=[n],s=hn(e["!ref"]);r.dense=Array.isArray(e),i.push(Oye(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(kye(e,s,o,r));return i.push("</table>"+a),i.join("")}function JF(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Lt(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=hn(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var f=[],d=0,h=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,x=0,w=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var k=o[m];if(vA(k)){if(n.display)continue;h[p]={hidden:!0}}var b=k.children;for(g=x=0;g<b.length;++g){var _=b[g];if(!(n.display&&vA(_))){var S=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):xN(_.innerHTML),E=_.getAttribute("data-z")||_.getAttribute("z");for(d=0;d<f.length;++d){var T=f[d];T.s.c==x+i&&T.s.r<p+a&&p+a<=T.e.r&&(x=T.e.c+1-i,d=-1)}y=+_.getAttribute("colspan")||1,((w=+_.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:p+a,c:x+i},e:{r:p+a+(w||1)-1,c:x+i+(y||1)-1}});var F={t:"s",v:S},C=_.getAttribute("data-t")||_.getAttribute("t")||"";S!=null&&(S.length==0?F.t=C||"z":n.raw||S.trim().length==0||C=="s"||(S==="TRUE"?F={t:"b",v:!0}:S==="FALSE"?F={t:"b",v:!1}:isNaN(xa(S))?isNaN(Yl(S).getDate())||(F={t:"d",v:jt(S)},n.cellDates||(F={t:"n",v:pr(F.v)}),F.z=n.dateNF||ze[14]):F={t:"n",v:xa(S)})),F.z===void 0&&E!=null&&(F.z=E);var A="",M=_.getElementsByTagName("A");if(M&&M.length)for(var V=0;V<M.length&&!(M[V].hasAttribute("href")&&(A=M[V].getAttribute("href"),A.charAt(0)!="#"));++V);A&&A.charAt(0)!="#"&&(F.l={Target:A}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][x+i]=F):e[He({c:x+i,r:p+a})]=F,c.e.c<x+i&&(c.e.c=x+i),x+=y}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,p-1+a),e["!ref"]=Xe(c),p>=l&&(e["!fullref"]=Xe((c.e.r=o.length-m+p-1+a,c))),e}function QF(e,t){var r=t||{},n=r.dense?[]:{};return JF(n,e,t)}function Cye(e,t){return xs(QF(e,t),t)}function vA(e){var t="",r=Pye(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Pye(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function jye(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=st(t.replace(/<[^>]*>/g,""));return[r]}var gA={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ZF(e,t){var r=t||{},n=db(e),a=[],i,s,o={name:""},l="",c=0,u,f,d={},h=[],m=r.dense?[]:{},p,g,x={value:""},w="",y=0,k=[],b=-1,_=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,T={},F=[],C={},A=0,M=0,V=[],z=1,Y=1,J=[],Q={Names:[]},j={},X=["",""],ee=[],P={},G="",B=0,q=!1,ne=!1,ye=0;for(Df.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Df.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?m["!ref"]=Xe(S):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(m["!fullref"]=m["!ref"],S.e.r=r.sheetRows-1,m["!ref"]=Xe(S)),F.length&&(m["!merges"]=F),V.length&&(m["!rows"]=V),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),d[u.name]=m,ne=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Ve(p[0],!1),b=_=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,m=r.dense?[]:{},F=[],V=[],ne=!0);break;case"table-row-group":p[1]==="/"?--E:++E;break;case"table-row":case"行":if(p[1]==="/"){b+=z,z=1;break}if(f=Ve(p[0],!1),f.行号?b=f.行号-1:b==-1&&(b=0),z=+f["number-rows-repeated"]||1,z<10)for(ye=0;ye<z;++ye)E>0&&(V[b+ye]={level:E});_=-1;break;case"covered-table-cell":p[1]!=="/"&&++_,r.sheetStubs&&(r.dense?(m[b]||(m[b]=[]),m[b][_]={t:"z"}):m[He({r:b,c:_})]={t:"z"}),w="",k=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++_,x=Ve(p[0],!1),Y=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(g.f=dA(st(x.formula))),(x.数据类型||x["value-type"])=="string"&&(g.t="s",g.v=st(x["string-value"]||""),r.dense?(m[b]||(m[b]=[]),m[b][_]=g):m[He({r:b,c:_})]=g),_+=Y-1;else if(p[1]!=="/"){++_,w="",y=0,k=[],Y=1;var pe=z?b+z-1:b;if(_>S.e.c&&(S.e.c=_),_<S.s.c&&(S.s.c=_),b<S.s.r&&(S.s.r=b),pe>S.e.r&&(S.e.r=pe),x=Ve(p[0],!1),ee=[],P={},g={t:x.数据类型||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=st(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(A=parseInt(x["number-matrix-rows-spanned"],10)||0,M=parseInt(x["number-matrix-columns-spanned"],10)||0,C={s:{r:b,c:_},e:{r:b+A-1,c:_+M-1}},g.F=Xe(C),J.push([C,g.F])),x.formula)g.f=dA(x.formula);else for(ye=0;ye<J.length;++ye)b>=J[ye][0].s.r&&b<=J[ye][0].e.r&&_>=J[ye][0].s.c&&_<=J[ye][0].e.c&&(g.F=J[ye][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(A=parseInt(x["number-rows-spanned"],10)||0,M=parseInt(x["number-columns-spanned"],10)||0,C={s:{r:b,c:_},e:{r:b+A-1,c:_+M-1}},F.push(C)),x["number-columns-repeated"]&&(Y=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Ct(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=jt(x["date-value"]),r.cellDates||(g.t="n",g.v=pr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=ace(x["time-value"])/86400,r.cellDates&&(g.t="d",g.v=Tm(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(w=st(x["string-value"]),k=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(q=!1,g.t==="s"&&(g.v=w||"",k.length&&(g.R=k),q=y==0),j.Target&&(g.l=j),ee.length>0&&(g.c=ee,ee=[]),w&&r.cellText!==!1&&(g.w=w),q&&(g.t="z",delete g.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var te=0;te<z;++te){if(Y=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(m[b+te]||(m[b+te]=[]),m[b+te][_]=te==0?g:Nt(g);--Y>0;)m[b+te][_+Y]=Nt(g);else for(m[He({r:b+te,c:_})]=g;--Y>0;)m[He({r:b+te,c:_+Y})]=Nt(g);S.e.c<=_&&(S.e.c=_)}Y=parseInt(x["number-columns-repeated"]||"1",10),_+=Y-1,Y=0,g={},w="",k=[]}j={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i;P.t=w,k.length&&(P.R=k),P.a=G,ee.push(P)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);G="",B=0,w="",y=0,k=[];break;case"creator":p[1]==="/"?G=n.slice(B,p.index):B=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);w="",y=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(T[o.name]=l,(i=a.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(l="",o=Ve(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ve(p[0],!1),l+=gA[p[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ve(p[0],!1),l+=gA[p[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,p.index);break}else c=p.index+p[0].length;break;case"named-range":s=Ve(p[0],!1),X=Xv(s["cell-range-address"]);var le={Name:s.name,Ref:X[0]+"!"+X[1]};ne&&(le.Sheet=h.length),Q.Names.push(le);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!x||!x["string-value"])){var Se=jye(n.slice(y,p.index));w=(w.length>0?w+`
`:"")+Se[0]}else Ve(p[0],!1),y=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{X=Xv(Ve(p[0])["target-range-address"]),d[X[0]]["!autofilter"]={ref:X[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(j=Ve(p[0],!1),!j.href)break;j.Target=st(j.href),delete j.href,j.Target.charAt(0)=="#"&&j.Target.indexOf(".")>-1?(X=Xv(j.Target.slice(1)),j.Target="#"+X[0]+"!"+X[1]):j.Target.match(/^\.\.[\\\/]/)&&(j.Target=j.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var N={Sheets:d,SheetNames:h,Workbook:Q};return r.bookSheets&&delete N.Sheets,N}function yA(e,t){t=t||{},Ln(e,"META-INF/manifest.xml")&&aue(rr(e,"META-INF/manifest.xml"),t);var r=kn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=ZF(wt(r),t);return Ln(e,"meta.xml")&&(n.Props=zN(rr(e,"meta.xml"))),n}function xA(e,t){return ZF(e,t)}var Nye=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+If({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qt+t}}(),wA=function(){var e=function(i){return mt(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var l=[];l.push('      <table:table table:name="'+mt(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,f=hn(i["!ref"]||"A1"),d=i["!merges"]||[],h=0,m=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(c=0;c<f.s.r;++c)p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=f.e.r;++c){for(p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)l.push(t);for(;u<=f.e.c;++u){var x=!1,w={},y="";for(h=0;h!=d.length;++h)if(!(d[h].s.c>u)&&!(d[h].s.r>c)&&!(d[h].e.c<u)&&!(d[h].e.r<c)){(d[h].s.c!=u||d[h].s.r!=c)&&(x=!0),w["table:number-columns-spanned"]=d[h].e.c-d[h].s.c+1,w["table:number-rows-spanned"]=d[h].e.r-d[h].s.r+1;break}if(x){l.push(r);continue}var k=He({r:c,c:u}),b=m?(i[c]||[])[u]:i[k];if(b&&b.f&&(w["table:formula"]=mt(Qpe(b.f)),b.F&&b.F.slice(0,k.length)==k)){var _=hn(b.F);w["table:number-matrix-columns-spanned"]=_.e.c-_.s.c+1,w["table:number-matrix-rows-spanned"]=_.e.r-_.s.r+1}if(!b){l.push(t);continue}switch(b.t){case"b":y=b.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=b.v?"true":"false";break;case"n":y=b.w||String(b.v||0),w["office:value-type"]="float",w["office:value"]=b.v||0;break;case"s":case"str":y=b.v==null?"":b.v,w["office:value-type"]="string";break;case"d":y=b.w||jt(b.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=jt(b.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(t);continue}var S=e(y);if(b.l&&b.l.Target){var E=b.l.Target;E=E.charAt(0)=="#"?"#"+Zpe(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),S=Te("text:a",S,{"xlink:href":E.replace(/&/g,"&amp;")})}l.push("          "+Te("table:table-cell",Te("text:p",S,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ss(f),f.ods=o;var d=c["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Qt],c=If({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=If({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(WN().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),a(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)l.push(n(s.Sheets[s.SheetNames[f]],s,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function eI(e,t){if(t.bookType=="fods")return wA(e,t);var r=lb(),n="",a=[],i=[];return n="mimetype",Ye(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ye(r,n,wA(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ye(r,n,Nye(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ye(r,n,Qt+WN()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ye(r,n,oue(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ye(r,n,iue(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function uo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Hx(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):wt(ys(e))}function Fye(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Sn(Fa(e))}function Iye(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ls(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function bA(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Dye(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Rye(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Wf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ht(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Gt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ut(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Wf(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Wf(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:i};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function Sr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(ht(n*8+a.type)),a.type==2&&t.push(ht(a.data.length)),t.push(a.data))})}),ls(t)}function Db(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Mn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Wf(e,n),i=ut(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Gt(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=ut(o.data),c=Gt(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(s.merge=Gt(i[3][0].data)>>>0>0),r.push(s)}return r}function Ro(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ht(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ht(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:ht(s.data.length)}],n[2].push({data:Sr(s.meta),type:2})});var i=Sr(n);t.push(ht(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),ls(t)}function Mye(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Wf(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ls(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=ls(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function $n(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Mye(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ls(t)}function Mo(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=ht(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return ls(t)}function $ye(e,t,r,n){var a=uo(e),i=a.getUint32(4,!0),s=(n>1?12:8)+bA(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=bA(i&(n>1?12288:4096))*4,i&16&&(l=a.getUint32(s,!0),s+=4),i&32&&(c=a.getFloat64(s,!0),s+=8),i&64&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Lye(e,t,r){var n=uo(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=Dye(e,i),i+=16),a&2&&(c=n.getFloat64(i,!0),i+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function Jv(e,t){var r=new Uint8Array(32),n=uo(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Rye(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Qv(e,t){var r=new Uint8Array(32),n=uo(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Bye(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return $ye(e,t,r,e[0]);case 5:return Lye(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Rr(e){var t=ut(e);return Wf(t[1][0].data)}function _A(e,t){var r=ut(t.data),n=Gt(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=ut(s.data),l=Gt(o[1][0].data)>>>0;switch(n){case 1:i[l]=Hx(o[3][0].data);break;case 8:{var c=e[Rr(o[9][0].data)][0],u=ut(c.data),f=e[Rr(u[1][0].data)][0],d=Gt(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=ut(f.data);i[l]=h[3].map(function(m){return Hx(m.data)}).join("")}break}}),i}function Uye(e,t){var r,n,a,i,s,o,l,c,u,f,d,h,m,p,g=ut(e),x=Gt(g[1][0].data)>>>0,w=Gt(g[2][0].data)>>>0,y=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Gt(g[8][0].data)>0||!1,k,b;if((i=(a=g[7])==null?void 0:a[0])!=null&&i.data&&t!=0)k=(o=(s=g[7])==null?void 0:s[0])==null?void 0:o.data,b=(c=(l=g[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&t!=1)k=(h=(d=g[4])==null?void 0:d[0])==null?void 0:h.data,b=(p=(m=g[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var _=y?4:1,S=uo(k),E=[],T=0;T<k.length/2;++T){var F=S.getUint16(T*2,!0);F<65535&&E.push([T,F])}if(E.length!=w)throw"Expected ".concat(w," cells, found ").concat(E.length);var C=[];for(T=0;T<E.length-1;++T)C[E[T][0]]=b.subarray(E[T][1]*_,E[T+1][1]*_);return E.length>=1&&(C[E[E.length-1][0]]=b.subarray(E[E.length-1][1]*_)),{R:x,cells:C}}function Wye(e,t){var r,n=ut(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Gt(n[7][0].data)>>>0>0?1:0:-1,i=Db(n[5],function(s){return Uye(s,a)});return{nrows:Gt(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function zye(e,t,r){var n,a=ut(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Gt(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Gt(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Xe(i);var s=ut(a[4][0].data),o=_A(e,e[Rr(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?_A(e,e[Rr(s[17][0].data)][0]):[],c=ut(s[3][0].data),u=0;c[1].forEach(function(f){var d=ut(f.data),h=e[Rr(d[2][0].data)][0],m=Gt(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=Wye(e,h);p.data.forEach(function(g,x){g.forEach(function(w,y){var k=He({r:u+x,c:y}),b=Bye(w,o,l);b&&(r[k]=b)})}),u+=p.nrows})}function Hye(e,t){var r=ut(t.data),n={"!ref":"A1"},a=e[Rr(r[2][0].data)],i=Gt(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return zye(e,a[0],n),n}function Vye(e,t){var r,n=ut(t.data),a={name:(r=n[1])!=null&&r[0]?Hx(n[1][0].data):"",sheets:[]},i=Db(n[2],Rr);return i.forEach(function(s){e[s].forEach(function(o){var l=Gt(o.meta[1][0].data);l==6e3&&a.sheets.push(Hye(e,o))})}),a}function Gye(e,t){var r=Bb(),n=ut(t.data),a=Db(n[1],Rr);if(a.forEach(function(i){e[i].forEach(function(s){var o=Gt(s.meta[1][0].data);if(o==2){var l=Vye(e,s);l.sheets.forEach(function(c,u){Ub(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Zv(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=$n(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=Mn(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Gt(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(l){i[l].forEach(function(c){var u=Gt(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Gye(i,o)}function Kye(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Gt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=uo(e[7][0].data),u=0,f=[],d=uo(e[4][0].data),h=0,m=[],p=0;p<t.length;++p){if(t[p]==null){c.setUint16(p*2,65535,!0),d.setUint16(p*2,65535);continue}c.setUint16(p*2,u,!0),d.setUint16(p*2,h,!0);var g,x;switch(typeof t[p]){case"string":g=Jv({t:"s",v:t[p]},r),x=Qv({t:"s",v:t[p]},r);break;case"number":g=Jv({t:"n",v:t[p]},r),x=Qv({t:"n",v:t[p]},r);break;case"boolean":g=Jv({t:"b",v:t[p]},r),x=Qv({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),u+=g.length,m.push(x),h+=x.length,++l}for(e[2][0].data=ht(l);p<e[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),d.setUint16(p*2,65535,!0);return e[6][0].data=ls(f),e[3][0].data=ls(m),l}function qye(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=hn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Xe(n)));var i=hp(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(G){return G.forEach(function(B){typeof B=="string"&&s.push(B)})});var o={},l=[],c=Le.read(t.numbers,{type:"base64"});c.FileIndex.map(function(G,B){return[G,c.FullPaths[B]]}).forEach(function(G){var B=G[0],q=G[1];if(B.type==2&&B.name.match(/\.iwa/)){var ne=B.content,ye=$n(ne),pe=Mn(ye);pe.forEach(function(te){l.push(te.id),o[te.id]={deps:[],location:q,type:Gt(te.messages[0].meta[1][0].data)}})}}),l.sort(function(G,B){return G-B});var u=l.filter(function(G){return G>1}).map(function(G){return[G,ht(G)]});c.FileIndex.map(function(G,B){return[G,c.FullPaths[B]]}).forEach(function(G){var B=G[0];if(G[1],!!B.name.match(/\.iwa/)){var q=Mn($n(B.content));q.forEach(function(ne){ne.messages.forEach(function(ye){u.forEach(function(pe){ne.messages.some(function(te){return Gt(te.meta[1][0].data)!=11006&&Iye(te.data,pe[1])})&&o[pe[0]].deps.push(ne.id)})})})}});for(var f=Le.find(c,o[1].location),d=Mn($n(f.content)),h,m=0;m<d.length;++m){var p=d[m];p.id==1&&(h=p)}var g=Rr(ut(h.messages[0].data)[1][0].data);for(f=Le.find(c,o[g].location),d=Mn($n(f.content)),m=0;m<d.length;++m)p=d[m],p.id==g&&(h=p);for(g=Rr(ut(h.messages[0].data)[2][0].data),f=Le.find(c,o[g].location),d=Mn($n(f.content)),m=0;m<d.length;++m)p=d[m],p.id==g&&(h=p);for(g=Rr(ut(h.messages[0].data)[2][0].data),f=Le.find(c,o[g].location),d=Mn($n(f.content)),m=0;m<d.length;++m)p=d[m],p.id==g&&(h=p);var x=ut(h.messages[0].data);{x[6][0].data=ht(n.e.r+1),x[7][0].data=ht(n.e.c+1);var w=Rr(x[46][0].data),y=Le.find(c,o[w].location),k=Mn($n(y.content));{for(var b=0;b<k.length&&k[b].id!=w;++b);if(k[b].id!=w)throw"Bad ColumnRowUIDMapArchive";var _=ut(k[b].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var S=0;S<=n.e.c;++S){var E=[];E[1]=E[2]=[{type:0,data:ht(S+420690)}],_[1].push({type:2,data:Sr(E)}),_[2].push({type:0,data:ht(S)}),_[3].push({type:0,data:ht(S)})}_[4]=[],_[5]=[],_[6]=[];for(var T=0;T<=n.e.r;++T)E=[],E[1]=E[2]=[{type:0,data:ht(T+726270)}],_[4].push({type:2,data:Sr(E)}),_[5].push({type:0,data:ht(T)}),_[6].push({type:0,data:ht(T)});k[b].messages[0].data=Sr(_)}y.content=Mo(Ro(k)),y.size=y.content.length,delete x[46];var F=ut(x[4][0].data);{F[7][0].data=ht(n.e.r+1);var C=ut(F[1][0].data),A=Rr(C[2][0].data);y=Le.find(c,o[A].location),k=Mn($n(y.content));{if(k[0].id!=A)throw"Bad HeaderStorageBucket";var M=ut(k[0].messages[0].data);for(T=0;T<i.length;++T){var V=ut(M[2][0].data);V[1][0].data=ht(T),V[4][0].data=ht(i[T].length),M[2][T]={type:M[2][0].type,data:Sr(V)}}k[0].messages[0].data=Sr(M)}y.content=Mo(Ro(k)),y.size=y.content.length;var z=Rr(F[2][0].data);y=Le.find(c,o[z].location),k=Mn($n(y.content));{if(k[0].id!=z)throw"Bad HeaderStorageBucket";for(M=ut(k[0].messages[0].data),S=0;S<=n.e.c;++S)V=ut(M[2][0].data),V[1][0].data=ht(S),V[4][0].data=ht(n.e.r+1),M[2][S]={type:M[2][0].type,data:Sr(V)};k[0].messages[0].data=Sr(M)}y.content=Mo(Ro(k)),y.size=y.content.length;var Y=Rr(F[4][0].data);(function(){for(var G=Le.find(c,o[Y].location),B=Mn($n(G.content)),q,ne=0;ne<B.length;++ne){var ye=B[ne];ye.id==Y&&(q=ye)}var pe=ut(q.messages[0].data);{pe[3]=[];var te=[];s.forEach(function(N,Re){te[1]=[{type:0,data:ht(Re)}],te[2]=[{type:0,data:ht(1)}],te[3]=[{type:2,data:Fye(N)}],pe[3].push({type:2,data:Sr(te)})})}q.messages[0].data=Sr(pe);var le=Ro(B),Se=Mo(le);G.content=Se,G.size=G.content.length})();var J=ut(F[3][0].data);{var Q=J[1][0];delete J[2];var j=ut(Q.data);{var X=Rr(j[2][0].data);(function(){for(var G=Le.find(c,o[X].location),B=Mn($n(G.content)),q,ne=0;ne<B.length;++ne){var ye=B[ne];ye.id==X&&(q=ye)}var pe=ut(q.messages[0].data);{delete pe[6],delete J[7];var te=new Uint8Array(pe[5][0].data);pe[5]=[];for(var le=0,Se=0;Se<=n.e.r;++Se){var N=ut(te);le+=Kye(N,i[Se],s),N[1][0].data=ht(Se),pe[5].push({data:Sr(N),type:2})}pe[1]=[{type:0,data:ht(n.e.c+1)}],pe[2]=[{type:0,data:ht(n.e.r+1)}],pe[3]=[{type:0,data:ht(le)}],pe[4]=[{type:0,data:ht(n.e.r+1)}]}q.messages[0].data=Sr(pe);var Re=Ro(B),ae=Mo(Re);G.content=ae,G.size=G.content.length})()}Q.data=Sr(j)}F[3][0].data=Sr(J)}x[4][0].data=Sr(F)}h.messages[0].data=Sr(x);var ee=Ro(d),P=Mo(ee);return f.content=P,f.size=f.content.length,c}function tI(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Rb(e){tI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Mb(e){tI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Xye(e){return Ze.WS.indexOf(e)>-1?"sheet":e==Ze.CS?"chart":e==Ze.DS?"dialog":e==Ze.MS?"macro":e&&e.length?e:"sheet"}function Yye(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Xye(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Jye(e,t,r,n,a,i,s,o,l,c,u,f){try{i[n]=Eu(kn(e,r,!0),t);var d=rr(e,t),h;switch(o){case"sheet":h=xge(d,t,a,l,i[n],c,u,f);break;case"chart":if(h=wge(d,t,a,l,i[n],c,u,f),!h||!h["!drawel"])break;var m=au(h["!drawel"].Target,t),p=Rf(m),g=she(kn(e,m,!0),Eu(kn(e,p,!0),m)),x=au(g,m),w=Rf(x);h=Kve(kn(e,x,!0),x,l,Eu(kn(e,w,!0),x),c,h);break;case"macro":h=bge(d,t,a,l,i[n],c,u,f);break;case"dialog":h=_ge(d,t,a,l,i[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=h;var y=[];i&&i[n]&&Kt(i[n]).forEach(function(k){var b="";if(i[n][k].Type==Ze.CMNT){b=au(i[n][k].Target,t);var _=Tge(rr(e,b,!0),b,l);if(!_||!_.length)return;oA(h,_,!1)}i[n][k].Type==Ze.TCMNT&&(b=au(i[n][k].Target,t),y=y.concat(lhe(rr(e,b,!0),l)))}),y&&y.length&&oA(h,y,!0,l.people||[])}catch(k){if(l.WTF)throw k}}function Dn(e){return e.charAt(0)=="/"?e.slice(1):e}function Qye(e,t){if(xc(),t=t||{},Rb(t),Ln(e,"META-INF/manifest.xml")||Ln(e,"objectdata.xml"))return yA(e,t);if(Ln(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Zv<"u"){if(e.FileIndex)return Zv(e);var r=Le.utils.cfb_new();return OT(e).forEach(function(V){Ye(r,V,cce(e,V))}),Zv(r)}throw new Error("Unsupported NUMBERS file")}if(!Ln(e,"[Content_Types].xml"))throw Ln(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=OT(e),a=rue(kn(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",rr(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!rr(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Tu=[],a.sst)try{Tu=Ege(rr(e,Dn(a.sst)),a.sst,t)}catch(V){if(t.WTF)throw V}t.cellStyles&&a.themes.length&&(l=kge(kn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=Sge(rr(e,Dn(a.style)),a.style,l,t))}a.links.map(function(V){try{var z=Eu(kn(e,Rf(Dn(V))),V);return Oge(rr(e,Dn(V)),z,V,t)}catch{}});var u=yge(rr(e,Dn(a.workbooks[0])),a.workbooks[0],t),f={},d="";a.coreprops.length&&(d=rr(e,Dn(a.coreprops[0]),!0),d&&(f=zN(d)),a.extprops.length!==0&&(d=rr(e,Dn(a.extprops[0]),!0),d&&cue(d,f,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(d=kn(e,Dn(a.custprops[0]),!0),d&&(h=fue(d,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?s=u.Sheets.map(function(z){return z.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=h),t.bookSheets&&typeof s<"u"&&(m.SheetNames=s),t.bookSheets?m.SheetNames:t.bookProps))return m;s={};var p={};t.bookDeps&&a.calcchain&&(p=Age(rr(e,Dn(a.calcchain)),a.calcchain));var g=0,x={},w,y;{var k=u.Sheets;f.Worksheets=k.length,f.SheetNames=[];for(var b=0;b!=k.length;++b)f.SheetNames[b]=k[b].name}var _=i?"bin":"xml",S=a.workbooks[0].lastIndexOf("/"),E=(a.workbooks[0].slice(0,S+1)+"_rels/"+a.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");Ln(e,E)||(E="xl/_rels/workbook."+_+".rels");var T=Eu(kn(e,E,!0),E.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Cge(rr(e,Dn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=uhe(rr(e,Dn(a.people[0])),t)),T&&(T=Yye(T,u.Sheets));var F=rr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var C="sheet";if(T&&T[g]?(w="xl/"+T[g][1].replace(/[\/]?xl\//,""),Ln(e,w)||(w=T[g][1]),Ln(e,w)||(w=E.replace(/_rels\/.*$/,"")+T[g][1]),C=T[g][2]):(w="xl/worksheets/sheet"+(g+1-F)+"."+_,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,M=0;M!=t.sheets.length;++M)typeof t.sheets[M]=="number"&&t.sheets[M]==g&&(A=1),typeof t.sheets[M]=="string"&&t.sheets[M].toLowerCase()==f.SheetNames[g].toLowerCase()&&(A=1);if(!A)continue e}}Jye(e,w,y,f.SheetNames[g],g,x,s,C,t,u,l,c)}return m={Directory:a,Workbook:u,Props:f,Custprops:h,Deps:p,Sheets:s,SheetNames:f.SheetNames,Strings:Tu,Styles:c,Themes:l,SSF:Nt(ze)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(V,z){V=V.replace(/^Root Entry[\/]/,""),m.keys.push(V),m.files[V]=e.FileIndex[z]}))),t&&t.bookVBA&&(a.vba.length>0?m.vbaraw=rr(e,Dn(a.vba[0]),!0):a.defaults&&a.defaults.bin===yhe&&(m.vbaraw=rr(e,"xl/vbaProject.bin",!0))),m}function Zye(e,t){var r=t||{},n="Workbook",a=Le.find(e,n);try{if(n="/!DataSpaces/Version",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Cde(a.content),n="/!DataSpaces/DataSpaceMap",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=jde(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Nde(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Ide(a.content)}catch{}if(n="/EncryptionInfo",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Dde(a.content);if(n="/EncryptedPackage",a=Le.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function exe(e,t){return t.bookType=="ods"?eI(e,t):t.bookType=="numbers"?qye(e,t):t.bookType=="xlsb"?txe(e,t):rxe(e,t)}function txe(e,t){al=1024,e&&!e.SSF&&(e.SSF=Nt(ze)),e&&e.SSF&&(xc(),Sm(e.SSF),t.revssf=Em(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Au?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=OF.indexOf(t.bookType)>-1,a=_b();Mb(t=t||{});var i=lb(),s="",o=0;if(t.cellXfs=[],ws(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ye(i,s,HN(e.Props,t)),a.coreprops.push(s),pt(t.rels,2,s,Ze.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Ye(i,s,KN(e.Props)),a.extprops.push(s),pt(t.rels,3,s,Ze.EXT_PROPS),e.Custprops!==e.Props&&Kt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ye(i,s,qN(e.Custprops)),a.custprops.push(s),pt(t.rels,4,s,Ze.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ye(i,s,jge(o-1,s,t,e,u)),a.sheets.push(s),pt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ze.WS[0])}if(f){var h=f["!comments"],m=!1,p="";h&&h.length>0&&(p="xl/comments"+o+"."+r,Ye(i,p,Ige(h,p)),a.comments.push(p),pt(u,-1,"../comments"+o+"."+r,Ze.CMNT),m=!0),f["!legacy"]&&m&&Ye(i,"xl/drawings/vmlDrawing"+o+".vml",TF(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Ye(i,Rf(s),ml(u))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ye(i,s,Fge(t.Strings,s,t)),a.strs.push(s),pt(t.wbrels,-1,"sharedStrings."+r,Ze.SST)),s="xl/workbook."+r,Ye(i,s,Pge(e,s)),a.workbooks.push(s),pt(t.rels,1,s,Ze.WB),s="xl/theme/theme1.xml",Ye(i,s,Ob(e.Themes,t)),a.themes.push(s),pt(t.wbrels,-1,"theme/theme1.xml",Ze.THEME),s="xl/styles."+r,Ye(i,s,Nge(e,s,t)),a.styles.push(s),pt(t.wbrels,-1,"styles."+r,Ze.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ye(i,s,e.vbaraw),a.vba.push(s),pt(t.wbrels,-1,"vbaProject.bin",Ze.VBA)),s="xl/metadata."+r,Ye(i,s,Dge(s)),a.metadata.push(s),pt(t.wbrels,-1,"metadata."+r,Ze.XLMETA),Ye(i,"[Content_Types].xml",UN(a,t)),Ye(i,"_rels/.rels",ml(t.rels)),Ye(i,"xl/_rels/workbook."+r+".rels",ml(t.wbrels)),delete t.revssf,delete t.ssf,i}function rxe(e,t){al=1024,e&&!e.SSF&&(e.SSF=Nt(ze)),e&&e.SSF&&(xc(),Sm(e.SSF),t.revssf=Em(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Au?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=OF.indexOf(t.bookType)>-1,a=_b();Mb(t=t||{});var i=lb(),s="",o=0;if(t.cellXfs=[],ws(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ye(i,s,HN(e.Props,t)),a.coreprops.push(s),pt(t.rels,2,s,Ze.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Ye(i,s,KN(e.Props)),a.extprops.push(s),pt(t.rels,3,s,Ze.EXT_PROPS),e.Custprops!==e.Props&&Kt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ye(i,s,qN(e.Custprops)),a.custprops.push(s),pt(t.rels,4,s,Ze.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ye(i,s,LF(o-1,t,e,f)),a.sheets.push(s),pt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ze.WS[0])}if(d){var m=d["!comments"],p=!1,g="";if(m&&m.length>0){var x=!1;m.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(x=!0)})}),x&&(g="xl/threadedComments/threadedComment"+o+"."+r,Ye(i,g,che(m,u,t)),a.threadedcomments.push(g),pt(f,-1,"../threadedComments/threadedComment"+o+"."+r,Ze.TCMNT)),g="xl/comments"+o+"."+r,Ye(i,g,AF(m)),a.comments.push(g),pt(f,-1,"../comments"+o+"."+r,Ze.CMNT),p=!0}d["!legacy"]&&p&&Ye(i,"xl/drawings/vmlDrawing"+o+".vml",TF(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Ye(i,Rf(s),ml(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ye(i,s,pF(t.Strings,t)),a.strs.push(s),pt(t.wbrels,-1,"sharedStrings."+r,Ze.SST)),s="xl/workbook."+r,Ye(i,s,HF(e)),a.workbooks.push(s),pt(t.rels,1,s,Ze.WB),s="xl/theme/theme1.xml",Ye(i,s,Ob(e.Themes,t)),a.themes.push(s),pt(t.wbrels,-1,"theme/theme1.xml",Ze.THEME),s="xl/styles."+r,Ye(i,s,_F(e,t)),a.styles.push(s),pt(t.wbrels,-1,"styles."+r,Ze.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ye(i,s,e.vbaraw),a.vba.push(s),pt(t.wbrels,-1,"vbaProject.bin",Ze.VBA)),s="xl/metadata."+r,Ye(i,s,EF()),a.metadata.push(s),pt(t.wbrels,-1,"metadata."+r,Ze.XLMETA),u.length>1&&(s="xl/persons/person.xml",Ye(i,s,fhe(u)),a.people.push(s),pt(t.wbrels,-1,"persons/person.xml",Ze.PEOPLE)),Ye(i,"[Content_Types].xml",UN(a,t)),Ye(i,"_rels/.rels",ml(t.rels)),Ye(i,"xl/_rels/workbook."+r+".rels",ml(t.wbrels)),delete t.revssf,delete t.ssf,i}function $b(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Cn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nxe(e,t){return Le.find(e,"EncryptedPackage")?Zye(e,t):qF(e,t)}function axe(e,t){var r,n=e,a=t||{};return a.type||(a.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r=vN(n,a),Qye(r,a)}function rI(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Wx(e.slice(r),t);default:break e}return Jl.to_workbook(e,t)}function ixe(e,t){var r="",n=$b(e,t);switch(t.type){case"base64":r=Cn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=so(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=wt(r)),t.type="binary",rI(r,t)}function sxe(e,t){var r=e;return t.type=="base64"&&(r=Cn(r)),r=Pf.utils.decode(1200,r.slice(2),"str"),t.type="binary",rI(r,t)}function oxe(e){return e.match(/[^\x00-\x7F]/)?Fa(e):e}function eg(e,t,r,n){return n?(r.type="string",Jl.to_workbook(e,r)):Jl.to_workbook(t,r)}function Vx(e,t){nb();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Vx(new Uint8Array(e),(r=Nt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),gl={},r.dateNF&&(gl.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=tce(e),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=oxe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Nt(r),r.type="array",Vx(ab(n),r)}switch((a=$b(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return nxe(Le.read(n,r),r);break;case 9:if(a[1]<=8)return qF(n,r);break;case 60:return Wx(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return dde(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return dF.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?axe(n,r):eg(e,n,r,i);case 239:return a[3]===60?Wx(n,r):eg(e,n,r,i);case 255:if(a[1]===254)return sxe(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Ks.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Ks.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Ux.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return xF.to_workbook(n,r);break;case 10:case 13:case 32:return ixe(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return fde.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Ux.to_workbook(n,r):eg(e,n,r,i)}function nI(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return od(t.file,Le.write(e,{type:Qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Le.write(e,t)}function lxe(e,t){var r=Nt(t||{}),n=exe(e,r);return cxe(n,r)}function cxe(e,t){var r={},n=Qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Le.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(_m(a))}return t.password&&typeof encrypt_agile<"u"?nI(encrypt_agile(a,t.password),t):t.type==="file"?od(t.file,a):t.type=="string"?wt(a):a}function uxe(e,t){var r=t||{},n=oye(e,r);return nI(n,r)}function Oa(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return jf(Fa(n));case"binary":return Fa(n);case"string":return e;case"file":return od(t.file,n,"utf8");case"buffer":return Qe?Si(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Oa(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fxe(e,t){switch(t.type){case"base64":return jf(e);case"binary":return e;case"string":return e;case"file":return od(t.file,e,"binary");case"buffer":return Qe?Si(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function u0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?jf(r):t.type=="string"?wt(r):r;case"file":return od(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function aI(e,t){nb(),nge(e);var r=Nt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=aI(e,r);return r.type="array",_m(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Oa(eye(e,r),r);case"slk":case"sylk":return Oa(fF.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Oa(YF(e.Sheets[e.SheetNames[a]],r),r);case"txt":return fxe(iI(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Oa(Lb(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Oa(dF.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return u0(Ux.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Oa(Jl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Oa(xF.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Oa(hF.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Oa(eI(e,r),r);case"wk1":return u0(Ks.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return u0(Ks.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),u0(XF(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),uxe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return lxe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function dxe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function hxe(e,t,r){var n={};return n.type="file",n.file=t,dxe(n),aI(e,n)}function pxe(e,t,r,n,a,i,s,o){var l=Jt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!s||e[r])for(var h=t.s.c;h<=t.e.c;++h){var m=s?e[r][h]:e[n[h]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;i[h]!=null&&(d[i[h]]=c);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[h]!=null){if(p==null)if(m.t=="e"&&p===null)d[i[h]]=null;else if(c!==void 0)d[i[h]]=c;else if(u&&p===null)d[i[h]]=null;else continue;else d[i[h]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:yi(m,p,o);p!=null&&(f=!1)}}return{row:d,isempty:f}}function hp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=lt(u);break;case"number":l=lt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var f=Jt(l.s.r),d=[],h=[],m=0,p=0,g=Array.isArray(e),x=l.s.r,w=0,y={};g&&!e[x]&&(e[x]=[]);var k=c.skipHidden&&e["!cols"]||[],b=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(k[w]||{}).hidden)switch(d[w]=$t(w),r=g?e[x][w]:e[d[w]+f],n){case 1:i[w]=w-l.s.c;break;case 2:i[w]=d[w];break;case 3:i[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=yi(r,null,c),p=y[s]||0,!p)y[s]=1;else{do o=s+"_"+p++;while(y[o]);y[s]=p,y[o]=1}i[w]=o}for(x=l.s.r+a;x<=l.e.r;++x)if(!(b[x]||{}).hidden){var _=pxe(e,l,x,d,n,i,g,c);(_.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(h[m++]=_.row)}return h.length=m,h}var SA=/"/g;function mxe(e,t,r,n,a,i,s,o){for(var l=!0,c=[],u="",f=Jt(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var h=o.dense?(e[r]||[])[d]:e[n[d]+f];if(h==null)u="";else if(h.v!=null){l=!1,u=""+(o.rawNumbers&&h.t=="n"?h.v:yi(h,null,o));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===a||p===i||p===34||o.forceQuotes){u='"'+u.replace(SA,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(l=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(SA,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function Lb(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=lt(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(d[m]||{}).hidden||(f[m]=$t(m));for(var p=0,g=a.s.r;g<=a.e.r;++g)(h[g]||{}).hidden||(u=mxe(e,a,g,f,s,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete n.dense,r.join("")}function iI(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Lb(e,t);return r}function vxe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=lt(e["!ref"]),i="",s=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=$t(o);for(var u=a.s.r;u<=a.e.r;++u)for(i=Jt(u),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function sI(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Lt(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var f=lt(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(s=f.e.r+1,u.e.r=s+t.length-1+a)}else s==-1&&(s=0,u.e.r=t.length-1+a);var d=n.header||[],h=0;t.forEach(function(p,g){Kt(p).forEach(function(x){(h=d.indexOf(x))==-1&&(d[h=d.length]=x);var w=p[x],y="z",k="",b=He({c:o+h,r:s+g+a});c=zf(i,b),w&&typeof w=="object"&&!(w instanceof Date)?i[b]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",n.cellDates||(y="n",w=pr(w)),k=n.dateNF||ze[14]):w===null&&n.nullError&&(y="e",w=0),c?(c.t=y,c.v=w,delete c.w,delete c.R,k&&(c.z=k)):i[b]=c={t:y,v:w},k&&(c.z=k))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var m=Jt(s);if(a)for(h=0;h<d.length;++h)i[$t(h+o)+m]={t:"s",v:d[h]};return i["!ref"]=Xe(u),i}function gxe(e,t){return sI(null,e,t)}function zf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Lt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?zf(e,He(t)):zf(e,He({r:t,c:r||0}))}function yxe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Bb(){return{SheetNames:[],Sheets:{}}}function Ub(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(zF(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function xxe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=yxe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function wxe(e,t){return e.z=t,e}function oI(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function bxe(e,t,r){return oI(e,"#"+t,r)}function _xe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Sxe(e,t,r,n){for(var a=typeof t!="string"?t:lt(t),i=typeof t=="string"?t:Xe(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=zf(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var E0={encode_col:$t,encode_row:Jt,encode_cell:He,encode_range:Xe,decode_col:vb,decode_row:mb,split_cell:Fce,decode_cell:Lt,decode_range:hn,format_cell:yi,sheet_add_aoa:IN,sheet_add_json:sI,sheet_add_dom:JF,aoa_to_sheet:wc,json_to_sheet:gxe,table_to_sheet:QF,table_to_book:Cye,sheet_to_csv:Lb,sheet_to_txt:iI,sheet_to_json:hp,sheet_to_html:YF,sheet_to_formulae:vxe,sheet_to_row_object_array:hp,sheet_get_cell:zf,book_new:Bb,book_append_sheet:Ub,book_set_sheet_visibility:xxe,cell_set_number_format:wxe,cell_set_hyperlink:oI,cell_set_internal_link:bxe,cell_add_comment:_xe,sheet_set_array_formula:Sxe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function kxe({storageKey:e,delayMs:t=2e3,serializeDraft:r,deserializeDraft:n,onFlush:a}){const[i,s]=R.useState(!1),[o,l]=R.useState(!1),[c,u]=R.useState(null),[f,d]=R.useState(null),h=R.useRef(null),m=R.useRef(null),p=R.useRef(!1),g=R.useCallback(S=>{try{const E=r(S);localStorage.setItem(e,E)}catch(E){console.error("Failed to persist draft:",E)}},[e,r]),x=R.useCallback(()=>{try{localStorage.removeItem(e)}catch(S){console.error("Failed to clear draft:",S)}},[e]),w=R.useCallback(()=>{try{const S=localStorage.getItem(e);if(S)return n(S)}catch(S){console.error("Failed to load draft:",S)}return null},[e,n]),y=R.useCallback(async()=>{if(!(p.current||!h.current)){p.current=!0,l(!0),d(null);try{await a(h.current),h.current=null,s(!1),u(new Date().toISOString()),x()}catch(S){console.error("Autosave flush failed:",S);const E=S.message||S.error_description||String(S);d(E)}finally{l(!1),p.current=!1}}},[a,x]),k=R.useCallback(S=>{h.current=S,s(!0),d(null),g(S),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{y()},t)},[t,g,y]),b=R.useCallback(async()=>{m.current&&(clearTimeout(m.current),m.current=null),await y()},[y]),_=R.useCallback(()=>{m.current&&(clearTimeout(m.current),m.current=null),h.current=null,s(!1),d(null),x()},[x]);return R.useEffect(()=>{const S=E=>{if(i)return E.preventDefault(),E.returnValue="You have unsaved changes. Are you sure you want to leave?",E.returnValue};return window.addEventListener("beforeunload",S),()=>{window.removeEventListener("beforeunload",S)}},[i]),R.useEffect(()=>()=>{m.current&&clearTimeout(m.current)},[]),{hasUnsavedChanges:i,isSaving:o,lastSavedAt:c,error:f,queueChanges:k,saveNow:b,discard:_,loadDraft:w}}function Exe({visible:e,isSaving:t,lastSavedAt:r,error:n,onSave:a,onDiscard:i}){if(!e)return null;const s=o=>{if(!o)return"";try{const l=new Date(o),c=String(l.getHours()).padStart(2,"0"),u=String(l.getMinutes()).padStart(2,"0"),f=String(l.getSeconds()).padStart(2,"0");return`${c}:${u}:${f}`}catch{return""}};return v.jsx("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-50 transition-all duration-300 ease-in-out",children:v.jsxs("div",{className:"bg-white rounded-lg shadow-lg border-2 border-slate-300 px-6 py-3 flex items-center gap-4",children:[v.jsx("div",{className:"flex items-center gap-2 min-w-[150px]",children:t?v.jsxs(v.Fragment,{children:[v.jsxs("svg",{className:"animate-spin h-4 w-4 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[v.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),v.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),v.jsx("span",{className:"text-sm text-slate-600",children:"Saving..."})]}):n?v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"text-red-600",children:"⚠️"}),v.jsx("span",{className:"text-sm text-red-600",title:n,children:"Save failed"})]}):r?v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"text-green-600",children:"✓"}),v.jsxs("span",{className:"text-sm text-slate-600",children:["Saved at ",s(r)]})]}):v.jsx("span",{className:"text-sm text-slate-600",children:"Unsaved changes"})}),v.jsxs("div",{className:"flex items-center gap-2 border-l border-slate-300 pl-4",children:[v.jsx("button",{onClick:i,disabled:t,className:"px-4 py-1.5 text-sm rounded-lg border border-slate-300 bg-white hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Discard"}),v.jsx("button",{onClick:a,disabled:t,className:"px-4 py-1.5 text-sm rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:"Save"})]})]})})}function Txe(){const[e,t]=R.useState(!1),[r,n]=R.useState(!1),a=R.useRef(null),i=async o=>{var c;const l=o.target.files;if(!(!l||l.length===0)){t(!0);try{console.debug("[UploadServiceScanButton] Uploading files:",l.length);const u=Array.from(l).map(m=>new Promise((p,g)=>{const x=new FileReader;x.onload=()=>{const w=x.result.split(",")[1];p({filename:m.name,mimeType:m.type,data:w})},x.onerror=g,x.readAsDataURL(m)})),f=await Promise.all(u),d=await fetch("/api/imports/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:f,meta:{source:"delivery-tickets"}})});if(!d.ok){const m=await d.json();throw new Error(m.message||"Upload failed")}const h=await d.json();console.debug("[UploadServiceScanButton] Upload success:",h),t(!1),h.importId?(n(!0),console.debug("[UploadServiceScanButton] Triggering processing for import:",h.importId),(await fetch("/api/imports/process",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({importId:h.importId})})).ok?(console.debug("[UploadServiceScanButton] Processing complete"),alert(`Successfully uploaded and processed ${h.files.length} file(s). Check Imports Review tab to review and accept.`)):(console.warn("[UploadServiceScanButton] Processing failed, but upload succeeded"),alert(`Successfully uploaded ${h.files.length} file(s). Processing will be attempted automatically.`)),n(!1)):alert(`Successfully uploaded ${((c=h.files)==null?void 0:c.length)||0} file(s).`),a.current&&(a.current.value="")}catch(u){console.error("[UploadServiceScanButton] Error:",u),alert("Upload failed: "+u.message),t(!1),n(!1)}}},s=()=>e?"⏳ Uploading...":r?"🔄 Processing...":"📄 Upload Service Scan";return v.jsxs(v.Fragment,{children:[v.jsx("button",{className:"rounded-lg border px-3 py-1.5 bg-green-600 text-white hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>{var o;return(o=a.current)==null?void 0:o.click()},disabled:e||r,title:"Upload scanned service tickets (PDF/Image) for processing",children:s()}),v.jsx("input",{ref:a,type:"file",accept:".pdf,.jpg,.jpeg,.png,.gif",multiple:!0,className:"hidden",onChange:i})]})}function Axe(){const[e,t]=R.useState([]),[r,n]=R.useState([]),[a,i]=R.useState("open"),[s,o]=R.useState([]),l=R.useRef(null),c=R.useRef(null),[u,f]=R.useState(null),[d,h]=R.useState({}),[m,p]=R.useState(1),[g]=R.useState(15),[x,w]=R.useState(0),[y,k]=R.useState({}),[b,_]=R.useState("all"),[S,E]=R.useState(""),[T,F]=R.useState(""),[C,A]=R.useState("ALL"),M=kxe({storageKey:"delivery-tickets-draft",delayMs:2e3,serializeDraft:I=>JSON.stringify(I),deserializeDraft:I=>JSON.parse(I),onFlush:async I=>{const K=await P6(I),ue=Object.entries(K).filter(([ve,ke])=>!ke.success);if(ue.length>0)throw console.error("Some ticket updates failed:",ue),new Error(`Failed to save ${ue.length} ticket(s). See console for details.`)}}),V=R.useMemo(()=>{if(b==="all")return r;const I=new Date;let K,ue;if(b==="today")K=new Date(I.getFullYear(),I.getMonth(),I.getDate()),ue=new Date(I.getFullYear(),I.getMonth(),I.getDate()+1);else if(b==="week"){const ve=I.getDay();K=new Date(I.getFullYear(),I.getMonth(),I.getDate()-ve),ue=new Date(I.getFullYear(),I.getMonth(),I.getDate()+(7-ve))}else if(b==="month")K=new Date(I.getFullYear(),I.getMonth(),1),ue=new Date(I.getFullYear(),I.getMonth()+1,1);else if(b==="year")K=new Date(I.getFullYear(),0,1),ue=new Date(I.getFullYear()+1,0,1);else if(b==="custom"){if(!S&&!T)return r;K=S?new Date(S):new Date(0),ue=T?new Date(new Date(T).getTime()+864e5):new Date(864e13)}return r.filter(ve=>{if(!ve.date)return!1;const ke=new Date(ve.date);return ke>=K&&ke<ue})},[r,b,S,T]),z=R.useMemo(()=>{if(b==="all")return e;const I=new Date;let K,ue;if(b==="today")K=new Date(I.getFullYear(),I.getMonth(),I.getDate()),ue=new Date(I.getFullYear(),I.getMonth(),I.getDate()+1);else if(b==="week"){const ve=I.getDay();K=new Date(I.getFullYear(),I.getMonth(),I.getDate()-ve),ue=new Date(I.getFullYear(),I.getMonth(),I.getDate()+(7-ve))}else if(b==="month")K=new Date(I.getFullYear(),I.getMonth(),1),ue=new Date(I.getFullYear(),I.getMonth()+1,1);else if(b==="year")K=new Date(I.getFullYear(),0,1),ue=new Date(I.getFullYear()+1,0,1);else if(b==="custom"){if(!S&&!T)return e;K=S?new Date(S):new Date(0),ue=T?new Date(new Date(T).getTime()+864e5):new Date(864e13)}return e.filter(ve=>{if(!ve.date)return!1;const ke=new Date(ve.date);return ke>=K&&ke<ue})},[e,b,S,T]),Y=R.useMemo(()=>R6(V),[V]),J=R.useMemo(()=>C==="ALL"?z:z.filter(I=>(I.truck||I.truck_id||"Unassigned")===C),[z,C]),Q=R.useMemo(()=>C==="ALL"?V:V.filter(I=>(I.truck||I.truck_id||"Unassigned")===C),[V,C]),j=R.useMemo(()=>ly(V),[V]),X=R.useMemo(()=>C==="ALL"?j:ly(Q),[Q,C,j]),ee=R.useMemo(()=>{const I=D6(V);return Object.keys(I).map(K=>({truck:K,...I[K]})).sort((K,ue)=>ue.amount-K.amount)},[V]);R.useMemo(()=>({qty:j.tickets,amount:j.amount,totalGallons:j.totalGallons,avgMiles:j.avgMiles,onTimePct:j.onTimePct}),[j]);async function P(){var K;const{data:I}=await be.auth.getUser();return((K=I==null?void 0:I.user)==null?void 0:K.id)??null}R.useEffect(()=>{let I=!0;async function K(){try{const[{rows:ue,count:ve},ke]=await Promise.all([_2(m,g),T6()]);if(!I)return;w(ve),n(ke);const Be=M.loadDraft();if(Be){const Ce=ue.map($e=>Be[$e.id]?{...$e,...Be[$e.id]}:$e);t(Ce),k(Be),setTimeout(()=>{I&&M.queueChanges(Be)},100)}else t(ue);const Me={};if(await Promise.all(ue.slice(0,30).map(async Ce=>{try{const $e=await S2(Ce.id);Me[Ce.id]=$e}catch($e){console.error(`Failed to load attachments for ticket ${Ce.id}:`,$e.message||$e),Me[Ce.id]=[]}})),!I)return;h(Me)}catch(ue){console.error("Failed to load tickets:",ue);const ve=ue.message||ue.error_description||JSON.stringify(ue);alert(`Failed to load tickets: ${ve}. See console for details.`)}}return K(),()=>{I=!1}},[m,g]),R.useEffect(()=>{const I=document.querySelector(".delivery-table-container");if(!I)return;const K=ke=>{if(!ke)return;const Be=ke.querySelector('[data-col="gallons"] input'),Me=ke.querySelector('[data-col="qty"] input'),Ce=ke.querySelector('[data-col="price"] input'),$e=ke.querySelector('[data-col="account"] input'),ct=(Be==null?void 0:Be.value)||"—",je=(Me==null?void 0:Me.value)||"—",Ge=(Ce==null?void 0:Ce.value)||"—",Zt=($e==null?void 0:$e.value)||"—",yt=document.getElementById("preview-gallons"),Sa=document.getElementById("preview-qty"),_c=document.getElementById("preview-price"),md=document.getElementById("preview-account");if(yt&&(yt.textContent=ct!=="—"?ct:"—"),Sa&&(Sa.textContent=je!=="—"?je:"—"),_c){const vd=parseFloat(Ge);_c.textContent=Ge!=="—"&&!isNaN(vd)?`$${vd.toFixed(2)}`:"—"}md&&(md.textContent=Zt!=="—"?Zt:"—")},ue=ke=>{const Me=ke.target.closest("tr");K(Me)},ve=ke=>{const Me=ke.target.closest("tr");K(Me)};return I.addEventListener("input",ue),I.addEventListener("focusin",ve),()=>{I.removeEventListener("input",ue),I.removeEventListener("focusin",ve)}},[]);async function G(){const I=await P(),K=new Date(Date.now()-864e5).toISOString().slice(0,10),ue={date:K,driver:"",truck:"",truck_id:null,customerName:"",customer_name:"",account:"",qty:null,price:null,tax:null,hazmat_fee:null,amount:null,status:"draft",notes:"",ticket_id:null,ticket_no:null,gallons:null,gallons_delivered:null,price_per_gallon:null,total_amount:null,delivery_date:K,ticket_date:K,scheduled_window_start:null,arrival_time:null,departure_time:null,odometer_start:null,odometer_end:null,miles_driven:null,on_time_flag:null,created_by:I};try{const ve=await A6(ue);t(ke=>[ve,...ke])}catch(ve){console.error("Failed to add ticket:",ve);const ke=ve.message||ve.error_description||JSON.stringify(ve);alert(`Failed to add ticket: ${ke}. See console for details.`)}}async function B(I,K,ue){const ke=["qty","price","tax","hazmat_fee","amount","gallons_delivered","odometer_start","odometer_end"].includes(K)?ue===""||ue==null?null:Number(ue):ue,Be={[K]:ke},Me=e.find(Ce=>Ce.id===I);if(Me){if(K==="qty"||K==="price"||K==="tax"||K==="hazmat_fee"){const Ce=K==="qty"?ke||0:Me.qty||0,$e=K==="price"?ke||0:Me.price||0,ct=K==="tax"?ke||0:Me.tax||0,je=K==="hazmat_fee"?ke||0:Me.hazmat_fee||0;Be.amount=Ce*$e+ct+je}if(K==="odometer_start"||K==="odometer_end"){const Ce=K==="odometer_start"?ke:Me.odometer_start,$e=K==="odometer_end"?ke:Me.odometer_end;Ce!=null&&$e!=null&&Ce!==""&&$e!==""?Be.miles_driven=Number($e)-Number(Ce):Be.miles_driven=null}if(K==="scheduled_window_start"||K==="arrival_time"){const Ce=K==="scheduled_window_start"?ke:Me.scheduled_window_start,$e=K==="arrival_time"?ke:Me.arrival_time;if(Ce&&$e){const ct=new Date(Ce),je=new Date($e),Ge=5*60*1e3;Be.on_time_flag=je<=new Date(ct.getTime()+Ge)?1:0}else Be.on_time_flag=null}t(Ce=>Ce.map($e=>$e.id!==I?$e:{...$e,...Be})),k(Ce=>{const $e={...Ce,[I]:{...Ce[I]||{},...Be}};return M.queueChanges($e),$e})}}async function q(I){if(confirm("Delete this ticket?"))try{await C6(I),t(K=>K.filter(ue=>ue.id!==I)),h(K=>{const ue={...K};return delete ue[I],ue}),k(K=>{const ue={...K};return delete ue[I],Object.keys(ue).length>0?M.queueChanges(ue):M.discard(),ue})}catch(K){console.error(K),alert("Delete failed.")}}async function ne(){await M.saveNow(),k({})}async function ye(){if(confirm("Discard all unsaved changes? This will reload data from the server.")){k({}),M.discard();try{const{rows:I,count:K}=await _2(m,g);t(I),w(K)}catch(I){console.error("Failed to reload tickets:",I),alert("Failed to reload tickets. Please refresh the page.")}}}function pe(I){I.target&&(I.target.tagName==="INPUT"||I.target.tagName==="TEXTAREA")&&(I.target.scrollLeft=0)}async function te(I){const K=await I.text(),[ue,...ve]=K.split(/\r?\n/).filter(Boolean),ke=ue.split(",").map(je=>je.trim()),Me=["date","driver","truck","customer","account","qty","price","tax","amount"].filter(je=>!ke.includes(je));if(Me.length){alert("Missing csv columns: "+Me.join(", "));return}const Ce=Object.fromEntries(ke.map((je,Ge)=>[je,Ge])),$e=ve.map(je=>{const Ge=je.split(",");return{date:Ge[Ce.date],driver:Ge[Ce.driver],truck:Ge[Ce.truck],customerName:Ge[Ce.customer],account:Ge[Ce.account],qty:Number(Ge[Ce.qty]||0),price:Number(Ge[Ce.price]||0),tax:Number(Ge[Ce.tax]||0),amount:Number(Ge[Ce.amount]||0),status:"draft"}}),ct=await P();try{const je=$e.map(yt=>({...yt,created_by:ct})),{data:Ge,error:Zt}=await be.from("delivery_tickets").insert(je).select();if(Zt)throw Zt;t(yt=>[...Ge,...yt]),alert(`Imported ${Ge.length} rows.`)}catch(je){console.error("Import failed:",je),alert("CSV import failed. See console.")}}function le(I){var ue;const K=(ue=I.target.files)==null?void 0:ue[0];K&&te(K),I.target.value=""}function Se(I){var K;f(I),(K=c.current)==null||K.click()}async function N(I){var ue;const K=(ue=I.target.files)==null?void 0:ue[0];if(K&&u){await Re(u,K);const ve=await S2(u);h(ke=>({...ke,[u]:ve})),f(null)}I.target.value=""}async function Re(I,K){const ue=`tickets/${I}/${Date.now()}-${K.name}`;try{const ve=await j6(K,ue),ke=await P(),Be=(ve==null?void 0:ve.path)||(ve==null?void 0:ve.Key)||ue;await N6({ticket_id:I,storage_key:Be,filename:K.name,content_type:K.type,size:K.size,uploaded_by:ke}),alert("Attachment uploaded.")}catch(ve){console.error("Upload failed:",ve),alert("Attachment upload failed.")}}function ae(){const I=[];e.forEach((K,ue)=>{K.customerName||I.push({i:ue,msg:"Missing customer"}),K.account||I.push({i:ue,msg:"Missing account"}),(K.qty||0)<=0&&I.push({i:ue,msg:"Qty must be > 0"}),(K.price||0)<0&&I.push({i:ue,msg:"Price must be >= 0"})}),o(I),I.length||alert("No exceptions. Ready to transfer.")}async function re(){if(s.length)return alert("Resolve exceptions first.");if(!e.length)return alert("Nothing to post.");try{const I=e.filter(ue=>ue.status==="draft").map(ue=>ue.id);I.length&&await be.from("delivery_tickets").update({status:"posted"}).in("id",I);const K=await E6();t(K),i("posted"),alert("Batch posted.")}catch(I){console.error("Post failed:",I),alert("Post failed.")}}function fe(){const I=["date,driver,truck,customer,qty,amount",...e.filter(ve=>ve.status==="posted").map(ve=>[ve.date,ve.driver,ve.truck,ve.customerName,ve.qty,ve.amount].join(","))].join(`
`),K=new Blob([I],{type:"text/csv"}),ue=document.createElement("a");ue.href=URL.createObjectURL(K),ue.download="pps-truck-export.csv",ue.click(),URL.revokeObjectURL(ue.href)}function de(){const I=["date","truck","driver","ticket_id","customerName","gallons_delivered","account","qty","price","tax","hazmat_fee","amount","status"],K=[I.join(","),...J.map(Be=>I.map(Me=>{const Ce=Be[Me]??"";return String(Ce).includes(",")||String(Ce).includes('"')?`"${String(Ce).replace(/"/g,'""')}"`:Ce}).join(","))].join(`
`),ue=new Blob([K],{type:"text/csv"}),ve=URL.createObjectURL(ue),ke=document.createElement("a");ke.href=ve,ke.download=`delivery-tickets-${b}-${C}-${new Date().toISOString().slice(0,10)}.csv`,ke.click(),URL.revokeObjectURL(ve)}function Ue(){const I=["Date","Truck","Driver","Ticket ID","Customer","Gallons Delivered","Account","Qty","Price","Tax","Hazmat Fee","Amount","Status"],K=["date","truck","driver","ticket_id","customerName","gallons_delivered","account","qty","price","tax","hazmat_fee","amount","status"],ue=[I,...J.map(Me=>K.map(Ce=>Me[Ce]??""))],ve=E0.aoa_to_sheet(ue),ke=E0.book_new();E0.book_append_sheet(ke,ve,"Tickets");const Be=`delivery-tickets-${b}-${C}-${new Date().toISOString().slice(0,10)}.xlsx`;hxe(ke,Be)}const at=R.useMemo(()=>{const I=C==="ALL"?z:J,K={};return I.forEach(ue=>{const ve=ue.date||"Unknown";K[ve]||(K[ve]={date:ve,gallons:0,revenue:0}),K[ve].gallons+=Number(ue.gallons_delivered||ue.qty)||0,K[ve].revenue+=Number(ue.amount)||0}),Object.values(K).sort((ue,ve)=>ue.date.localeCompare(ve.date))},[z,J,C]);return v.jsxs("div",{className:"dt-page space-y-6",children:[v.jsx(Exe,{visible:M.hasUnsavedChanges,isSaving:M.isSaving,lastSavedAt:M.lastSavedAt,error:M.error,onSave:ne,onDiscard:ye}),v.jsxs("header",{className:"flex items-center justify-between",children:[v.jsx("h2",{className:"text-xl font-semibold",children:"Delivery Tickets"}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{className:"rounded-lg border px-3 py-1.5",onClick:G,children:"Add ticket"}),v.jsx("button",{className:"rounded-lg border px-3 py-1.5",onClick:()=>{var I;return(I=l.current)==null?void 0:I.click()},children:"Import CSV"}),v.jsx("input",{ref:l,type:"file",accept:".csv",className:"hidden",onChange:le})]})]}),v.jsx("div",{className:"rounded-lg border p-4 bg-slate-50",children:v.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[v.jsx("label",{className:"font-semibold",children:"Filters:"}),v.jsx("button",{className:`px-3 py-1 rounded ${b==="all"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>_("all"),children:"All"}),v.jsx("button",{className:`px-3 py-1 rounded ${b==="today"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>_("today"),children:"Today"}),v.jsx("button",{className:`px-3 py-1 rounded ${b==="week"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>_("week"),children:"This Week"}),v.jsx("button",{className:`px-3 py-1 rounded ${b==="month"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>_("month"),children:"This Month"}),v.jsx("button",{className:`px-3 py-1 rounded ${b==="year"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>_("year"),children:"This Year"}),v.jsx("button",{className:`px-3 py-1 rounded ${b==="custom"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>_("custom"),children:"Custom Range"}),b==="custom"&&v.jsxs(v.Fragment,{children:[v.jsx("input",{type:"date",value:S,onChange:I=>E(I.target.value),className:"px-2 py-1 border rounded text-sm",placeholder:"Start"}),v.jsx("span",{children:"to"}),v.jsx("input",{type:"date",value:T,onChange:I=>F(I.target.value),className:"px-2 py-1 border rounded text-sm",placeholder:"End"})]})]})}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("label",{className:"font-semibold",children:"Truck:"}),v.jsxs("select",{value:C,onChange:I=>A(I.target.value),className:"px-3 py-1.5 border rounded",children:[v.jsx("option",{value:"ALL",children:"All Trucks"}),Y.map(I=>v.jsx("option",{value:I,children:I},I))]}),v.jsxs("span",{className:"text-sm text-slate-600",children:["Showing ",J.length," of ",e.length," tickets"]})]}),v.jsxs("div",{className:"rounded-lg border p-4",children:[v.jsxs("h3",{className:"font-semibold mb-3",children:["Overall Metrics ",C!=="ALL"&&`(${C})`]}),v.jsxs("div",{className:"grid gap-3 sm:grid-cols-4 lg:grid-cols-6",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Tickets"}),v.jsx("div",{className:"text-lg font-semibold",children:X.tickets})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Total Gallons"}),v.jsx("div",{className:"text-lg font-semibold",children:X.totalGallons.toFixed(1)})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Revenue"}),v.jsxs("div",{className:"text-lg font-semibold",children:["$",X.amount.toFixed(2)]})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Avg $/Gallon"}),v.jsxs("div",{className:"text-lg font-semibold",children:["$",X.avgPricePerGallon.toFixed(2)]})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Avg Miles/Ticket"}),v.jsx("div",{className:"text-lg font-semibold",children:X.avgMiles.toFixed(1)})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-xs text-slate-600",children:"On-Time %"}),v.jsxs("div",{className:"text-lg font-semibold",children:[X.onTimePct.toFixed(1),"%"]})]})]})]}),C==="ALL"&&ee.length>0&&v.jsxs("div",{className:"rounded-lg border p-4",children:[v.jsx("h3",{className:"font-semibold mb-3",children:"Per-Truck Breakdown"}),v.jsx("div",{className:"overflow-x-hidden max-w-full",children:v.jsxs("table",{className:"w-full text-sm",children:[v.jsx("thead",{className:"bg-slate-50 text-left",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-3 py-2 text-xs",children:"Truck"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Tickets"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Gallons"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Revenue"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Avg $/Gal"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"On-Time %"})]})}),v.jsx("tbody",{children:ee.map(I=>v.jsxs("tr",{className:"border-t",children:[v.jsx("td",{className:"px-3 py-2 font-medium",children:I.truck}),v.jsx("td",{className:"px-3 py-2 tabular-nums",children:I.tickets}),v.jsx("td",{className:"px-3 py-2 tabular-nums",children:I.totalGallons.toFixed(1)}),v.jsxs("td",{className:"px-3 py-2 tabular-nums",children:["$",I.amount.toFixed(2)]}),v.jsxs("td",{className:"px-3 py-2 tabular-nums",children:["$",I.avgPricePerGallon.toFixed(2)]}),v.jsxs("td",{className:"px-3 py-2 tabular-nums",children:[I.onTimePct.toFixed(1),"%"]})]},I.truck))})]})})]}),v.jsxs("div",{className:"delivery-top-bar",role:"region","aria-label":"Delivery header",children:[v.jsx("div",{children:"Delivery Tickets"}),v.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"12px"},children:[v.jsx(Txe,{}),v.jsxs("div",{style:{fontSize:"14px",opacity:.85},children:[J.length," tickets on this page"]})]})]}),v.jsxs("div",{id:"delivery-input-preview",className:"delivery-input-preview","aria-live":"polite",children:[v.jsxs("div",{children:[v.jsx("strong",{children:"Gallons:"})," ",v.jsx("span",{id:"preview-gallons",children:"—"})]}),v.jsxs("div",{children:[v.jsx("strong",{children:"Quantity:"})," ",v.jsx("span",{id:"preview-qty",children:"—"})]}),v.jsxs("div",{children:[v.jsx("strong",{children:"Price:"})," ",v.jsx("span",{id:"preview-price",children:"—"})]}),v.jsxs("div",{children:[v.jsx("strong",{children:"Account:"})," ",v.jsx("span",{id:"preview-account",children:"—"})]})]}),v.jsx("div",{className:"delivery-table-container",children:v.jsx("div",{className:"dt-table-wrap rounded-xl border",onBlurCapture:pe,children:v.jsxs("table",{className:"delivery-table dt-table w-full text-sm",children:[v.jsx("thead",{className:"bg-slate-50 text-left",children:v.jsxs("tr",{children:[v.jsx("th",{className:"dt-th px-2 py-2 text-xs",children:"Date"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs",children:"Truck"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden md:table-cell",children:"Driver"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden lg:table-cell",children:"TicketID"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs",children:"Customer"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs gal",children:"Gallons"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden 2xl:table-cell",children:"Arrival"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden 2xl:table-cell",children:"Odo Start"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden 2xl:table-cell",children:"Odo End"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden 2xl:table-cell",children:"Miles"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden xl:table-cell",children:"On-Time"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden md:table-cell",children:"Account"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs qty",children:"Quantity"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs",children:"Price"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden md:table-cell",children:"Tax"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden md:table-cell",children:"Hazmat"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs amt",children:"Amount"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden lg:table-cell",children:"Status"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs hidden xl:table-cell",children:"Files"}),v.jsx("th",{className:"dt-th px-2 py-2 text-xs"})]})}),v.jsxs("tbody",{children:[J.map(I=>v.jsxs("tr",{className:"border-t",children:[v.jsx("td",{className:"dt-td px-2 py-2 whitespace-nowrap",children:v.jsx("input",{type:"date",value:I.date||"",onChange:K=>B(I.id,"date",K.target.value),className:"input text-xs w-28"})}),v.jsx("td",{className:"dt-td px-2 py-2",children:v.jsx("input",{value:I.truck||"",onChange:K=>B(I.id,"truck",K.target.value),className:"input text-xs w-16"})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden md:table-cell",children:v.jsx("input",{value:I.driver||"",onChange:K=>B(I.id,"driver",K.target.value),className:"input text-xs w-20"})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden lg:table-cell",children:v.jsx("input",{value:I.ticket_id||"",onChange:K=>B(I.id,"ticket_id",K.target.value),className:"input text-xs w-20",placeholder:"ID"})}),v.jsx("td",{className:"dt-td px-2 py-2",children:v.jsx("input",{value:I.customerName||"",onChange:K=>B(I.id,"customerName",K.target.value),className:"input text-xs w-24"})}),v.jsx("td",{className:"dt-td px-2 py-2","data-col":"gallons",children:v.jsx("input",{value:I.gallons_delivered??"",type:"number",step:"0.1",onChange:K=>B(I.id,"gallons_delivered",K.target.value),className:"input text-xs w-16 tabular-nums"})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden 2xl:table-cell whitespace-nowrap",children:v.jsx("input",{type:"datetime-local",value:F6(I.arrival_time),onChange:K=>B(I.id,"arrival_time",I6(K.target.value)),className:"input text-xs w-36"})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden 2xl:table-cell",children:v.jsx("input",{value:I.odometer_start??"",type:"number",step:"0.1",onChange:K=>B(I.id,"odometer_start",K.target.value),className:"input text-xs w-20 tabular-nums",placeholder:"Start"})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden 2xl:table-cell",children:v.jsx("input",{value:I.odometer_end??"",type:"number",step:"0.1",onChange:K=>B(I.id,"odometer_end",K.target.value),className:"input text-xs w-20 tabular-nums",placeholder:"End"})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden 2xl:table-cell",children:v.jsx("span",{className:"text-xs font-mono tabular-nums",children:I.miles_driven!=null?Number(I.miles_driven).toFixed(1):"-"})}),v.jsxs("td",{className:"dt-td px-2 py-2 text-center hidden xl:table-cell",children:[I.on_time_flag===1&&v.jsx("span",{title:"On Time",children:"✅"}),I.on_time_flag===0&&v.jsx("span",{title:"Late",children:"⏱️"}),I.on_time_flag==null&&v.jsx("span",{className:"text-slate-400",children:"-"})]}),v.jsx("td",{className:"dt-td px-2 py-2 hidden md:table-cell","data-col":"account",children:v.jsx("input",{value:I.account||"",onChange:K=>B(I.id,"account",K.target.value),className:"input text-xs w-20"})}),v.jsx("td",{className:"dt-td px-2 py-2","data-col":"qty",children:v.jsx("input",{value:I.qty??"",type:"number",step:"1",onChange:K=>B(I.id,"qty",K.target.value),className:"input text-xs w-14 tabular-nums"})}),v.jsx("td",{className:"dt-td px-2 py-2","data-col":"price",children:v.jsx("input",{value:I.price??"",type:"number",step:"0.01",onChange:K=>B(I.id,"price",K.target.value),className:"input text-xs w-16 tabular-nums"})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden md:table-cell",children:v.jsx("input",{value:I.tax??"",type:"number",step:"0.01",onChange:K=>B(I.id,"tax",K.target.value),className:"input text-xs w-14 tabular-nums"})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden md:table-cell",children:v.jsx("input",{value:I.hazmat_fee??"",type:"number",step:"0.01",onChange:K=>B(I.id,"hazmat_fee",K.target.value),className:"input text-xs w-14 tabular-nums"})}),v.jsx("td",{className:"dt-td px-2 py-2 whitespace-nowrap",children:v.jsxs("span",{className:"text-xs font-mono tabular-nums",children:["$",(I.amount||0).toFixed(2)]})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden lg:table-cell",children:v.jsxs("select",{value:I.status||"draft",onChange:K=>B(I.id,"status",K.target.value),className:"text-xs w-20",children:[v.jsx("option",{value:"draft",children:"draft"}),v.jsx("option",{value:"posted",children:"posted"})]})}),v.jsx("td",{className:"dt-td px-2 py-2 hidden xl:table-cell",children:v.jsxs("div",{className:"flex items-center gap-1",children:[v.jsx("button",{className:"rounded border px-1 py-0.5 text-xs whitespace-nowrap",onClick:()=>Se(I.id),children:"📎"}),(d[I.id]||[]).length>0&&v.jsxs("span",{className:"text-xs text-slate-500",children:["(",(d[I.id]||[]).length,")"]})]})}),v.jsx("td",{className:"dt-td px-2 py-2",children:v.jsx("button",{className:"text-red-600 text-xs",onClick:()=>q(I.id),title:"Remove",children:"✕"})})]},I.id)),!J.length&&v.jsx("tr",{children:v.jsx("td",{colSpan:20,className:"dt-td px-3 py-6 text-center text-slate-500",children:"No tickets match the current filters."})})]})]})})}),v.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4 bg-slate-50",children:[v.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",e.length>0?(m-1)*g+1:0," - ",Math.min(m*g,x)," of ",x," tickets"]}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("button",{onClick:()=>p(I=>Math.max(1,I-1)),disabled:m===1,className:"px-3 py-1.5 rounded border disabled:opacity-50 disabled:cursor-not-allowed",children:"← Previous"}),v.jsxs("span",{className:"text-sm font-medium",children:["Page ",m," of ",Math.max(1,Math.ceil(x/g))]}),v.jsx("button",{onClick:()=>p(I=>I+1),disabled:m*g>=x,className:"px-3 py-1.5 rounded border disabled:opacity-50 disabled:cursor-not-allowed",children:"Next →"}),v.jsx("button",{className:"rounded-lg border px-3 py-1.5 bg-blue-600 text-white hover:bg-blue-700 ml-2",onClick:G,style:{fontWeight:500},children:"+ Add Ticket"})]})]}),at.length>0&&v.jsxs("div",{className:"dt-analytics rounded-lg border p-4",children:[v.jsxs("h3",{className:"font-semibold mb-4",children:["Analytics ",C!=="ALL"&&`(${C})`]}),v.jsxs("div",{className:"space-y-8",children:[v.jsxs("div",{children:[v.jsx("h4",{className:"text-sm font-medium mb-2 text-slate-700",children:"Gallons Delivered by Day"}),v.jsx(ph,{width:"100%",height:250,children:v.jsxs(ep,{data:at,children:[v.jsx(Xh,{strokeDasharray:"3 3"}),v.jsx(Vl,{dataKey:"date",tick:{fontSize:12}}),v.jsx(Kl,{tick:{fontSize:12}}),v.jsx(xn,{}),v.jsx(ai,{}),v.jsx(gi,{type:"monotone",dataKey:"gallons",stroke:"#3b82f6",strokeWidth:2,name:"Gallons"})]})})]}),v.jsxs("div",{children:[v.jsx("h4",{className:"text-sm font-medium mb-2 text-slate-700",children:"Revenue by Day"}),v.jsx(ph,{width:"100%",height:250,children:v.jsxs(ep,{data:at,children:[v.jsx(Xh,{strokeDasharray:"3 3"}),v.jsx(Vl,{dataKey:"date",tick:{fontSize:12}}),v.jsx(Kl,{tick:{fontSize:12}}),v.jsx(xn,{formatter:I=>`$${I.toFixed(2)}`}),v.jsx(ai,{}),v.jsx(gi,{type:"monotone",dataKey:"revenue",stroke:"#10b981",strokeWidth:2,name:"Revenue ($)"})]})})]})]})]}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("button",{className:"rounded-lg border px-3 py-1.5",onClick:ae,children:"Run Edit Listing (Preview)"}),v.jsx("button",{className:"rounded-lg border px-3 py-1.5",onClick:re,disabled:a==="posted",children:"Transfer / Post"}),v.jsx("button",{className:"rounded-lg border px-3 py-1.5",onClick:fe,disabled:a!=="posted",children:"Export to Trucks (PPS)"}),v.jsx("button",{className:"rounded-lg border px-3 py-1.5 bg-blue-50",onClick:de,children:"Export CSV"}),v.jsx("button",{className:"rounded-lg border px-3 py-1.5 bg-green-50",onClick:Ue,children:"Export Excel"})]}),v.jsx("input",{ref:c,type:"file",accept:"*",className:"hidden",onChange:N})]})}function Oxe(e){if(typeof e!="string")return e;const t=e.match(/^="([^"]*)"$/);return t?t[1]:e.startsWith("=")?e.substring(1):e}function Cxe(e){if(!e)return"";let t=String(e);return t=t.replace(/^\uFEFF/,""),t=t.replace(/["""'']/g,""),t=t.replace(/\u00A0/g," "),t=t.toLowerCase().trim(),t=t.replace(/\s+/g," "),t}function Pxe(e){if(e==null||e==="")return null;let t=String(e).trim();t=t.replace(/[$€£¥]/g,""),t=t.replace(/\s/g,""),t=t.replace(/,/g,"");const r=t.split(".");r.length>2&&(t=r.slice(0,-1).join("")+"."+r[r.length-1]);const n=parseFloat(t);return isNaN(n)?null:n}function jxe(e){if(!e)return"unscheduled";const t=String(e).toLowerCase().trim();return t.includes("completed")||t.includes("done")||t.includes("finished")?"completed":t.includes("cancel")||t.includes("void")?"canceled":t.includes("in progress")||t.includes("active")||t.includes("working")?"in_progress":t.includes("scheduled")||t.includes("confirmed")||t.includes("pending")?"scheduled":"unscheduled"}function Nxe(e){if(!e)return null;const t=new Date(e);return isNaN(t.getTime())?null:t.toISOString()}function Fxe(e,t){if(e){const r=new Date(e);if(!isNaN(r.getTime()))return r.toISOString().split("T")[0]}if(t){const r=new Date(t);if(!isNaN(r.getTime()))return r.toISOString().split("T")[0]}return null}function Ixe(e){var r;return e&&((r=String(e).split(",")[0])==null?void 0:r.trim())||null}const Dxe={"job #":"job_number","job#":"job_number","job number":"job_number","job description":"job_description",description:"job_description","job status":"raw_status",status:"raw_status","customer name":"customer_name",customer:"customer_name",address:"address","service address":"address","job created date":"job_created_at","created date":"job_created_at",created:"job_created_at","job scheduled start date":"scheduled_start_at","scheduled start date":"scheduled_start_at","scheduled start":"scheduled_start_at","scheduled date":"scheduled_start_at","assigned employees":"assigned_employees_raw",employees:"assigned_employees_raw",techs:"assigned_employees_raw",technicians:"assigned_employees_raw","job amount":"job_amount",amount:"job_amount",total:"job_amount","due amount":"due_amount",due:"due_amount",balance:"due_amount"};function lI(e){const t=Cxe(e);return Dxe[t]||null}function cI(e,t){const r={raw:e};return t.forEach((n,a)=>{if(!n)return;let i=e[a];i=Oxe(i),n==="job_created_at"||n==="scheduled_start_at"?r[n]=Nxe(i):n==="job_amount"||n==="due_amount"?r[n]=Pxe(i):n==="raw_status"?(r[n]=i,r.status=jxe(i)):r[n]=i||null}),r.job_date=Fxe(r.scheduled_start_at,r.job_created_at),r.primary_tech=Ixe(r.assigned_employees_raw),r}function kA(e){const t=[];let r="",n=!1;for(let a=0;a<e.length;a++){const i=e[a];i==='"'?n=!n:i===","&&!n?(t.push(r.trim()),r=""):r+=i}return t.push(r.trim()),t}function Rxe(e){const t=e.split(/\r?\n/).filter(o=>o.trim());if(t.length===0)throw new Error("CSV file is empty");const r=t[0],a=kA(r).map(o=>lI(o));if(!a.some(o=>o!==null))throw new Error("No recognized columns found. Expected Housecall Pro format with headers like: Job #, Job description, Job status, Customer name, etc.");const s=[];for(let o=1;o<t.length;o++){const l=t[o];if(!l.trim())continue;const c=kA(l),u=cI(c,a);u.job_number&&s.push(u)}return{rows:s,totalRows:s.length,mappedHeaders:a.filter(o=>o!==null)}}function Mxe(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const i=new Uint8Array(a.target.result),s=Vx(i,{type:"array"}),o=s.SheetNames[0],l=s.Sheets[o],c=E0.sheet_to_json(l,{header:1,raw:!1,defval:""});if(c.length===0)throw new Error("Excel file is empty");const f=c[0].map(m=>String(m||"")).map(m=>lI(m));if(!f.some(m=>m!==null))throw new Error("No recognized columns found. Expected Housecall Pro format with headers like: Job #, Job description, Job status, Customer name, etc.");const h=[];for(let m=1;m<c.length;m++){const p=c[m];if(!p||p.length===0)continue;const g=cI(p,f);g.job_number&&h.push(g)}t({rows:h,totalRows:h.length,mappedHeaders:f.filter(m=>m!==null)})}catch(i){r(i)}},n.onerror=()=>{r(new Error("Failed to read file"))},n.readAsArrayBuffer(e)})}async function $xe(e){const t=e.name.toLowerCase();if(t.endsWith(".csv")){const r=await e.text();return Rxe(r)}else{if(t.endsWith(".xlsx")||t.endsWith(".xls"))return await Mxe(e);throw new Error("Unsupported file format. Please upload a CSV or XLSX file.")}}const Lxe=500;function Bxe(e){if(!e||e.length===0)return[];const t=new Map;return e.forEach(r=>{const n=String(r.job_number||"").trim();n&&t.set(n,r)}),Array.from(t.values())}async function Uxe(e,t){var s,o,l;if(!e||e.length===0)throw new Error("No rows to import");const r=Bxe(e);if(r.length===0)throw new Error("No valid jobs found after deduplication");const n=r.map(c=>({job_number:String(c.job_number||"").trim(),job_description:c.job_description||null,status:c.status||"unscheduled",raw_status:c.raw_status||null,customer_name:c.customer_name||null,address:c.address||null,job_created_at:c.job_created_at||null,scheduled_start_at:c.scheduled_start_at||null,job_date:c.job_date||null,assigned_employees_raw:c.assigned_employees_raw||null,primary_tech:c.primary_tech||null,job_amount:c.job_amount||null,due_amount:c.due_amount||null,raw:c.raw||null})),{data:a,error:i}=await be.rpc("service_jobs_bulk_upsert",{rows:n});if(i)throw console.error("Bulk upsert error:",i),i.code==="42883"?new Error("RPC function 'service_jobs_bulk_upsert' does not exist. Please run the setup migration."):i.code==="42P01"?new Error("Table 'service_jobs' does not exist. Please run the setup migration."):i.code==="42501"||(s=i.message)!=null&&s.includes("permission denied")?new Error("Permission denied. Please ensure you are authenticated and have the required permissions."):(o=i.message)!=null&&o.includes("JWT")||(l=i.message)!=null&&l.includes("Not authenticated")?new Error("Authentication required. Please sign in and try again."):new Error(i.message||"Failed to save jobs to database");return{success:!0,inserted:(a==null?void 0:a.inserted)||0,updated:(a==null?void 0:a.updated)||0,total:(a==null?void 0:a.total)||0}}async function Wxe(e={}){var s,o;const{data:t}=await be.auth.getUser(),r=(s=t==null?void 0:t.user)==null?void 0:s.id;if(!r)throw new Error("Not authenticated");let n=be.from("service_jobs").select("*").eq("created_by",r);e.startDate&&(n=n.gte("job_date",e.startDate)),e.endDate&&(n=n.lte("job_date",e.endDate)),e.status&&e.status!=="all"&&(n=n.eq("status",e.status)),e.tech&&e.tech!=="all"&&(n=n.eq("primary_tech",e.tech)),n=n.order("job_date",{ascending:!1,nullsLast:!0}).limit(Lxe);const{data:a,error:i}=await n;if(i)throw console.error("Fetch error:",i),i.code==="42P01"?new Error("Table 'service_jobs' does not exist. Please run the setup migration."):(o=i.message)!=null&&o.includes("JWT")?new Error("Authentication required. Please sign in and try again."):new Error(i.message||"Failed to fetch jobs from database");return a||[]}function EA(e){const t={overall:{count:e.length,revenue:0,due:0},byStatus:{completed:{count:0,revenue:0,due:0},scheduled:{count:0,revenue:0,due:0},in_progress:{count:0,revenue:0,due:0},unscheduled:{count:0,revenue:0,due:0},canceled:{count:0,revenue:0,due:0}}};return e.forEach(r=>{const n=Number(r.job_amount)||0,a=Number(r.due_amount)||0,i=r.status||"unscheduled";t.overall.revenue+=n,t.overall.due+=a,t.byStatus[i]||(t.byStatus[i]={count:0,revenue:0,due:0}),t.byStatus[i].count+=1,t.byStatus[i].revenue+=n,t.byStatus[i].due+=a}),t}function zxe(e){const t=new Set;return e.forEach(r=>{r.primary_tech&&t.add(r.primary_tech)}),Array.from(t).sort()}async function Hxe(e){const{error:t}=await be.from("service_jobs").delete().eq("id",e);if(t)throw console.error("Delete error:",t),t;return!0}async function Vxe(){try{const{error:e}=await be.from("service_jobs").select("id").limit(0);return e?e.code!=="42P01":!0}catch(e){return console.error("Schema check error:",e),!1}}function Gxe(){const[e,t]=R.useState(!1),r=R.useRef(null),n=async a=>{const i=a.target.files;if(!(!i||i.length===0)){t(!0);try{console.debug("[ServiceUploadButton] Uploading files:",i.length);const s=Array.from(i).map(u=>new Promise((f,d)=>{const h=new FileReader;h.onload=()=>{const m=h.result.split(",")[1];f({filename:u.name,mimeType:u.type,data:m})},h.onerror=d,h.readAsDataURL(u)})),o=await Promise.all(s),l=await fetch("/api/imports/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:o,meta:{}})});if(!l.ok){const u=await l.json();throw new Error(u.message||"Upload failed")}const c=await l.json();console.debug("[ServiceUploadButton] Upload success:",c),c.importId&&(console.debug("[ServiceUploadButton] Triggering processing for import:",c.importId),fetch("/api/imports/process",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({importId:c.importId})}).catch(u=>{console.error("[ServiceUploadButton] Processing error:",u)})),alert(`Successfully uploaded ${c.files.length} file(s). Processing started.`),r.current&&(r.current.value="")}catch(s){console.error("[ServiceUploadButton] Error:",s),alert("Upload failed: "+s.message)}finally{t(!1)}}};return v.jsxs(v.Fragment,{children:[v.jsx("button",{className:"rounded-lg border px-3 py-1.5 bg-green-600 text-white hover:bg-green-700 disabled:opacity-50",onClick:()=>{var a;return(a=r.current)==null?void 0:a.click()},disabled:e,title:"Upload scanned service tickets (PDF/Image)",children:e?"⏳ Uploading...":"📄 Upload Service Scan"}),v.jsx("input",{ref:r,type:"file",accept:".pdf,.jpg,.jpeg,.png,.gif",multiple:!0,className:"hidden",onChange:n})]})}function Kxe(e){const t={completed:{bg:"#dcfce7",border:"#bbf7d0",text:"#166534"},scheduled:{bg:"#dbeafe",border:"#bfdbfe",text:"#1e40af"},in_progress:{bg:"#fed7aa",border:"#fdba74",text:"#9a3412"},unscheduled:{bg:"#f3f4f6",border:"#e5e7eb",text:"#374151"},canceled:{bg:"#fee2e2",border:"#fecaca",text:"#991b1b"}};return t[e]||t.unscheduled}function f0({status:e}){const t=Kxe(e);return v.jsx("span",{style:{display:"inline-block",padding:"4px 8px",borderRadius:"9999px",fontSize:"12px",fontWeight:500,backgroundColor:t.bg,color:t.text,border:`1px solid ${t.border}`},children:e.replace(/_/g," ")})}function qxe(){var le,Se,N,Re;const[e,t]=R.useState([]),[r,n]=R.useState(null),[a,i]=R.useState(!1),[s,o]=R.useState(!1),[l,c]=R.useState(!1),[u,f]=R.useState(""),[d,h]=R.useState(""),[m,p]=R.useState(!1),[g,x]=R.useState(!1),[w,y]=R.useState(!1),[k,b]=R.useState(null),[_,S]=R.useState("all"),[E,T]=R.useState(""),[F,C]=R.useState(""),[A,M]=R.useState("ALL"),[V,z]=R.useState("all"),Y=R.useRef(null);async function J(){var re;const{data:ae}=await be.auth.getUser();return((re=ae==null?void 0:ae.user)==null?void 0:re.id)??null}async function Q(){const ae=await Wxe();return t(ae),ae}async function j(){c(!0),f(""),h("");try{await Q(),h("Data reloaded successfully"),setTimeout(()=>h(""),3e3)}catch(ae){console.error("Reload error:",ae),f(`Failed to reload: ${ae.message}`)}finally{c(!1)}}R.useEffect(()=>{async function ae(){const re=await J();b(re),await Vxe()||p(!0),await j()}ae()},[]);async function X(ae){var fe;const re=(fe=ae.target.files)==null?void 0:fe[0];if(re){i(!0),f(""),h("");try{const de=await $xe(re);n(de)}catch(de){console.error("Parse error:",de),f(`Failed to parse file: ${de.message}`)}finally{i(!1),ae.target.value=""}}}async function ee(){if(r){o(!0),f(""),h("");try{const ae=await J();if(!ae)throw new Error("Not authenticated");const re=await Uxe(r.rows,ae),fe=[];re.inserted>0&&fe.push(`${re.inserted} new job(s)`),re.updated>0&&fe.push(`${re.updated} updated`),h(`Successfully imported: ${fe.join(", ")}. Total: ${re.total} job(s).`),n(null),await j()}catch(ae){console.error("Import error:",ae),f(`Failed to import: ${ae.message}`)}finally{o(!1)}}}function P(){n(null),f("")}async function G(ae){if(confirm("Delete this job? This cannot be undone."))try{await Hxe(ae),t(e.filter(re=>re.id!==ae)),h("Job deleted successfully")}catch(re){console.error("Delete error:",re),f(`Failed to delete: ${re.message}`)}}const B=R.useMemo(()=>{if(_==="all")return e;const ae=new Date;let re,fe;if(_==="today")re=new Date(ae.getFullYear(),ae.getMonth(),ae.getDate()),fe=new Date(ae.getFullYear(),ae.getMonth(),ae.getDate()+1);else if(_==="week"){const de=ae.getDay();re=new Date(ae.getFullYear(),ae.getMonth(),ae.getDate()-de),fe=new Date(ae.getFullYear(),ae.getMonth(),ae.getDate()+(7-de))}else if(_==="month")re=new Date(ae.getFullYear(),ae.getMonth(),1),fe=new Date(ae.getFullYear(),ae.getMonth()+1,1);else if(_==="year")re=new Date(ae.getFullYear(),0,1),fe=new Date(ae.getFullYear()+1,0,1);else if(_==="custom"){if(!E&&!F)return e;re=E?new Date(E):new Date(0),fe=F?new Date(new Date(F).getTime()+864e5):new Date(864e13)}return e.filter(de=>{if(!de.job_date)return!1;const Ue=new Date(de.job_date);return Ue>=re&&Ue<fe})},[e,_,E,F]),q=R.useMemo(()=>A==="ALL"?B:B.filter(ae=>ae.primary_tech===A),[B,A]),ne=R.useMemo(()=>V==="all"?q:q.filter(ae=>ae.status===V),[q,V]),ye=R.useMemo(()=>zxe(B),[B]),pe=R.useMemo(()=>EA(ne),[ne]),te=R.useMemo(()=>r?EA(r.rows):null,[r]);return v.jsxs("div",{className:"space-y-6",children:[v.jsxs("header",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("h2",{className:"text-xl font-semibold",children:"Service Tracking"}),w&&k&&v.jsxs("span",{className:"text-xs px-2 py-1 rounded bg-slate-100 text-slate-600 font-mono",title:"Current User ID",children:[k.slice(0,8),"..."]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{className:"rounded-lg border px-3 py-1.5 bg-white hover:bg-slate-50 disabled:opacity-50",onClick:j,disabled:l,title:"Reload saved jobs from database",children:l?"⏳ Reloading...":"🔄 Reload"}),v.jsx("button",{className:"rounded-lg border px-3 py-1.5 bg-blue-600 text-white hover:bg-blue-700",onClick:()=>{var ae;return(ae=Y.current)==null?void 0:ae.click()},disabled:a,children:a?"Processing...":"Upload Report"}),v.jsx(Gxe,{})]}),v.jsx("input",{ref:Y,type:"file",accept:".csv,.xlsx,.xls",className:"hidden",onChange:X})]}),m&&!g&&v.jsx("div",{className:"rounded-lg border border-yellow-300 bg-yellow-50 p-4",children:v.jsxs("div",{className:"flex items-start justify-between",children:[v.jsxs("div",{className:"flex-1",children:[v.jsx("strong",{className:"text-yellow-800",children:"⚠️ Setup Required:"}),v.jsxs("p",{className:"text-yellow-700 mt-1",children:["The ",v.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"service_jobs"})," table is missing. Preview and import will work, but data cannot be saved until you run the setup migration."]}),v.jsxs("p",{className:"text-yellow-700 mt-2 text-sm",children:["👉 Run the SQL file:",v.jsx("code",{className:"bg-yellow-100 px-1 rounded ml-1",children:"sql/2025-10-16_service_tracking.sql"})," ","in your Supabase SQL editor."]})]}),v.jsx("button",{className:"text-yellow-800 hover:text-yellow-900 ml-4",onClick:()=>x(!0),title:"Dismiss",children:"✕"})]})}),u&&v.jsxs("div",{className:"rounded-lg border border-red-300 bg-red-50 p-4 text-red-800",children:[v.jsx("strong",{children:"Error:"})," ",u]}),d&&v.jsxs("div",{className:"rounded-lg border border-green-300 bg-green-50 p-4 text-green-800",children:[v.jsx("strong",{children:"Success:"})," ",d]}),r&&v.jsxs("div",{className:"rounded-lg border bg-white p-6 shadow-sm",children:[v.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview Import"}),v.jsxs("div",{className:"mb-4 rounded-lg border bg-slate-50 p-4",children:[v.jsx("h4",{className:"font-semibold mb-3",children:"Summary by Status"}),v.jsx("div",{className:"grid gap-3 sm:grid-cols-3 lg:grid-cols-5",children:Object.entries(te.byStatus).map(([ae,re])=>v.jsxs("div",{className:"rounded-lg border bg-white p-3",children:[v.jsx("div",{className:"mb-2",children:v.jsx(f0,{status:ae})}),v.jsxs("div",{className:"text-sm",children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Count"}),v.jsx("div",{className:"font-semibold",children:re.count})]}),v.jsxs("div",{className:"text-sm mt-1",children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Revenue"}),v.jsxs("div",{className:"font-semibold",children:["$",re.revenue.toFixed(2)]})]}),v.jsxs("div",{className:"text-sm mt-1",children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Due"}),v.jsxs("div",{className:"font-semibold",children:["$",re.due.toFixed(2)]})]})]},ae))}),v.jsxs("div",{className:"mt-4 pt-4 border-t",children:[v.jsxs("div",{className:"font-semibold",children:["Total: ",te.overall.count," jobs • Revenue: $",te.overall.revenue.toFixed(2)," • Due: $",te.overall.due.toFixed(2)]}),v.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:["Completed Revenue: $",(((le=te.byStatus.completed)==null?void 0:le.revenue)||0).toFixed(2)," • Pipeline: $",((te.overall.revenue||0)-(((Se=te.byStatus.completed)==null?void 0:Se.revenue)||0)).toFixed(2)]})]})]}),v.jsxs("div",{className:"mb-4",children:[v.jsx("h4",{className:"font-semibold mb-2",children:"Preview Rows (first 100)"}),v.jsx("div",{className:"overflow-x-auto rounded-lg border max-h-96",children:v.jsxs("table",{className:"w-full text-sm",children:[v.jsx("thead",{className:"bg-slate-50 text-left sticky top-0 z-10",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-3 py-2 text-xs",children:"Job #"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Customer"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Status"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Date"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Tech"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Amount"})]})}),v.jsx("tbody",{children:r.rows.slice(0,100).map((ae,re)=>v.jsxs("tr",{className:"border-t",children:[v.jsx("td",{className:"px-3 py-2",children:ae.job_number}),v.jsx("td",{className:"px-3 py-2",children:ae.customer_name}),v.jsx("td",{className:"px-3 py-2",children:v.jsx(f0,{status:ae.status})}),v.jsx("td",{className:"px-3 py-2",children:ae.job_date||"-"}),v.jsx("td",{className:"px-3 py-2",children:ae.primary_tech||"-"}),v.jsxs("td",{className:"px-3 py-2",children:["$",(ae.job_amount||0).toFixed(2)]})]},re))})]})}),r.rows.length>100&&v.jsxs("div",{className:"text-sm text-slate-600 mt-2",children:["Showing 100 of ",r.rows.length," rows"]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{className:"rounded-lg border px-4 py-2 bg-blue-600 text-white hover:bg-blue-700",onClick:ee,disabled:s,children:s?"Importing...":"Import to Database"}),v.jsx("button",{className:"rounded-lg border px-4 py-2 hover:bg-slate-50",onClick:P,disabled:s,children:"Cancel"})]})]}),!r&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"rounded-lg border p-4 bg-slate-50",children:v.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[v.jsx("label",{className:"font-semibold",children:"Filters:"}),v.jsx("button",{className:`px-3 py-1 rounded ${_==="all"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>S("all"),children:"All"}),v.jsx("button",{className:`px-3 py-1 rounded ${_==="today"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>S("today"),children:"Today"}),v.jsx("button",{className:`px-3 py-1 rounded ${_==="week"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>S("week"),children:"This Week"}),v.jsx("button",{className:`px-3 py-1 rounded ${_==="month"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>S("month"),children:"This Month"}),v.jsx("button",{className:`px-3 py-1 rounded ${_==="year"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>S("year"),children:"This Year"}),v.jsx("button",{className:`px-3 py-1 rounded ${_==="custom"?"bg-blue-600 text-white":"bg-white border"}`,onClick:()=>S("custom"),children:"Custom Range"}),_==="custom"&&v.jsxs(v.Fragment,{children:[v.jsx("input",{type:"date",value:E,onChange:ae=>T(ae.target.value),className:"px-2 py-1 border rounded text-sm",placeholder:"Start"}),v.jsx("span",{children:"to"}),v.jsx("input",{type:"date",value:F,onChange:ae=>C(ae.target.value),className:"px-2 py-1 border rounded text-sm",placeholder:"End"})]})]})}),v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"font-semibold",children:"Tech:"}),v.jsxs("select",{value:A,onChange:ae=>M(ae.target.value),className:"px-3 py-1.5 border rounded",children:[v.jsx("option",{value:"ALL",children:"All Techs"}),ye.map(ae=>v.jsx("option",{value:ae,children:ae},ae))]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("label",{className:"font-semibold",children:"Status:"}),v.jsxs("select",{value:V,onChange:ae=>z(ae.target.value),className:"px-3 py-1.5 border rounded",children:[v.jsx("option",{value:"all",children:"All Statuses"}),v.jsx("option",{value:"completed",children:"Completed"}),v.jsx("option",{value:"scheduled",children:"Scheduled"}),v.jsx("option",{value:"in_progress",children:"In Progress"}),v.jsx("option",{value:"unscheduled",children:"Unscheduled"}),v.jsx("option",{value:"canceled",children:"Canceled"})]})]}),v.jsxs("span",{className:"text-sm text-slate-600",children:["Showing ",ne.length," of ",e.length," jobs"]})]}),v.jsxs("div",{className:"rounded-lg border p-4",children:[v.jsx("h3",{className:"font-semibold mb-3",children:"Summary"}),v.jsx("div",{className:"grid gap-3 sm:grid-cols-3 lg:grid-cols-5",children:Object.entries(pe.byStatus).map(([ae,re])=>v.jsxs("div",{className:"rounded-lg border bg-slate-50 p-3",children:[v.jsx("div",{className:"mb-2",children:v.jsx(f0,{status:ae})}),v.jsxs("div",{className:"text-sm",children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Count"}),v.jsx("div",{className:"font-semibold",children:re.count})]}),v.jsxs("div",{className:"text-sm mt-1",children:[v.jsx("div",{className:"text-xs text-slate-600",children:"Revenue"}),v.jsxs("div",{className:"font-semibold",children:["$",re.revenue.toFixed(2)]})]})]},ae))}),v.jsx("div",{className:"mt-4 pt-4 border-t",children:v.jsxs("div",{className:"font-semibold",children:["Total: ",pe.overall.count," jobs • Completed Revenue: $",(((N=pe.byStatus.completed)==null?void 0:N.revenue)||0).toFixed(2)," • Pipeline: $",((pe.overall.revenue||0)-(((Re=pe.byStatus.completed)==null?void 0:Re.revenue)||0)).toFixed(2)]})})]}),v.jsx("div",{className:"rounded-lg border",children:v.jsxs("table",{className:"w-full text-sm",children:[v.jsx("thead",{className:"bg-slate-50 text-left",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-3 py-2 text-xs",children:"Job #"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Customer"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Status"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Date"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Tech"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Defers"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Description"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Amount"}),v.jsx("th",{className:"px-3 py-2 text-xs",children:"Due"}),v.jsx("th",{className:"px-3 py-2 text-xs"})]})}),v.jsxs("tbody",{children:[ne.map(ae=>v.jsxs("tr",{className:"border-t",children:[v.jsx("td",{className:"px-3 py-2",children:ae.job_number}),v.jsx("td",{className:"px-3 py-2",children:ae.customer_name}),v.jsx("td",{className:"px-3 py-2",children:v.jsx(f0,{status:ae.status})}),v.jsx("td",{className:"px-3 py-2",children:ae.job_date||"-"}),v.jsx("td",{className:"px-3 py-2",children:ae.primary_tech||"-"}),v.jsx("td",{className:"px-3 py-2 tabular-nums",children:ae.reschedule_count||0}),v.jsx("td",{className:"px-3 py-2 max-w-xs truncate",children:ae.job_description||"-"}),v.jsxs("td",{className:"px-3 py-2 tabular-nums",children:["$",(ae.job_amount||0).toFixed(2)]}),v.jsxs("td",{className:"px-3 py-2 tabular-nums",children:["$",(ae.due_amount||0).toFixed(2)]}),v.jsx("td",{className:"px-3 py-2",children:v.jsx("button",{className:"text-red-600 text-xs hover:text-red-800",onClick:()=>G(ae.id),title:"Delete",children:"✕"})})]},ae.id)),ne.length===0&&v.jsx("tr",{children:v.jsx("td",{colSpan:10,className:"px-3 py-6 text-center text-slate-500",children:"No jobs found. Upload a Housecall Pro report to get started."})})]})]})})]})]})}function Ta({title:e,value:t,sub:r,right:n,style:a,children:i}){return v.jsxs("div",{style:{background:"white",border:"1px solid #E5E7EB",borderRadius:12,padding:16,...a},children:[v.jsxs("div",{style:{display:"flex",alignItems:"baseline"},children:[v.jsx("div",{style:{fontSize:12,color:"#6B7280",fontWeight:500},children:e}),v.jsx("div",{style:{marginLeft:"auto"},children:n})]}),t!==void 0&&v.jsx("div",{style:{fontSize:24,fontWeight:700,marginTop:6},children:t}),r&&v.jsx("div",{style:{fontSize:12,color:"#6B7280",marginTop:4},children:r}),i]})}function Kc({title:e,actions:t,children:r}){return v.jsxs("section",{style:{marginTop:24},children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:12},children:[v.jsx("h3",{style:{margin:0,fontSize:16},children:e}),v.jsx("div",{style:{marginLeft:"auto"},children:t})]}),v.jsx("div",{children:r})]})}function Xxe({data:e=[],height:t=60,stroke:r="#111827",fill:n="rgba(17,24,39,0.08)"}){const a=Math.max(100,Math.max(2,e.length)*14),i=Math.max(1,...e),s=Math.min(0,...e),o=Math.max(1,i-s),l=e.map((f,d)=>{const h=d/Math.max(e.length-1,1)*(a-10)+5,m=t-(f-s)/o*(t-10)-5;return[h,m]}),c=l.map(([f,d],h)=>h?`L ${f} ${d}`:`M ${f} ${d}`).join(" "),u=l.length?`M ${l[0][0]} ${t-5} L ${l.map(([f,d])=>`${f} ${d}`).join(" L ")} L ${l[l.length-1][0]} ${t-5} Z`:"";return v.jsxs("svg",{viewBox:`0 0 ${a} ${t}`,style:{width:"100%",height:t},children:[v.jsx("path",{d:u,fill:n}),v.jsx("path",{d:c,fill:"none",stroke:r,strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round"})]})}function TA({categories:e=[],series:t=[],height:r=160}){const i=Math.max(80,e.length*38+10),s=e.map((c,u)=>t.reduce((f,d)=>f+(d.values[u]||0),0)),o=Math.max(1,...s),l=c=>c/o*(r-20);return v.jsx("svg",{viewBox:`0 0 ${i} ${r}`,style:{width:"100%",height:r},children:e.map((c,u)=>{const f=5+u*38;let d=r-10;return v.jsx("g",{children:t.map(h=>{const m=h.values[u]||0,p=l(m);return d-=p,v.jsx("rect",{x:f,y:d,width:24,height:p,fill:h.color,rx:"3"},h.name)})},c)})})}function Yxe({rows:e=[]}){const t=Math.max(1,...e.map(r=>r.value||0));return v.jsx("div",{style:{display:"grid",gap:8},children:e.map(r=>v.jsxs("div",{children:[v.jsxs("div",{style:{display:"flex",alignItems:"baseline"},children:[v.jsx("div",{style:{fontSize:12,color:"#6B7280"},children:r.label}),v.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6B7280"},children:["$",Math.round(r.value||0).toLocaleString()]})]}),v.jsx("div",{style:{height:10,background:"#F3F4F6",borderRadius:999,overflow:"hidden"},children:v.jsx("div",{style:{width:`${Math.round((r.value||0)/t*100)}%`,height:"100%",background:"#111827"}})})]},r.label))})}function $o(e){return new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().slice(0,10)}function Gx(e){const t=new Date;if(e==="30d"){const r=new Date;return r.setDate(t.getDate()-29),{from:$o(r),to:$o(t),label:"Last 30 days"}}if(e==="mtd"){const r=new Date(t.getFullYear(),t.getMonth(),1);return{from:$o(r),to:$o(t),label:"This month"}}if(e==="ytd"){const r=new Date(t.getFullYear(),0,1);return{from:$o(r),to:$o(t),label:"Year to date"}}return Gx("30d")}function d0(e){const t=(e==null?void 0:e.date)||(e==null?void 0:e.scheduled_window_start)||(e==null?void 0:e.created_at);if(!t)return null;const r=new Date(t);return isNaN(+r)?null:r}function AA(e){return e.toISOString().slice(0,10)}function Jxe(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=(t.getUTCDay()+6)%7;t.setUTCDate(t.getUTCDate()-r+3);const n=new Date(Date.UTC(t.getUTCFullYear(),0,4)),a=1+Math.round(((t-n)/864e5-3)/7);return`${t.getUTCFullYear()}-W${String(a).padStart(2,"0")}`}function Qxe(e,t){return t==="day"?AA(e):t==="week"?Jxe(e):t==="month"?`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`:t==="year"?String(e.getFullYear()):AA(e)}function Zxe(e,t){if(t==="day")return e;if(t==="week"){const[r,n]=e.split("-W");return`W${n} ${r}`}return e}function e1e(){var k,b,_,S,E,T;const[e,t]=R.useState("30d"),[r,n]=R.useState(Gx("30d")),[a,i]=R.useState(!0),[s,o]=R.useState(""),[l,c]=R.useState([]),[u,f]=R.useState([]),[d,h]=R.useState([]),[m,p]=R.useState("day");R.useEffect(()=>{n(Gx(e))},[e]),R.useEffect(()=>{let F=!0;async function C(){i(!0),o("");try{const{from:A,to:M}=r,{data:V,error:z}=await be.from("service_jobs").select("job_date,status,job_amount").gte("job_date",A).lte("job_date",M).order("job_date",{ascending:!0});if(z)throw z;const{data:Y,error:J}=await be.from("service_job_techs").select("tech_name, job_amount, job_date").gte("job_date",A).lte("job_date",M);if(J)throw J;const{data:Q,error:j}=await be.from("delivery_tickets").select("date, scheduled_window_start, created_at, amount, gallons_delivered, qty, status, truck").limit(5e3);if(j)throw j;if(!F)return;const X=new Date(A+"T00:00:00"),ee=new Date(M+"T23:59:59"),P=(Array.isArray(Q)?Q:[]).filter(G=>{const B=d0(G);return B&&B>=X&&B<=ee});c(Array.isArray(V)?V:[]),f(Array.isArray(Y)?Y:[]),h(P)}catch(A){o((A==null?void 0:A.message)||String(A))}finally{i(!1)}}return C(),()=>{F=!1}},[r]);const g=R.useMemo(()=>{const F=re=>re?String(re).slice(0,10):"",C=Array.from(new Set(l.map(re=>F(re.job_date)))).sort(),A=new Map,M=(re,fe,de,Ue,at)=>{A.has(re)||A.set(re,new Map);const I=A.get(re),K=I.get(fe)||{count:0,revenue:0,due:0};I.set(fe,{count:K.count+(de||0),revenue:K.revenue+(Ue||0),due:K.due+(at||0)})};l.forEach(re=>M(F(re.job_date),re.status,re.job_count||0,Number(re.total_revenue||0),Number(re.total_due||0)));const V=C.map(re=>{var fe,de;return((de=(fe=A.get(re))==null?void 0:fe.get("completed"))==null?void 0:de.revenue)||0}),z=[{name:"Completed",key:"completed",color:"#16A34A"},{name:"Scheduled",key:"scheduled",color:"#4338CA"},{name:"In Progress",key:"in_progress",color:"#F59E0B"},{name:"Canceled",key:"canceled",color:"#DC2626"}].map(re=>({name:re.name,color:re.color,values:C.map(fe=>{var de,Ue;return((Ue=(de=A.get(fe))==null?void 0:de.get(re.key))==null?void 0:Ue.count)||0})})),Y=l.filter(re=>re.status==="completed").reduce((re,fe)=>re+Number(fe.total_revenue||0),0),J=["scheduled","in_progress"].reduce((re,fe)=>re+l.filter(de=>de.status===fe).reduce((de,Ue)=>de+Number(Ue.total_revenue||0),0),0),Q={completed:l.filter(re=>re.status==="completed").reduce((re,fe)=>re+(fe.job_count||0),0),scheduled:l.filter(re=>re.status==="scheduled").reduce((re,fe)=>re+(fe.job_count||0),0),inProgress:l.filter(re=>re.status==="in_progress").reduce((re,fe)=>re+(fe.job_count||0),0),canceled:l.filter(re=>re.status==="canceled").reduce((re,fe)=>re+(fe.job_count||0),0)},j=Array.from(new Set(d.map(re=>{const fe=d0(re);return fe?fe.toISOString().slice(0,10):null}).filter(Boolean))).sort(),X=new Map,ee=(re,fe,de)=>{X.has(re)||X.set(re,{amount:0,statusCounts:{}});const Ue=X.get(re);Ue.amount+=Number(fe||0);const at=String(de||"{}").toLowerCase();Ue.statusCounts[at]=(Ue.statusCounts[at]||0)+1};d.forEach(re=>{const fe=d0(re);if(!fe)return;const de=fe.toISOString().slice(0,10);ee(de,re.amount,re.status)});const P=j.map(re=>{var fe;return((fe=X.get(re))==null?void 0:fe.amount)||0}),G=new Map,B=[];d.forEach(re=>{const fe=d0(re);if(!fe)return;const de=Qxe(fe,m);G.has(de)||(G.set(de,{amount:0,statusCounts:{}}),B.push(de));const Ue=G.get(de);Ue.amount+=Number(re.amount||0);const at=String(re.status||"{}").toLowerCase();Ue.statusCounts[at]=(Ue.statusCounts[at]||0)+1});const q=B.sort(),ne=[{name:"Delivered",key:"delivered",color:"#16A34A"},{name:"Scheduled",key:"scheduled",color:"#4338CA"},{name:"Issues",key:"issue",color:"#DC2626"}].map(re=>({name:re.name,color:re.color,values:q.map(fe=>{var de;return((de=G.get(fe))==null?void 0:de.statusCounts[re.key])||0})})),ye={tickets:d.length,gallons:d.reduce((re,fe)=>re+(Number(fe.gallons_delivered??fe.qty)||0),0),revenue:d.reduce((re,fe)=>re+(Number(fe.amount)||0),0)},pe=ye.gallons>0?ye.revenue/ye.gallons:0,te=Array.from(new Set([...C,...j])).sort(),le=new Map(C.map((re,fe)=>[re,V[fe]||0])),Se=new Map(j.map((re,fe)=>[re,P[fe]||0])),N=te.map(re=>(le.get(re)||0)+(Se.get(re)||0)),Re=new Map;u.forEach(re=>{const fe=(re.tech_name||"").trim()||"Unassigned";Re.set(fe,(Re.get(fe)||0)+Number(re.job_amount||0))});const ae=Array.from(Re.entries()).map(([re,fe])=>({label:re,value:fe})).sort((re,fe)=>fe.value-re.value).slice(0,7);return{serviceDays:C,serviceCompletedRevenueByDay:V,serviceSeriesStatus:z,svcCompletedRevenue:Y,svcPipelineRevenue:J,svcCounts:Q,ticketsDays:j,deliveriesRevenueByDay:P,ticketsBuckets:q,deliveriesSeriesStatus:ne,deliveriesTotals:ye,deliveriesAvgPrice:pe,allDays:te,combinedRevenueByDay:N,topTechs:ae}},[l,u,d,m]),x=F=>"$"+Math.round(F||0).toLocaleString(),w=F=>(F||0).toLocaleString(),y=(g.svcCompletedRevenue||0)+(((k=g.deliveriesTotals)==null?void 0:k.revenue)||0);return v.jsxs("div",{style:{display:"grid",gap:16},children:[v.jsxs(Kc,{title:"Executive Overview",actions:v.jsxs("div",{style:{display:"flex",gap:8},children:[v.jsxs("select",{value:e,onChange:F=>t(F.target.value),style:{padding:"8px 10px",border:"1px solid #E5E7EB",borderRadius:8},children:[v.jsx("option",{value:"30d",children:"Last 30 days"}),v.jsx("option",{value:"mtd",children:"This month"}),v.jsx("option",{value:"ytd",children:"Year to date"})]}),v.jsxs("div",{style:{alignSelf:"center",fontSize:12,color:"#6B7280"},children:[r.label," • ",r.from," → ",r.to]})]}),children:[s&&v.jsx("div",{style:{color:"#b91c1c",fontSize:12,marginBottom:8},children:s}),v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, minmax(180px, 1fr))",gap:12},children:[v.jsx(Ta,{title:"Total Revenue (Service + Deliveries)",value:x(y),sub:"Sum over range"}),v.jsx(Ta,{title:"Service Revenue (Completed)",value:x(g.svcCompletedRevenue)}),v.jsx(Ta,{title:"Delivery Revenue",value:x((b=g.deliveriesTotals)==null?void 0:b.revenue)}),v.jsx(Ta,{title:"Service Jobs — Completed",value:w((_=g.svcCounts)==null?void 0:_.completed)}),v.jsx(Ta,{title:"Service Pipeline (Sched + In Prog)",value:x(g.svcPipelineRevenue)}),v.jsx(Ta,{title:"Delivery Gallons",value:w((S=g.deliveriesTotals)==null?void 0:S.gallons),sub:"Avg $"+(g.deliveriesAvgPrice||0).toFixed(2)+"/gal"})]})]}),v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:16},children:[v.jsx(Kc,{title:"Combined Revenue Trend",children:v.jsxs(Ta,{children:[v.jsx(Xxe,{data:g.combinedRevenueByDay||[]}),v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,color:"#6B7280",marginTop:6},children:[v.jsx("span",{children:((E=g.allDays)==null?void 0:E[0])||""}),v.jsx("span",{children:((T=g.allDays)==null?void 0:T[g.allDays.length-1])||""})]})]})}),v.jsx(Kc,{title:"Top Technicians (Service Revenue)",children:v.jsx(Ta,{children:v.jsx(Yxe,{rows:g.topTechs||[]})})})]}),v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[v.jsx(Kc,{title:"Service — Jobs by Status (Daily)",children:v.jsxs(Ta,{children:[v.jsx(TA,{categories:g.serviceDays,series:g.serviceSeriesStatus}),v.jsx("div",{style:{display:"flex",gap:12,marginTop:8,fontSize:12,color:"#6B7280",flexWrap:"wrap"},children:g.serviceSeriesStatus.map(F=>v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[v.jsx("span",{style:{width:12,height:12,background:F.color,display:"inline-block",borderRadius:3}}),F.name]},F.name))})]})}),v.jsx(Kc,{title:"Deliveries — Tickets by Status",actions:v.jsxs("select",{value:m,onChange:F=>p(F.target.value),style:{padding:"6px 10px",border:"1px solid #E5E7EB",borderRadius:8},title:"Group by",children:[v.jsx("option",{value:"day",children:"Day"}),v.jsx("option",{value:"week",children:"Week"}),v.jsx("option",{value:"month",children:"Month"}),v.jsx("option",{value:"year",children:"Year"})]}),children:v.jsxs(Ta,{children:[v.jsx(TA,{categories:g.ticketsBuckets.map(F=>Zxe(F,m)),series:g.deliveriesSeriesStatus}),v.jsx("div",{style:{display:"flex",gap:12,marginTop:8,fontSize:12,color:"#6B7280",flexWrap:"wrap"},children:g.deliveriesSeriesStatus.map(F=>v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[v.jsx("span",{style:{width:12,height:12,background:F.color,display:"inline-block",borderRadius:3}}),F.name]},F.name))})]})})]})]})}function t1e({targetId:e="billboard-root",className:t=""}){const[r,n]=R.useState(!1),a=R.useCallback(()=>{const o=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;n(!!o)},[]);R.useEffect(()=>(document.addEventListener("fullscreenchange",a),document.addEventListener("webkitfullscreenchange",a),document.addEventListener("mozfullscreenchange",a),document.addEventListener("MSFullscreenChange",a),()=>{document.removeEventListener("fullscreenchange",a),document.removeEventListener("webkitfullscreenchange",a),document.removeEventListener("mozfullscreenchange",a),document.removeEventListener("MSFullscreenChange",a)}),[a]);const i=async()=>{try{const o=document.getElementById(e)||document.documentElement;if(!o)return;o.requestFullscreen?await o.requestFullscreen():o.webkitRequestFullscreen?await o.webkitRequestFullscreen():o.mozRequestFullScreen?await o.mozRequestFullScreen():o.msRequestFullscreen&&await o.msRequestFullscreen()}catch(o){console.error("requestFullscreen error",o)}},s=async()=>{try{document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.mozCancelFullScreen?await document.mozCancelFullScreen():document.msExitFullscreen&&await document.msExitFullscreen()}catch(o){console.error("exitFullscreen error",o)}};return v.jsx("button",{type:"button",className:t,"aria-pressed":r,onClick:()=>r?s():i(),title:r?"Exit fullscreen":"Enter fullscreen",style:{padding:"8px 10px",borderRadius:8,border:"none",background:"rgba(0,0,0,0.6)",color:"white",cursor:"pointer",fontSize:14},children:r?"Exit Fullscreen":"Fullscreen"})}var uI={};function r1e(e){if(typeof window>"u")return;const t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}Object.defineProperty(uI,"__esModule",{value:!0});var Wt=R;function n1e(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Ci=n1e(Wt);r1e(`.rfm-marquee-container {
  overflow-x: hidden;
  display: flex;
  flex-direction: row;
  position: relative;
  width: var(--width);
  transform: var(--transform);
}
.rfm-marquee-container:hover div {
  animation-play-state: var(--pause-on-hover);
}
.rfm-marquee-container:active div {
  animation-play-state: var(--pause-on-click);
}

.rfm-overlay {
  position: absolute;
  width: 100%;
  height: 100%;
}
.rfm-overlay::before, .rfm-overlay::after {
  background: linear-gradient(to right, var(--gradient-color), rgba(255, 255, 255, 0));
  content: "";
  height: 100%;
  position: absolute;
  width: var(--gradient-width);
  z-index: 2;
  pointer-events: none;
  touch-action: none;
}
.rfm-overlay::after {
  right: 0;
  top: 0;
  transform: rotateZ(180deg);
}
.rfm-overlay::before {
  left: 0;
  top: 0;
}

.rfm-marquee {
  flex: 0 0 auto;
  min-width: var(--min-width);
  z-index: 1;
  display: flex;
  flex-direction: row;
  align-items: center;
  animation: scroll var(--duration) linear var(--delay) var(--iteration-count);
  animation-play-state: var(--play);
  animation-delay: var(--delay);
  animation-direction: var(--direction);
}
@keyframes scroll {
  0% {
    transform: translateX(0%);
  }
  100% {
    transform: translateX(-100%);
  }
}

.rfm-initial-child-container {
  flex: 0 0 auto;
  display: flex;
  min-width: auto;
  flex-direction: row;
  align-items: center;
}

.rfm-child {
  transform: var(--transform);
}`);const a1e=Wt.forwardRef(function({style:t={},className:r="",autoFill:n=!1,play:a=!0,pauseOnHover:i=!1,pauseOnClick:s=!1,direction:o="left",speed:l=50,delay:c=0,loop:u=0,gradient:f=!1,gradientColor:d="white",gradientWidth:h=200,onFinish:m,onCycleComplete:p,onMount:g,children:x},w){const[y,k]=Wt.useState(0),[b,_]=Wt.useState(0),[S,E]=Wt.useState(1),[T,F]=Wt.useState(!1),C=Wt.useRef(null),A=w||C,M=Wt.useRef(null),V=Wt.useCallback(()=>{if(M.current&&A.current){const ee=A.current.getBoundingClientRect(),P=M.current.getBoundingClientRect();let G=ee.width,B=P.width;(o==="up"||o==="down")&&(G=ee.height,B=P.height),E(n&&G&&B&&B<G?Math.ceil(G/B):1),k(G),_(B)}},[n,A,o]);Wt.useEffect(()=>{if(T&&(V(),M.current&&A.current)){const ee=new ResizeObserver(()=>V());return ee.observe(A.current),ee.observe(M.current),()=>{ee&&ee.disconnect()}}},[V,A,T]),Wt.useEffect(()=>{V()},[V,x]),Wt.useEffect(()=>{F(!0)},[]),Wt.useEffect(()=>{typeof g=="function"&&g()},[]);const z=Wt.useMemo(()=>n?b*S/l:b<y?y/l:b/l,[n,y,b,S,l]),Y=Wt.useMemo(()=>Object.assign(Object.assign({},t),{"--pause-on-hover":!a||i?"paused":"running","--pause-on-click":!a||i&&!s||s?"paused":"running","--width":o==="up"||o==="down"?"100vh":"100%","--transform":o==="up"?"rotate(-90deg)":o==="down"?"rotate(90deg)":"none"}),[t,a,i,s,o]),J=Wt.useMemo(()=>({"--gradient-color":d,"--gradient-width":typeof h=="number"?`${h}px`:h}),[d,h]),Q=Wt.useMemo(()=>({"--play":a?"running":"paused","--direction":o==="left"?"normal":"reverse","--duration":`${z}s`,"--delay":`${c}s`,"--iteration-count":u?`${u}`:"infinite","--min-width":n?"auto":"100%"}),[a,o,z,c,u,n]),j=Wt.useMemo(()=>({"--transform":o==="up"?"rotate(90deg)":o==="down"?"rotate(-90deg)":"none"}),[o]),X=Wt.useCallback(ee=>[...Array(Number.isFinite(ee)&&ee>=0?ee:0)].map((P,G)=>Ci.default.createElement(Wt.Fragment,{key:G},Wt.Children.map(x,B=>Ci.default.createElement("div",{style:j,className:"rfm-child"},B)))),[j,x]);return T?Ci.default.createElement("div",{ref:A,style:Y,className:"rfm-marquee-container "+r},f&&Ci.default.createElement("div",{style:J,className:"rfm-overlay"}),Ci.default.createElement("div",{className:"rfm-marquee",style:Q,onAnimationIteration:p,onAnimationEnd:m},Ci.default.createElement("div",{className:"rfm-initial-child-container",ref:M},Wt.Children.map(x,ee=>Ci.default.createElement("div",{style:j,className:"rfm-child"},ee))),X(S-1)),Ci.default.createElement("div",{className:"rfm-marquee",style:Q},X(S))):null});var i1e=uI.default=a1e;const tg={BASE_URL:"/KPI-Dashboard/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impza2Fqa3d1bGFhYWtoYW9semR1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0NTExMjEsImV4cCI6MjA3MzAyNzEyMX0.8pq0sVGGofg2vGmrOdbvqbVX-mFcdQInZ3T5pc70Qb4",VITE_SUPABASE_URL:"https://jskajkwulaaakhaolzdu.supabase.co"};var qc={};function Wb(e=30){var t;try{if(typeof window<"u"&&((t=window.__ENV)!=null&&t.VITE_BILLBOARD_REFRESH_SEC)){const r=parseInt(window.__ENV.VITE_BILLBOARD_REFRESH_SEC,10);if(isFinite(r)&&r>0)return r}if(typeof import.meta<"u"&&(tg!=null&&tg.VITE_BILLBOARD_REFRESH_SEC)){const r=parseInt(void 0,10);if(isFinite(r)&&r>0)return r}if(typeof process<"u"&&typeof qc<"u"&&(qc!=null&&qc.VITE_BILLBOARD_REFRESH_SEC)){const r=parseInt(qc.VITE_BILLBOARD_REFRESH_SEC,10);if(isFinite(r)&&r>0)return r}}catch(r){console.warn("[readRefreshSec] Error reading refresh interval, using default:",r)}return e}function zb(e){return e*1e3}const T0=[{label:"SERVICE REVENUE",value:"$125,000",change:"+8.1%",positive:!0},{label:"DELIVERY REVENUE",value:"$89,451",change:"+5.2%",positive:!0},{label:"TOTAL TICKETS",value:"156",change:null,positive:null},{label:"GALLONS",value:"45,231",change:"+12.3%",positive:!0},{label:"COMPLETED JOBS",value:"42",change:null,positive:null}];async function s1e(){try{const{getBillboardSummary:e}=await rc(async()=>{const{getBillboardSummary:r}=await Promise.resolve().then(()=>d1e);return{getBillboardSummary:r}},void 0),t=await e();return t.error&&console.warn("[BillboardTopTicker] Error from getBillboardSummary:",t.error),t.data||null}catch(e){return console.error("[BillboardTopTicker] Error calling clientGetBillboardSummary:",e),null}}function o1e({pollInterval:e=null}){const[t,r]=R.useState(T0),[n,a]=R.useState(!0),[i,s]=R.useState(null),[o,l]=R.useState("loading"),c=e||zb(Wb(30)),u=async()=>{try{console.log("[BillboardTopTicker] Fetching data from Supabase...");const f=await s1e();if(f&&f.serviceTracking&&f.deliveryTickets){const d=l1e(f);r(d),s(null),l("supabase"),console.log("[BillboardTopTicker] Successfully loaded data from Supabase:",f)}else console.warn("[BillboardTopTicker] No data from Supabase, using sample data"),r(T0),s("Using sample data - configure Supabase credentials"),l("sample")}catch(f){console.error("[BillboardTopTicker] Fetch error:",f),s(f.message),r(T0),l("error")}finally{a(!1)}};return R.useEffect(()=>{u();const f=setInterval(u,c),d=h=>{console.log("[BillboardTopTicker] Forced refresh triggered:",h.detail),u()};return typeof window<"u"&&window.addEventListener("billboard-refresh",d),()=>{clearInterval(f),typeof window<"u"&&window.removeEventListener("billboard-refresh",d)}},[c]),n?v.jsx("div",{className:"billboard-top-ticker-loading",children:v.jsx("span",{children:"Loading ticker data..."})}):v.jsxs("div",{className:"billboard-top-ticker-container",children:[v.jsx(i1e,{speed:40,gradient:!1,pauseOnHover:!0,pauseOnClick:!0,delay:0,play:!0,direction:"left",children:t.map((f,d)=>v.jsxs("div",{className:"billboard-top-ticker-item",children:[v.jsx("span",{className:"billboard-top-ticker-label",children:f.label}),v.jsx("span",{className:"billboard-top-ticker-value",children:f.value}),f.change&&v.jsx("span",{className:`billboard-top-ticker-chip ${f.positive?"chip-positive":"chip-negative"}`,children:f.change})]},d))}),o==="sample"&&v.jsx("div",{className:"billboard-data-warning",children:"⚠️ Sample data - Configure Supabase in Settings"})]})}function l1e(e){var d,h,m,p,g,x,w,y;if(!e)return T0;const t=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(k||0),r=k=>new Intl.NumberFormat("en-US").format(k||0),n=k=>{const b=parseFloat(k)||0;return`${b>=0?"+":""}${b.toFixed(1)}%`},a=((d=e.serviceTracking)==null?void 0:d.completedRevenue)||0,i=((h=e.deliveryTickets)==null?void 0:h.revenue)||0,s=((m=e.deliveryTickets)==null?void 0:m.totalTickets)||0,o=((p=e.deliveryTickets)==null?void 0:p.totalGallons)||0,l=((g=e.serviceTracking)==null?void 0:g.completed)||0,c=((x=e.serviceTracking)==null?void 0:x.scheduled)||0,u=((w=e.weekCompare)==null?void 0:w.thisWeekTotalRevenue)||0,f=((y=e.weekCompare)==null?void 0:y.percentChange)||0;return[{label:"TOTAL REVENUE",value:t(u),change:n(f),positive:f>=0},{label:"SERVICE REVENUE",value:t(a),change:null,positive:null},{label:"DELIVERY REVENUE",value:t(i),change:null,positive:null},{label:"DELIVERY TICKETS",value:r(s),change:null,positive:null},{label:"GALLONS",value:r(o),change:null,positive:null},{label:"COMPLETED JOBS",value:r(l),change:null,positive:null},{label:"SCHEDULED JOBS",value:r(c),change:null,positive:null}]}const c1e=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2});function u1e({thisWeekTotalRevenue:e=0,lastWeekTotalRevenue:t=0,percentChange:r=0,scheduledJobs:n=0,scheduledRevenue:a=0}){console.debug("[WeekCompareBar] Scheduled metrics:",{scheduledJobs:n,scheduledRevenue:a});const i=t>0?e/t*100:e>0?100:0,s=R.useMemo(()=>i>110?{bg:"#dcfce7",bar:"#10b981",text:"#166534",label:"Strong Growth"}:i>=90?{bg:"#fef3c7",bar:"#f59e0b",text:"#92400e",label:"Stable"}:{bg:"#fee2e2",bar:"#ef4444",text:"#991b1b",label:"Needs Attention"},[i]),o=Math.min(i,150),l=c=>c==null||c===""?"$0.00":c1e.format(c);return v.jsxs("div",{className:"week-compare-bar",role:"region","aria-label":"Week revenue comparison",children:[v.jsxs("div",{className:"week-compare-header",children:[v.jsx("h3",{className:"week-compare-title",children:"This Week vs Last Week"}),v.jsx("div",{className:"week-compare-status",style:{color:s.text,backgroundColor:s.bg},"aria-live":"polite",children:s.label})]}),v.jsxs("div",{className:"week-compare-values",children:[v.jsxs("div",{className:"week-compare-value-item",children:[v.jsx("span",{className:"week-compare-value-label",children:"This Week"}),v.jsx("span",{className:"week-compare-value-amount",style:{color:s.bar},"aria-label":`This week revenue: ${l(e)}`,children:l(e)})]}),v.jsxs("div",{className:"week-compare-value-item",children:[v.jsx("span",{className:"week-compare-value-label",children:"Last Week"}),v.jsx("span",{className:"week-compare-value-amount","aria-label":`Last week revenue: ${l(t)}`,children:l(t)})]}),v.jsxs("div",{className:"week-compare-value-item",children:[v.jsx("span",{className:"week-compare-value-label",children:"Change"}),v.jsxs("span",{className:`week-compare-value-amount ${r>=0?"positive":"negative"}`,style:{color:s.text},"aria-label":`Change: ${r>=0?"+":""}${r.toFixed(1)}%`,children:[r>=0?"+":"",r.toFixed(1),"%"]})]}),v.jsxs("div",{className:"week-compare-value-item",children:[v.jsx("span",{className:"week-compare-value-label",children:"Scheduled Jobs"}),v.jsx("span",{className:"week-compare-value-amount","aria-label":`Scheduled jobs: ${n}`,children:n})]}),v.jsxs("div",{className:"week-compare-value-item",children:[v.jsx("span",{className:"week-compare-value-label",children:"Scheduled Revenue"}),v.jsx("span",{className:"week-compare-value-amount",style:{color:"#8b5cf6"},"aria-label":`Scheduled revenue: ${l(a)}`,children:l(a)})]})]}),v.jsx("div",{className:"week-compare-bar-container",style:{backgroundColor:s.bg},role:"progressbar","aria-valuenow":Math.round(i),"aria-valuemin":"0","aria-valuemax":"150","aria-label":`Performance at ${Math.round(i)}% of last week`,children:v.jsx("div",{className:"week-compare-bar-fill",style:{width:`${o}%`,backgroundColor:s.bar,transition:"width 0.6s ease"},children:v.jsxs("span",{className:"week-compare-bar-label",children:[i.toFixed(0),"%"]})})}),v.jsxs("div",{className:"week-compare-legend","aria-label":"Performance legend",children:[v.jsxs("div",{className:"week-compare-legend-item",children:[v.jsx("div",{className:"week-compare-legend-marker",style:{backgroundColor:"#ef4444"}}),v.jsx("span",{children:"<90% - Needs Attention"})]}),v.jsxs("div",{className:"week-compare-legend-item",children:[v.jsx("div",{className:"week-compare-legend-marker",style:{backgroundColor:"#f59e0b"}}),v.jsx("span",{children:"90-110% - Stable"})]}),v.jsxs("div",{className:"week-compare-legend-item",children:[v.jsx("div",{className:"week-compare-legend-marker",style:{backgroundColor:"#10b981"}}),v.jsx("span",{children:">110% - Strong Growth"})]})]})]})}const OA={serviceTracking:{completed:42,scheduled:18,deferred:3,completedRevenue:125e3,pipelineRevenue:45e3,scheduledJobs:18,scheduledRevenue:45e3},deliveryTickets:{totalTickets:156,totalGallons:45230.5,revenue:89450.75},weekCompare:{thisWeekTotalRevenue:214450.75,lastWeekTotalRevenue:198320.5,percentChange:8.1,scheduledJobs:18,scheduledRevenue:45e3,lastWeekScheduledJobs:15,lastWeekScheduledRevenue:38e3},lastUpdated:new Date().toISOString()};function Kx(e){const t=new Date(e),r=t.getDay(),n=t.getDate()-r+(r===0?-6:1),a=new Date(t.setDate(n));return a.setHours(0,0,0,0),a}function CA(e){const t=Kx(e),r=new Date(t);return r.setDate(r.getDate()+6),r.setHours(23,59,59,999),r}async function PA(e,t){if(!be)throw new Error("Supabase client not configured");const r=e.toISOString().split("T")[0],n=t.toISOString().split("T")[0],{data:a,error:i}=await be.from("service_jobs").select("status, job_amount, job_date").gte("job_date",r).lte("job_date",n);if(i)throw console.error("[fetchMetricsClient] Error fetching service jobs:",i),new Error(`Failed to fetch service jobs: ${i.message}`);const s={completed:0,scheduled:0,deferred:0,completedRevenue:0,pipelineRevenue:0,scheduledJobs:0,scheduledRevenue:0};return(a||[]).forEach(o=>{const l=parseFloat(o.job_amount)||0,c=(o.status||"").toLowerCase();c==="completed"?(s.completed+=1,s.completedRevenue+=l):c==="scheduled"||c==="assigned"||c==="confirmed"?(s.scheduled+=1,s.pipelineRevenue+=l,s.scheduledJobs+=1,s.scheduledRevenue+=l):c==="deferred"?(s.deferred+=1,s.pipelineRevenue+=l):(c==="unscheduled"||c==="in_progress")&&(s.scheduled+=1,s.pipelineRevenue+=l)}),console.debug("[fetchMetricsClient] Service summary:",{startDate:r,endDate:n,scheduledJobs:s.scheduledJobs,scheduledRevenue:s.scheduledRevenue}),s}async function jA(e,t){if(!be)throw new Error("Supabase client not configured");const r=e.toISOString().split("T")[0],n=t.toISOString().split("T")[0],{data:a,error:i}=await be.from("delivery_tickets").select("qty, amount, date").gte("date",r).lte("date",n);if(i)throw console.error("[fetchMetricsClient] Error fetching delivery tickets:",i),new Error(`Failed to fetch delivery tickets: ${i.message}`);let s=0,o=0,l=0;return(a||[]).forEach(c=>{s+=1,o+=parseFloat(c.qty)||0,l+=parseFloat(c.amount)||0}),{totalTickets:s,totalGallons:o,revenue:l}}async function Hb(){try{if(!be)return console.warn("[fetchMetricsClient] Supabase not configured, using mock data"),{data:OA,error:null};const e=new Date,t=Kx(e),r=CA(e),n=t.toISOString().split("T")[0],a=r.toISOString().split("T")[0];try{const[{data:w=[],error:y}={},{data:k=[],error:b}={}]=await Promise.all([be.from("service_jobs_daily").select("day, job_count, revenue").gte("day",n).lte("day",a),be.from("delivery_tickets_daily").select("day, ticket_count, total_gallons, revenue").gte("day",n).lte("day",a)]);if(!y&&!b){const _=(w||[]).reduce((X,ee)=>(X.completed=(X.completed||0)+(Number(ee.job_count)||0),X.completedRevenue=(X.completedRevenue||0)+(Number(ee.revenue)||0),X),{completed:0,completedRevenue:0}),S=(k||[]).reduce((X,ee)=>(X.totalTickets=(X.totalTickets||0)+(Number(ee.ticket_count)||0),X.totalGallons=(X.totalGallons||0)+(Number(ee.total_gallons)||0),X.revenue=(X.revenue||0)+(Number(ee.revenue)||0),X),{totalTickets:0,totalGallons:0,revenue:0}),E=new Date(t);E.setDate(E.getDate()-7);const T=new Date(r);T.setDate(T.getDate()-7);const F=E.toISOString().split("T")[0],C=T.toISOString().split("T")[0],[{data:A=[]}={},{data:M=[]}={}]=await Promise.all([be.from("service_jobs_daily").select("day, job_count, revenue").gte("day",F).lte("day",C),be.from("delivery_tickets_daily").select("day, ticket_count, total_gallons, revenue").gte("day",F).lte("day",C)]),V=(A||[]).reduce((X,ee)=>(X.completed=(X.completed||0)+(Number(ee.job_count)||0),X.completedRevenue=(X.completedRevenue||0)+(Number(ee.revenue)||0),X),{completed:0,completedRevenue:0}),z=(M||[]).reduce((X,ee)=>(X.totalTickets=(X.totalTickets||0)+(Number(ee.ticket_count)||0),X.totalGallons=(X.totalGallons||0)+(Number(ee.total_gallons)||0),X.revenue=(X.revenue||0)+(Number(ee.revenue)||0),X),{totalTickets:0,totalGallons:0,revenue:0}),Y=(_.completedRevenue||0)+(S.revenue||0),J=(V.completedRevenue||0)+(z.revenue||0);let Q=0;J===0?Q=Y>0?100:0:Q=(Y-J)/J*100;const j={serviceTracking:_,deliveryTickets:S,weekCompare:{thisWeekTotalRevenue:Y,lastWeekTotalRevenue:J,percentChange:parseFloat(Q.toFixed(1)),scheduledJobs:_.scheduledJobs||0,scheduledRevenue:_.scheduledRevenue||0,lastWeekScheduledJobs:V.scheduledJobs||0,lastWeekScheduledRevenue:V.scheduledRevenue||0},lastUpdated:new Date().toISOString(),debug:{usedView:!0,viewRange:{start:n,end:a}}};return console.debug("[fetchMetricsClient] Billboard summary (view path):",{scheduledJobs:j.weekCompare.scheduledJobs,scheduledRevenue:j.weekCompare.scheduledRevenue}),{data:j,error:null}}console.warn("[fetchMetricsClient] One or both view queries returned errors, falling back to table-level summary",{svcErr:y,delErr:b})}catch(w){console.warn("[fetchMetricsClient] Error querying aggregate views, falling back to base table summaries",w)}const i=new Date,s=Kx(i),o=CA(i),l=new Date(s);l.setDate(l.getDate()-7);const c=new Date(o);c.setDate(c.getDate()-7);const[u,f,d,h]=await Promise.all([PA(s,o),PA(l,c),jA(s,o),jA(l,c)]),m=(u.completedRevenue||0)+(d.revenue||0),p=(f.completedRevenue||0)+(h.revenue||0);let g=0;p===0?g=m>0?100:0:g=(m-p)/p*100;const x={serviceTracking:u,deliveryTickets:d,weekCompare:{thisWeekTotalRevenue:m,lastWeekTotalRevenue:p,percentChange:parseFloat(g.toFixed(1)),scheduledJobs:u.scheduledJobs||0,scheduledRevenue:u.scheduledRevenue||0,lastWeekScheduledJobs:f.scheduledJobs||0,lastWeekScheduledRevenue:f.scheduledRevenue||0},lastUpdated:new Date().toISOString(),debug:{usedView:!1,reason:"fallback to per-table aggregators"}};return console.debug("[fetchMetricsClient] Billboard summary (fallback path):",{scheduledJobs:x.weekCompare.scheduledJobs,scheduledRevenue:x.weekCompare.scheduledRevenue}),{data:x,error:null}}catch(e){return console.error("[fetchMetricsClient] Error in getBillboardSummary:",e),{data:OA,error:null}}}async function f1e(e,t,r,n){try{let l=function(p){if(!p)return null;if(typeof p=="string")return p.split("T")[0];if(p instanceof Date){const g=p.getFullYear(),x=p.getMonth()+1,w=p.getDate();return new Date(Date.UTC(g,x-1,w)).toISOString().split("T")[0]}return String(p).split("T")[0]},c=function(p){const[g,x,w]=p.split("-"),y=parseInt(g,10),k=parseInt(x,10),b=parseInt(w,10),S=new Date(Date.UTC(y,k-1,b)).getUTCDay(),E=b-S+(S===0?-6:1);return new Date(Date.UTC(y,k-1,E)).toISOString().split("T")[0]},u=function(p){const[g,x]=p.split("-");return`${g}-${x}-01`};const a=e==="service"?"service_jobs":"delivery_tickets",i=e==="service"?"job_date":"date",{data:s,error:o}=await be.from(a).select("*").gte(i,r).lte(i,n);if(o)throw new Error(`Failed to fetch from ${a}: ${o.message}`);const f={};(s||[]).forEach(p=>{const g=p[i];if(!g)return;const x=l(g);if(!x)return;let w;if(t==="day"?w=x:t==="week"?w=c(x):w=u(x),f[w]||(e==="service"?f[w]={job_count:0,revenue:0}:f[w]={ticket_count:0,total_gallons:0,revenue:0}),e==="service"){const y=(p.status||"").toLowerCase();if(!y.includes("cancel")&&y.includes("completed")){const k=parseFloat(p.job_amount)||0;f[w].job_count+=1,f[w].revenue+=k}}else{const y=(p.status||"").toLowerCase();!y.includes("void")&&!y.includes("cancel")&&(f[w].ticket_count+=1,f[w].total_gallons+=parseFloat(p.qty)||0,f[w].revenue+=parseFloat(p.amount)||0)}});const h={day:"day",week:"week_start",month:"month_start"}[t];return{data:Object.entries(f).map(([p,g])=>({[h]:p,...g})).sort((p,g)=>p[h].localeCompare(g[h])),error:null}}catch(a){return console.error("[fetchMetricsClient] Error in aggregateFromBaseTable:",a),{data:null,error:a.message}}}async function NA(e,t,r,n,a,i){var f,d,h;const{data:s,error:o}=await be.from(e).select("*").gte(t,r).lte(t,n).order(t,{ascending:!0}),l=o&&(((f=o.message)==null?void 0:f.includes("does not exist"))||((d=o.message)==null?void 0:d.includes("relation"))||((h=o.message)==null?void 0:h.includes("schema cache"))||o.code==="42P01");if(o&&!l)return console.error("[fetchMetricsClient] Unexpected error querying view:",o),{data:null,error:o.message,debug:{usedFallback:!1,viewName:e,error:o.message},totals:null};const c=m=>{if(!m||m.length===0)return null;const p={recordCount:m.length};return a==="service"?(p.totalJobs=m.reduce((g,x)=>g+(parseFloat(x.job_count)||0),0),p.totalRevenue=m.reduce((g,x)=>g+(parseFloat(x.revenue)||0),0)):(p.totalTickets=m.reduce((g,x)=>g+(parseFloat(x.ticket_count)||0),0),p.totalGallons=m.reduce((g,x)=>g+(parseFloat(x.total_gallons)||0),0),p.totalRevenue=m.reduce((g,x)=>g+(parseFloat(x.revenue)||0),0)),p};if(l){console.warn(`[fetchMetricsClient] View '${e}' not found, falling back to base table aggregation`);const m=await f1e(a,i,r,n),p=c(m.data);return{data:m.data,error:m.error,totals:p,debug:{usedFallback:!0,viewName:e,reason:"View not found in database schema",suggestion:"Run migrations/001_create_metrics_views.sql in Supabase SQL Editor",totals:p}}}const u=c(s);return{data:s||[],error:null,totals:u,debug:{usedFallback:!1,viewName:e,totals:u}}}async function Vb(e){var t;try{if(!be)return console.warn("[fetchMetricsClient] Supabase not configured, cannot fetch timeseries"),{primary:[],comparison:null,error:"Supabase not configured",debug:{usedFallback:!1,error:"No Supabase client"},totals:null};const{source:r,start:n,end:a,granularity:i,compare:s,compareStart:o,compareEnd:l}=e;if(!r||!n||!a||!i)throw new Error("Missing required parameters: source, start, end, granularity");const u=(t={service:{day:"service_jobs_daily",week:"service_jobs_weekly",month:"service_jobs_monthly"},delivery:{day:"delivery_tickets_daily",week:"delivery_tickets_weekly",month:"delivery_tickets_monthly"}}[r])==null?void 0:t[i];if(!u)throw new Error(`Invalid source (${r}) or granularity (${i})`);const d={day:"day",week:"week_start",month:"month_start"}[i],h=n.toISOString().split("T")[0],m=a.toISOString().split("T")[0],p=await NA(u,d,h,m,r,i);if(p.error)throw console.error("[fetchMetricsClient] Error fetching primary data:",p.error),new Error(`Failed to fetch ${r} data: ${p.error}`);let g=null,x=null,w=null;if(s){let y,k;if(s==="previous"){const b=a-n,_=new Date(n.getTime()-b),S=new Date(n.getTime()-1);y=_.toISOString().split("T")[0],k=S.toISOString().split("T")[0]}else s==="custom"&&o&&l?(y=o.toISOString().split("T")[0],k=l.toISOString().split("T")[0]):console.warn("[fetchMetricsClient] Invalid compare mode or missing compareStart/compareEnd");if(y&&k){const b=await NA(u,d,y,k,r,i);b.error?console.warn("[fetchMetricsClient] Error fetching comparison data:",b.error):(g=b.data,x=b.debug,w=b.totals)}}return{primary:p.data||[],comparison:g,error:null,totals:{primary:p.totals,comparison:w},debug:{primary:p.debug,comparison:x}}}catch(r){return console.error("[fetchMetricsClient] Error in getMetricsTimeseries:",r),{primary:[],comparison:null,error:r.message,totals:null,debug:{error:r.message}}}}const d1e=Object.freeze(Object.defineProperty({__proto__:null,getBillboardSummary:Hb,getMetricsTimeseries:Vb},Symbol.toStringTag,{value:"Module"}));function Xc({title:e,value:t,sub:r,status:n="ok",trend:a,ariaLabel:i}){const s={ok:"#10b981",warn:"#f59e0b",neg:"#ef4444"},o=s[n]||s.ok;return v.jsx("div",{className:"kpi-card",role:"group","aria-label":i||`${e}: ${t}`,style:{borderLeft:`4px solid ${o}`,padding:"16px",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:l=>{l.currentTarget.style.transform="translateY(-2px)",l.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.15)"},onMouseLeave:l=>{l.currentTarget.style.transform="translateY(0)",l.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.1)"},children:v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[v.jsxs("div",{style:{flex:1},children:[v.jsx("div",{style:{fontSize:"0.875rem",color:"#6b7280",fontWeight:500,marginBottom:"4px",textTransform:"uppercase",letterSpacing:"0.025em"},children:e}),v.jsx("div",{style:{fontSize:"1.875rem",fontWeight:700,color:"#111827",lineHeight:1.2,marginBottom:"4px"},children:t}),r&&v.jsx("div",{style:{fontSize:"0.75rem",color:"#9ca3af"},children:r})]}),a&&v.jsx("div",{style:{fontSize:"0.875rem",fontWeight:600,color:o,padding:"4px 8px",borderRadius:"4px",backgroundColor:`${o}15`},children:a})]})})}function h1e({ticks:e=[]}){const[t,r]=R.useState(null),n={ok:"#10b981",warn:"#f59e0b",neg:"#ef4444",neutral:"#9ca3af"};return!e||e.length===0?null:v.jsx("div",{style:{display:"flex",alignItems:"center",gap:"24px",padding:"16px",backgroundColor:"#f9fafb",borderRadius:"8px",flexWrap:"wrap"},role:"list","aria-label":"Status indicators",children:e.map((a,i)=>{const s=n[a.status]||n.neutral,o=t===i;return v.jsxs("div",{role:"listitem",style:{display:"flex",alignItems:"center",gap:"8px",position:"relative",cursor:a.tooltip?"pointer":"default"},onMouseEnter:()=>r(i),onMouseLeave:()=>r(null),"aria-label":a.tooltip||`${a.label}: ${a.status}`,children:[v.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:s,boxShadow:`0 0 0 ${o?"4px":"0px"} ${s}40`,transition:"box-shadow 0.2s"},"aria-hidden":"true"}),v.jsx("span",{style:{fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:a.label}),a.tooltip&&o&&v.jsxs("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",marginBottom:"8px",padding:"8px 12px",backgroundColor:"#1f2937",color:"#fff",fontSize:"0.75rem",borderRadius:"6px",whiteSpace:"nowrap",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",zIndex:10,pointerEvents:"none"},role:"tooltip",children:[a.tooltip,v.jsx("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"6px solid #1f2937"},"aria-hidden":"true"})]})]},i)})})}const Pi={revenue:{ok:1e5,warn:5e4},tickets:{ok:100,warn:50},jobs:{ok:30,warn:15},percentChange:{ok:0,warn:-5}};function ji(e,t){return e>=t.ok?"ok":e>=t.warn?"warn":"neg"}function p1e(){const[e,t]=R.useState(null),[r,n]=R.useState([]),[a,i]=R.useState([]),[s,o]=R.useState([]),[l,c]=R.useState(!0),[u,f]=R.useState(null),d=R.useRef(!0),h=R.useRef(null),m=zb(Wb(30)),p=R.useCallback(async()=>{try{const j=await Hb();if(j.error){console.error("[MetricsGrid] Error fetching metrics:",j.error),f(j.error);return}j.data&&d.current&&(t(j.data),f(null),console.log("[MetricsGrid] Metrics updated:",j.data))}catch(j){console.error("[MetricsGrid] Fetch error:",j),d.current&&f(j.message)}finally{d.current&&c(!1)}},[]),g=R.useCallback(async()=>{try{const j=new Date,X=new Date;X.setDate(X.getDate()-7);const ee=await Vb({source:"delivery",start:X,end:j,granularity:"day"});ee.primary&&ee.primary.length>0&&d.current&&n(ee.primary)}catch(j){console.warn("[MetricsGrid] Error fetching timeseries:",j)}},[]),x=R.useCallback(async()=>{if(!be){console.warn("[MetricsGrid] Supabase not configured, skipping top items fetch");return}try{const{data:j,error:X}=await be.from("delivery_tickets").select("customer, amount, date").order("amount",{ascending:!1}).limit(3);!X&&j&&d.current&&i(j);const{data:ee,error:P}=await be.from("service_jobs").select("customer_name, job_amount, job_date, status").eq("status","completed").order("job_amount",{ascending:!1}).limit(3);!P&&ee&&d.current&&o(ee)}catch(j){console.warn("[MetricsGrid] Error fetching top items:",j)}},[]),w=R.useCallback(()=>{if(!be){console.warn("[MetricsGrid] Supabase not configured, skipping realtime subscription");return}try{const j=be.channel("public:metrics-updates").on("postgres_changes",{event:"*",schema:"public",table:"delivery_tickets"},X=>{console.log("[MetricsGrid] Realtime update from delivery_tickets:",X),p(),g(),x()}).on("postgres_changes",{event:"*",schema:"public",table:"service_jobs"},X=>{console.log("[MetricsGrid] Realtime update from service_jobs:",X),p(),g(),x()}).subscribe(X=>{X==="SUBSCRIBED"?console.log("[MetricsGrid] Realtime subscription active"):(X==="CHANNEL_ERROR"||X==="TIMED_OUT")&&console.warn("[MetricsGrid] Realtime subscription failed, continuing with polling:",X)});h.current=j}catch(j){console.warn("[MetricsGrid] Error setting up realtime subscription:",j)}},[p,g,x]);R.useEffect(()=>{d.current=!0,p(),g(),x();const j=setInterval(()=>{p(),g(),x()},m);w();const X=ee=>{console.log("[MetricsGrid] Forced refresh triggered:",ee.detail),p(),g(),x()};return typeof window<"u"&&window.addEventListener("billboard-refresh",X),()=>{d.current=!1,clearInterval(j),h.current&&(be==null||be.removeChannel(h.current),h.current=null),typeof window<"u"&&window.removeEventListener("billboard-refresh",X)}},[p,g,x,m,w]);const y=j=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(j||0),k=j=>new Intl.NumberFormat("en-US").format(j||0);if(l)return v.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#6b7280"},children:"Loading metrics..."});if(u)return v.jsxs("div",{style:{padding:"24px",textAlign:"center",color:"#ef4444"},children:["Error loading metrics: ",u]});if(!e)return v.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#6b7280"},children:"No metrics available"});const b=e.deliveryTickets||{},_=e.serviceTracking||{},S=e.weekCompare||{},E=S.thisWeekTotalRevenue||0,T=S.percentChange||0,F=b.totalTickets||0,C=b.totalGallons||0,A=_.completed||0,M=b.revenue||0,V=_.completedRevenue||0,z=_.pipelineRevenue||0,Y=S.scheduledJobs||0,J=S.scheduledRevenue||0;console.debug("[MetricsGrid] Scheduled metrics:",{scheduledJobs:Y,scheduledRevenue:J});const Q=[{label:"Revenue",status:ji(E,Pi.revenue),tooltip:`Total revenue: ${y(E)}`},{label:"Deliveries",status:ji(F,Pi.tickets),tooltip:`${F} delivery tickets`},{label:"Services",status:ji(A,Pi.jobs),tooltip:`${A} completed jobs`},{label:"Trend",status:ji(T,Pi.percentChange),tooltip:`Week-over-week: ${T>=0?"+":""}${T.toFixed(1)}%`}];return v.jsxs("div",{style:{padding:"16px"},children:[v.jsx("div",{style:{marginBottom:"24px"},children:v.jsx(h1e,{ticks:Q})}),v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginBottom:"24px"},children:[v.jsx(Xc,{title:"Total Revenue",value:y(E),sub:"This week vs last week",status:ji(E,Pi.revenue),trend:`${T>=0?"+":""}${T.toFixed(1)}%`,ariaLabel:`Total revenue: ${y(E)}, ${T>=0?"up":"down"} ${Math.abs(T).toFixed(1)}% from last week`}),v.jsx(Xc,{title:"Delivery Revenue",value:y(M),sub:`${k(F)} tickets, ${k(C)} gallons`,status:ji(M,Pi.revenue),ariaLabel:`Delivery revenue: ${y(M)} from ${F} tickets`}),v.jsx(Xc,{title:"Service Revenue",value:y(V),sub:`${A} completed jobs`,status:ji(V,Pi.revenue),ariaLabel:`Service revenue: ${y(V)} from ${A} completed jobs`}),v.jsx(Xc,{title:"Pipeline",value:y(z),sub:"Scheduled & deferred",status:"neutral",ariaLabel:`Pipeline revenue: ${y(z)}`}),v.jsx(Xc,{title:"Scheduled Jobs",value:k(Y),sub:`Revenue: ${y(J)}`,status:ji(Y,Pi.jobs),ariaLabel:`Scheduled jobs: ${Y}, Revenue: ${y(J)}`})]}),r.length>0&&v.jsxs("div",{style:{marginBottom:"24px"},children:[v.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"#374151",marginBottom:"12px"},children:"Delivery Revenue Trend (Last 7 Days)"}),v.jsx("div",{style:{height:"120px",backgroundColor:"#fff",borderRadius:"8px",padding:"12px"},children:v.jsx(ph,{width:"100%",height:"100%",children:v.jsxs(ep,{data:r,children:[v.jsx(gi,{type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:2,dot:!1}),v.jsx(xn,{formatter:j=>[y(j),"Revenue"],labelFormatter:j=>`Day: ${j}`})]})})})]}),v.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"16px"},children:[a.length>0&&v.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[v.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"#374151",marginBottom:"12px"},children:"Top 3 Deliveries"}),v.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:a.map((j,X)=>v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",backgroundColor:"#f9fafb",borderRadius:"4px"},children:[v.jsx("span",{style:{fontSize:"0.875rem",color:"#374151",fontWeight:500},children:j.customer||"Unknown"}),v.jsx("span",{style:{fontSize:"0.875rem",color:"#10b981",fontWeight:600},children:y(j.amount)})]},X))})]}),s.length>0&&v.jsxs("div",{style:{backgroundColor:"#fff",borderRadius:"8px",padding:"16px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[v.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,color:"#374151",marginBottom:"12px"},children:"Top 3 Services"}),v.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:s.map((j,X)=>v.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",backgroundColor:"#f9fafb",borderRadius:"4px"},children:[v.jsx("span",{style:{fontSize:"0.875rem",color:"#374151",fontWeight:500},children:j.customer_name||"Unknown"}),v.jsx("span",{style:{fontSize:"0.875rem",color:"#10b981",fontWeight:600},children:y(j.job_amount)})]},X))})]})]})]})}function m1e(e){const[t,r]=R.useState(!1),[n,a]=R.useState(!1),[i,s]=R.useState({thisWeekTotalRevenue:0,lastWeekTotalRevenue:0,percentChange:0,scheduledJobs:0,scheduledRevenue:0}),o=R.useRef(!0),l=zb(Wb(10));R.useEffect(()=>{const f=new URLSearchParams(window.location.search);f.get("tv")==="1"&&r(!0);const d=()=>{const m=!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement);a(m),!m&&(f.get("popout")==="1"||f.get("tv")==="1")&&a(!0)};d();const h=()=>{d()};return document.addEventListener("fullscreenchange",h),document.addEventListener("webkitfullscreenchange",h),document.addEventListener("mozfullscreenchange",h),document.addEventListener("MSFullscreenChange",h),()=>{document.removeEventListener("fullscreenchange",h),document.removeEventListener("webkitfullscreenchange",h),document.removeEventListener("mozfullscreenchange",h),document.removeEventListener("MSFullscreenChange",h)}},[]);const c=R.useCallback(async()=>{try{const f=await Hb();if(f.data&&f.data.weekCompare){const{thisWeekTotalRevenue:d,lastWeekTotalRevenue:h,percentChange:m,scheduledJobs:p,scheduledRevenue:g}=f.data.weekCompare;o.current&&(s({thisWeekTotalRevenue:d||0,lastWeekTotalRevenue:h||0,percentChange:m||0,scheduledJobs:p||0,scheduledRevenue:g||0}),console.debug("[BillboardPage] Week compare data updated with scheduled metrics:",{scheduledJobs:p||0,scheduledRevenue:g||0}))}}catch(f){console.error("[BillboardPage] Error fetching week compare data:",f)}},[o]);R.useEffect(()=>{o.current=!0,c();const f=setInterval(c,l),d=h=>{console.log("[BillboardPage] Forced refresh triggered:",h.detail),c()};return typeof window<"u"&&window.addEventListener("billboard-refresh",d),()=>{o.current=!1,clearInterval(f),typeof window<"u"&&window.removeEventListener("billboard-refresh",d)}},[c,l,o]);const u=()=>{c(),window.location.reload()};return v.jsxs("div",{id:"billboard-root",className:`billboard-page ${n?"is-fullscreen":""}`,children:[!t&&v.jsxs("header",{className:"billboard-header",children:[v.jsx("div",{className:"billboard-title-placeholder","aria-hidden":"true"}),v.jsxs("div",{className:"billboard-controls",children:[v.jsx("button",{onClick:u,children:"Refresh"}),v.jsx(t1e,{targetId:"billboard-root"})]})]}),v.jsx("div",{className:"billboard-center-ticker",children:v.jsx("div",{className:"billboard-center-ticker-inner",children:v.jsx(o1e,{})})}),v.jsx("div",{className:"billboard-week-compare-wrapper",style:{padding:"12px 16px"},children:v.jsx(u1e,{thisWeekTotalRevenue:i.thisWeekTotalRevenue,lastWeekTotalRevenue:i.lastWeekTotalRevenue,percentChange:i.percentChange,scheduledJobs:i.scheduledJobs,scheduledRevenue:i.scheduledRevenue})}),v.jsx(p1e,{})]})}function v1e(){const[e,t]=R.useState([]),[r,n]=R.useState(!1),[a,i]=R.useState(null),[s,o]=R.useState(!1),[l,c]=R.useState({name:"",account:"",amount:"",period:"monthly"}),u=async()=>{try{const p=await fetch("/api/quickbooks/accounts");if(p.ok){const g=await p.json();t(g.accounts||[]),o(!0),i(null)}else{const g=await p.json();o(!1),p.status!==401&&i(g.message||"Failed to fetch accounts")}}catch(p){console.error("Connection check error:",p),o(!1)}};R.useEffect(()=>{u()},[]);const f=()=>{window.location.href="/api/quickbooks/connect"},d=async()=>{n(!0),i(null),await u(),n(!1)},h=(p,g)=>{c(x=>({...x,[p]:g}))},m=async p=>{if(p.preventDefault(),!l.name||!l.account||!l.amount){alert("Please fill in all required fields");return}console.log("Budget to create:",l),alert(`Budget creation not yet implemented.

Would create:
${JSON.stringify(l,null,2)}`),c({name:"",account:"",amount:"",period:"monthly"})};return v.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:24},children:[v.jsx("h2",{style:{marginTop:0,marginBottom:24},children:"Budget Manager"}),v.jsxs("div",{style:{background:"white",border:"1px solid #E5E7EB",borderRadius:12,padding:24,marginBottom:24},children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:16},children:[v.jsx("h3",{style:{margin:0,fontSize:18},children:"QuickBooks Integration"}),v.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[s&&v.jsxs("button",{onClick:d,disabled:r,style:{padding:"8px 16px",borderRadius:8,border:"1px solid #E5E7EB",background:"white",cursor:r?"not-allowed":"pointer",opacity:r?.6:1},children:["🔄 ",r?"Refreshing...":"Refresh Accounts"]}),!s&&v.jsx("button",{onClick:f,style:{padding:"8px 16px",borderRadius:8,border:"1px solid #10B981",background:"#10B981",color:"white",cursor:"pointer",fontWeight:500},children:"🔗 Connect QuickBooks"})]})]}),a&&v.jsx("div",{style:{background:"#FEE2E2",border:"1px solid #FECACA",color:"#991B1B",padding:12,borderRadius:8,marginBottom:16},children:a}),!s&&!a&&v.jsxs("div",{style:{background:"#FEF3C7",border:"1px solid #FDE68A",color:"#92400E",padding:12,borderRadius:8},children:[v.jsx("strong",{children:"QuickBooks Not Connected"}),v.jsxs("p",{style:{margin:"8px 0 0 0",fontSize:14},children:['Click "Connect QuickBooks" to authorize this application to access your QuickBooks data.',v.jsx("br",{}),v.jsx("strong",{children:"Note:"})," QuickBooks OAuth requires serverless function deployment (Vercel/Netlify). For static hosting, you'll need to set up a backend service."]})]}),s&&v.jsxs("div",{style:{background:"#DCFCE7",border:"1px solid #BBF7D0",color:"#166534",padding:12,borderRadius:8},children:["✅ QuickBooks Connected - ",e.length," accounts available"]})]}),s&&e.length>0&&v.jsxs("div",{style:{background:"white",border:"1px solid #E5E7EB",borderRadius:12,padding:24,marginBottom:24},children:[v.jsx("h3",{style:{marginTop:0,marginBottom:16,fontSize:18},children:"Chart of Accounts"}),v.jsx("div",{style:{overflow:"auto",maxHeight:400},children:v.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[v.jsx("thead",{children:v.jsxs("tr",{style:{background:"#F3F4F6"},children:[v.jsx("th",{style:{textAlign:"left",padding:12,borderBottom:"1px solid #E5E7EB",fontSize:12,color:"#6B7280"},children:"Account Name"}),v.jsx("th",{style:{textAlign:"left",padding:12,borderBottom:"1px solid #E5E7EB",fontSize:12,color:"#6B7280"},children:"Type"}),v.jsx("th",{style:{textAlign:"right",padding:12,borderBottom:"1px solid #E5E7EB",fontSize:12,color:"#6B7280"},children:"Balance"})]})}),v.jsx("tbody",{children:e.map((p,g)=>v.jsxs("tr",{style:{background:g%2?"#FAFAFA":"white"},children:[v.jsx("td",{style:{padding:12,borderBottom:"1px solid #F3F4F6"},children:p.Name}),v.jsx("td",{style:{padding:12,borderBottom:"1px solid #F3F4F6"},children:p.AccountType}),v.jsxs("td",{style:{padding:12,borderBottom:"1px solid #F3F4F6",textAlign:"right"},children:["$",parseFloat(p.CurrentBalance||0).toLocaleString()]})]},p.Id||g))})]})})]}),v.jsxs("div",{style:{background:"white",border:"1px solid #E5E7EB",borderRadius:12,padding:24},children:[v.jsx("h3",{style:{marginTop:0,marginBottom:16,fontSize:18},children:"Create Budget"}),v.jsx("form",{onSubmit:m,children:v.jsxs("div",{style:{display:"grid",gap:16},children:[v.jsxs("div",{children:[v.jsx("label",{htmlFor:"budget-name",style:{display:"block",marginBottom:6,fontSize:14,fontWeight:500,color:"#374151"},children:"Budget Name *"}),v.jsx("input",{id:"budget-name",type:"text",value:l.name,onChange:p=>h("name",p.target.value),placeholder:"e.g., Monthly Fuel Budget",required:!0,style:{width:"100%",padding:"10px 12px",border:"1px solid #E5E7EB",borderRadius:8,fontSize:14}})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"budget-account",style:{display:"block",marginBottom:6,fontSize:14,fontWeight:500,color:"#374151"},children:"Account *"}),v.jsxs("select",{id:"budget-account",value:l.account,onChange:p=>h("account",p.target.value),required:!0,style:{width:"100%",padding:"10px 12px",border:"1px solid #E5E7EB",borderRadius:8,fontSize:14},children:[v.jsx("option",{value:"",children:"Select an account..."}),e.map(p=>v.jsxs("option",{value:p.Id,children:[p.Name," (",p.AccountType,")"]},p.Id)),e.length===0&&v.jsx("option",{value:"placeholder",children:"Connect QuickBooks to see accounts"})]})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"budget-amount",style:{display:"block",marginBottom:6,fontSize:14,fontWeight:500,color:"#374151"},children:"Budget Amount *"}),v.jsx("input",{id:"budget-amount",type:"number",step:"0.01",min:"0",value:l.amount,onChange:p=>h("amount",p.target.value),placeholder:"0.00",required:!0,style:{width:"100%",padding:"10px 12px",border:"1px solid #E5E7EB",borderRadius:8,fontSize:14}})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"budget-period",style:{display:"block",marginBottom:6,fontSize:14,fontWeight:500,color:"#374151"},children:"Period"}),v.jsxs("select",{id:"budget-period",value:l.period,onChange:p=>h("period",p.target.value),style:{width:"100%",padding:"10px 12px",border:"1px solid #E5E7EB",borderRadius:8,fontSize:14},children:[v.jsx("option",{value:"monthly",children:"Monthly"}),v.jsx("option",{value:"quarterly",children:"Quarterly"}),v.jsx("option",{value:"annually",children:"Annually"})]})]}),v.jsxs("div",{style:{background:"#F9FAFB",border:"1px dashed #E5E7EB",borderRadius:8,padding:12,fontSize:12,color:"#6B7280"},children:[v.jsx("strong",{children:"TODO:"})," Implement POST to /api/budgets endpoint to save budget object. This form currently shows a preview of what would be submitted."]}),v.jsx("button",{type:"submit",style:{padding:"10px 16px",borderRadius:8,border:"1px solid #111827",background:"#111827",color:"white",cursor:"pointer",fontWeight:500,fontSize:14},children:"Create Budget (Preview)"})]})})]})]})}function g1e({startDate:e,endDate:t,onStartDateChange:r,onEndDateChange:n,compareMode:a,onCompareModeChange:i,compareStart:s,compareEnd:o,onCompareStartChange:l,onCompareEndChange:c}){return v.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[v.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Time Range"}),v.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Start Date"}),v.jsx("input",{type:"date",value:e,onChange:u=>r(u.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"End Date"}),v.jsx("input",{type:"date",value:t,onChange:u=>n(u.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),v.jsxs("div",{className:"mb-3",children:[v.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Compare To"}),v.jsxs("select",{value:a,onChange:u=>i(u.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"none",children:"No Comparison"}),v.jsx("option",{value:"previous",children:"Previous Period"}),v.jsx("option",{value:"custom",children:"Custom Period"})]})]}),a==="custom"&&v.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-3 border-t border-slate-200",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Compare Start"}),v.jsx("input",{type:"date",value:s,onChange:u=>l(u.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Compare End"}),v.jsx("input",{type:"date",value:o,onChange:u=>c(u.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})}const y1e=[{value:"job_count",label:"Job Count"},{value:"revenue",label:"Revenue"}],x1e=[{value:"ticket_count",label:"Ticket Count"},{value:"total_gallons",label:"Total Gallons"},{value:"revenue",label:"Revenue"}];function w1e({source:e,metric:t,granularity:r,onSourceChange:n,onMetricChange:a,onGranularityChange:i}){const s=e==="service"?y1e:x1e;return v.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-4",children:[v.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Metrics"}),v.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Data Source"}),v.jsxs("select",{value:e,onChange:o=>n(o.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"service",children:"Service Jobs"}),v.jsx("option",{value:"delivery",children:"Delivery Tickets"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Metric"}),v.jsx("select",{value:t,onChange:o=>a(o.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:s.map(o=>v.jsx("option",{value:o.value,children:o.label},o.value))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-600 mb-1",children:"Granularity"}),v.jsxs("select",{value:r,onChange:o=>i(o.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"day",children:"Daily"}),v.jsx("option",{value:"week",children:"Weekly"}),v.jsx("option",{value:"month",children:"Monthly"})]})]})]})]})}function FA(e,t){const r=new Date(e);return t==="day"?r.toLocaleDateString("en-US",{month:"short",day:"numeric"}):t==="week"?r.toLocaleDateString("en-US",{month:"short",day:"numeric"}):t==="month"?r.toLocaleDateString("en-US",{year:"numeric",month:"short"}):e}function b1e(e,t){return t.includes("revenue")||t.includes("amount")?`$${parseFloat(e).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:t.includes("gallons")?`${parseFloat(e).toLocaleString(void 0,{maximumFractionDigits:1})} gal`:parseFloat(e).toLocaleString()}function _1e(){const e=new Date,t=new Date;return t.setDate(t.getDate()-30),{start:t.toISOString().split("T")[0],end:e.toISOString().split("T")[0]}}function S1e(){var M,V,z,Y,J,Q;const e=_1e(),[t,r]=R.useState("service"),[n,a]=R.useState("revenue"),[i,s]=R.useState("day"),[o,l]=R.useState(e.start),[c,u]=R.useState(e.end),[f,d]=R.useState("none"),[h,m]=R.useState(""),[p,g]=R.useState(""),[x,w]=R.useState([]),[y,k]=R.useState(!1),[b,_]=R.useState(null),[S,E]=R.useState(null),[T,F]=R.useState(null);R.useEffect(()=>{(t==="service"||t==="delivery")&&a("revenue")},[t]),R.useEffect(()=>{C()},[t,n,i,o,c,f,h,p]);async function C(){k(!0),_(null);try{const j=new Date(o),X=new Date(c),ee={source:t,start:j,end:X,granularity:i};f==="previous"?ee.compare="previous":f==="custom"&&h&&p&&(ee.compare="custom",ee.compareStart=new Date(h),ee.compareEnd=new Date(p));const P=await Vb(ee);if(E(P.debug||null),F(P.totals||null),P.error){_(P.error),w([]),k(!1);return}const B={day:"day",week:"week_start",month:"month_start"}[i],q=(P.primary||[]).map(ne=>({date:FA(ne[B],i),value:parseFloat(ne[n])||0}));if(P.comparison&&P.comparison.length>0){const ne={};P.comparison.forEach(ye=>{const pe=FA(ye[B],i);ne[pe]=parseFloat(ye[n])||0}),q.forEach((ye,pe)=>{P.comparison[pe]&&(ye.comparison=parseFloat(P.comparison[pe][n])||0)})}w(q),k(!1)}catch(j){console.error("[GraphsPage] Error fetching data:",j),_(j.message||"Failed to fetch data"),w([]),k(!1)}}function A(){const j={job_count:"Job Count",ticket_count:"Ticket Count",total_gallons:"Total Gallons",revenue:"Revenue"},X={service:"Service Jobs",delivery:"Delivery Tickets"},ee={day:"Daily",week:"Weekly",month:"Monthly"};return`${X[t]} - ${j[n]} (${ee[i]})`}return v.jsxs("div",{className:"p-4",children:[v.jsx("div",{className:"panel-header mb-4",children:v.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Metrics Graphs"})}),v.jsx(w1e,{source:t,metric:n,granularity:i,onSourceChange:r,onMetricChange:a,onGranularityChange:s}),v.jsx(g1e,{startDate:o,endDate:c,onStartDateChange:l,onEndDateChange:u,compareMode:f,onCompareModeChange:d,compareStart:h,compareEnd:p,onCompareStartChange:m,onCompareEndChange:g}),((M=S==null?void 0:S.primary)==null?void 0:M.usedFallback)&&v.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 [...]"})})}),v.jsxs("div",{className:"ml-3 flex-1",children:[v.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Using fallback aggregation from base tables"}),v.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[v.jsxs("p",{children:["The database view ",v.jsx("code",{className:"bg-yellow-100 px-1 py-0.5 rounded",children:S.primary.viewName})," was not found. Data is being aggregated from the base tables in real-time, which may be slower."]}),v.jsxs("p",{className:"mt-2",children:[v.jsx("strong",{children:"To improve performance:"})," Run ",v.jsx("code",{className:"bg-yellow-100 px-1 py-0.5 rounded",children:"migrations/001_create_metrics_views.sql"})," in your Supabase SQL Editor."]}),(T==null?void 0:T.primary)&&v.jsxs("div",{className:"mt-3 p-3 bg-yellow-100 rounded border border-yellow-300",children:[v.jsx("p",{className:"font-semibold text-yellow-900 mb-1",children:"Aggregated Totals:"}),v.jsxs("ul",{className:"text-xs space-y-1",children:[v.jsxs("li",{children:["• Records: ",T.primary.recordCount]}),t==="service"&&v.jsxs(v.Fragment,{children:[v.jsxs("li",{children:["• Total Jobs: ",(V=T.primary.totalJobs)==null?void 0:V.toLocaleString()]}),v.jsxs("li",{children:["• Total Revenue: $",(z=T.primary.totalRevenue)==null?void 0:z.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),t==="delivery"&&v.jsxs(v.Fragment,{children:[v.jsxs("li",{children:["• Total Tickets: ",(Y=T.primary.totalTickets)==null?void 0:Y.toLocaleString()]}),v.jsxs("li",{children:["• Total Gallons: ",(J=T.primary.totalGallons)==null?void 0:J.toLocaleString(void 0,{maximumFractionDigits:1})]}),v.jsxs("li",{children:["• Total Revenue: $",(Q=T.primary.totalRevenue)==null?void 0:Q.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})]})]})]})}),!y&&!b&&x.length>0&&(()=>{const j=x.some(ee=>ee.value<0),X=x.some(ee=>(n.includes("revenue")||n.includes("amount"))&&ee.value>1e6);return j||X?v.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"flex-shrink-0",children:v.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),v.jsxs("div",{className:"ml-3 flex-1",children:[v.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Data Quality Notice"}),v.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[j&&v.jsx("p",{children:"⚠️ Some data points show negative revenue values. Please verify the data in the base tables."}),X&&v.jsx("p",{children:"⚠️ Some values appear unusually high. Please verify the data for accuracy."})]})]})]})}):null})(),v.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[v.jsx("h2",{className:"text-lg font-semibold text-slate-800 mb-4",children:A()}),y&&v.jsx("div",{className:"flex items-center justify-center h-64",children:v.jsx("div",{className:"text-slate-500",children:"Loading data..."})}),b&&v.jsx("div",{className:"flex items-center justify-center h-64",children:v.jsxs("div",{className:"text-red-500",children:["Error: ",b]})}),!y&&!b&&x.length===0&&v.jsx("div",{className:"flex items-center justify-center h-64",children:v.jsx("div",{className:"text-slate-500",children:"No data available for the selected period"})}),!y&&!b&&x.length>0&&v.jsx(ph,{width:"100%",height:400,children:v.jsxs(ep,{data:x,children:[v.jsx(Xh,{strokeDasharray:"3 3"}),v.jsx(Vl,{dataKey:"date",tick:{fontSize:12},angle:-45,textAnchor:"end",height:80}),v.jsx(Kl,{tick:{fontSize:12},tickFormatter:j=>n.includes("revenue")||n.includes("amount")?`$${(j/1e3).toFixed(0)}k`:j.toLocaleString()}),v.jsx(xn,{formatter:j=>b1e(j,n),contentStyle:{fontSize:12}}),v.jsx(ai,{}),v.jsx(gi,{type:"monotone",dataKey:"value",stroke:"#3b82f6",strokeWidth:2,name:"Current Period",dot:{r:4}}),x.some(j=>j.comparison!==void 0)&&v.jsx(gi,{type:"monotone",dataKey:"comparison",stroke:"#f59e0b",strokeWidth:2,strokeDasharray:"5 5",name:"Comparison Period",dot:{r:4}})]})})]})]})}function Gb(e){return typeof e!="number"?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function fI(e){if(!e)return"";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return e}}function dI({status:e}){const r={pending:"bg-yellow-100 text-yellow-800",needs_review:"bg-orange-100 text-orange-800",accepted:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800";return v.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${r}`,children:e==null?void 0:e.replace("_"," ").toUpperCase()})}function k1e({row:e,index:t,onUpdate:r,included:n,onIncludeChange:a,importType:i}){const[s,o]=R.useState(!1),[l,c]=R.useState(e),[u,f]=R.useState(!1),d=()=>{r(t,l),o(!1)},h=()=>{c(e),o(!1)},m=i==="delivery";return s?v.jsxs("tr",{className:"bg-blue-50",children:[v.jsx("td",{className:"px-4 py-2",children:v.jsx("input",{type:"checkbox",checked:n,onChange:p=>a(t,p.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})}),m?v.jsxs(v.Fragment,{children:[v.jsx("td",{className:"px-4 py-2",children:v.jsx("input",{type:"text",value:l.customerName||l.customer||"",onChange:p=>c({...l,customerName:p.target.value,customer:p.target.value}),className:"w-full px-2 py-1 text-sm border rounded",placeholder:"Customer"})}),v.jsx("td",{className:"px-4 py-2",children:v.jsx("input",{type:"text",value:l.truck||l.driver||"",onChange:p=>c({...l,truck:p.target.value}),className:"w-full px-2 py-1 text-sm border rounded",placeholder:"Truck/Driver"})}),v.jsx("td",{className:"px-4 py-2",children:v.jsx("input",{type:"number",step:"0.01",value:l.qty||l.gallons||"",onChange:p=>{const g=parseFloat(p.target.value)||0;c({...l,qty:g})},className:"w-full px-2 py-1 text-sm border rounded",placeholder:"Qty/Gallons"})})]}):v.jsxs(v.Fragment,{children:[v.jsx("td",{className:"px-4 py-2",children:v.jsx("input",{type:"text",value:l.jobNumber||"",onChange:p=>c({...l,jobNumber:p.target.value}),className:"w-full px-2 py-1 text-sm border rounded",placeholder:"Job #"})}),v.jsx("td",{className:"px-4 py-2",children:v.jsx("input",{type:"text",value:l.customer||"",onChange:p=>c({...l,customer:p.target.value}),className:"w-full px-2 py-1 text-sm border rounded",placeholder:"Customer"})})]}),v.jsx("td",{className:"px-4 py-2",children:v.jsx("input",{type:"text",value:l.date||"",onChange:p=>c({...l,date:p.target.value}),className:"w-full px-2 py-1 text-sm border rounded",placeholder:"Date"})}),v.jsx("td",{className:"px-4 py-2",children:v.jsxs("select",{value:l.status||"",onChange:p=>c({...l,status:p.target.value}),className:"w-full px-2 py-1 text-sm border rounded",children:[v.jsx("option",{value:"",children:"-"}),v.jsx("option",{value:"scheduled",children:"Scheduled"}),v.jsx("option",{value:"assigned",children:"Assigned"}),v.jsx("option",{value:"confirmed",children:"Confirmed"}),v.jsx("option",{value:"completed",children:"Completed"})]})}),v.jsx("td",{className:"px-4 py-2",children:v.jsx("input",{type:"number",step:"0.01",value:l.amount||"",onChange:p=>c({...l,amount:parseFloat(p.target.value)||0}),className:"w-full px-2 py-1 text-sm border rounded",placeholder:"Amount"})}),v.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:l.page}),v.jsx("td",{className:"px-4 py-2 text-sm",children:v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:d,className:"text-green-600 hover:text-green-800 font-medium text-xs",children:"Save"}),v.jsx("button",{onClick:h,className:"text-gray-600 hover:text-gray-800 font-medium text-xs",children:"Cancel"})]})})]}):v.jsxs(v.Fragment,{children:[v.jsxs("tr",{className:n?"hover:bg-gray-50":"bg-gray-100 text-gray-400 hover:bg-gray-100",children:[v.jsx("td",{className:"px-4 py-2 text-sm",children:v.jsx("input",{type:"checkbox",checked:n,onChange:p=>a(t,p.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})}),m?v.jsxs(v.Fragment,{children:[v.jsx("td",{className:"px-4 py-2 text-sm",children:e.customerName||e.customer||"-"}),v.jsx("td",{className:"px-4 py-2 text-sm",children:e.truck||e.driver||"-"}),v.jsx("td",{className:"px-4 py-2 text-sm",children:e.qty||e.gallons||"-"})]}):v.jsxs(v.Fragment,{children:[v.jsx("td",{className:"px-4 py-2 text-sm",children:e.jobNumber||"-"}),v.jsx("td",{className:"px-4 py-2 text-sm",children:e.customer||"-"})]}),v.jsx("td",{className:"px-4 py-2 text-sm",children:e.date||"-"}),v.jsx("td",{className:"px-4 py-2 text-sm",children:e.status||"-"}),v.jsx("td",{className:"px-4 py-2 text-sm",children:Gb(e.amount)}),v.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:e.page}),v.jsx("td",{className:"px-4 py-2 text-sm",children:v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>o(!0),className:"text-blue-600 hover:text-blue-800 font-medium text-xs",children:"Edit"}),e.rawColumns&&v.jsx("button",{onClick:()=>f(!u),className:"text-gray-600 hover:text-gray-800 font-medium text-xs",children:u?"Hide":"Raw"})]})})]}),u&&e.rawColumns&&v.jsx("tr",{className:"bg-gray-50",children:v.jsxs("td",{colSpan:m?9:8,className:"px-4 py-2 text-xs text-gray-600",children:[v.jsx("div",{className:"font-medium mb-1",children:"Raw Columns:"}),v.jsx("div",{className:"font-mono",children:JSON.stringify(e.rawColumns)})]})})]})}function E1e({importRecord:e,onClose:t,onStatusChange:r}){var T,F,C,A;const[n,a]=R.useState([]),[i,s]=R.useState([]),[o,l]=R.useState([]),[c,u]=R.useState(""),[f,d]=R.useState({}),[h,m]=R.useState(null),[p,g]=R.useState(!1);R.useEffect(()=>{var M;if(e){const V=e.parsed||{},z=V.rows||[];a(z),s(z.map(()=>!0)),d(V.summary||{}),u(e.ocr_text||""),m(((M=e.meta)==null?void 0:M.detection)||null),x()}},[e]);const x=async()=>{if(!(e!=null&&e.attached_files))return;const M=[];for(const V of e.attached_files)try{const{data:z}=await be.storage.from("ticket-scans").createSignedUrl(V.path,3600);z!=null&&z.signedUrl&&M.push({url:z.signedUrl,filename:V.filename})}catch(z){console.error("[ImportsReview] Error loading image:",z)}l(M)},w=(M,V)=>{const z=[...n];z[M]=V,a(z)},y=(M,V)=>{const z=[...i];z[M]=V,s(z)},k=()=>i.filter(Boolean).length,b=async()=>{g(!0);try{const M={...e.parsed,rows:n,summary:E(n)},{error:V}=await be.from("ticket_imports").update({parsed:M}).eq("id",e.id);if(V)throw V;alert("Draft saved successfully"),r()}catch(M){console.error("[ImportsReview] Error saving draft:",M),alert("Failed to save draft: "+M.message)}finally{g(!1)}},_=async()=>{const M=k();if(M===0){alert("No rows selected. Please select at least one row to import.");return}if(confirm(`Accept this import and create ${M} ticket(s)/job(s)?`)){g(!0);try{const V=n.filter((J,Q)=>i[Q]),z=await fetch("/.netlify/functions/imports-accept",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({importId:e.id})});if(!z.ok){const J=await z.json();throw new Error(J.message||"Failed to accept import")}const Y=await z.json();if(!Y.success)throw new Error(Y.message||"Failed to accept import");alert(`Import accepted successfully!

Created: ${Y.inserted||0} record(s)
Failed: ${Y.failed||0} record(s)`),r(),t()}catch(V){console.error("[ImportsReview] Error accepting import:",V),alert("Failed to accept import: "+V.message)}finally{g(!1)}}},S=async()=>{if(confirm("Reject this import?")){g(!0);try{const{error:M}=await be.from("ticket_imports").update({status:"rejected"}).eq("id",e.id);if(M)throw M;alert("Import rejected"),r(),t()}catch(M){console.error("[ImportsReview] Error rejecting import:",M),alert("Failed to reject import: "+M.message)}finally{g(!1)}}},E=M=>{let V=0,z=0,Y=0;return M.forEach(J=>{const Q=(J.status||"").toLowerCase(),j=J.amount||0;(Q.includes("scheduled")||Q.includes("assigned")||Q.includes("confirmed"))&&(V++,z+=j),Y+=j}),{totalRows:M.length,scheduledJobs:V,scheduledRevenue:z,salesTotal:Y}};return e?v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-auto",children:v.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full m-4 max-h-[90vh] overflow-auto",children:[v.jsxs("div",{className:"border-b p-6 sticky top-0 bg-white z-10",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsxs("h2",{className:"text-2xl font-bold",children:["Import #",e.id]}),v.jsxs("div",{className:"flex gap-4 mt-2 text-sm text-gray-600",children:[v.jsxs("span",{children:["Source: ",e.src]}),v.jsxs("span",{children:["Created: ",fI(e.created_at)]}),v.jsx(dI,{status:e.status})]}),h&&v.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[v.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded ${h.type==="delivery"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:(T=h.type)==null?void 0:T.toUpperCase()}),v.jsxs("span",{className:"text-xs text-gray-600",children:["Confidence: ",((h.confidence||0)*100).toFixed(0),"%"]}),v.jsxs("span",{className:"text-xs text-gray-600",children:["(",((F=h.hits)==null?void 0:F.length)||0," tokens matched)"]}),h.hits&&h.hits.length>0&&v.jsxs("span",{className:"text-xs text-gray-500",children:["[",h.hits.join(", "),"]"]})]})]}),v.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-2xl font-bold",children:"×"})]}),v.jsxs("div",{className:"grid grid-cols-5 gap-4 mt-4",children:[v.jsxs("div",{className:"bg-gray-50 rounded p-3",children:[v.jsx("div",{className:"text-xs text-gray-500",children:"Total Rows"}),v.jsx("div",{className:"text-xl font-bold",children:f.totalRows||0})]}),v.jsxs("div",{className:"bg-blue-50 rounded p-3",children:[v.jsx("div",{className:"text-xs text-gray-500",children:"Selected to Import"}),v.jsx("div",{className:"text-xl font-bold text-blue-600",children:k()})]}),v.jsxs("div",{className:"bg-green-50 rounded p-3",children:[v.jsx("div",{className:"text-xs text-gray-500",children:"Scheduled Jobs"}),v.jsx("div",{className:"text-xl font-bold",children:f.scheduledJobs||0})]}),v.jsxs("div",{className:"bg-green-50 rounded p-3",children:[v.jsx("div",{className:"text-xs text-gray-500",children:"Scheduled Revenue"}),v.jsx("div",{className:"text-xl font-bold",children:Gb(f.scheduledRevenue||0)})]}),v.jsxs("div",{className:"bg-purple-50 rounded p-3",children:[v.jsx("div",{className:"text-xs text-gray-500",children:"OCR Confidence"}),v.jsxs("div",{className:"text-xl font-bold",children:[((e.confidence||0)*100).toFixed(1),"%"]})]})]})]}),v.jsxs("div",{className:"p-6",children:[o.length>0&&v.jsxs("div",{className:"mb-6",children:[v.jsx("h3",{className:"text-lg font-bold mb-3",children:"Scanned Images"}),v.jsx("div",{className:"grid grid-cols-2 gap-4",children:o.map((M,V)=>v.jsxs("div",{className:"border rounded overflow-hidden",children:[v.jsx("img",{src:M.url,alt:M.filename,className:"w-full h-auto"}),v.jsx("div",{className:"bg-gray-50 px-3 py-2 text-sm text-gray-600",children:M.filename})]},V))})]}),v.jsxs("div",{className:"mb-6",children:[v.jsxs("h3",{className:"text-lg font-bold mb-3",children:["Parsed Data",v.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(Type: ",((C=e.meta)==null?void 0:C.importType)||"service",")"]})]}),v.jsx("div",{className:"border rounded overflow-hidden",children:v.jsxs("table",{className:"w-full",children:[v.jsx("thead",{className:"bg-gray-50",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:v.jsx("input",{type:"checkbox",checked:i.length>0&&i.every(Boolean),ref:M=>{if(M){const V=i.some(Boolean),z=i.every(Boolean);M.indeterminate=V&&!z}},onChange:M=>s(n.map(()=>M.target.checked)),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500",title:"Select/Deselect All"})}),((A=e.meta)==null?void 0:A.importType)==="delivery"?v.jsxs(v.Fragment,{children:[v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Truck/Driver"}),v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"})]}):v.jsxs(v.Fragment,{children:[v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Job #"}),v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"})]}),v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Page"}),v.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),v.jsx("tbody",{className:"divide-y",children:n.map((M,V)=>{var z;return v.jsx(k1e,{row:M,index:V,onUpdate:w,included:i[V],onIncludeChange:y,importType:((z=e.meta)==null?void 0:z.importType)||"service"},V)})})]})})]}),v.jsxs("details",{className:"mb-6",children:[v.jsx("summary",{className:"text-lg font-bold mb-3 cursor-pointer",children:"Raw OCR Text"}),v.jsx("pre",{className:"bg-gray-50 p-4 rounded text-xs overflow-auto max-h-64",children:c})]})]}),v.jsxs("div",{className:"border-t p-6 bg-gray-50 sticky bottom-0 flex gap-4 justify-end",children:[v.jsx("button",{onClick:S,disabled:p,className:"px-6 py-2 border border-red-500 text-red-600 rounded hover:bg-red-50 disabled:opacity-50",children:"Reject"}),v.jsx("button",{onClick:b,disabled:p,className:"px-6 py-2 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50",children:"Save Draft"}),v.jsx("button",{onClick:_,disabled:p,className:"px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:"Accept & Create Tickets"})]})]})}):null}function T1e(){const[e,t]=R.useState([]),[r,n]=R.useState(!0),[a,i]=R.useState(null),[s,o]=R.useState("needs_review");R.useEffect(()=>{l()},[s]);const l=async()=>{n(!0);try{let d=be.from("ticket_imports").select("*").order("created_at",{ascending:!1});s!=="all"&&(d=d.eq("status",s));const{data:h,error:m}=await d;if(m)throw m;t(h||[])}catch(d){console.error("[ImportsReview] Error loading imports:",d)}finally{n(!1)}},c=d=>{i(d)},u=()=>{i(null)},f=()=>{l()};return v.jsxs("div",{className:"max-w-7xl mx-auto",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Ticket Imports Review"}),v.jsx("p",{className:"text-gray-600",children:"Review and approve scanned ticket imports"})]}),v.jsx("div",{className:"mb-6 flex gap-2",children:["all","pending","needs_review","accepted","rejected"].map(d=>v.jsx("button",{onClick:()=>o(d),className:`px-4 py-2 rounded font-medium ${s===d?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:d.replace("_"," ").toUpperCase()},d))}),r?v.jsx("div",{className:"text-center py-12 text-gray-500",children:"Loading..."}):e.length===0?v.jsxs("div",{className:"text-center py-12 text-gray-500",children:["No imports found with status: ",s]}):v.jsx("div",{className:"grid gap-4",children:e.map(d=>{var h;return v.jsx("div",{onClick:()=>c(d),className:"border rounded-lg p-4 hover:shadow-lg cursor-pointer transition-shadow",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"font-bold text-lg",children:["Import #",d.id]}),v.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[v.jsxs("span",{children:["Source: ",d.src]}),d.src_email&&v.jsxs("span",{className:"ml-4",children:["From: ",d.src_email]}),v.jsxs("span",{className:"ml-4",children:["Created: ",fI(d.created_at)]})]}),((h=d.parsed)==null?void 0:h.summary)&&v.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:[d.parsed.summary.totalRows," rows,"," ",d.parsed.summary.scheduledJobs," scheduled jobs,"," ",Gb(d.parsed.summary.scheduledRevenue)," scheduled revenue"]})]}),v.jsxs("div",{className:"flex items-center gap-4",children:[d.confidence&&v.jsxs("div",{className:"text-right",children:[v.jsx("div",{className:"text-xs text-gray-500",children:"Confidence"}),v.jsxs("div",{className:"font-bold",children:[(d.confidence*100).toFixed(1),"%"]})]}),v.jsx(dI,{status:d.status})]})]})},d.id)})}),a&&v.jsx(E1e,{importRecord:a,onClose:u,onStatusChange:f})]})}class A1e extends Z.Component{constructor(t){super(t),this.state={err:null}}static getDerivedStateFromError(t){return{err:t}}componentDidCatch(t,r){console.error("Render error:",t,r)}render(){return this.state.err?v.jsxs("div",{style:{padding:24},children:[v.jsx("h2",{style:{marginTop:0},children:"Something went wrong."}),v.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:String(this.state.err)})]}):this.props.children}}function O1e(){const[e,t]=R.useState("user");return R.useEffect(()=>{let r=!1;async function n(){var i;try{const{data:s}=await be.auth.getUser(),o=(i=s==null?void 0:s.user)==null?void 0:i.id;if(!o)return;const{data:l}=await be.from("profiles").select("role").eq("id",o).maybeSingle();r||t(((l==null?void 0:l.role)||"user").toLowerCase())}catch{r||t("user")}}n();const{data:a}=be.auth.onAuthStateChange(()=>n());return()=>{var i,s;r=!0,(s=(i=a==null?void 0:a.subscription)==null?void 0:i.unsubscribe)==null||s.call(i)}},[]),v.jsxs("div",{style:{position:"fixed",right:16,bottom:16,background:"#111827",color:"white",padding:"6px 10px",borderRadius:8,fontSize:12,zIndex:9,boxShadow:"0 4px 16px rgba(0,0,0,0.2)"},children:["Role: ",e]})}function Wo({children:e,fallback:t=null}){const[r,n]=R.useState(null);return R.useEffect(()=>{let a=!0;return(async()=>{var i;try{const{data:s}=await be.auth.getUser(),o=(i=s==null?void 0:s.user)==null?void 0:i.id;if(!o){a&&n(!1);return}const{data:l,error:c}=await be.from("profiles").select("role").eq("id",o).maybeSingle();if(!a)return;if(c){console.error("AdminOnly profile error:",c),n(!1);return}n(((l==null?void 0:l.role)||"").toLowerCase()==="admin")}catch{a&&n(!1)}})(),()=>{a=!1}},[]),r===null?null:r?v.jsx(v.Fragment,{children:e}):t}function C1e(){const[e,t]=R.useState(""),[r,n]=R.useState(!1),[a,i]=R.useState("");async function s(o){o.preventDefault(),i("");const l=new URL("/KPI-Dashboard/",window.location.href).href,{error:c}=await be.auth.signInWithOtp({email:e,options:{emailRedirectTo:l}});c?i(c.message):n(!0)}return v.jsx("div",{style:{minHeight:"100vh",display:"grid",placeItems:"center",background:"#F8FAFC"},children:v.jsxs("div",{style:{width:380,background:"#fff",border:"1px solid #E5E7EB",borderRadius:12,padding:24},children:[v.jsx("h2",{style:{marginTop:0},children:"Sign in"}),r?v.jsx("div",{children:v.jsx("p",{children:"We sent you a sign-in link. Open it on this device."})}):v.jsxs("form",{onSubmit:s,children:[v.jsx("label",{style:{display:"block",fontSize:12,color:"#6B7280",marginBottom:6},children:"Work email"}),v.jsx("input",{type:"email",required:!0,value:e,onChange:o=>t(o.target.value),placeholder:"you@company.com",style:{width:"100%",padding:"10px 12px",border:"1px solid #E5E7EB",borderRadius:8,marginBottom:12}}),!!a&&v.jsx("div",{style:{color:"#b91c1c",fontSize:12,marginBottom:8},children:a}),v.jsx("button",{type:"submit",style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #E5E7EB",background:"#111827",color:"white",cursor:"pointer"},children:"Send magic link"})]})]})})}function P1e({title:e,actions:t,children:r}){return v.jsxs("section",{style:{marginTop:24},children:[v.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:12},children:[v.jsx("h3",{style:{margin:0,fontSize:16},children:e}),v.jsx("div",{style:{marginLeft:"auto"},children:t})]}),v.jsx("div",{children:r})]})}function j1e({columns:e,rows:t,keyField:r}){return v.jsx("div",{style:{overflow:"auto",border:"1px solid #E5E7EB",borderRadius:12},children:v.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[v.jsx("thead",{children:v.jsx("tr",{style:{background:"#F3F4F6"},children:e.map(n=>v.jsx("th",{style:{textAlign:"left",padding:"10px 12px",fontSize:12,color:"#6B7280",borderBottom:"1px solid #E5E7EB"},children:n.label},n.key))})}),v.jsx("tbody",{children:t.map((n,a)=>v.jsx("tr",{style:{background:a%2?"#FAFAFA":"white"},children:e.map(i=>v.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid #F3F4F6",fontSize:13},children:typeof i.render=="function"?i.render(n[i.key],n,a):n[i.key]},i.key))},n[r]??a))})]})})}const hI=Z.createContext(null),IA={propaneGallonsSold:428310,unleadedSalesCStores:1318550,offRoadDieselGallons:96440,newTanksSet:42,serviceRevenue:264900,customerCounts:[{state:"TX",residential:1240,commercial:310},{state:"NM",residential:460,commercial:120},{state:"OK",residential:380,commercial:95}]},DA="kpi-store-v1";function N1e({children:e}){const[t,r]=R.useState(()=>{try{const o=localStorage.getItem(DA);return o?JSON.parse(o):IA}catch{return IA}}),[n,a]=R.useState(!1);R.useEffect(()=>{try{localStorage.setItem(DA,JSON.stringify(t))}catch{}},[t]);const i=R.useCallback(o=>r(l=>({...l,...o})),[]),s={kpis:t,setKpis:r,update:i,editMode:n,setEditMode:a};return v.jsx(hI.Provider,{value:s,children:e})}function F1e(){const e=R.useContext(hI);if(!e)throw new Error("useKpis must be used within KPIProvider");return e}const RA=["Midland","Odessa","Lubbock","Abilene","San Angelo"],MA=["Diesel","Gasoline","DEF"],$A=["J. Carter","L. Nguyen","M. Patel","R. Gomez","S. Ali"],Ka=(e,t)=>Math.round(e+Math.random()*(t-e)),I1e=(e,t)=>e+Math.random()*(t-e);function D1e(e=160){return Array.from({length:e},(t,r)=>{const n=Ka(300,5e3),a=parseFloat(I1e(2.25,4.25).toFixed(2));return{id:r+1,date:new Date(2025,7,Ka(1,30)).toISOString().slice(0,10),store:RA[Ka(0,RA.length-1)],product:MA[Ka(0,MA.length-1)],driver:$A[Ka(0,$A.length-1)],gallons:n,price:a,amount:n*a,ticketId:"T-"+(1e3+r),status:["Delivered","Scheduled","Issue"][Ka(0,2)],notes:Ka(0,4)?"":"Call store on arrival"}})}function R1e(e){const t=new Map;return e.forEach(r=>{t.set(r.store,(t.get(r.store)||0)+r.amount)}),Array.from(t.entries()).map(([r,n],a)=>({id:a+1,invoiceNo:"INV-"+(5e3+a),store:r,total:n,status:["Open","Pending","Paid"][Ka(0,2)],created:new Date(2025,7,Ka(1,30)).toISOString().slice(0,10)}))}function M1e(){const[e]=R.useState(D1e(160)),t=R.useMemo(()=>R1e(e),[e]);return v.jsx("div",{style:{display:"grid",gap:16},children:v.jsx(P1e,{title:"Store Invoicing",children:v.jsx(j1e,{keyField:"id",columns:[{key:"invoiceNo",label:"Invoice"},{key:"store",label:"Store"},{key:"created",label:"Created"},{key:"status",label:"Status"},{key:"total",label:"Total",render:r=>"$"+r.toLocaleString(void 0,{maximumFractionDigits:0})}],rows:t})})})}const qx=[{key:"dashboard",label:"Dashboard",adminOnly:!1,Component:e1e},{key:"budget",label:"Budget",adminOnly:!1,Component:v1e},{key:"procedures",label:"Procedures",adminOnly:!1,Component:S6},{key:"billboard",label:"Billboard",adminOnly:!1,Component:m1e},{key:"graphs",label:"Graphs",adminOnly:!1,Component:S1e},{key:"invoicing",label:"Store Invoicing",adminOnly:!0,Component:M1e},{key:"tickets",label:"Delivery Tickets",adminOnly:!0,Component:Axe},{key:"service",label:"Service Tracking",adminOnly:!0,Component:qxe},{key:"imports",label:"Imports Review",adminOnly:!0,Component:T1e}];function $1e({session:e}){const[t,r]=R.useState(!1),n=Object.keys(localStorage).filter(i=>i.startsWith("sb-")).slice(0,5),a=new URL("/KPI-Dashboard/",window.location.href).href;return v.jsxs("div",{style:{position:"fixed",left:16,bottom:16,zIndex:9999},children:[v.jsxs("button",{onClick:()=>r(i=>!i),style:{padding:"6px 10px",borderRadius:8,border:"1px solid #E5E7EB",background:t?"#111827":"white",color:t?"white":"#111827",cursor:"pointer"},children:[t?"Hide":"Show"," Debug"]}),t&&v.jsx("pre",{style:{marginTop:8,maxWidth:420,maxHeight:260,overflow:"auto",background:"white",border:"1px solid #E5E7EB",borderRadius:12,padding:12,fontSize:12},children:JSON.stringify({session:e!=null&&e.user?{id:e.user.id,email:e.user.email}:null,access_token:e!=null&&e.access_token?"[present]":null,expectedRedirect:a,path:window.location.pathname,hasSupabaseKeys:n.length>0,supabaseKeysPreview:n},null,2)})]})}function L1e(){const[e,t]=R.useState("dashboard"),[r,n]=R.useState(null),[a,i]=R.useState(!0),[s,o]=R.useState({operations:!0});function l(u){o(f=>({...f,[u]:!f[u]}))}if(R.useEffect(()=>{let u=!0;async function f(){try{const{data:h,error:m}=await be.auth.getSession();if(m&&console.error("getSession error:",m),!u)return;n((h==null?void 0:h.session)??null)}catch(h){if(console.error("Auth init threw:",h),!u)return;n(null)}finally{u&&i(!1)}}f();const{data:d}=be.auth.onAuthStateChange((h,m)=>{u&&(n(m),i(!1))});return()=>{var h,m;u=!1,(m=(h=d==null?void 0:d.subscription)==null?void 0:h.unsubscribe)==null||m.call(h)}},[]),a)return v.jsxs("div",{style:{padding:24},children:[v.jsx("div",{style:{fontSize:18,marginBottom:8},children:"Restoring session…"}),v.jsxs("div",{style:{fontSize:13,color:"#6B7280"},children:["If this never finishes, try ",v.jsx("a",{href:new URL("/KPI-Dashboard/",window.location.href).href,children:"reloading"}),"."]})]});if(!r)return v.jsx(C1e,{});const c=qx.find(u=>u.key===e)||qx[0];return v.jsx(A1e,{children:v.jsxs(N1e,{children:[v.jsx(B1e,{}),v.jsx(O1e,{}),v.jsx($1e,{session:r}),v.jsx(U1e,{active:e,setActive:t,groupsOpen:s,toggleGroup:l,Current:c})]})})}function B1e(){const{editMode:e,setEditMode:t}=F1e();return v.jsx("header",{style:{padding:"16px 24px",borderBottom:"1px solid #E5E7EB",background:"white",position:"sticky",top:0,zIndex:5},children:v.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[v.jsx("h1",{style:{margin:0,fontSize:20},children:"Gibson Oil & Gas — KPI Dashboard"}),v.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[v.jsx(Wo,{fallback:null,children:v.jsx("button",{onClick:()=>t(!e),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #E5E7EB",background:e?"#111827":"white",color:e?"white":"#111827",cursor:"pointer"},title:"Toggle edit mode for manual KPI updates",children:e?"Editing KPIs…":"Edit KPIs"})}),v.jsx("button",{onClick:async()=>{await be.auth.signOut(),window.location.reload()},style:{padding:"8px 10px",borderRadius:8,border:"1px solid #E5E7EB",background:"white",cursor:"pointer"},children:"Sign out"})]})]})})}function U1e({active:e,setActive:t,groupsOpen:r,toggleGroup:n,Current:a}){return v.jsxs("div",{style:{display:"flex",background:"#F8FAFC",minHeight:"calc(100vh - 60px)"},children:[v.jsx("aside",{style:{width:260,borderRight:"1px solid #E5E7EB",background:"white",minHeight:"calc(100vh - 60px)",position:"sticky",top:60,alignSelf:"flex-start"},children:v.jsxs("nav",{style:{padding:12},children:[["dashboard","financial","ops","budget","export","procedures","billboard","graphs"].map(i=>{const s=qx.find(l=>l.key===i);if(!s)return null;const o=a.key===s.key;return v.jsx("button",{onClick:()=>t(s.key),style:{display:"block",width:"100%",textAlign:"left",padding:"10px 12px",marginBottom:6,borderRadius:8,border:"1px solid #E5E7EB",background:o?"#EEF2FF":"white",cursor:"pointer",fontWeight:500},children:s.label},s.key)}),v.jsx("div",{style:{marginTop:10,marginBottom:6,fontSize:12,color:"#6B7280"},children:"GROUP"}),v.jsxs("div",{style:{border:"1px solid #E5E7EB",borderRadius:10,overflow:"hidden",background:"white"},children:[v.jsxs("button",{onClick:()=>n("operations"),style:{display:"flex",gap:8,alignItems:"center",width:"100%",padding:"10px 12px",border:"none",background:"white",cursor:"pointer",fontWeight:600},children:[v.jsx("span",{style:{display:"inline-block",width:18,textAlign:"center",transform:r.operations?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"}}),"Operations"]}),r.operations&&v.jsxs("div",{style:{borderTop:"1px solid #F3F4F6",padding:8},children:[v.jsx(Wo,{fallback:null,children:v.jsx("button",{onClick:()=>t("invoicing"),style:{display:"block",width:"100%",textAlign:"left",padding:"8px 12px",borderRadius:8,border:"1px solid #E5E7EB",background:a.key==="invoicing"?"#EEF2FF":"white",cursor:"pointer",fontWeight:500,marginBottom:6},children:"Store Invoicing 🔒"})}),v.jsx(Wo,{fallback:null,children:v.jsx("button",{onClick:()=>t("tickets"),style:{display:"block",width:"100%",textAlign:"left",padding:"8px 12px",borderRadius:8,border:"1px solid #E5E7EB",background:a.key==="tickets"?"#EEF2FF":"white",cursor:"pointer",fontWeight:500,marginBottom:6},children:"Delivery Tickets 🔒"})}),v.jsx(Wo,{fallback:null,children:v.jsx("button",{onClick:()=>t("service"),style:{display:"block",width:"100%",textAlign:"left",padding:"8px 12px",borderRadius:8,border:"1px solid #E5E7EB",background:a.key==="service"?"#EEF2FF":"white",cursor:"pointer",fontWeight:500},children:"Service Tracking 🔒"})}),v.jsx(Wo,{fallback:v.jsx("div",{style:{fontSize:12,color:"#6B7280",padding:"6px 12px"},children:"Admin-only tools live here."}),children:null})]})]})]})}),v.jsx("main",{style:{flex:1,padding:24},children:a.adminOnly?v.jsx(Wo,{fallback:v.jsx("div",{children:"Admins only."}),children:v.jsx(a.Component,{})}):v.jsx(a.Component,{})})]})}function W1e(){const[e,t]=Z.useState("password"),[r,n]=Z.useState(""),[a,i]=Z.useState(""),[s,o]=Z.useState(!1),[l,c]=Z.useState("");async function u(h){h.preventDefault(),o(!0),c("");const{error:m}=await be.auth.signInWithPassword({email:r,password:a});o(!1),m?c(m.message):window.location.reload()}async function f(h){h.preventDefault(),o(!0),c("");const{error:m}=await be.auth.signUp({email:r,password:a});o(!1),c(m?m.message:"Check your email to confirm your account, then sign in.")}async function d(h){h.preventDefault(),o(!0),c("");const{error:m}=await be.auth.signInWithOtp({email:r});o(!1),c(m?m.message:"Magic link sent. Check your email.")}return v.jsxs("div",{style:{width:360,padding:24,border:"1px solid #e5e7eb",borderRadius:12,background:"white",boxShadow:"0 10px 30px rgba(0,0,0,0.08)"},children:[v.jsx("h2",{style:{marginTop:0,marginBottom:12},children:"Sign in"}),v.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16},children:[v.jsx("button",{onClick:()=>t("password"),style:{flex:1,padding:8,borderRadius:8,border:"1px solid #d1d5db",background:e==="password"?"#111827":"white",color:e==="password"?"white":"black",cursor:"pointer"},children:"Email + Password"}),v.jsx("button",{onClick:()=>t("magic"),style:{flex:1,padding:8,borderRadius:8,border:"1px solid #d1d5db",background:e==="magic"?"#111827":"white",color:e==="magic"?"white":"black",cursor:"pointer"},children:"Magic Link"})]}),e==="password"?v.jsxs("form",{onSubmit:u,children:[v.jsx("label",{children:"Email"}),v.jsx("input",{type:"email",required:!0,value:r,onChange:h=>n(h.target.value),style:rg}),v.jsx("label",{children:"Password"}),v.jsx("input",{type:"password",required:!0,value:a,onChange:h=>i(h.target.value),style:rg}),v.jsxs("div",{style:{display:"flex",gap:8},children:[v.jsx("button",{type:"submit",disabled:s,style:LA,children:s?"Signing in…":"Sign in"}),v.jsx("button",{onClick:f,disabled:s,style:z1e,children:"Create account"})]})]}):v.jsxs("form",{onSubmit:d,children:[v.jsx("label",{children:"Email"}),v.jsx("input",{type:"email",required:!0,value:r,onChange:h=>n(h.target.value),style:rg}),v.jsx("button",{type:"submit",disabled:s,style:LA,children:s?"Sending…":"Send magic link"})]}),l&&v.jsx("p",{style:{marginTop:12,color:"#b91c1c"},children:l})]})}const rg={width:"100%",padding:10,border:"1px solid #d1d5db",borderRadius:8,marginBottom:12},LA={flex:1,padding:10,background:"#111827",color:"white",border:"1px solid #111827",borderRadius:8,cursor:"pointer"},z1e={flex:1,padding:10,background:"white",color:"black",border:"1px solid #d1d5db",borderRadius:8,cursor:"pointer"};function H1e({children:e}){const[t,r]=Z.useState("checking");return Z.useEffect(()=>{let n=!0;async function a(){const{data:s,error:o}=await be.auth.getSession();if(n){if(console.log("[AuthGate] getSession:",{data:s,error:o}),o){r("signed-out");return}r(s!=null&&s.session?"signed-in":"signed-out")}}a();const{data:{subscription:i}}=be.auth.onAuthStateChange((s,o)=>{n&&(console.log("[AuthGate] onAuthStateChange:",{session:o}),r(o?"signed-in":"signed-out"))});return()=>{n=!1,i.unsubscribe()}},[]),t==="checking"?v.jsx("div",{style:{padding:24},children:v.jsx("p",{children:"Checking sign-in…"})}):t==="signed-out"?v.jsx("div",{style:{minHeight:"100vh",display:"grid",placeItems:"center"},children:v.jsx(W1e,{})}):v.jsx(v.Fragment,{children:e})}function V1e(){const[e,t]=Z.useState("");Z.useEffect(()=>{let n=!0;be.auth.getUser().then(({data:i})=>{var s;n&&t(((s=i==null?void 0:i.user)==null?void 0:s.email)||"")});const{data:{subscription:a}}=be.auth.onAuthStateChange((i,s)=>{var o;t(((o=s==null?void 0:s.user)==null?void 0:o.email)||"")});return()=>{n=!1,a.unsubscribe()}},[]);async function r(){await be.auth.signOut(),window.location.reload()}return v.jsxs("div",{className:"app-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1.5rem",fontSize:"0.875rem"},children:[v.jsx("div",{style:{fontWeight:600,fontSize:"1rem"},children:"Gibson Oil & Gas — KPI Dashboard"}),v.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[v.jsx("span",{style:{opacity:.8},children:e?`Signed in as ${e}`:"Not signed in"}),v.jsx("button",{onClick:r,className:"btn btn-sm secondary",children:"Sign out"})]})]})}ng.createRoot(document.getElementById("root")).render(v.jsx(Z.StrictMode,{children:v.jsxs(H1e,{children:[v.jsx(V1e,{}),v.jsx(L1e,{})]})}));
//# sourceMappingURL=index-C81WKdMD.js.map
